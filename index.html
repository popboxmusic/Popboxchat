<!-- CETCETY - YENÄ° Ä°KON DÃœZENÄ° + YÃ–NETÄ°CÄ° PANELÄ° -->
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CETCETY â€¢ Tam SÃ¼rÃ¼m</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- YouTube API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <style>
        /* ========== TEMEL STILLER ========== */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: #0f0f0f; color: #fff; overflow: hidden; height: 100vh; transition: 0.2s; }
        body.light-theme { background: #f5f5f5; color: #1a1a1a; }
        .app { display: flex; height: 100vh; width: 100vw; position: relative; }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #1a1a1a; }
        body.light-theme ::-webkit-scrollbar-track { background: #ddd; }
        ::-webkit-scrollbar-thumb { background: #3f3f3f; border-radius: 3px; }
        body.light-theme ::-webkit-scrollbar-thumb { background: #aaa; }

        /* ========== GÄ°RÄ°Åž EKRANI ========== */
        .login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(10px);
            display: flex; align-items: center; justify-content: center;
            z-index: 1000; transition: opacity 0.3s;
        }
        .login-overlay.hidden { display: none; }
        .login-panel {
            width: 360px; background: rgba(20,20,20,0.6); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px; padding: 32px; backdrop-filter: blur(10px); color: #fff;
        }
        body.light-theme .login-panel { background: rgba(255,255,255,0.7); border: 1px solid rgba(0,0,0,0.1); color: #333; }
        .login-panel h2 { text-align: center; margin-bottom: 24px; font-size: 24px; font-weight: 600; }
        .form-group { margin-bottom: 20px; }
        .login-panel label { display: block; margin-bottom: 8px; font-size: 13px; color: #aaa; }
        body.light-theme .login-panel label { color: #666; }
        .login-panel input {
            width: 100%; padding: 12px 16px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px; color: #fff; font-size: 14px; outline: none;
        }
        body.light-theme .login-panel input { background: rgba(255,255,255,0.5); border: 1px solid rgba(0,0,0,0.2); color: #333; }
        .login-panel input:focus { border-color: #ff0000; }
        
        .password-wrapper {
            position: relative;
            width: 100%;
        }
        .password-wrapper input { padding-right: 45px !important; }
        .password-toggle {
            position: absolute; right: 12px; top: 50%; transform: translateY(-50%);
            color: #aaa; cursor: pointer; font-size: 18px; z-index: 2;
        }
        .password-toggle:hover { color: #ff0000; }
        body.light-theme .password-toggle { color: #666; }
        
        .login-panel button {
            width: 100%; padding: 14px; background: #ff0000; border: none; border-radius: 8px;
            color: #fff; font-weight: 600; font-size: 16px; cursor: pointer; transition: 0.2s; margin-top: 8px;
        }
        .login-panel button:hover { background: #cc0000; }
        .login-info { text-align: center; margin-top: 16px; font-size: 12px; color: #aaa; }

        /* ========== SOL Ä°KON PANELÄ° - YENÄ° DÃœZEN ========== */
        .icon-panel {
            width: 72px; background: #0a0a0a; border-right: 1px solid #2a2a2a;
            display: flex; flex-direction: column; align-items: center; padding: 24px 0; gap: 24px;
            flex-shrink: 0; z-index: 20; transition: 0.2s;
        }
        body.light-theme .icon-panel { background: #fff; border-right: 1px solid #ddd; }
        .icon-item {
            width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center;
            justify-content: center; color: #aaa; cursor: pointer; transition: 0.2s; font-size: 20px; position: relative;
        }
        .icon-item:hover { background: #2a2a2a; color: #fff; }
        body.light-theme .icon-item:hover { background: #e0e0e0; color: #333; }
        .icon-item.active { color: #fff; background: #ff0000; }
        .icon-badge {
            position: absolute; top: -4px; right: -4px; width: 18px; height: 18px; border-radius: 50%;
            background: #ff4444; color: white; font-size: 10px; display: flex; align-items: center;
            justify-content: center; border: 2px solid #0a0a0a;
        }
        body.light-theme .icon-badge { border: 2px solid #fff; }
        .profile-avatar {
            width: 48px; height: 48px; border-radius: 50%;
            background: #1a1a1a; border: 2px solid #3f3f3f; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            font-weight: 600; color: #fff; position: relative;
            overflow: hidden;
        }
        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        body.light-theme .profile-avatar { background: #ddd; border: 2px solid #aaa; color: #333; }

        /* ========== ANA Ä°Ã‡ERÄ°K ========== */
        .main-content { flex: 1; display: flex; overflow: hidden; position: relative; }

        /* ========== SOL PANEL ========== */
        .left-panel {
            width: 320px; background: #0a0a0a; border-right: 1px solid #2a2a2a;
            display: flex; flex-direction: column; flex-shrink: 0; z-index: 15;
        }
        body.light-theme .left-panel { background: #fff; border-right: 1px solid #ddd; }
        .panel-header {
            padding: 16px 20px; border-bottom: 1px solid #2a2a2a;
            display: flex; align-items: center; justify-content: space-between;
        }
        body.light-theme .panel-header { border-bottom: 1px solid #ddd; }
        .panel-header h3 {
            display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 600; color: #fff;
        }
        body.light-theme .panel-header h3 { color: #333; }
        .panel-close {
            width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center;
            justify-content: center; color: #aaa; cursor: pointer;
        }
        .panel-close:hover { background: #2a2a2a; color: #fff; }
        body.light-theme .panel-close:hover { background: #ddd; color: #333; }
        .panel-content { flex: 1; overflow-y: auto; padding: 20px; }

        /* ========== SEKMELER ========== */
        .panel-tabs {
            display: flex; border-bottom: 1px solid #2a2a2a; background: #0a0a0a;
        }
        body.light-theme .panel-tabs { background: #fff; border-bottom: 1px solid #ddd; }
        .panel-tab {
            flex: 1; padding: 12px; text-align: center; font-size: 12px; font-weight: 600;
            color: #aaa; cursor: pointer; transition: 0.2s;
        }
        .panel-tab:hover { background: #1a1a1a; color: #fff; }
        .panel-tab.active { color: #fff; border-bottom: 2px solid #ff0000; }
        body.light-theme .panel-tab.active { color: #333; }

        /* ========== LÄ°STE Ã–ÄžELERÄ° ========== */
        .channel-item, .online-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 4px;
            transition: 0.2s;
        }
        .channel-item:hover, .online-item:hover { background: #1a1a1a; }
        body.light-theme .channel-item:hover, body.light-theme .online-item:hover { background: #f0f0f0; }
        .channel-avatar, .online-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #1a1a1a;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ff0000;
            font-size: 16px;
            flex-shrink: 0;
        }
        .online-avatar { background: #0a5c36; color: #fff; }
        .channel-info, .online-info { flex: 1; min-width: 0; }
        .channel-name, .online-name {
            font-weight: 600;
            font-size: 14px;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        body.light-theme .channel-name, body.light-theme .online-name { color: #333; }
        .online-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #2ecc71;
            margin-left: 4px;
        }
        .channel-meta, .online-meta {
            font-size: 11px;
            color: #aaa;
            margin-top: 2px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        body.light-theme .channel-meta, body.light-theme .online-meta { color: #666; }

        /* ========== YETKÄ° BADGE'LERÄ° ========== */
        .badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            margin-left: 6px;
            background: rgba(0,0,0,0.3);
            border: 1px solid;
            backdrop-filter: blur(2px);
        }
        .badge-owner { color: #ffd700; border-color: rgba(255,215,0,0.5); }
        .badge-admin { color: #ff6b6b; border-color: rgba(255,107,107,0.5); }
        .badge-coadmin { color: #6495ed; border-color: rgba(100,149,237,0.5); }
        .badge-operator { color: #ffa500; border-color: rgba(255,165,0,0.5); }
        .badge-hidden { color: #aaa; border-color: rgba(170,170,170,0.5); }
        .badge-ow { color: #9370db; border-color: rgba(147,112,219,0.5); }

        /* ========== CHAT PANELÄ° ========== */
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 0;
            background: #0f0f0f;
            position: relative;
        }
        body.light-theme .chat-container { background: #f9f9f9; }
        .chat-header {
            padding: 16px 24px;
            border-bottom: 1px solid #2a2a2a;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        body.light-theme .chat-header { border-bottom: 1px solid #ddd; }
        .chat-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
            color: #fff;
        }
        body.light-theme .chat-title { color: #333; }
        .chat-title i { color: #ff0000; }
        .channel-info-bar {
            display: flex;
            align-items: center;
            gap: 16px;
            color: #aaa;
            font-size: 13px;
        }
        body.light-theme .channel-info-bar { color: #666; }
        
        .messages {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        .message {
            display: flex;
            flex-direction: column;
            max-width: 70%;
        }
        .message.right { align-self: flex-end; }
        .message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }
        .message-sender {
            font-weight: 600;
            font-size: 13px;
            color: #fff;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        body.light-theme .message-sender { color: #333; }
        .message-time {
            font-size: 11px;
            color: #aaa;
        }
        .message-text {
            font-size: 14px;
            line-height: 1.5;
            color: #fff;
            word-break: break-word;
        }
        body.light-theme .message-text { color: #333; }
        .message.right .message-text { color: #ff0000; }
        
        .system-message {
            align-self: center;
            color: #aaa;
            font-size: 12px;
            padding: 8px 16px;
            background: #1a1a1a;
            border-radius: 20px;
            margin: 8px 0;
            border: 1px solid #2a2a2a;
        }
        body.light-theme .system-message { background: #e0e0e0; color: #666; border: 1px solid #ccc; }
        
        .message-input-container {
            padding: 20px 24px;
            background: #0a0a0a;
            border-top: 1px solid #2a2a2a;
        }
        body.light-theme .message-input-container { background: #fff; border-top: 1px solid #ddd; }
        .input-wrapper {
            display: flex;
            align-items: center;
            gap: 12px;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 28px;
            padding: 4px 4px 4px 20px;
        }
        body.light-theme .input-wrapper { background: #f0f0f0; border: 1px solid #ccc; }
        .message-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #fff;
            font-size: 14px;
            padding: 12px 0;
            resize: none;
            max-height: 80px;
            outline: none;
        }
        body.light-theme .message-input { color: #333; }
        .send-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: #2a2a2a;
            border: 1px solid #3f3f3f;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.2s;
        }
        .send-btn:hover { background: #ff0000; border-color: #ff0000; }

        /* ========== Ã–ZEL SOHBET PANELÄ° ========== */
        .private-chat-panel {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            background: #0a0a0a;
            display: none;
            flex-direction: column;
            z-index: 30;
        }
        body.light-theme .private-chat-panel { background: #fff; }
        .private-chat-panel.active { display: flex; }
        .private-chat-header {
            padding: 16px 20px;
            border-bottom: 1px solid #2a2a2a;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .private-chat-user { display: flex; align-items: center; gap: 12px; }
        .private-chat-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #1a1a1a;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ff0000;
        }
        .private-chat-info h4 { font-size: 14px; font-weight: 600; color: #fff; }
        .private-chat-info span { font-size: 11px; color: #aaa; }
        .private-chat-actions { display: flex; gap: 12px; }
        .private-chat-action {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            cursor: pointer;
        }
        .private-chat-action:hover { background: #1a1a1a; color: #fff; }
        body.light-theme .private-chat-action:hover { background: #ddd; color: #333; }
        .private-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        .private-message {
            display: flex;
            flex-direction: column;
            max-width: 80%;
        }
        .private-message.right { align-self: flex-end; }
        .private-message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }
        .private-message-sender { font-weight: 600; font-size: 12px; color: #fff; }
        .private-message-time { font-size: 10px; color: #aaa; }
        .private-message-text {
            font-size: 13px;
            line-height: 1.4;
            color: #fff;
            word-break: break-word;
        }
        .private-message.right .private-message-text { color: #ff0000; }
        .private-message-media { margin-top: 8px; border-radius: 12px; overflow: hidden; }
        .private-message-media img, .private-message-media video {
            width: 100%;
            max-height: 200px;
            object-fit: cover;
            border-radius: 12px;
            cursor: pointer;
        }
        .private-input-container {
            padding: 20px;
            background: #0a0a0a;
            border-top: 1px solid #2a2a2a;
        }
        body.light-theme .private-input-container { background: #fff; border-top: 1px solid #ddd; }
        .private-input-wrapper { display: flex; flex-direction: column; gap: 12px; }
        .private-media-actions { display: flex; gap: 12px; padding: 0 4px; }
        .private-media-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #1a1a1a;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            cursor: pointer;
        }
        .private-media-btn:hover { background: #2a2a2a; color: #fff; }
        body.light-theme .private-media-btn { background: #ddd; color: #666; }
        body.light-theme .private-media-btn:hover { background: #ccc; color: #333; }
        .private-text-input { display: flex; gap: 12px; }
        .private-input {
            flex: 1;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 24px;
            padding: 12px 16px;
            color: #fff;
            font-size: 13px;
            resize: none;
            outline: none;
        }
        body.light-theme .private-input { background: #f0f0f0; border: 1px solid #ccc; color: #333; }
        .private-send-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: #2a2a2a;
            border: 1px solid #3f3f3f;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        .private-send-btn:hover { background: #ff0000; border-color: #ff0000; }

        /* ========== MEDYA PANELÄ° ========== */
        .media-panel {
            width: 420px;
            background: #0a0a0a;
            border-left: 1px solid #2a2a2a;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }
        body.light-theme .media-panel { background: #fff; border-left: 1px solid #ddd; }
        .media-header {
            padding: 16px 20px;
            border-bottom: 1px solid #2a2a2a;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        body.light-theme .media-header { border-bottom: 1px solid #ddd; }
        .media-title { display: flex; align-items: center; gap: 8px; font-weight: 600; font-size: 14px; color: #fff; }
        body.light-theme .media-title { color: #333; }
        .media-controls { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
        .media-control {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            cursor: pointer;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.2s;
        }
        .media-control:hover { 
            background: #ff0000; 
            color: #fff; 
            border-color: #ff0000;
        }
        .media-control.disabled { 
            opacity: 0.3; 
            cursor: not-allowed; 
            pointer-events: none;
            background: rgba(255,255,255,0.05);
        }
        
        /* YouTube Player */
        .youtube-player { 
            width: 100%; 
            aspect-ratio: 16/9; 
            background: #000; 
            border-bottom: 1px solid #2a2a2a; 
            position: relative; 
            display: block;
        }
        #youtubeContainer { width: 100%; height: 100%; }
        
        /* Spotify Player */
        .spotify-player {
            width: 100%;
            aspect-ratio: 16/9;
            background: #121212;
            border-bottom: 1px solid #2a2a2a;
            display: none;
        }
        .spotify-iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }
        
        .player-controls {
            position: absolute;
            bottom: 16px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 20px;
            z-index: 10;
        }
        .player-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: rgba(0,0,0,0.7);
            border: 2px solid #fff;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.2s;
            font-size: 18px;
        }
        .player-btn:hover { background: #ff0000; border-color: #ff0000; }
        
        .now-playing {
            padding: 12px 20px;
            background: #0f0f0f;
            border-bottom: 1px solid #2a2a2a;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 13px;
            color: #fff;
        }
        body.light-theme .now-playing { background: #f5f5f5; border-bottom: 1px solid #ddd; color: #333; }
        
        .playlist-container { flex: 1; overflow-y: auto; padding: 20px; }
        .playlist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #2a2a2a;
        }
        body.light-theme .playlist-header { border-bottom: 1px solid #ddd; }
        .playlist-title { display: flex; align-items: center; gap: 8px; font-weight: 600; font-size: 14px; color: #fff; }
        body.light-theme .playlist-title { color: #333; }
        .playlist-count { color: #aaa; font-size: 12px; }
        .playlist-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 4px;
            cursor: pointer;
            transition: 0.2s;
        }
        .playlist-item:hover { background: #1a1a1a; }
        body.light-theme .playlist-item:hover { background: #f0f0f0; }
        .playlist-item.active { background: #1a1a1a; border-left: 4px solid #ff0000; }
        .playlist-thumb {
            width: 48px;
            height: 48px;
            border-radius: 6px;
            background: #1a1a1a;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ff0000;
            font-size: 24px;
            flex-shrink: 0;
        }
        .spotify-thumb {
            background: #1DB954;
            color: #fff;
        }

        /* ========== MODAL PANEL ========== */
        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 24px;
            z-index: 2000;
            width: 400px;
            max-height: 80vh;
            overflow-y: auto;
        }
        .modal.active { display: block; }
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 1999;
        }
        .modal-overlay.active { display: block; }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .modal-header h3 { color: #ffd700; }
        .modal-close {
            cursor: pointer;
            color: #aaa;
        }
        .modal-close:hover { color: #fff; }
        .modal-section {
            margin-bottom: 20px;
            padding: 10px;
            background: #0a0a0a;
            border-radius: 8px;
        }
        .modal-section h4 {
            color: #fff;
            margin-bottom: 10px;
        }
        .modal-input {
            width: 100%;
            padding: 8px;
            margin-bottom: 8px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 4px;
            color: #fff;
        }
        .modal-btn {
            width: 100%;
            padding: 8px;
            border: none;
            border-radius: 4px;
            color: #fff;
            cursor: pointer;
            margin-bottom: 4px;
        }
        .modal-btn.primary { background: #ff0000; }
        .modal-btn.success { background: #00cc66; }
        .modal-btn.warning { background: #ffaa00; }
        .modal-btn.danger { background: #ff4444; }
        .modal-btn.info { background: #6495ed; }
        .modal-btn.orange { background: #ffa500; }
        .modal-btn.purple { background: #9370db; }
        .modal-btn:hover { opacity: 0.8; }

        /* Profil resmi yÃ¼kleme */
        .avatar-upload {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 0 auto 20px;
            cursor: pointer;
        }
        .avatar-upload img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #ff0000;
        }
        .avatar-upload .upload-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: 0.2s;
        }
        .avatar-upload:hover .upload-overlay {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- GÄ°RÄ°Åž EKRANI -->
    <div id="loginOverlay" class="login-overlay">
        <div class="login-panel">
            <h2>ðŸŽ§ CETCETY</h2>
            <div class="form-group">
                <label>KullanÄ±cÄ± AdÄ±</label>
                <input type="text" id="loginNick" placeholder="Ã¶rn: mateky" autocomplete="off">
            </div>
            <div class="form-group">
                <label>Åžifre</label>
                <div class="password-wrapper">
                    <input type="password" id="loginPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                    <i class="fas fa-eye password-toggle" id="togglePassword" onclick="togglePassword()"></i>
                </div>
            </div>
            <button onclick="login()">GiriÅŸ Yap / KayÄ±t Ol</button>
            <div class="login-info">KayÄ±tlÄ± nickler ÅŸifre ile. KayÄ±tsÄ±z nickler ÅŸifresiz.</div>
        </div>
    </div>

    <!-- ANA UYGULAMA -->
    <div id="app" class="app" style="display: none;">
        <!-- SOL Ä°KON PANELÄ° - YENÄ° DÃœZEN -->
        <div class="icon-panel">
            <div class="icon-item" onclick="showHome()" title="Ana Sayfa"><i class="fas fa-home"></i></div>
            <div class="icon-item" onclick="openNotifications()" title="Bildirimler"><i class="fas fa-bell"></i><span class="icon-badge" id="notificationBadge">0</span></div>
            <div class="icon-item" onclick="openChannels()" title="Kanallar"><i class="fas fa-list-ul"></i><span class="icon-badge" id="channelCountBadge">0</span></div>
            <div class="icon-item" onclick="openOnline()" title="Ã‡evrimiÃ§i"><i class="fas fa-users"></i><span class="icon-badge" id="onlineBadge">0</span></div>
            <div class="profile-avatar" id="profileAvatar" onclick="openProfile()"><span id="avatarText">?</span></div>
        </div>

        <div class="main-content">
            <!-- SOL PANEL (dinamik) -->
            <div class="left-panel" id="leftPanel"></div>

            <!-- CHAT PANELÄ° -->
            <div class="chat-container">
                <div class="chat-header">
                    <div class="chat-title">
                        <i class="fas fa-hashtag"></i>
                        <span id="currentChannelName">genel</span>
                        <span class="channel-info-bar">
                            <span id="channelUserCount">0</span> Ã§evrimiÃ§i â€¢ 
                            <span id="channelSubscribers">15M</span> abone
                        </span>
                    </div>
                </div>
                <div class="messages" id="messages">
                    <div class="system-message"><i class="fas fa-info-circle"></i> CETCETY'ye hoÅŸ geldin! /help yazarak komutlarÄ± gÃ¶rebilirsin.</div>
                </div>
                <div class="message-input-container">
                    <div class="input-wrapper">
                        <textarea id="messageInput" class="message-input" placeholder="Mesaj yazÄ±n... /help" rows="1" oninput="autoResize(this)"></textarea>
                        <div class="send-btn" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></div>
                    </div>
                </div>

                <!-- Ã–ZEL SOHBET PANELÄ° -->
                <div id="privateChatPanel" class="private-chat-panel">
                    <div class="private-chat-header">
                        <div class="private-chat-user">
                            <div class="private-chat-avatar" id="privateChatAvatar">ðŸ‘¤</div>
                            <div class="private-chat-info">
                                <h4 id="privateChatName">KullanÄ±cÄ±</h4>
                                <span id="privateChatStatus">Ã‡evrimiÃ§i</span>
                            </div>
                        </div>
                        <div class="private-chat-actions">
                            <div class="private-chat-action" onclick="blockUser()" title="Engelle"><i class="fas fa-ban"></i></div>
                            <div class="private-chat-action" onclick="reportUser()" title="Åžikayet Et"><i class="fas fa-flag"></i></div>
                            <div class="private-chat-action" onclick="closePrivateChat()" title="Kapat"><i class="fas fa-times"></i></div>
                        </div>
                    </div>
                    <div class="private-chat-messages" id="privateChatMessages"></div>
                    <div class="private-input-container">
                        <div class="private-input-wrapper">
                            <div class="private-media-actions">
                                <div class="private-media-btn" onclick="triggerImageUpload()" title="Resim GÃ¶nder"><i class="fas fa-image"></i></div>
                                <div class="private-media-btn" onclick="triggerVideoUpload()" title="Video GÃ¶nder"><i class="fas fa-video"></i></div>
                                <input type="file" id="privateImageUpload" accept="image/*" style="display:none;" onchange="sendImageFile(this)">
                                <input type="file" id="privateVideoUpload" accept="video/*" style="display:none;" onchange="sendVideoFile(this)">
                            </div>
                            <div class="private-text-input">
                                <textarea id="privateMessageInput" class="private-input" placeholder="Mesaj yazÄ±n..." rows="1"></textarea>
                                <div class="private-send-btn" onclick="sendPrivateMessage()"><i class="fas fa-paper-plane"></i></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MEDYA PANELÄ° -->
            <div class="media-panel">
                <div class="media-header">
                    <div class="media-title">
                        <i class="fab fa-youtube" style="color:#ff0000;" id="mediaIcon"></i>
                        <span id="currentMediaType">YouTube</span>
                    </div>
                    <div class="media-controls">
                        <!-- YÃ¶netici Paneli Butonu - Sadece yetkililer gÃ¶rebilir -->
                        <div id="adminPanelBtn" class="media-control" onclick="toggleAdminPanel()" title="YÃ¶netici Paneli" style="display: none;">
                            <i class="fas fa-crown"></i>
                        </div>
                        
                        <!-- Media GeÃ§iÅŸ (YouTube/Spotify) -->
                        <div class="media-control" onclick="toggleMedia()" title="YouTube/Spotify GeÃ§iÅŸ">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        
                        <!-- Video Ekle (YouTube) - Sadece yetkililer -->
                        <div id="addYoutubeBtn" class="media-control" onclick="openAddYoutubeModal()" title="YouTube Video Ekle" style="display: none;">
                            <i class="fab fa-youtube"></i>
                        </div>
                        
                        <!-- Spotify Ekle - Sadece yetkililer -->
                        <div id="addSpotifyBtn" class="media-control" onclick="openAddSpotifyModal()" title="Spotify Playlist Ekle" style="display: none;">
                            <i class="fab fa-spotify"></i>
                        </div>
                        
                        <!-- Kanal Gizle/GÃ¶ster - Sadece yetkililer -->
                        <div id="hideChannelBtn" class="media-control" onclick="toggleHidden()" title="Kanal Gizle/GÃ¶ster" style="display: none;">
                            <i id="hideIcon" class="fas fa-eye"></i>
                        </div>
                        
                        <!-- Åžikayet Et - Herkes -->
                        <div id="reportChannelBtn" class="media-control" onclick="reportChannel()" title="Åžikayet Et">
                            <i class="fas fa-flag"></i>
                        </div>
                    </div>
                </div>
                
                <!-- YouTube Player -->
                <div id="youtubePlayer" class="youtube-player">
                    <div id="youtubeContainer"></div>
                    <div class="player-controls">
                        <div class="player-btn" id="playerMuteBtn" onclick="toggleMute()">
                            <i class="fas fa-volume-up" id="muteIcon"></i>
                        </div>
                        <div class="player-btn" id="playerPlayPauseBtn" onclick="togglePlayPause()">
                            <i class="fas fa-pause" id="playPauseIcon"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Spotify Player -->
                <div id="spotifyPlayer" class="spotify-player">
                    <iframe id="spotifyIframe" class="spotify-iframe" 
                        src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M?utm_source=generator" 
                        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture">
                    </iframe>
                </div>
                
                <!-- Åžu An Ã‡alÄ±yor -->
                <div class="now-playing">
                    <i class="fas fa-circle" style="color:#ff0000; font-size:8px;"></i>
                    <span id="nowPlayingTitle">CETCETY Radio</span>
                    <span id="nowPlayingOwner" style="color: #6495ed; margin-left: auto;">ðŸ‘‘ MateKy</span>
                </div>
                
                <!-- Playlist (YouTube) -->
                <div class="playlist-container" id="youtubePlaylist" style="display: block;">
                    <div class="playlist-header">
                        <span class="playlist-title"><i class="fab fa-youtube" style="color:#ff0000;"></i> YouTube Playlist</span>
                        <span class="playlist-count" id="youtubeCount">0 video</span>
                    </div>
                    <div id="youtubeItems" class="playlist-items"></div>
                </div>
                
                <!-- Playlist (Spotify) -->
                <div class="playlist-container" id="spotifyPlaylist" style="display: none;">
                    <div class="playlist-header">
                        <span class="playlist-title"><i class="fab fa-spotify" style="color:#1DB954;"></i> Spotify Playlist</span>
                        <span class="playlist-count" id="spotifyCount">0 playlist</span>
                    </div>
                    <div id="spotifyItems" class="playlist-items"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- YÃ–NETÄ°CÄ° PANELÄ° MODAL -->
    <div id="adminPanel" class="modal">
        <div class="modal-header">
            <h3><i class="fas fa-crown"></i> YÃ¶netici Paneli</h3>
            <div class="modal-close" onclick="toggleAdminPanel()"><i class="fas fa-times"></i></div>
        </div>
        
        <div class="modal-section">
            <h4>ðŸ‘¤ Yetkili Ä°ÅŸlemleri</h4>
            <input type="text" id="adminTargetUser" class="modal-input" placeholder="KullanÄ±cÄ± adÄ±">
        </div>
        
        <div class="modal-section">
            <h5 style="color: #ff4444;"><i class="fas fa-ban"></i> Ban</h5>
            <select id="banDuration" class="modal-input">
                <option value="5">5 Dakika</option>
                <option value="10">10 Dakika</option>
                <option value="60">1 Saat</option>
                <option value="0">SÃ¼resiz</option>
            </select>
            <input type="text" id="banReason" class="modal-input" placeholder="Ban sebebi">
            <button class="modal-btn danger" onclick="banUser()">Banla</button>
        </div>
        
        <div class="modal-section">
            <h5 style="color: #ffaa00;"><i class="fas fa-user-slash"></i> Kick</h5>
            <input type="text" id="kickReason" class="modal-input" placeholder="Kick sebebi">
            <button class="modal-btn warning" onclick="kickUser()">Kickle</button>
        </div>
        
        <div class="modal-section">
            <h5 style="color: #00cc66;"><i class="fas fa-check-circle"></i> Unban</h5>
            <button class="modal-btn success" onclick="unbanUser()">YasaÄŸÄ± KaldÄ±r</button>
        </div>
        
        <div id="ownerAdminActions" class="modal-section" style="display: none;">
            <h5 style="color: #ff6b6b;"><i class="fas fa-shield-alt"></i> Admin Ä°ÅŸlemleri</h5>
            <button class="modal-btn info" onclick="addAdmin()">Admin Yap</button>
            <button class="modal-btn danger" onclick="removeAdmin()">Admin Ã‡Ä±kar</button>
        </div>
        
        <div id="channelOwnerActions" class="modal-section" style="display: none;">
            <h5 style="color: #6495ed;"><i class="fas fa-user-tie"></i> Co-Admin</h5>
            <button class="modal-btn info" onclick="addCoAdmin()">Co-Admin Yap</button>
            <button class="modal-btn danger" onclick="removeCoAdmin()">Co-Admin Ã‡Ä±kar</button>
            
            <h5 style="color: #ffa500; margin-top: 10px;"><i class="fas fa-tools"></i> Operator</h5>
            <button class="modal-btn orange" onclick="addOperator()">Operator Yap</button>
            <button class="modal-btn danger" onclick="removeOperator()">Operator Ã‡Ä±kar</button>
        </div>
    </div>

    <!-- YOUTUBE EKLE MODAL -->
    <div id="addYoutubeModal" class="modal">
        <div class="modal-header">
            <h3><i class="fab fa-youtube" style="color:#ff0000;"></i> YouTube Video Ekle</h3>
            <div class="modal-close" onclick="closeModals()"><i class="fas fa-times"></i></div>
        </div>
        <div class="modal-section">
            <input type="text" id="youtubeUrl" class="modal-input" placeholder="YouTube URL veya ID">
            <input type="text" id="youtubeTitle" class="modal-input" placeholder="Video BaÅŸlÄ±ÄŸÄ±">
            <button class="modal-btn primary" onclick="addYoutubeVideo()">Videoyu Ekle</button>
        </div>
    </div>

    <!-- SPOTIFY EKLE MODAL -->
    <div id="addSpotifyModal" class="modal">
        <div class="modal-header">
            <h3><i class="fab fa-spotify" style="color:#1DB954;"></i> Spotify Playlist Ekle</h3>
            <div class="modal-close" onclick="closeModals()"><i class="fas fa-times"></i></div>
        </div>
        <div class="modal-section">
            <input type="text" id="spotifyUrl" class="modal-input" placeholder="Spotify Playlist URL">
            <input type="text" id="spotifyTitle" class="modal-input" placeholder="Playlist BaÅŸlÄ±ÄŸÄ±">
            <button class="modal-btn success" onclick="addSpotifyPlaylist()">Playlist'i Ekle</button>
        </div>
    </div>

    <!-- PROFÄ°L RESMÄ° YÃœKLE MODAL -->
    <div id="avatarModal" class="modal">
        <div class="modal-header">
            <h3><i class="fas fa-camera"></i> Profil Resmi YÃ¼kle</h3>
            <div class="modal-close" onclick="closeModals()"><i class="fas fa-times"></i></div>
        </div>
        <div class="modal-section">
            <div class="avatar-upload" onclick="document.getElementById('avatarUpload').click()">
                <img id="avatarPreview" src="https://via.placeholder.com/100" alt="Profil">
                <div class="upload-overlay">
                    <i class="fas fa-camera"></i>
                </div>
            </div>
            <input type="file" id="avatarUpload" accept="image/*" style="display:none;" onchange="previewAvatar(this)">
            <button class="modal-btn primary" onclick="saveAvatar()">Kaydet</button>
        </div>
    </div>

    <!-- KANAL AÃ‡ MODAL -->
    <div id="createChannelModal" class="modal">
        <div class="modal-header">
            <h3><i class="fas fa-plus-circle"></i> Kanal AÃ§</h3>
            <div class="modal-close" onclick="closeModals()"><i class="fas fa-times"></i></div>
        </div>
        <div class="modal-section">
            <input type="text" id="newChannelName" class="modal-input" placeholder="Kanal adÄ±">
            <input type="text" id="newChannelDesc" class="modal-input" placeholder="AÃ§Ä±klama">
            <button class="modal-btn primary" onclick="createChannel()">KanalÄ± OluÅŸtur</button>
        </div>
    </div>

    <!-- DESTEK MODAL -->
    <div id="supportModal" class="modal">
        <div class="modal-header">
            <h3><i class="fas fa-headset"></i> Destek</h3>
            <div class="modal-close" onclick="closeModals()"><i class="fas fa-times"></i></div>
        </div>
        <div class="modal-section">
            <textarea id="supportMessage" class="modal-input" placeholder="Sorununuzu yazÄ±n..." rows="4"></textarea>
            <button class="modal-btn info" onclick="sendSupport()">GÃ¶nder</button>
        </div>
    </div>

    <!-- HESAP SÄ°L MODAL -->
    <div id="deleteAccountModal" class="modal">
        <div class="modal-header">
            <h3><i class="fas fa-exclamation-triangle" style="color:#ff4444;"></i> Hesap Sil</h3>
            <div class="modal-close" onclick="closeModals()"><i class="fas fa-times"></i></div>
        </div>
        <div class="modal-section">
            <p style="color:#ff4444; margin-bottom:10px;">Bu iÅŸlem geri alÄ±namaz!</p>
            <input type="password" id="deletePassword" class="modal-input" placeholder="Åžifrenizi girin">
            <button class="modal-btn danger" onclick="deleteAccount()">HesabÄ±mÄ± Sil</button>
        </div>
    </div>

    <!-- Modal Arkaplan -->
    <div id="modalOverlay" class="modal-overlay" onclick="closeAllModals()"></div>

    <script>
        // ========== FIREBASE KONFÄ°G ==========
        const firebaseConfig = {
            apiKey: "AIzaSyCrn_tXJZCAlKhem45aXxj4f0h26EPOQ70",
            authDomain: "popboxmusicchat.firebaseapp.com",
            databaseURL: "https://popboxmusicchat-default-rtdb.firebaseio.com",
            projectId: "popboxmusicchat",
            storageBucket: "popboxmusicchat.appspot.com",
            messagingSenderId: "206625719024",
            appId: "1:206625719024:web:d28f478a2c96d10412f835"
        };

        // Firebase baÅŸlat
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        console.log('ðŸ”¥ Firebase baÅŸlatÄ±ldÄ±!');

        // ========== GLOBAL DEÄžÄ°ÅžKENLER ==========
        let currentUser = null;
        let currentChannel = 'genel';
        let currentPrivateChat = null;
        let currentMedia = 'youtube';
        let ytPlayer = null;
        let isMuted = false;
        let isPlaying = true;

        // Yetki seviyeleri
        const ROLE_LEVELS = {
            'owner': 5,
            'admin': 4,
            'coadmin': 3,
            'operator': 2,
            'user': 1
        };

        // ========== YARDIMCI FONKSÄ°YONLAR ==========
        function togglePassword() {
            const input = document.getElementById('loginPassword');
            const icon = document.getElementById('togglePassword');
            input.type = input.type === 'password' ? 'text' : 'password';
            icon.className = input.type === 'password' ? 'fas fa-eye password-toggle' : 'fas fa-eye-slash password-toggle';
        }

        function autoResize(t) {
            t.style.height = 'auto';
            t.style.height = Math.min(t.scrollHeight, 80) + 'px';
        }

        function escapeHTML(t) {
            if (!t) return '';
            let d = document.createElement('div');
            d.textContent = t;
            return d.innerHTML;
        }

        function addSystemMessage(t) {
            let d = document.createElement('div');
            d.className = 'system-message';
            d.innerHTML = `<i class="fas fa-info-circle"></i> ${escapeHTML(t)}`;
            document.getElementById('messages').appendChild(d);
            document.getElementById('messages').scrollTop = document.getElementById('messages').scrollHeight;
        }

        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            const i = document.getElementById('themeIcon').querySelector('i');
            i.className = document.body.classList.contains('light-theme') ? 'fas fa-sun' : 'fas fa-moon';
            localStorage.setItem('theme', document.body.classList.contains('light-theme') ? 'light' : 'dark');
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num/1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num/1000).toFixed(1) + 'K';
            return num;
        }

        // Yetki kontrolÃ¼
        function hasPermission(requiredRole) {
            if (!currentUser) return false;
            if (currentUser.role === 'owner') return true;
            if (currentUser.role === 'admin') return requiredRole !== 'owner';
            if (currentUser.role === 'coadmin') return requiredRole !== 'owner' && requiredRole !== 'admin';
            if (currentUser.role === 'operator') return requiredRole === 'operator' || requiredRole === 'user';
            return false;
        }

        // ========== GÄ°RÄ°Åž Ä°ÅžLEMLERÄ° ==========
        function login() {
            const nick = document.getElementById('loginNick').value.trim();
            const pass = document.getElementById('loginPassword').value.trim();
            if (!nick) { alert('KullanÄ±cÄ± adÄ± boÅŸ olamaz!'); return; }

            let role = 'user';
            if (nick === 'MateKy') {
                if (pass !== 'Sahi17407@SCM') {
                    alert('Owner ÅŸifresi hatalÄ±!');
                    return;
                }
                role = 'owner';
            }

            currentUser = {
                id: Date.now().toString(),
                name: nick,
                role: role,
                roleLevel: ROLE_LEVELS[role],
                subscribedChannels: ['genel'],
                myChannel: null,
                avatar: nick.charAt(0).toUpperCase(),
                avatarUrl: null,
                password: pass || '',
                privateMode: 'all',
                blockedNicks: []
            };

            localStorage.setItem('cetcety_user', JSON.stringify(currentUser));

            database.ref(`users/${currentUser.id}`).set({
                name: currentUser.name,
                role: currentUser.role,
                avatar: currentUser.avatar
            });

            database.ref(`online/${currentChannel}/${currentUser.id}`).set({
                name: currentUser.name,
                role: currentUser.role
            });

            document.getElementById('loginOverlay').classList.add('hidden');
            document.getElementById('app').style.display = 'flex';
            document.getElementById('avatarText').textContent = currentUser.avatar;

            loadLeftPanel('channels');
            addSystemMessage(`ðŸ‘‹ HoÅŸ geldin, ${nick}!`);

            listenMessages();
            listenOnline();
            updateMediaButtons();
        }

        // ========== MESAJ Ä°ÅžLEMLERÄ° ==========
        function listenMessages() {
            database.ref('messages').orderByChild('timestamp').limitToLast(50).on('child_added', (snapshot) => {
                const msg = snapshot.val();
                if (msg && msg.channel === currentChannel) {
                    displayMessage(msg, msg.sender === currentUser?.name);
                }
            });
        }

        function listenOnline() {
            database.ref(`online/${currentChannel}`).on('value', (snapshot) => {
                const users = snapshot.val() || {};
                document.getElementById('channelUserCount').textContent = Object.keys(users).length;
                document.getElementById('onlineBadge').textContent = Object.keys(users).length;
                updateOnlineList(users);
            });
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            if (!text || !currentUser) return;

            if (text.startsWith('/')) {
                handleCommand(text);
                input.value = '';
                autoResize(input);
                return;
            }

            const msg = {
                sender: currentUser.name,
                text: text,
                channel: currentChannel,
                time: new Date().toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' }),
                timestamp: Date.now()
            };

            database.ref('messages').push(msg);
            input.value = '';
            autoResize(input);
        }

        function displayMessage(msg, isMe) {
            const container = document.getElementById('messages');
            const div = document.createElement('div');
            div.className = `message ${isMe ? 'right' : ''}`;
            div.innerHTML = `
                <div class="message-header" style="${isMe ? 'justify-content: flex-end;' : ''}">
                    <span class="message-time">${msg.time}</span>
                    <span class="message-sender">${escapeHTML(msg.sender)}</span>
                </div>
                <div class="message-text">${escapeHTML(msg.text)}</div>
            `;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        function updateOnlineList(users) {
            if (document.getElementById('leftPanel').querySelector('.panel-header h3')?.innerText.includes('Ã‡evrimiÃ§i')) {
                showOnlineList();
            }
        }

        // ========== KANAL Ä°ÅžLEMLERÄ° ==========
        function joinChannel(channelName) {
            if (channelName === 'ow' && currentUser?.name !== 'MateKy') {
                addSystemMessage('âŒ Bu kanala eriÅŸim yetkiniz yok.');
                return;
            }

            database.ref(`online/${currentChannel}/${currentUser.id}`).remove();
            currentChannel = channelName;
            document.getElementById('currentChannelName').textContent = channelName;
            document.getElementById('messages').innerHTML = '';

            database.ref(`online/${channelName}/${currentUser.id}`).set({
                name: currentUser.name,
                role: currentUser.role
            });

            if (channelName === 'ow' && currentUser?.name === 'MateKy') {
                loadOWMessages();
            }

            addSystemMessage(`ðŸ“¢ #${channelName} kanalÄ±na katÄ±ldÄ±n!`);
        }

        // ========== Ã–ZEL SOHBET ==========
        function openPrivateChat(username) {
            if (!username) return;
            currentPrivateChat = username;
            document.getElementById('privateChatName').textContent = username;
            document.getElementById('privateChatAvatar').innerHTML = username.charAt(0).toUpperCase();
            document.getElementById('privateChatPanel').classList.add('active');
        }

        function closePrivateChat() {
            document.getElementById('privateChatPanel').classList.remove('active');
            currentPrivateChat = null;
        }

        function sendPrivateMessage() {
            const input = document.getElementById('privateMessageInput');
            const text = input.value.trim();
            if (!text || !currentPrivateChat || !currentUser) return;

            displayPrivateMessage(text, 'text', true);
            input.value = '';
        }

        function displayPrivateMessage(content, type, isMe) {
            const container = document.getElementById('privateChatMessages');
            const time = new Date().toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
            let html = '';

            if (type === 'text') {
                html = `<div class="private-message ${isMe ? 'right' : ''}">
                    <div class="private-message-header" style="${isMe ? 'justify-content: flex-end;' : ''}">
                        <span class="private-message-time">${time}</span>
                        <span class="private-message-sender">${isMe ? currentUser.name : currentPrivateChat}</span>
                    </div>
                    <div class="private-message-text">${escapeHTML(content)}</div>
                </div>`;
            } else if (type === 'image') {
                html = `<div class="private-message ${isMe ? 'right' : ''}">
                    <div class="private-message-header" style="${isMe ? 'justify-content: flex-end;' : ''}">
                        <span class="private-message-time">${time}</span>
                        <span class="private-message-sender">${isMe ? currentUser.name : currentPrivateChat}</span>
                    </div>
                    <div class="private-message-media">
                        <img src="${content}" style="max-width:100%; border-radius:8px;" onclick="window.open(this.src)">
                    </div>
                </div>`;
            }

            container.insertAdjacentHTML('beforeend', html);
            container.scrollTop = container.scrollHeight;
        }

        function triggerImageUpload() {
            document.getElementById('privateImageUpload').click();
        }

        function sendImageFile(input) {
            if (!input.files || !input.files[0] || !currentPrivateChat) return;
            const file = input.files[0];
            const reader = new FileReader();
            reader.onload = (e) => {
                displayPrivateMessage(e.target.result, 'image', true);
            };
            reader.readAsDataURL(file);
        }

        function triggerVideoUpload() {
            document.getElementById('privateVideoUpload').click();
        }

        function sendVideoFile(input) {
            if (!input.files || !input.files[0] || !currentPrivateChat) return;
            const file = input.files[0];
            const reader = new FileReader();
            reader.onload = (e) => {
                displayPrivateMessage(e.target.result, 'video', true);
            };
            reader.readAsDataURL(file);
        }

        function blockUser() {
            if (currentPrivateChat) {
                addSystemMessage(`ðŸš« ${currentPrivateChat} engellendi`);
                closePrivateChat();
            }
        }

        function reportUser() {
            if (currentPrivateChat) {
                addSystemMessage(`âš ï¸ ${currentPrivateChat} ÅŸikayet edildi`);
            }
        }

        // ========== YOUTUBE PLAYER ==========
        function onYouTubeIframeAPIReady() {
            ytPlayer = new YT.Player('youtubeContainer', {
                height: '100%',
                width: '100%',
                videoId: 'jfKfPfyJRdk',
                playerVars: {
                    autoplay: 1,
                    controls: 0,
                    modestbranding: 1,
                    rel: 0
                },
                events: {
                    onReady: e => e.target.playVideo(),
                    onStateChange: e => {
                        document.getElementById('playPauseIcon').className = e.data === YT.PlayerState.PLAYING ? 'fas fa-pause' : 'fas fa-play';
                        isPlaying = e.data === YT.PlayerState.PLAYING;
                    }
                }
            });
        }

        function toggleMute() {
            if (!ytPlayer) return;
            if (isMuted) {
                ytPlayer.unMute();
                document.getElementById('muteIcon').className = 'fas fa-volume-up';
            } else {
                ytPlayer.mute();
                document.getElementById('muteIcon').className = 'fas fa-volume-mute';
            }
            isMuted = !isMuted;
        }

        function togglePlayPause() {
            if (!ytPlayer) return;
            if (isPlaying) ytPlayer.pauseVideo();
            else ytPlayer.playVideo();
        }

        // ========== MEDYA GEÃ‡Ä°Åž ==========
        function toggleMedia() {
            const youtubePlayer = document.getElementById('youtubePlayer');
            const spotifyPlayer = document.getElementById('spotifyPlayer');
            const youtubePlaylist = document.getElementById('youtubePlaylist');
            const spotifyPlaylist = document.getElementById('spotifyPlaylist');
            const mediaIcon = document.getElementById('mediaIcon');
            const mediaType = document.getElementById('currentMediaType');

            if (currentMedia === 'youtube') {
                youtubePlayer.style.display = 'none';
                spotifyPlayer.style.display = 'block';
                youtubePlaylist.style.display = 'none';
                spotifyPlaylist.style.display = 'block';
                mediaIcon.className = 'fab fa-spotify';
                mediaIcon.style.color = '#1DB954';
                mediaType.textContent = 'Spotify';
                currentMedia = 'spotify';
            } else {
                youtubePlayer.style.display = 'block';
                spotifyPlayer.style.display = 'none';
                youtubePlaylist.style.display = 'block';
                spotifyPlaylist.style.display = 'none';
                mediaIcon.className = 'fab fa-youtube';
                mediaIcon.style.color = '#ff0000';
                mediaType.textContent = 'YouTube';
                currentMedia = 'youtube';
            }
        }

        // ========== YOUTUBE PLAYLIST ==========
        function getYoutubePlaylist() {
            const saved = localStorage.getItem('youtube_playlist');
            return saved ? JSON.parse(saved) : [];
        }

        function saveYoutubePlaylist(playlist) {
            localStorage.setItem('youtube_playlist', JSON.stringify(playlist));
            updateYoutubePlaylistUI();
        }

        function updateYoutubePlaylistUI() {
            const playlist = getYoutubePlaylist();
            const container = document.getElementById('youtubeItems');
            let html = '';

            playlist.forEach((item) => {
                html += `<div class="playlist-item" onclick="playYoutubeVideo('${item.id}')">
                    <div class="playlist-thumb"><i class="fab fa-youtube"></i></div>
                    <div class="playlist-info">
                        <div class="playlist-song">${escapeHTML(item.title)}</div>
                        <div class="playlist-artist">${escapeHTML(item.addedBy)}</div>
                    </div>
                </div>`;
            });

            container.innerHTML = html || '<div style="color:#aaa; text-align:center; padding:20px;">HenÃ¼z video eklenmemiÅŸ</div>';
            document.getElementById('youtubeCount').textContent = `${playlist.length} video`;
        }

        function playYoutubeVideo(videoId) {
            if (!ytPlayer) return;
            ytPlayer.loadVideoById(videoId);
            document.getElementById('nowPlayingTitle').textContent = 'YouTube Video';
        }

        // ========== SPOTIFY PLAYLIST ==========
        function getSpotifyPlaylists() {
            const saved = localStorage.getItem('spotify_playlists');
            return saved ? JSON.parse(saved) : [];
        }

        function saveSpotifyPlaylists(playlists) {
            localStorage.setItem('spotify_playlists', JSON.stringify(playlists));
            updateSpotifyPlaylistUI();
        }

        function updateSpotifyPlaylistUI() {
            const playlists = getSpotifyPlaylists();
            const container = document.getElementById('spotifyItems');
            let html = '';

            playlists.forEach((item) => {
                html += `<div class="playlist-item" onclick="playSpotifyPlaylist('${item.url}')">
                    <div class="playlist-thumb spotify-thumb"><i class="fab fa-spotify"></i></div>
                    <div class="playlist-info">
                        <div class="playlist-song">${escapeHTML(item.title)}</div>
                        <div class="playlist-artist">${escapeHTML(item.addedBy)}</div>
                    </div>
                </div>`;
            });

            container.innerHTML = html || '<div style="color:#aaa; text-align:center; padding:20px;">HenÃ¼z playlist eklenmemiÅŸ</div>';
            document.getElementById('spotifyCount').textContent = `${playlists.length} playlist`;
        }

        function playSpotifyPlaylist(url) {
            const iframe = document.getElementById('spotifyIframe');
            iframe.src = url;
            document.getElementById('nowPlayingTitle').textContent = 'Spotify Playlist';
        }

        // ========== MEDYA BUTONLARINI GÃœNCELLE ==========
        function updateMediaButtons() {
            const isOwner = currentUser?.role === 'owner';
            const isAdmin = currentUser?.role === 'admin';
            const isCoAdmin = currentUser?.role === 'coadmin';
            const isOperator = currentUser?.role === 'operator';
            
            const canEdit = isOwner || isAdmin || isCoAdmin;
            
            document.getElementById('adminPanelBtn').style.display = canEdit ? 'flex' : 'none';
            document.getElementById('addYoutubeBtn').style.display = canEdit ? 'flex' : 'none';
            document.getElementById('addSpotifyBtn').style.display = canEdit ? 'flex' : 'none';
            document.getElementById('hideChannelBtn').style.display = canEdit ? 'flex' : 'none';
        }

        // ========== MODAL Ä°ÅžLEMLERÄ° ==========
        function toggleAdminPanel() {
            document.getElementById('adminPanel').classList.toggle('active');
            document.getElementById('modalOverlay').classList.toggle('active');
        }

        function openAddYoutubeModal() {
            if (!hasPermission('coadmin')) {
                alert('Video ekleme yetkiniz yok!');
                return;
            }
            document.getElementById('addYoutubeModal').classList.add('active');
            document.getElementById('modalOverlay').classList.add('active');
        }

        function openAddSpotifyModal() {
            if (!hasPermission('coadmin')) {
                alert('Spotify ekleme yetkiniz yok!');
                return;
            }
            document.getElementById('addSpotifyModal').classList.add('active');
            document.getElementById('modalOverlay').classList.add('active');
        }

        function closeModals() {
            document.getElementById('addYoutubeModal').classList.remove('active');
            document.getElementById('addSpotifyModal').classList.remove('active');
            document.getElementById('adminPanel').classList.remove('active');
            document.getElementById('avatarModal').classList.remove('active');
            document.getElementById('createChannelModal').classList.remove('active');
            document.getElementById('supportModal').classList.remove('active');
            document.getElementById('deleteAccountModal').classList.remove('active');
            document.getElementById('modalOverlay').classList.remove('active');
        }

        function closeAllModals() {
            closeModals();
        }

        // ========== YOUTUBE VÄ°DEO EKLE ==========
        function addYoutubeVideo() {
            const url = document.getElementById('youtubeUrl').value.trim();
            let title = document.getElementById('youtubeTitle').value.trim();

            if (!url) { alert('YouTube URL girin!'); return; }

            let videoId = '';
            if (url.includes('youtube.com/watch?v=')) {
                videoId = url.split('v=')[1]?.split('&')[0];
            } else if (url.includes('youtu.be/')) {
                videoId = url.split('youtu.be/')[1]?.split('?')[0];
            } else {
                videoId = url;
            }

            if (!videoId || videoId.length < 5) { alert('GeÃ§ersiz YouTube URL!'); return; }
            if (!title) title = `Video ${videoId.substring(0, 6)}`;

            const playlist = getYoutubePlaylist();
            playlist.push({
                id: videoId,
                title: title,
                addedBy: currentUser?.name || 'Misafir'
            });
            saveYoutubePlaylist(playlist);

            closeModals();
            addSystemMessage(`âœ… Video eklendi: ${title}`);
        }

        // ========== SPOTIFY PLAYLIST EKLE ==========
        function addSpotifyPlaylist() {
            const url = document.getElementById('spotifyUrl').value.trim();
            let title = document.getElementById('spotifyTitle').value.trim();

            if (!url) { alert('Spotify URL girin!'); return; }

            let embedUrl = url;
            if (url.includes('open.spotify.com/playlist/')) {
                const playlistId = url.split('playlist/')[1]?.split('?')[0];
                embedUrl = `https://open.spotify.com/embed/playlist/${playlistId}`;
            }

            if (!title) title = 'Spotify Playlist';

            const playlists = getSpotifyPlaylists();
            playlists.push({
                url: embedUrl,
                title: title,
                addedBy: currentUser?.name || 'Misafir'
            });
            saveSpotifyPlaylists(playlists);

            closeModals();
            addSystemMessage(`âœ… Spotify playlist eklendi: ${title}`);
        }

        // ========== KANAL Ä°ÅžLEMLERÄ° ==========
        function toggleHidden() {
            if (!hasPermission('coadmin')) {
                addSystemMessage('âŒ Bu iÅŸlem iÃ§in yetkiniz yok!');
                return;
            }
            addSystemMessage('ðŸ‘ï¸ Kanal gizleme Ã¶zelliÄŸi yakÄ±nda...');
        }

        function reportChannel() {
            const reason = prompt('Åžikayet sebebi:');
            if (reason) {
                addSystemMessage(`ðŸš© #${currentChannel} ÅŸikayet edildi: ${reason}`);
            }
        }

        // ========== PROFÄ°L Ä°ÅžLEMLERÄ° ==========
        function openProfile() {
            loadLeftPanel('profile');
        }

        function previewAvatar(input) {
            if (!input.files || !input.files[0]) return;
            const file = input.files[0];
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('avatarPreview').src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function saveAvatar() {
            const preview = document.getElementById('avatarPreview');
            const avatarText = document.getElementById('avatarText');
            
            if (preview.src && preview.src !== 'https://via.placeholder.com/100') {
                avatarText.innerHTML = `<img src="${preview.src}" style="width:100%; height:100%; border-radius:50%; object-fit:cover;">`;
                currentUser.avatarUrl = preview.src;
                localStorage.setItem('cetcety_user', JSON.stringify(currentUser));
                addSystemMessage('âœ… Profil resmi gÃ¼ncellendi');
            }
            closeModals();
        }

        function openAvatarModal() {
            document.getElementById('avatarModal').classList.add('active');
            document.getElementById('modalOverlay').classList.add('active');
        }

        function openCreateChannelModal() {
            document.getElementById('createChannelModal').classList.add('active');
            document.getElementById('modalOverlay').classList.add('active');
        }

        function createChannel() {
            const name = document.getElementById('newChannelName').value.trim();
            if (!name) { alert('Kanal adÄ± girin!'); return; }
            
            addSystemMessage(`âœ… #${name} kanalÄ± oluÅŸturuldu!`);
            closeModals();
        }

        function openSupportModal() {
            document.getElementById('supportModal').classList.add('active');
            document.getElementById('modalOverlay').classList.add('active');
        }

        function sendSupport() {
            const msg = document.getElementById('supportMessage').value.trim();
            if (msg) {
                addSystemMessage(`ðŸ›Ÿ Destek talebiniz iletildi: "${msg}"`);
                closeModals();
            }
        }

        function openDeleteAccountModal() {
            document.getElementById('deleteAccountModal').classList.add('active');
            document.getElementById('modalOverlay').classList.add('active');
        }

        function deleteAccount() {
            const pass = document.getElementById('deletePassword').value.trim();
            if (pass === currentUser?.password) {
                localStorage.removeItem('cetcety_user');
                alert('HesabÄ±nÄ±z silindi!');
                location.reload();
            } else {
                alert('Åžifre hatalÄ±!');
            }
        }

        function changeNick() {
            const newNick = prompt('Yeni kullanÄ±cÄ± adÄ±:', currentUser?.name);
            if (newNick && newNick.trim()) {
                currentUser.name = newNick.trim();
                currentUser.avatar = newNick.charAt(0).toUpperCase();
                localStorage.setItem('cetcety_user', JSON.stringify(currentUser));
                document.getElementById('avatarText').textContent = currentUser.avatar;
                addSystemMessage(`âœ… KullanÄ±cÄ± adÄ± deÄŸiÅŸtirildi: ${newNick}`);
                loadLeftPanel('profile');
            }
        }

        function changePassword() {
            const newPass = prompt('Yeni ÅŸifre:');
            if (newPass) {
                currentUser.password = newPass;
                localStorage.setItem('cetcety_user', JSON.stringify(currentUser));
                addSystemMessage('âœ… Åžifre gÃ¼ncellendi');
            }
        }

        function togglePrivateMode() {
            const modes = ['all', 'none', 'blocked'];
            const currentMode = currentUser.privateMode || 'all';
            const nextMode = modes[(modes.indexOf(currentMode) + 1) % modes.length];
            
            currentUser.privateMode = nextMode;
            localStorage.setItem('cetcety_user', JSON.stringify(currentUser));
            
            const modeText = {
                'all': 'Herkese AÃ§Ä±k',
                'none': 'Herkese KapalÄ±',
                'blocked': 'Sadece Engellenenler'
            };
            addSystemMessage(`ðŸ”’ Ã–zel sohbet modu: ${modeText[nextMode]}`);
        }

        function blockNick() {
            const nick = prompt('Engellenecek kullanÄ±cÄ± adÄ±:');
            if (nick) {
                if (!currentUser.blockedNicks) currentUser.blockedNicks = [];
                if (!currentUser.blockedNicks.includes(nick)) {
                    currentUser.blockedNicks.push(nick);
                    localStorage.setItem('cetcety_user', JSON.stringify(currentUser));
                    addSystemMessage(`ðŸš« ${nick} engellendi`);
                }
            }
        }

        // ========== Ä°KON FONKSÄ°YONLARI ==========
        function showHome() {
            addSystemMessage('ðŸ  Ana sayfa');
        }

        function openNotifications() {
            loadLeftPanel('notifications');
        }

        function openChannels() {
            loadLeftPanel('channels');
        }

        function openOnline() {
            loadLeftPanel('online');
        }

        function loadLeftPanel(panelName) {
            const panel = document.getElementById('leftPanel');
            
            if (panelName === 'channels') {
                let html = `
                    <div class="panel-header">
                        <h3><i class="fas fa-list-ul" style="color:#ff0000;"></i> PopÃ¼ler Kanallar</h3>
                        <div class="panel-close" onclick="loadLeftPanel('channels')">
                            <i class="fas fa-times"></i>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div class="channel-item" onclick="joinChannel('genel')">
                            <div class="channel-avatar"><i class="fas fa-hashtag"></i></div>
                            <div class="channel-info">
                                <div class="channel-name">genel</div>
                                <div class="channel-meta">ðŸ‘‘ MateKy â€¢ 15M abone</div>
                            </div>
                        </div>
                        <div class="channel-item" onclick="joinChannel('ow')">
                            <div class="channel-avatar"><i class="fas fa-crown"></i></div>
                            <div class="channel-info">
                                <div class="channel-name">ow <span class="badge badge-ow">ðŸ”’</span></div>
                                <div class="channel-meta">ðŸ‘‘ MateKy â€¢ Gizli</div>
                            </div>
                        </div>
                    </div>`;
                panel.innerHTML = html;
            }
            else if (panelName === 'online') {
                showOnlineList();
            }
            else if (panelName === 'notifications') {
                panel.innerHTML = `
                    <div class="panel-header">
                        <h3><i class="fas fa-bell" style="color:#ff4444;"></i> Bildirimler</h3>
                        <div class="panel-close" onclick="loadLeftPanel('channels')">
                            <i class="fas fa-times"></i>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div style="color:#aaa; text-align:center; padding:20px;">Bildirim yok</div>
                    </div>`;
            }
            else if (panelName === 'profile') {
                const roleText = currentUser.role === 'owner' ? 'ðŸ‘‘ Owner' : 
                                currentUser.role === 'admin' ? 'âš¡ Admin' : 
                                currentUser.role === 'coadmin' ? 'ðŸ”§ Co-Admin' : 
                                currentUser.role === 'operator' ? 'ðŸ› ï¸ Operator' : 'ðŸ‘¤ KullanÄ±cÄ±';
                
                const roleClass = currentUser.role === 'owner' ? 'badge-owner' :
                                 currentUser.role === 'admin' ? 'badge-admin' :
                                 currentUser.role === 'coadmin' ? 'badge-coadmin' :
                                 currentUser.role === 'operator' ? 'badge-operator' : '';
                
                const avatarHtml = currentUser?.avatarUrl ? 
                    `<img src="${currentUser.avatarUrl}" style="width:80px; height:80px; border-radius:50%; object-fit:cover;">` : 
                    `<div style="width:80px; height:80px; border-radius:50%; background:#ff0000; color:#fff; display:flex; align-items:center; justify-content:center; font-size:32px;">${currentUser?.avatar || '?'}</div>`;
                
                panel.innerHTML = `
                    <div class="panel-header">
                        <h3><i class="fas fa-user" style="color:#ff0000;"></i> Profil</h3>
                        <div class="panel-close" onclick="loadLeftPanel('channels')">
                            <i class="fas fa-times"></i>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div style="text-align:center; padding:20px 0;">
                            <div style="margin-bottom:15px; cursor:pointer;" onclick="openAvatarModal()">
                                ${avatarHtml}
                            </div>
                            <h2>${currentUser?.name}</h2>
                            <span class="badge ${roleClass}" style="margin-bottom:15px;">${roleText}</span>
                        </div>
                        
                        <div class="modal-section">
                            <button class="modal-btn info" onclick="openAvatarModal()" style="margin-bottom:8px;"><i class="fas fa-camera"></i> Profil Resmi YÃ¼kle</button>
                            <button class="modal-btn info" onclick="changeNick()" style="margin-bottom:8px;"><i class="fas fa-pen"></i> Nick DeÄŸiÅŸtir</button>
                            <button class="modal-btn info" onclick="changePassword()" style="margin-bottom:8px;"><i class="fas fa-lock"></i> Åžifre DeÄŸiÅŸtir</button>
                            <button class="modal-btn primary" onclick="openCreateChannelModal()" style="margin-bottom:8px;"><i class="fas fa-plus-circle"></i> Kanal AÃ§</button>
                            <button class="modal-btn success" onclick="openSupportModal()" style="margin-bottom:8px;"><i class="fas fa-headset"></i> Destek</button>
                            <button class="modal-btn warning" onclick="togglePrivateMode()" style="margin-bottom:8px;"><i class="fas fa-user-secret"></i> Ã–zel Sohbet: ${currentUser.privateMode === 'all' ? 'Herkese AÃ§Ä±k' : currentUser.privateMode === 'none' ? 'KapalÄ±' : 'Engellenenler'}</button>
                            <button class="modal-btn warning" onclick="blockNick()" style="margin-bottom:8px;"><i class="fas fa-ban"></i> Belirli KiÅŸiyi Engelle</button>
                            <button class="modal-btn danger" onclick="logout()" style="margin-bottom:8px;"><i class="fas fa-sign-out-alt"></i> GÃ¼venli Ã‡Ä±kÄ±ÅŸ</button>
                            <button class="modal-btn danger" onclick="openDeleteAccountModal()"><i class="fas fa-trash"></i> HesabÄ± Sil</button>
                        </div>
                    </div>`;
            }
            setActiveIcon(panelName);
        }

        function showOnlineList() {
            database.ref(`online/${currentChannel}`).once('value', (snapshot) => {
                const users = snapshot.val() || {};
                const panel = document.getElementById('leftPanel');
                let html = `
                    <div class="panel-header">
                        <h3><i class="fas fa-users" style="color:#2ecc71;"></i> Ã‡evrimiÃ§i (${Object.keys(users).length})</h3>
                        <div class="panel-close" onclick="loadLeftPanel('channels')">
                            <i class="fas fa-times"></i>
                        </div>
                    </div>
                    <div class="panel-content">`;
                
                Object.values(users).forEach(user => {
                    let roleIcon = '';
                    if (user.role === 'owner') roleIcon = 'ðŸ‘‘ ';
                    else if (user.role === 'admin') roleIcon = 'âš¡ ';
                    else if (user.role === 'coadmin') roleIcon = 'ðŸ”§ ';
                    else if (user.role === 'operator') roleIcon = 'ðŸ› ï¸ ';
                    
                    html += `<div class="online-item" onclick="openPrivateChat('${user.name}')">
                        <div class="online-avatar"><span>${user.name.charAt(0)}</span></div>
                        <div class="online-info">
                            <div class="online-name">${roleIcon}${user.name}<span class="online-status"></span></div>
                            <div class="online-meta"><span>#${currentChannel}</span></div>
                        </div>
                    </div>`;
                });
                
                html += `</div>`;
                panel.innerHTML = html;
            });
        }

        function setActiveIcon(active) {
            document.querySelectorAll('.icon-item').forEach(el => el.classList.remove('active'));
            if (active === 'channels') {
                document.querySelector('.icon-item[onclick*="openChannels"]')?.classList.add('active');
            } else if (active === 'online') {
                document.querySelector('.icon-item[onclick*="openOnline"]')?.classList.add('active');
            } else if (active === 'notifications') {
                document.querySelector('.icon-item[onclick*="openNotifications"]')?.classList.add('active');
            } else if (active === 'profile') {
                document.querySelector('.profile-avatar')?.classList.add('active');
            }
        }

        // ========== KOMUT Ä°ÅžLEME ==========
        function handleCommand(cmd) {
            const parts = cmd.substring(1).split(' ');
            const main = parts[0].toLowerCase();

            if (main === 'help') {
                addSystemMessage('ðŸ“‹ KOMUTLAR:');
                addSystemMessage('/join #kanal - Kanala katÄ±l');
                addSystemMessage('/msg kullanÄ±cÄ± mesaj - Ã–zel mesaj gÃ¶nder');
                addSystemMessage('/nick list - Ã‡evrimiÃ§i listesi');
                addSystemMessage('/ping - BaÄŸlantÄ± testi');
                addSystemMessage('/temizle - Sohbeti temizle');
            }
            else if (main === 'join') {
                const ch = parts[1]?.replace('#', '');
                if (ch) joinChannel(ch);
                else addSystemMessage('âŒ Kanal adÄ± girin');
            }
            else if (main === 'msg') {
                const target = parts[1];
                const msg = parts.slice(2).join(' ');
                if (target && msg) {
                    openPrivateChat(target);
                    setTimeout(() => {
                        document.getElementById('privateMessageInput').value = msg;
                        sendPrivateMessage();
                    }, 300);
                } else addSystemMessage('KullanÄ±m: /msg kullanÄ±cÄ± mesaj');
            }
            else if (main === 'nick' && parts[1] === 'list') {
                showOnlineList();
            }
            else if (main === 'ping') {
                addSystemMessage('ðŸ“ Pong!');
            }
            else if (main === 'temizle' || main === 'clear') {
                document.getElementById('messages').innerHTML = '';
                addSystemMessage('âœ… Sohbet temizlendi');
            }
            else {
                addSystemMessage(`âŒ Bilinmeyen komut: ${cmd}`);
            }
        }

        // ========== YÃ–NETÄ°CÄ° PANELÄ° FONKSÄ°YONLARI ==========
        function banUser() {
            const user = document.getElementById('adminTargetUser').value;
            addSystemMessage(`ðŸš« ${user} yasaklandÄ±`);
            toggleAdminPanel();
        }

        function kickUser() {
            const user = document.getElementById('adminTargetUser').value;
            addSystemMessage(`ðŸ‘¢ ${user} atÄ±ldÄ±`);
            toggleAdminPanel();
        }

        function unbanUser() {
            const user = document.getElementById('adminTargetUser').value;
            addSystemMessage(`âœ… ${user} yasaÄŸÄ± kaldÄ±rÄ±ldÄ±`);
            toggleAdminPanel();
        }

        function addAdmin() {
            const user = document.getElementById('adminTargetUser').value;
            addSystemMessage(`âœ… ${user} admin yapÄ±ldÄ±`);
            toggleAdminPanel();
        }

        function removeAdmin() {
            const user = document.getElementById('adminTargetUser').value;
            addSystemMessage(`âœ… ${user} admin yetkisi alÄ±ndÄ±`);
            toggleAdminPanel();
        }

        function addCoAdmin() {
            const user = document.getElementById('adminTargetUser').value;
            addSystemMessage(`ðŸ”§ ${user} co-admin yapÄ±ldÄ±`);
            toggleAdminPanel();
        }

        function removeCoAdmin() {
            const user = document.getElementById('adminTargetUser').value;
            addSystemMessage(`ðŸ”¨ ${user} co-admin yetkisi alÄ±ndÄ±`);
            toggleAdminPanel();
        }

        function addOperator() {
            const user = document.getElementById('adminTargetUser').value;
            addSystemMessage(`ðŸ› ï¸ ${user} operator yapÄ±ldÄ±`);
            toggleAdminPanel();
        }

        function removeOperator() {
            const user = document.getElementById('adminTargetUser').value;
            addSystemMessage(`ðŸ”¨ ${user} operator yetkisi alÄ±ndÄ±`);
            toggleAdminPanel();
        }

        // ========== Ã‡IKIÅž ==========
        function logout() {
            if (currentUser) {
                database.ref(`online/${currentChannel}/${currentUser.id}`).remove();
            }
            localStorage.removeItem('cetcety_user');
            location.reload();
        }

        // ========== BAÅžLANGIÃ‡ ==========
        document.addEventListener('DOMContentLoaded', function() {
            if (localStorage.getItem('theme') === 'light') document.body.classList.add('light-theme');

            const savedUser = localStorage.getItem('cetcety_user');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    document.getElementById('loginOverlay').classList.add('hidden');
                    document.getElementById('app').style.display = 'flex';
                    
                    if (currentUser.avatarUrl) {
                        document.getElementById('avatarText').innerHTML = `<img src="${currentUser.avatarUrl}" style="width:100%; height:100%; border-radius:50%; object-fit:cover;">`;
                    } else {
                        document.getElementById('avatarText').textContent = currentUser.avatar;
                    }

                    database.ref(`online/${currentChannel}/${currentUser.id}`).set({
                        name: currentUser.name,
                        role: currentUser.role
                    });

                    listenMessages();
                    listenOnline();
                    updateYoutubePlaylistUI();
                    updateSpotifyPlaylistUI();
                    updateMediaButtons();
                    loadLeftPanel('channels');
                    addSystemMessage(`ðŸ‘‹ Tekrar hoÅŸ geldin, ${currentUser.name}!`);
                } catch (e) {
                    localStorage.removeItem('cetcety_user');
                }
            }

            const messageInput = document.getElementById('messageInput');
            if (messageInput) {
                messageInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessage();
                    }
                });
            }

            const privateInput = document.getElementById('privateMessageInput');
            if (privateInput) {
                privateInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendPrivateMessage();
                    }
                });
            }
        });
    </script>
</body>
</html>
