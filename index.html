<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CETCETY â€¢ Ã‡ift Medya</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://www.youtube.com/iframe_api"></script>
    
    <style>
        /* ========== RESET ========== */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background: #0f0f0f; 
            color: #fff; 
            overflow: hidden; 
            height: 100vh;
            width: 100vw;
            position: fixed;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MCIgaGVpZ2h0PSI4MCIgdmlld0JveD0iMCAwIDgwIDgwIj48cGF0aCBkPSJNMjAgMjBoMTB2MTBIMjB6TTUwIDUwaDEwdjEwSDUweiIgZmlsbD0icmdiYSgyNTUsMjU1LDI1NSwwLjA1KSIvPjwvc3ZnPg==');
            background-size: 80px 80px;
            background-repeat: repeat;
            opacity: 0.5;
            z-index: -1;
            pointer-events: none;
        }

        /* ========== GÄ°RÄ°Åž EKRANI ========== */
        .login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.95); backdrop-filter: blur(10px);
            display: flex; align-items: center; justify-content: center;
            z-index: 10000; transition: opacity 0.3s;
        }
        .login-overlay.hidden { display: none; }
        
        .login-panel {
            width: 90%; max-width: 360px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 24px;
            padding: 40px 24px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
        }
        
        .login-panel h2 { 
            text-align: center; 
            margin-bottom: 32px; 
            font-size: 32px; 
            font-weight: 700; 
            color: #ff0000;
        }
        
        .login-input {
            width: 100%;
            padding: 16px;
            background: #2a2a2a;
            border: 1px solid #3f3f3f;
            border-radius: 12px;
            color: #fff;
            font-size: 16px;
            margin-bottom: 16px;
            outline: none;
        }
        
        .login-input:focus { border-color: #ff0000; }
        
        .login-btn {
            width: 100%;
            padding: 16px;
            background: #ff0000;
            border: none;
            border-radius: 12px;
            color: #fff;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: 0.2s;
            margin-top: 8px;
        }
        
        .login-btn:active { transform: scale(0.98); background: #cc0000; }
        
        .login-info { 
            text-align: center; 
            margin-top: 24px; 
            font-size: 12px; 
            color: #888;
            line-height: 1.6;
        }
        .login-info a { color: #ff0000; text-decoration: none; font-weight: 600; cursor: pointer; }

        /* ========== ANA UYGULAMA ========== */
        .app {
            display: flex;
            height: 100vh;
            width: 100vw;
            background: #0f0f0f;
            position: relative;
        }

        /* ========== SOL Ä°KON PANELÄ° ========== */
        .icon-panel {
            width: 72px;
            background: #0f0f0f;
            border-right: 1px solid #2a2a2a;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 24px 0;
            gap: 16px;
            flex-shrink: 0;
            z-index: 20;
            height: 100vh;
            overflow-y: auto;
        }
        
        .icon-item {
            width: 48px; height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            cursor: pointer;
            transition: 0.2s;
            font-size: 22px;
            position: relative;
        }
        
        .icon-item:hover { background: #2a2a2a; color: #fff; }
        .icon-item.active { color: #fff; background: #ff0000; }
        
        .icon-badge {
            position: absolute; top: -4px; right: -4px;
            background: #ff4444;
            color: white;
            font-size: 10px;
            font-weight: 600;
            min-width: 18px;
            height: 18px;
            border-radius: 9px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 4px;
            border: 2px solid #0f0f0f;
        }
        
        .profile-avatar {
            margin-top: auto;
            width: 48px; height: 48px;
            border-radius: 50%;
            background: #2a2a2a;
            border: 2px solid #3f3f3f;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #fff;
            overflow: hidden;
        }
        
        .profile-avatar img { width: 100%; height: 100%; object-fit: cover; }
        .profile-avatar.active { border-color: #ff0000; }

        /* ========== ANA Ä°Ã‡ERÄ°K ========== */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* ========== VÄ°DEO BÃ–LÃœMÃœ ========== */
        .video-section {
            width: 100%;
            background: #000;
            position: relative;
            flex-shrink: 0;
        }
        
        /* Mobil: video Ã¼stte %30 */
        @media (max-width: 768px) {
            .video-section { height: 30vh; }
        }
        
        /* Tablet: video %35 */
        @media (min-width: 769px) and (max-width: 1024px) {
            .video-section { height: 35vh; }
        }
        
        /* MasaÃ¼stÃ¼: video %40 */
        @media (min-width: 1025px) {
            .video-section { height: 40vh; }
        }
        
        .video-wrapper {
            width: 100%;
            height: 100%;
            position: relative;
            background: #000;
        }
        
        #youtube-player {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }
        
        /* Video kontrolleri (videonun ÃœZERÄ°NDE) */
        .video-controls {
            position: absolute;
            bottom: 16px;
            right: 16px;
            display: flex;
            gap: 12px;
            z-index: 10;
        }
        
        .video-control-btn {
            width: 44px; height: 44px;
            border-radius: 50%;
            background: rgba(0,0,0,0.7);
            border: 2px solid rgba(255,255,255,0.3);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            backdrop-filter: blur(5px);
            font-size: 20px;
        }
        
        .video-control-btn:active { background: #ff0000; border-color: #ff0000; }

        /* ========== SOHBET BÃ–LÃœMÃœ ========== */
        .chat-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background: #0f0f0f;
            position: relative;
        }
        
        .chat-header {
            height: 56px;
            padding: 0 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #2a2a2a;
            background: #0f0f0f;
            flex-shrink: 0;
        }
        
        .chat-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }
        
        .chat-title i { color: #ff0000; }
        
        .channel-info-bar {
            font-size: 12px;
            color: #aaa;
            margin-left: 12px;
        }
        
        .subscribe-btn {
            padding: 6px 16px;
            background: #2a2a2a;
            border: 1px solid #3f3f3f;
            border-radius: 20px;
            color: #fff;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .subscribe-btn.subscribed { background: #ff0000; border-color: #ff0000; }

        /* ========== MESAJLAR ========== */
        .messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .message {
            display: flex;
            flex-direction: column;
            max-width: 85%;
            animation: fadeIn 0.2s;
        }
        
        .message.right { align-self: flex-end; }
        
        .message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
            font-size: 12px;
        }
        
        .message-sender {
            font-weight: 600;
            color: #ff0000;
            cursor: pointer;
        }
        
        .message-time { color: #aaa; }
        
        .message-text {
            font-size: 14px;
            line-height: 1.4;
            color: #fff;
            background: #2a2a2a;
            padding: 10px 14px;
            border-radius: 18px;
            word-break: break-word;
        }
        
        .message.right .message-text { background: #ff0000; color: #fff; }
        
        .system-message {
            align-self: center;
            background: #1a1a1a;
            color: #aaa;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            margin: 8px 0;
            max-width: 90%;
            text-align: center;
            border: 1px solid #2a2a2a;
        }
        
        .admin-system-message {
            align-self: center;
            background: rgba(255,0,0,0.2);
            color: #ffd700;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            margin: 8px 0;
            border: 1px solid #ff0000;
            font-weight: 600;
        }

        /* ========== MESAJ GÄ°RÄ°Åž ========== */
        .message-input-container {
            padding: 12px 16px;
            background: #0f0f0f;
            border-top: 1px solid #2a2a2a;
            flex-shrink: 0;
        }
        
        .input-wrapper {
            display: flex;
            align-items: center;
            gap: 12px;
            background: #2a2a2a;
            border: 1px solid #3f3f3f;
            border-radius: 28px;
            padding: 4px 4px 4px 16px;
        }
        
        .message-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #fff;
            font-size: 14px;
            padding: 12px 0;
            resize: none;
            max-height: 80px;
            outline: none;
        }
        
        .send-btn {
            width: 44px; height: 44px;
            border-radius: 50%;
            background: #ff0000;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #fff;
            flex-shrink: 0;
        }
        
        .send-btn:active { transform: scale(0.95); }

        /* ========== SOL PANEL (KAYAN) ========== */
        .left-panel {
            position: fixed;
            top: 0;
            left: -100%;
            width: 85%;
            max-width: 360px;
            height: 100vh;
            background: #0f0f0f;
            border-right: 1px solid #2a2a2a;
            z-index: 100;
            transition: left 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        
        .left-panel.active { left: 72px; } /* Ä°kon panelinin yanÄ±nda */
        
        .panel-header {
            height: 60px;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #2a2a2a;
            background: #0a0a0a;
            flex-shrink: 0;
        }
        
        .panel-header h3 {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }
        
        .subscription-count {
            background: #ff0000;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
        }
        
        .panel-close {
            width: 36px; height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            cursor: pointer;
        }
        
        .panel-close:active { background: #2a2a2a; color: #fff; }
        
        .panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        .panel-tabs {
            display: flex;
            border-bottom: 1px solid #2a2a2a;
            background: #0f0f0f;
        }
        
        .panel-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            font-size: 13px;
            font-weight: 600;
            color: #aaa;
            cursor: pointer;
        }
        
        .panel-tab.active {
            color: #fff;
            border-bottom: 2px solid #ff0000;
        }
        
        .search-container {
            display: flex;
            align-items: center;
            background: #2a2a2a;
            border: 1px solid #3f3f3f;
            border-radius: 30px;
            padding: 0 16px;
            margin-bottom: 20px;
        }
        
        .search-container i { color: #aaa; }
        
        .search-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #fff;
            padding: 14px 8px;
            outline: none;
        }

        /* Panel Ã¶ÄŸeleri */
        .subscription-item, .channel-item, .chat-item, .online-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 4px;
        }
        
        .subscription-item:hover, .channel-item:hover, .chat-item:hover, .online-item:hover {
            background: #2a2a2a;
        }
        
        .subscription-item.active {
            background: #2a2a2a;
            border-left: 4px solid #ff0000;
        }
        
        .subscription-avatar, .channel-avatar, .chat-avatar, .online-avatar {
            width: 40px; height: 40px;
            border-radius: 50%;
            background: #2a2a2a;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ff0000;
            font-size: 18px;
            flex-shrink: 0;
            overflow: hidden;
        }
        
        .online-avatar { background: #0a5c36; color: #fff; }
        
        .subscription-info, .channel-info, .chat-info, .online-info {
            flex: 1;
            min-width: 0;
        }
        
        .subscription-name, .channel-name, .chat-name, .online-name {
            font-weight: 600;
            font-size: 14px;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 6px;
            flex-wrap: wrap;
        }
        
        .subscription-meta, .channel-meta, .chat-meta, .online-meta {
            font-size: 11px;
            color: #aaa;
            margin-top: 2px;
        }
        
        .subscription-stats {
            font-size: 12px;
            color: #aaa;
        }
        
        .subscription-notification {
            width: 8px; height: 8px;
            background: #ff4444;
            border-radius: 50%;
            display: inline-block;
            margin-left: 6px;
        }

        /* Rozetler */
        .badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 9px;
            font-weight: 600;
            background: transparent;
            border: 1px solid;
        }
        .badge-owner { color: #ffd700; border-color: #ffd700; }
        .badge-admin { color: #ff6b6b; border-color: #ff6b6b; }
        .badge-coadmin { color: #6495ed; border-color: #6495ed; }
        .badge-operator { color: #ffaa00; border-color: #ffaa00; }
        .badge-hidden { color: #aaa; border-color: #aaa; }
        .badge-super-hidden { color: #ff0000; border-color: #ff0000; background: rgba(255,0,0,0.1); }

        /* PopÃ¼ler kanallar */
        .popular-channels {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #2a2a2a;
        }
        
        .popular-header {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #ffd700;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 12px;
        }
        
        .popular-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
        }
        
        .popular-item:hover { background: #2a2a2a; }
        
        .popular-info { flex: 1; }
        .popular-name { font-weight: 500; font-size: 13px; }
        .popular-subscribers { font-size: 10px; color: #aaa; }

        /* ========== Ã–ZEL SOHBET PANELÄ° ========== */
        .private-chat-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0f0f0f;
            z-index: 200;
            display: none;
            flex-direction: column;
        }
        
        .private-chat-panel.active { display: flex; }
        
        .private-chat-header {
            height: 60px;
            padding: 0 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #2a2a2a;
            background: #0a0a0a;
        }
        
        .private-chat-user {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .private-chat-avatar {
            width: 40px; height: 40px;
            border-radius: 50%;
            background: #ff0000;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .private-chat-avatar img { width: 100%; height: 100%; object-fit: cover; }
        
        .private-chat-info h4 { font-size: 16px; font-weight: 600; }
        .private-chat-info span { font-size: 12px; color: #aaa; }
        
        .private-chat-actions {
            display: flex;
            gap: 12px;
        }
        
        .private-chat-action {
            width: 40px; height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            cursor: pointer;
        }
        
        .private-chat-action:active { background: #2a2a2a; color: #fff; }
        
        .private-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .private-message {
            max-width: 85%;
            position: relative;
        }
        
        .private-message.right { align-self: flex-end; }
        
        .private-message-text {
            background: #2a2a2a;
            padding: 10px 14px;
            border-radius: 18px;
            font-size: 14px;
        }
        
        .private-message.right .private-message-text { background: #ff0000; }
        
        .private-message-media img, .private-message-media video {
            max-width: 100%;
            max-height: 200px;
            border-radius: 12px;
        }
        
        .delete-msg {
            position: absolute;
            top: -8px; right: -8px;
            width: 24px; height: 24px;
            border-radius: 50%;
            background: #ff4444;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            opacity: 0;
            transition: 0.2s;
            z-index: 5;
        }
        
        .private-message:hover .delete-msg { opacity: 1; }
        
        .private-input-container {
            padding: 16px;
            background: #0f0f0f;
            border-top: 1px solid #2a2a2a;
        }
        
        .private-media-actions {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .private-media-btn {
            width: 44px; height: 44px;
            border-radius: 50%;
            background: #2a2a2a;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            cursor: pointer;
        }
        
        .private-media-btn:active { background: #3f3f3f; color: #fff; }
        
        .private-input-wrapper {
            display: flex;
            gap: 12px;
        }
        
        .private-input {
            flex: 1;
            background: #2a2a2a;
            border: 1px solid #3f3f3f;
            border-radius: 24px;
            padding: 14px 16px;
            color: #fff;
            resize: none;
            outline: none;
        }
        
        .private-send-btn {
            width: 48px; height: 48px;
            border-radius: 50%;
            background: #ff0000;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        /* ========== MEDYA PANELÄ° (YOUTUBE PLAYLIST) ========== */
        .media-panel {
            position: fixed;
            top: 0;
            right: -100%;
            width: 85%;
            max-width: 400px;
            height: 100vh;
            background: #0f0f0f;
            border-left: 1px solid #2a2a2a;
            z-index: 150;
            transition: right 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        
        .media-panel.active { right: 0; }
        
        .media-header {
            height: 60px;
            padding: 0 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid #2a2a2a;
            background: #0a0a0a;
        }
        
        .media-tab {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            font-size: 13px;
            background: #2a2a2a;
            color: #aaa;
        }
        
        .media-tab.active { background: #ff0000; color: #fff; }
        .media-tab i { color: #ff0000; }
        .media-tab.active i { color: #fff; }
        
        .media-header-spacer { flex: 1; }
        
        .media-header-btn {
            width: 36px; height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            cursor: pointer;
            background: #2a2a2a;
        }
        
        .media-header-btn:active { background: #3f3f3f; color: #fff; }
        .media-header-btn.disabled { opacity: 0.4; pointer-events: none; }
        
        .media-playlist-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        .media-playlist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #2a2a2a;
        }
        
        .media-playlist-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-size: 14px;
        }
        
        .media-playlist-count { color: #aaa; font-size: 12px; }
        
        .media-playlist-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 4px;
        }
        
        .media-playlist-item:hover { background: #2a2a2a; }
        .media-playlist-item.active { background: #2a2a2a; border-left: 4px solid #ff0000; }
        
        .media-playlist-thumb {
            width: 48px; height: 48px;
            border-radius: 6px;
            background: #2a2a2a;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
            color: #ff0000;
        }
        
        .media-playlist-info { flex: 1; }
        .media-playlist-song { font-weight: 500; font-size: 13px; }
        .media-playlist-artist { font-size: 11px; color: #aaa; margin-top: 2px; }
        
        .media-playlist-actions {
            display: flex;
            gap: 8px;
            margin-left: auto;
        }
        
        .media-playlist-action {
            width: 32px; height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ff4444;
            cursor: pointer;
        }
        
        .media-playlist-action:hover { background: #3f3f3f; }
        .media-report-btn { color: #ffaa00; }

        /* ========== MODAL ========== */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.95);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 300;
            opacity: 0;
            visibility: hidden;
            transition: 0.3s;
        }
        
        .modal-overlay.active { opacity: 1; visibility: visible; }
        
        .modal-panel {
            width: 90%;
            max-width: 500px;
            background: #1a1a1a;
            border-radius: 24px;
            overflow: hidden;
        }
        
        .modal-header {
            padding: 20px;
            background: #0f0f0f;
            border-bottom: 1px solid #2a2a2a;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .modal-close {
            width: 36px; height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            cursor: pointer;
        }
        
        .modal-close:active { background: #2a2a2a; color: #fff; }
        
        .modal-content {
            padding: 24px;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .modal-footer {
            padding: 16px 20px;
            border-top: 1px solid #2a2a2a;
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        /* Form elemanlarÄ± */
        .form-group { margin-bottom: 16px; }
        .form-label { display: block; font-size: 12px; color: #aaa; margin-bottom: 6px; }
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px;
            background: #2a2a2a;
            border: 1px solid #3f3f3f;
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
            outline: none;
        }
        .form-textarea { min-height: 100px; resize: vertical; }
        .form-input:focus, .form-select:focus, .form-textarea:focus { border-color: #ff0000; }
        
        .form-button {
            padding: 12px 24px;
            background: #ff0000;
            border: none;
            border-radius: 8px;
            color: #fff;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
        }
        
        .form-button.secondary { background: #2a2a2a; }
        .form-button.danger { background: #6d0000; }
        
        .info-box {
            background: #2a2a2a;
            border-left: 4px solid #ff0000;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
        }
        .info-box p { color: #aaa; font-size: 13px; line-height: 1.5; }

        /* Avatar yÃ¼kleme */
        .avatar-upload {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding: 20px;
            background: #2a2a2a;
            border-radius: 12px;
        }
        
        .avatar-preview {
            width: 100px; height: 100px;
            border-radius: 50%;
            background: #3f3f3f;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: #ff0000;
            overflow: hidden;
        }
        
        .avatar-preview img { width: 100%; height: 100%; object-fit: cover; }
        
        .upload-btn {
            background: #3f3f3f;
            color: #fff;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        /* Owner takip gÃ¶stergesi */
        .owner-spy-indicator {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #ff0000;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 2px solid #ffd700;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }

        /* BaÄŸlantÄ± durumu */
        .connection-status {
            position: fixed;
            bottom: 80px;
            right: 16px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
        }
        
        .connection-status.connected { background: #0a5c36; }
        
        .status-dot {
            width: 8px; height: 8px;
            border-radius: 50%;
        }
        
        .connected .status-dot { background: #2ecc71; }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #1a1a1a; }
        ::-webkit-scrollbar-thumb { background: #3f3f3f; border-radius: 2px; }

        /* Mobil Ã¶zel dÃ¼zenlemeler */
        @media (max-width: 768px) {
            .icon-panel { width: 56px; }
            .icon-item { width: 40px; height: 40px; font-size: 18px; }
            .left-panel.active { left: 56px; }
            .media-panel { width: 100%; }
            .connection-status { bottom: 16px; }
        }
    </style>
</head>
<body>
    <!-- GÄ°RÄ°Åž EKRANI -->
    <div id="loginOverlay" class="login-overlay">
        <div class="login-panel">
            <h2>CETCETY</h2>
            <input type="text" id="loginNick" class="login-input" placeholder="KullanÄ±cÄ± adÄ±">
            <input type="password" id="loginPassword" class="login-input" placeholder="Åžifre (opsiyonel)">
            <button class="login-btn" onclick="handleLogin()">GÄ°RÄ°Åž YAP / KAYIT OL</button>
            <div class="login-info">
                KayÄ±tlÄ± nickler ÅŸifre ile. <strong>KayÄ±tsÄ±z nickler ÅŸifresiz.</strong><br>
                GiriÅŸ yaparak <a onclick="openKvkkModal()">KVKK</a> ve <a onclick="openTermsModal()">Åžartlar</a>'Ä± kabul edersiniz.
            </div>
        </div>
    </div>

    <!-- KVKK MODAL -->
    <div id="kvkkModal" class="modal-overlay">
        <div class="modal-panel">
            <div class="modal-header">
                <h3><i class="fas fa-shield-alt" style="color:#ff0000;"></i> KVKK AydÄ±nlatma Metni</h3>
                <div class="modal-close" onclick="closeModal('kvkkModal')"><i class="fas fa-times"></i></div>
            </div>
            <div class="modal-content">
                <p>KiÅŸisel verileriniz, platformun Ã§alÄ±ÅŸmasÄ± iÃ§in gerekli olan kullanÄ±cÄ± adÄ±, ÅŸifre (ÅŸifrelenmiÅŸ) ve IP adresi gibi verilerdir.</p>
            </div>
            <div class="modal-footer">
                <button class="form-button" onclick="closeModal('kvkkModal')">Kapat</button>
            </div>
        </div>
    </div>

    <!-- ÅžARTLAR MODAL -->
    <div id="termsModal" class="modal-overlay">
        <div class="modal-panel">
            <div class="modal-header">
                <h3><i class="fas fa-file-contract" style="color:#ff0000;"></i> KullanÄ±m ÅžartlarÄ±</h3>
                <div class="modal-close" onclick="closeModal('termsModal')"><i class="fas fa-times"></i></div>
            </div>
            <div class="modal-content">
                <p>1. Platform anonim kullanÄ±ma dayalÄ±dÄ±r.</p>
                <p>2. YasaklÄ± kelimeler, spam, hakaret yasaktÄ±r.</p>
                <p>3. Admin ve co-admin yetkilileri kanallarÄ±nÄ± yÃ¶netir.</p>
                <p>4. Owner tÃ¼m platformu yÃ¶netir.</p>
            </div>
            <div class="modal-footer">
                <button class="form-button" onclick="closeModal('termsModal')">Kapat</button>
            </div>
        </div>
    </div>

    <!-- VÄ°DEO EKLE MODAL -->
    <div id="youtubeModal" class="modal-overlay">
        <div class="modal-panel">
            <div class="modal-header">
                <h3><i class="fab fa-youtube" style="color:#ff0000;"></i> Video Ekle</h3>
                <div class="modal-close" onclick="closeModal('youtubeModal')"><i class="fas fa-times"></i></div>
            </div>
            <div class="modal-content">
                <div class="form-group">
                    <label class="form-label">Video URL / ID</label>
                    <input type="text" id="youtubeUrlInput" class="form-input" placeholder="https://youtube.com/watch?v=...">
                </div>
                <div class="form-group">
                    <label class="form-label">Video BaÅŸlÄ±ÄŸÄ±</label>
                    <input type="text" id="youtubeTitleInput" class="form-input" placeholder="Video baÅŸlÄ±ÄŸÄ±...">
                </div>
            </div>
            <div class="modal-footer">
                <button class="form-button secondary" onclick="closeModal('youtubeModal')">Ä°ptal</button>
                <button class="form-button" onclick="addYoutubeVideo()">Ekle</button>
            </div>
        </div>
    </div>

    <!-- AVATAR YÃœKLEME MODAL -->
    <div id="avatarModal" class="modal-overlay">
        <div class="modal-panel">
            <div class="modal-header">
                <h3><i class="fas fa-camera" style="color:#ff0000;"></i> Profil Resmi</h3>
                <div class="modal-close" onclick="closeModal('avatarModal')"><i class="fas fa-times"></i></div>
            </div>
            <div class="modal-content">
                <div class="avatar-upload">
                    <div class="avatar-preview" id="avatarPreview">
                        <span id="avatarPreviewText">?</span>
                        <img id="avatarPreviewImage" style="display: none;">
                    </div>
                    <input type="file" id="avatarFileInput" accept="image/*" style="display: none;" onchange="previewAvatar(this)">
                    <div class="upload-btn" onclick="document.getElementById('avatarFileInput').click()">
                        <i class="fas fa-upload"></i> Resim SeÃ§
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="form-button secondary" onclick="closeModal('avatarModal')">Ä°ptal</button>
                <button class="form-button" onclick="uploadAvatar()">Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Ã–ZEL SOHBET TAKÄ°P MODAL (OWNER) -->
    <div id="privateSpyModal" class="modal-overlay">
        <div class="modal-panel" style="width:600px;">
            <div class="modal-header">
                <h3><i class="fas fa-eye" style="color:#ff0000;"></i> Ã–zel Sohbet Takip - <span id="spyChannelName">#kanal</span></h3>
                <div class="modal-close" onclick="stopPrivateSpy()"><i class="fas fa-times"></i></div>
            </div>
            <div class="modal-content" id="spyMessages" style="max-height:400px; overflow-y:auto;"></div>
            <div class="modal-footer">
                <button class="form-button danger" onclick="stopPrivateSpy()">Takibi Durdur</button>
            </div>
        </div>
    </div>

    <!-- ANA UYGULAMA -->
    <div id="app" class="app" style="display: none;">
        <!-- SOL Ä°KON PANELÄ° -->
        <div class="icon-panel">
            <div class="icon-item" onclick="openSubscriptions()" title="Abonelikler">
                <i class="fas fa-bell"></i>
                <span class="icon-badge" id="subscriptionBadge">0</span>
            </div>
            <div class="icon-item" onclick="openChannelPanel()" title="Kanallar">
                <i class="fas fa-list-ul"></i>
                <span class="icon-badge" id="channelCountBadge">0</span>
            </div>
            <div class="icon-item" onclick="openChatListPanel()" title="Sohbetlerim">
                <i class="fas fa-comment"></i>
                <span class="icon-badge" id="chatListBadge">0</span>
            </div>
            <div class="icon-item" onclick="openNotificationPanel()" title="Bildirimler">
                <i class="fas fa-bell"></i>
                <span class="icon-badge" id="notificationBadge">0</span>
            </div>
            <div class="profile-avatar" id="profileAvatar" onclick="openProfilePanel()">
                <span id="avatarText">?</span>
                <img id="avatarImage" style="display: none;">
            </div>
        </div>

        <!-- ANA Ä°Ã‡ERÄ°K -->
        <div class="main-content">
            <!-- VÄ°DEO BÃ–LÃœMÃœ -->
            <div class="video-section">
                <div class="video-wrapper">
                    <div id="youtube-player"></div>
                    <div class="video-controls">
                        <div class="video-control-btn" onclick="toggleMute()" id="muteBtn">
                            <i class="fas fa-volume-up" id="muteIcon"></i>
                        </div>
                        <div class="video-control-btn" onclick="togglePlayPause()" id="playPauseBtn">
                            <i class="fas fa-pause" id="playPauseIcon"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SOHBET BÃ–LÃœMÃœ -->
            <div class="chat-section">
                <div class="chat-header">
                    <div class="chat-title">
                        <i class="fas fa-hashtag"></i>
                        <span id="currentChannelName">genel</span>
                        <span class="channel-info-bar">
                            <span id="channelUserCount">0</span> Ã§evrimiÃ§i â€¢ 
                            <span id="channelSubscribers">1</span> abone
                        </span>
                    </div>
                    <button id="subscribeChannelBtn" class="subscribe-btn" onclick="toggleChannelSubscribe()">
                        <i class="fas fa-plus"></i> Abone Ol
                    </button>
                </div>

                <div class="messages" id="messages">
                    <div class="system-message">CETCETY'ye hoÅŸ geldin! /help yazarak komutlarÄ± gÃ¶rebilirsin.</div>
                </div>

                <div class="message-input-container">
                    <div class="input-wrapper">
                        <textarea id="messageInput" class="message-input" placeholder="Mesaj yazÄ±n... /help" rows="1"></textarea>
                        <div class="send-btn" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SOL PANEL (KAYAN) -->
        <div class="left-panel" id="leftPanel"></div>

        <!-- MEDYA PANELÄ° (YOUTUBE PLAYLIST) -->
        <div class="media-panel" id="mediaPanel">
            <div class="media-header">
                <div class="media-tab active">
                    <i class="fab fa-youtube"></i>
                    <span>YouTube</span>
                </div>
                <div class="media-header-spacer"></div>
                <div class="media-header-btn" onclick="openAddYoutubeModal()" id="addYoutubeBtn" title="Video ekle">
                    <i class="fas fa-plus"></i>
                </div>
                <div class="media-header-btn media-report-btn" onclick="reportMedia()" title="Åžikayet Et">
                    <i class="fas fa-flag"></i>
                </div>
                <div class="media-header-btn" onclick="toggleChannelHidden()" id="hideYoutubeBtn" title="Gizle/GÃ¶ster">
                    <i class="fas fa-eye" id="hideYoutubeIcon"></i>
                </div>
            </div>

            <div class="media-now-playing" style="display: none;"> <!-- Gizli, placeholder -->
                <i class="fas fa-circle" style="color:#ff0000; font-size:8px;"></i>
                <div class="now-playing-info">
                    <div class="now-playing-title" id="youtubeNowPlayingTitle">CETCETY Radio</div>
                    <div class="now-playing-artist" id="youtubeNowPlayingArtist">
                        <span class="role-icon owner">ðŸ‘‘</span>
                        <span id="youtubeNowPlayingOwner">MateKy</span>
                    </div>
                </div>
            </div>

            <div class="media-playlist-container">
                <div class="media-playlist-header">
                    <span class="media-playlist-title"><i class="fas fa-list"></i> Kanal Playlist</span>
                    <span class="media-playlist-count" id="youtubePlaylistCount">1 video</span>
                </div>
                <div id="youtubePlaylistItems" class="media-playlist-items"></div>
            </div>
        </div>

        <!-- Ã–ZEL SOHBET PANELÄ° -->
        <div class="private-chat-panel" id="privateChatPanel">
            <div class="private-chat-header">
                <div class="private-chat-user">
                    <div class="private-chat-avatar" id="privateChatAvatar">?</div>
                    <div class="private-chat-info">
                        <h4 id="privateChatName">KullanÄ±cÄ±</h4>
                        <span>Ã§evrimiÃ§i</span>
                    </div>
                </div>
                <div class="private-chat-actions">
                    <div class="private-chat-action" onclick="blockUser()" title="Engelle">
                        <i class="fas fa-ban"></i>
                    </div>
                    <div class="private-chat-action" onclick="reportUser()" title="Åžikayet Et">
                        <i class="fas fa-flag"></i>
                    </div>
                    <div class="private-chat-action" onclick="closePrivateChat()" title="Kapat">
                        <i class="fas fa-times"></i>
                    </div>
                </div>
            </div>
            <div class="private-chat-messages" id="privateChatMessages"></div>
            <div class="private-input-container">
                <div class="private-media-actions">
                    <div class="private-media-btn" onclick="triggerPrivateImageUpload()" title="Resim GÃ¶nder">
                        <i class="fas fa-image"></i>
                    </div>
                    <div class="private-media-btn" onclick="triggerPrivateVideoUpload()" title="Video GÃ¶nder">
                        <i class="fas fa-video"></i>
                    </div>
                    <input type="file" id="privateImageUpload" accept="image/*" style="display: none;">
                    <input type="file" id="privateVideoUpload" accept="video/*" style="display: none;">
                </div>
                <div class="private-input-wrapper">
                    <textarea id="privateMessageInput" class="private-input" placeholder="Mesaj yazÄ±n..." rows="1"></textarea>
                    <div class="private-send-btn" onclick="sendPrivateMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- BAÄžLANTI DURUMU -->
        <div id="connectionStatus" class="connection-status connected">
            <span class="status-dot"></span>
            <span id="statusText">Yerel Mod</span>
        </div>

        <!-- SES BÄ°LDÄ°RÄ°M -->
        <audio id="notificationSound" style="display: none;">
            <source src="https://assets.mixkit.co/sfx/preview/mixkit-software-interface-start-2574.mp3" type="audio/mpeg">
        </audio>
    </div>

   <!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>

<!-- Ã–NCE firebase.js, SONRA diÄŸerleri -->
<script src="firebase.js"></script>
<script src="media.js"></script>
<script src="sohbet.js"></script>
<script src="admin.js"></script>
<script src="ikon.js"></script>

    <script>
        // ========== ANA BAÅžLANGIÃ‡ ==========
        // TÃ¼m modÃ¼llerin birbiriyle iletiÅŸimi

        // Global deÄŸiÅŸkenler
        let currentUser = null;
        let currentChannel = 'genel';
        let channels = JSON.parse(localStorage.getItem('cetcety_channels')) || {};
        let USERS_DB = JSON.parse(localStorage.getItem('cetcety_users')) || [];

        // VarsayÄ±lan kanallar
        if (!channels.genel) {
            channels.genel = {
                name: 'genel',
                owner: 'MateKy',
                ownerRole: 'owner',
                coAdmins: [],
                subscribers: 1,
                isHidden: false,
                isSuperHidden: false,
                youtube: {
                    currentVideo: 'QKEHXrDVBF8',
                    currentTitle: 'LoFi Study Beats',
                    currentArtist: 'Soul Cafe',
                    playlist: [{
                        id: 'QKEHXrDVBF8',
                        title: 'LoFi Study Beats',
                        addedBy: 'MateKy',
                        role: 'owner'
                    }]
                },
                onlineUsers: []
            };
        }

        if (!channels.admin) {
            channels.admin = {
                name: 'admin',
                owner: 'MateKy',
                ownerRole: 'owner',
                coAdmins: [],
                subscribers: 1,
                isHidden: false,
                isSuperHidden: false,
                youtube: {
                    currentVideo: 'QKEHXrDVBF8',
                    currentTitle: 'LoFi Study Beats',
                    currentArtist: 'Soul Cafe',
                    playlist: [{
                        id: 'QKEHXrDVBF8',
                        title: 'LoFi Study Beats',
                        addedBy: 'MateKy',
                        role: 'owner'
                    }]
                },
                onlineUsers: []
            };
        }

        // ========== MODAL FONKSÄ°YONLARI ==========
        function openKvkkModal() { document.getElementById('kvkkModal').classList.add('active'); }
        function openTermsModal() { document.getElementById('termsModal').classList.add('active'); }
        function closeModal(modalId) { document.getElementById(modalId).classList.remove('active'); }

        // ========== GÄ°RÄ°Åž ==========
        function handleLogin() {
            const nick = document.getElementById('loginNick').value.trim();
            const pass = document.getElementById('loginPassword').value.trim();
            
            if (!nick) { alert('KullanÄ±cÄ± adÄ± girin!'); return; }

            // KullanÄ±cÄ± var mÄ± kontrol et
            let existingUser = USERS_DB.find(u => u.name.toLowerCase() === nick.toLowerCase());

            if (existingUser) {
                // KayÄ±tlÄ± kullanÄ±cÄ±
                if (existingUser.password && existingUser.password !== pass) {
                    alert('HatalÄ± ÅŸifre!');
                    return;
                }
                
                // Owner kontrolÃ¼ (ÅŸifre gizli)
                if (nick.toLowerCase() === 'mateky' && pass !== 'Sahi17407@SCM') {
                    alert('Owner ÅŸifresi hatalÄ±!');
                    return;
                }
                
                currentUser = existingUser;
            } else {
                // Yeni kullanÄ±cÄ±
                if (nick.toLowerCase() === 'mateky') {
                    if (pass !== 'Sahi17407@SCM') {
                        alert('Owner ÅŸifresi hatalÄ±!');
                        return;
                    }
                }
                
                currentUser = {
                    id: Date.now().toString(),
                    name: nick,
                    nameLower: nick.toLowerCase(),
                    role: nick.toLowerCase() === 'mateky' ? 'owner' : 'user',
                    roleLevel: nick.toLowerCase() === 'mateky' ? 5 : 1,
                    subscribedChannels: ['genel'],
                    myChannel: null,
                    joinDate: new Date().toISOString(),
                    avatar: nick.charAt(0).toUpperCase(),
                    avatarData: null,
                    password: pass || '',
                    privateMode: 'all',
                    blockedNicks: [],
                    isOnline: true,
                    lastSeen: Date.now()
                };
                
                USERS_DB.push(currentUser);
                localStorage.setItem('cetcety_users', JSON.stringify(USERS_DB));
            }

            // Oturumu kaydet
            localStorage.setItem('cetcety_active_user', JSON.stringify(currentUser));

            // Kanala ekle
            if (!channels.genel.onlineUsers) channels.genel.onlineUsers = [];
            if (!channels.genel.onlineUsers.includes(currentUser.name)) {
                channels.genel.onlineUsers.push(currentUser.name);
            }
            localStorage.setItem('cetcety_channels', JSON.stringify(channels));

            // UI'Ä± gÃ¶ster
            document.getElementById('loginOverlay').classList.add('hidden');
            document.getElementById('app').style.display = 'flex';

            // TÃ¼m modÃ¼llere kullanÄ±cÄ±yÄ± bildir
            if (window.MediaPlayer) window.MediaPlayer.setUser(currentUser);
            if (window.Chat) window.Chat.setUser(currentUser);
            if (window.Admin) window.Admin.setUser(currentUser);
            if (window.Ikon) window.Ikon.setUser(currentUser);

            // YouTube'u baÅŸlat
            if (window.MediaPlayer) window.MediaPlayer.init();

            // HoÅŸ geldin mesajÄ±
            addSystemMessage(`ðŸ‘‹ HoÅŸ geldin, ${currentUser.name}!`);

            // Rozetleri gÃ¼ncelle
            updateAllBadges();
        }

        // ========== YARDIMCI FONKSÄ°YONLAR ==========
        function saveChannels() {
            localStorage.setItem('cetcety_channels', JSON.stringify(channels));
            if (window.Ikon) window.Ikon.setChannels(channels);
        }

        function addSystemMessage(text) {
            if (window.Chat && window.Chat.addSystemMessage) {
                window.Chat.addSystemMessage(text);
            }
        }

        function sendToAdminChannel(text) {
            // Admin kanalÄ±na mesaj gÃ¶nder
            if (!channels.admin) return;
            
            const time = new Date().toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
            
            if (!window.CHANNEL_MESSAGES) window.CHANNEL_MESSAGES = {};
            if (!window.CHANNEL_MESSAGES.admin) window.CHANNEL_MESSAGES.admin = [];
            
            window.CHANNEL_MESSAGES.admin.push({
                sender: 'ðŸ”” SÄ°STEM',
                text: text,
                time: time,
                timestamp: Date.now(),
                isHtml: true
            });
            
            localStorage.setItem('cetcety_channel_messages', JSON.stringify(window.CHANNEL_MESSAGES));
        }

        function updateAllBadges() {
            document.getElementById('subscriptionBadge').textContent = currentUser.subscribedChannels?.length || 0;
            document.getElementById('channelCountBadge').textContent = Object.keys(channels).length;
            if (window.Chat) window.Chat.updateUnreadBadge();
        }

        // ========== KANAL Ä°ÅžLEMLERÄ° ==========
        function joinChannel(channelName) {
            if (!channels[channelName]) return;
            
            // Eski kanaldan ayrÄ±l
            if (channels[currentChannel] && channels[currentChannel].onlineUsers) {
                channels[currentChannel].onlineUsers = channels[currentChannel].onlineUsers.filter(u => u !== currentUser.name);
            }
            
            currentChannel = channelName;
            
            // Yeni kanala ekle
            if (!channels[channelName].onlineUsers) channels[channelName].onlineUsers = [];
            if (!channels[channelName].onlineUsers.includes(currentUser.name)) {
                channels[channelName].onlineUsers.push(currentUser.name);
            }
            
            saveChannels();
            
            // UI'Ä± gÃ¼ncelle
            document.getElementById('currentChannelName').textContent = channelName;
            document.getElementById('channelUserCount').textContent = channels[channelName].onlineUsers.length;
            
            const subCount = formatNumber(channels[channelName].subscribers || 1);
            document.getElementById('channelSubscribers').textContent = subCount;
            
            // ModÃ¼llere haber ver
            if (window.Chat) window.Chat.setChannel(channelName);
            if (window.MediaPlayer) window.MediaPlayer.setChannel(channelName);
            if (window.Admin) window.Admin.setChannel(channelName);
            
            // Abone butonunu gÃ¼ncelle
            updateSubscribeButton();
            
            addSystemMessage(`ðŸ“¢ #${channelName} kanalÄ±na katÄ±ldÄ±n!`);
        }

        function updateSubscribeButton() {
            const btn = document.getElementById('subscribeChannelBtn');
            if (currentUser.subscribedChannels?.includes(currentChannel)) {
                btn.innerHTML = '<i class="fas fa-check"></i> Abone Olundu';
                btn.classList.add('subscribed');
            } else {
                btn.innerHTML = '<i class="fas fa-plus"></i> Abone Ol';
                btn.classList.remove('subscribed');
            }
        }

        function toggleChannelSubscribe() {
            if (!currentUser.subscribedChannels) currentUser.subscribedChannels = [];
            
            if (currentUser.subscribedChannels.includes(currentChannel)) {
                currentUser.subscribedChannels = currentUser.subscribedChannels.filter(c => c !== currentChannel);
                if (channels[currentChannel]) {
                    channels[currentChannel].subscribers = Math.max(1, (channels[currentChannel].subscribers || 1) - 1);
                }
                addSystemMessage(`âŒ #${currentChannel} abonelikten Ã§Ä±kÄ±ldÄ±.`);
            } else {
                currentUser.subscribedChannels.push(currentChannel);
                if (channels[currentChannel]) {
                    channels[currentChannel].subscribers = (channels[currentChannel].subscribers || 1) + 1;
                }
                addSystemMessage(`âœ… #${currentChannel} abone olundu.`);
            }
            
            localStorage.setItem('cetcety_active_user', JSON.stringify(currentUser));
            saveChannels();
            updateSubscribeButton();
            if (window.Ikon) window.Ikon.updateSubscriptions();
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toString();
        }

        // ========== Ã‡IKIÅž ==========
        function logout() {
            if (currentUser) {
                if (channels[currentChannel] && channels[currentChannel].onlineUsers) {
                    channels[currentChannel].onlineUsers = channels[currentChannel].onlineUsers.filter(u => u !== currentUser.name);
                    saveChannels();
                }
            }
            localStorage.removeItem('cetcety_active_user');
            location.reload();
        }

        // ========== SAYFA YÃœKLENDÄ°ÄžÄ°NDE ==========
        window.addEventListener('load', function() {
            // KayÄ±tlÄ± kullanÄ±cÄ± var mÄ±?
            const savedUser = localStorage.getItem('cetcety_active_user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                channels = JSON.parse(localStorage.getItem('cetcety_channels')) || channels;
                USERS_DB = JSON.parse(localStorage.getItem('cetcety_users')) || [];
                
                document.getElementById('loginOverlay').classList.add('hidden');
                document.getElementById('app').style.display = 'flex';
                
                if (window.MediaPlayer) window.MediaPlayer.setUser(currentUser);
                if (window.Chat) window.Chat.setUser(currentUser);
                if (window.Admin) window.Admin.setUser(currentUser);
                if (window.Ikon) window.Ikon.setUser(currentUser);
                
                if (window.MediaPlayer) window.MediaPlayer.init();
                
                updateAllBadges();
                addSystemMessage(`ðŸ‘‹ Tekrar hoÅŸ geldin, ${currentUser.name}!`);
            }
        });

        // Enter ile mesaj gÃ¶nderme
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                if (document.activeElement && document.activeElement.id === 'messageInput') {
                    e.preventDefault();
                    if (window.Chat) window.Chat.sendMessage();
                } else if (document.activeElement && document.activeElement.id === 'privateMessageInput') {
                    e.preventDefault();
                    if (window.Chat) window.Chat.sendPrivate();
                }
            }
            
            if (e.key === 'Escape') {
                closeModal('youtubeModal');
                closeModal('avatarModal');
                closeModal('privateSpyModal');
                document.getElementById('leftPanel').classList.remove('active');
                document.getElementById('mediaPanel').classList.remove('active');
                if (window.Chat) window.Chat.closePrivate();
            }
        });
    </script>
</body>
</html>
