<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popbox Elite - Minimal Chat</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* TEMEL SIFIRLAMA */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #000000;
            color: #ffffff;
            height: 100vh;
            overflow: hidden;
            position: relative;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        body.day-mode {
            background: #ffffff;
            color: #000000;
        }

        .hidden {
            display: none !important;
        }

        /* YOUTUBE VİDEO PANELİ */
        .youtube-panel {
            position: fixed;
            top: 50%;
            right: 30px;
            transform: translateY(-50%);
            width: 420px;
            height: 680px;
            z-index: 10;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.5),
                inset 0 0 0 1px rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            background: rgba(0, 0, 0, 0.75);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .day-mode .youtube-panel {
            background: rgba(255, 255, 255, 0.75);
            border: 1px solid rgba(0, 0, 0, 0.15);
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.1),
                inset 0 0 0 1px rgba(0, 0, 0, 0.1);
        }

        .youtube-header {
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .day-mode .youtube-header {
            background: rgba(255, 255, 255, 0.5);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .youtube-tabs {
            display: flex;
            gap: 10px;
        }

        .youtube-tab {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .day-mode .youtube-tab {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: rgba(0, 0, 0, 0.8);
        }

        .youtube-tab.active {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.3);
            color: #ffffff;
        }

        .day-mode .youtube-tab.active {
            background: rgba(0, 0, 0, 0.25);
            border-color: rgba(0, 0, 0, 0.3);
            color: #000000;
        }

        .youtube-iframe {
            width: 100%;
            height: 380px;
            border: none;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .day-mode .youtube-iframe {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .youtube-overlay {
            position: absolute;
            top: 80px;
            left: 0;
            width: 100%;
            height: 380px;
            background: linear-gradient(135deg, 
                rgba(0, 0, 0, 0.3) 0%, 
                rgba(0, 0, 0, 0.1) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.5;
            transition: opacity 0.3s ease;
        }

        .youtube-overlay:hover {
            opacity: 0.8;
        }

        .youtube-title {
            padding: 20px;
            font-size: 16px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.95);
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }

        .day-mode .youtube-title {
            color: rgba(0, 0, 0, 0.95);
            background: rgba(255, 255, 255, 0.5);
        }

        .playlist-container {
            padding: 15px 5px 15px 15px;
            max-height: 200px;
            overflow-y: auto;
            /* Scrollbar düzenlemeleri */
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.3) rgba(255, 255, 255, 0.1);
        }

        .day-mode .playlist-container {
            scrollbar-color: rgba(0, 0, 0, 0.3) rgba(0, 0, 0, 0.1);
        }

        /* Özel scrollbar için */
        .playlist-container::-webkit-scrollbar {
            width: 6px;
        }

        .playlist-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .day-mode .playlist-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
        }

        .playlist-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }

        .day-mode .playlist-container::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.3);
        }

        .playlist-container::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.4);
        }

        .day-mode .playlist-container::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.4);
        }

        .playlist-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            margin-bottom: 10px;
            margin-right: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .day-mode .playlist-item {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .playlist-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .day-mode .playlist-item:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .playlist-item.active {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .day-mode .playlist-item.active {
            background: rgba(0, 0, 0, 0.15);
            border-color: rgba(0, 0, 0, 0.2);
        }

        .playlist-number {
            width: 24px;
            height: 24px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .day-mode .playlist-number {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
        }

        .playlist-title {
            flex: 1;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .day-mode .playlist-title {
            color: rgba(0, 0, 0, 0.9);
        }

        .playlist-duration {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            white-space: nowrap;
        }

        .day-mode .playlist-duration {
            color: rgba(0, 0, 0, 0.5);
        }

        /* YENİ: VİDEO KONTROL BUTONLARI - YouTube API ile entegre */
        .video-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .day-mode .video-controls {
            background: rgba(255, 255, 255, 0.4);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .control-btn {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            color: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .day-mode .control-btn {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: rgba(0, 0, 0, 0.9);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .day-mode .control-btn:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
        }

        .volume-slider {
            flex: 1;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            appearance: none;
            outline: none;
            cursor: pointer;
        }

        .volume-slider::-webkit-slider-thumb {
            appearance: none;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            border: 2px solid rgba(0, 0, 0, 0.5);
        }

        .day-mode .volume-slider {
            background: rgba(0, 0, 0, 0.1);
        }

        .day-mode .volume-slider::-webkit-slider-thumb {
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        /* CHAT MESAJLARI */
        .chat-messages {
            flex: 1;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 20px;
            height: calc(100vh - 80px); /* Input alanı için yer bırak */
        }

        .chat-messages-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 100%;
            overflow-y: auto;
            padding-right: 10px;
            scroll-behavior: smooth;
        }

        /* Chat container için scrollbar */
        .chat-messages-container::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .day-mode .chat-messages-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
        }

        .chat-messages-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }

        .day-mode .chat-messages-container::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
        }

        .chat-messages-container::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .day-mode .chat-messages-container::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        .chat-message {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 18px;
            padding: 12px 16px;
            max-width: 70%;
            animation: messageAppear 0.3s ease forwards;
            opacity: 0;
            transform: translateY(10px);
        }

        @keyframes messageAppear {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .day-mode .chat-message {
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        /* Sol tarafa giden mesajlar */
        .chat-message.left {
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.1);
        }

        .day-mode .chat-message.left {
            background: rgba(0, 0, 0, 0.1);
        }

        /* Sağ tarafa giden mesajlar (kullanıcı) */
        .chat-message.right {
            align-self: flex-end;
            background: rgba(255, 255, 255, 0.15);
        }

        .day-mode .chat-message.right {
            background: rgba(0, 0, 0, 0.15);
        }

        .message-user {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }

        .message-user-avatar {
            width: 24px;
            height: 24px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }

        .day-mode .message-user-avatar {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
        }

        .message-user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .message-user-name {
            font-size: 12px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        .day-mode .message-user-name {
            color: rgba(0, 0, 0, 0.9);
        }

        .message-content {
            font-size: 14px;
            line-height: 1.4;
            color: rgba(255, 255, 255, 0.95);
        }

        .day-mode .message-content {
            color: rgba(0, 0, 0, 0.95);
        }

        .message-time {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.4);
            text-align: right;
            margin-top: 4px;
        }

        .day-mode .message-time {
            color: rgba(0, 0, 0, 0.4);
        }

        /* PROFİL PANELİ */
        .profile-panel {
            position: fixed;
            left: 70px;
            top: 0;
            width: 350px;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 95;
            display: none;
            flex-direction: column;
            padding: 20px;
            transform: translateX(-100%);
            transition: transform 0.3s ease, opacity 0.3s ease;
            opacity: 0;
        }

        .profile-panel.active {
            transform: translateX(0);
            opacity: 1;
        }

        .day-mode .profile-panel {
            background: rgba(255, 255, 255, 0.8);
            border-right: 1px solid rgba(0, 0, 0, 0.1);
        }

        .profile-header {
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .day-mode .profile-header {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .profile-avatar-large {
            width: 70px;
            height: 70px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 600;
            border: 2px solid rgba(255, 255, 255, 0.3);
            overflow: hidden;
            position: relative;
            cursor: pointer;
        }

        .profile-avatar-large img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .day-mode .profile-avatar-large {
            background: rgba(0, 0, 0, 0.15);
            border: 2px solid rgba(0, 0, 0, 0.3);
        }

        .profile-info h3 {
            font-size: 20px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 5px;
        }

        .day-mode .profile-info h3 {
            color: rgba(0, 0, 0, 0.95);
        }

        .profile-role {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            padding: 4px 10px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border-radius: 20px;
            display: inline-block;
        }

        .day-mode .profile-role {
            color: rgba(0, 0, 0, 0.6);
            background: rgba(0, 0, 0, 0.1);
        }

        .profile-sections {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
        }

        .profile-section {
            margin-bottom: 25px;
        }

        .profile-section h4 {
            font-size: 14px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .day-mode .profile-section h4 {
            color: rgba(0, 0, 0, 0.8);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .profile-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .day-mode .profile-item {
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .profile-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .day-mode .profile-item:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .profile-item-icon {
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .day-mode .profile-item-icon {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
        }

        .profile-item-text {
            flex: 1;
        }

        .profile-item-title {
            font-size: 14px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 2px;
        }

        .day-mode .profile-item-title {
            color: rgba(0, 0, 0, 0.95);
        }

        .profile-item-desc {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
        }

        .day-mode .profile-item-desc {
            color: rgba(0, 0, 0, 0.5);
        }

        /* SOL BAR ALTINDAKİ PROFİL RESMİ */
        .profile-bottom-avatar {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            border: 2px solid rgba(255, 255, 255, 0.3);
            overflow: hidden;
            cursor: pointer;
            z-index: 101;
        }

        .profile-bottom-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .day-mode .profile-bottom-avatar {
            background: rgba(0, 0, 0, 0.15);
            border: 2px solid rgba(0, 0, 0, 0.3);
        }

        /* ÖZEL SOHBET PANELİ */
        .private-chat-panel {
            position: fixed;
            left: 370px;
            top: 0;
            right: 450px;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(25px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 85;
            display: none;
            flex-direction: column;
            transform: translateX(100%);
            transition: transform 0.4s ease;
        }

        .private-chat-panel.active {
            transform: translateX(0);
            display: flex;
        }

        .day-mode .private-chat-panel {
            background: rgba(255, 255, 255, 0.85);
            border-right: 1px solid rgba(0, 0, 0, 0.1);
            border-left: 1px solid rgba(0, 0, 0, 0.1);
        }

        .private-chat-header {
            padding: 20px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .day-mode .private-chat-header {
            background: rgba(255, 255, 255, 0.6);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .private-chat-user {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .private-chat-avatar {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            overflow: hidden;
        }

        .private-chat-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .day-mode .private-chat-avatar {
            background: rgba(0, 0, 0, 0.15);
            border: 2px solid rgba(0, 0, 0, 0.3);
        }

        .private-chat-actions {
            display: flex;
            gap: 8px;
        }

        .private-action-btn {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .private-action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .day-mode .private-action-btn {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: rgba(0, 0, 0, 0.9);
        }

        .day-mode .private-action-btn:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        .private-action-btn.report {
            background: rgba(255, 59, 48, 0.2);
            border-color: rgba(255, 59, 48, 0.3);
            color: #ff3b30;
        }

        .private-action-btn.block {
            background: rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.9);
        }

        .private-chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .private-message {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 18px;
            padding: 12px 16px;
            max-width: 70%;
            animation: messageAppear 0.3s ease forwards;
        }

        .day-mode .private-message {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .private-message.right {
            align-self: flex-end;
            background: rgba(255, 255, 255, 0.15);
        }

        .day-mode .private-message.right {
            background: rgba(0, 0, 0, 0.15);
        }

        .private-message.left {
            align-self: flex-start;
        }

        .private-message-image {
            max-width: 100%;
            max-height: 300px;
            border-radius: 12px;
            margin-top: 8px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .private-message-image:hover {
            transform: scale(1.02);
        }

        .private-message-video {
            max-width: 100%;
            max-height: 300px;
            border-radius: 12px;
            margin-top: 8px;
        }

        .private-input-area {
            padding: 20px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(15px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .day-mode .private-input-area {
            background: rgba(255, 255, 255, 0.6);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .private-input-wrapper {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .private-message-input {
            flex: 1;
            padding: 14px 18px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            color: #ffffff;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .day-mode .private-message-input {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: #000000;
        }

        .private-message-input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.15);
        }

        .day-mode .private-message-input:focus {
            border-color: rgba(0, 0, 0, 0.4);
            background: rgba(0, 0, 0, 0.15);
        }

        .private-attachment-btn {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            color: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .day-mode .private-attachment-btn {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: rgba(0, 0, 0, 0.9);
        }

        .private-attachment-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .day-mode .private-attachment-btn:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        .private-send-btn {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            color: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .day-mode .private-send-btn {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: rgba(0, 0, 0, 0.9);
        }

        .private-send-btn:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        .day-mode .private-send-btn:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        /* KIRMIZI YANMA NOKTASI */
        .notification-dot {
            position: absolute;
            top: -3px;
            right: -3px;
            width: 12px;
            height: 12px;
            background: #ff3b30;
            border-radius: 50%;
            border: 2px solid rgba(0, 0, 0, 0.8);
            animation: pulse 2s infinite;
            display: none;
        }

        .day-mode .notification-dot {
            border: 2px solid rgba(255, 255, 255, 0.8);
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* DİĞER STİLLER */
        .blur-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: opacity 1.5s ease;
        }

        .day-mode .blur-layer {
            background: rgba(255, 255, 255, 0.8);
        }

        .icon-menu {
            position: fixed;
            left: 0;
            top: 0;
            width: 70px;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
            z-index: 100;
        }

        .day-mode .icon-menu {
            background: rgba(255, 255, 255, 0.7);
            border-right: 1px solid rgba(0, 0, 0, 0.1);
        }

        .menu-icon {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            position: relative;
        }

        .day-mode .menu-icon {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: rgba(0, 0, 0, 0.9);
        }

        .menu-icon:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .day-mode .menu-icon:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        .menu-icon.active {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .day-mode .menu-icon.active {
            background: rgba(0, 0, 0, 0.25);
            border-color: rgba(0, 0, 0, 0.3);
        }

        .online-panel {
            position: fixed;
            left: 70px;
            top: 0;
            width: 300px;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(15px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 90;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }

        .day-mode .online-panel {
            background: rgba(255, 255, 255, 0.6);
            border-right: 1px solid rgba(0, 0, 0, 0.1);
        }

        .online-header {
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }

        .day-mode .online-header {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .online-header h3 {
            font-size: 18px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.95);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .day-mode .online-header h3 {
            color: rgba(0, 0, 0, 0.95);
        }

        .online-tabs {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .online-tab {
            flex: 1;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
        }

        .day-mode .online-tab {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: rgba(0, 0, 0, 0.8);
        }

        .online-tab.active {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.3);
            color: #ffffff;
        }

        .day-mode .online-tab.active {
            background: rgba(0, 0, 0, 0.25);
            border-color: rgba(0, 0, 0, 0.3);
            color: #000000;
        }

        .nick-list {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
        }

        /* Nick list için scrollbar */
        .nick-list::-webkit-scrollbar {
            width: 6px;
        }

        .nick-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .day-mode .nick-list::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
        }

        .nick-list::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }

        .day-mode .nick-list::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
        }

        .nick-list::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .day-mode .nick-list::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        .nick-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .nick-item.has-notification {
            background: rgba(255, 59, 48, 0.1);
            border-radius: 8px;
            padding: 12px;
            margin-right: 5px;
        }

        .nick-item:hover {
            background: rgba(255, 255, 255, 0.05);
            padding-left: 8px;
            border-radius: 8px;
        }

        .day-mode .nick-item:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .nick-avatar {
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            position: relative;
        }

        .nick-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .day-mode .nick-avatar {
            background: rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(0, 0, 0, 0.2);
        }

        .nick-info {
            flex: 1;
        }

        .nick-name {
            font-size: 14px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.95);
        }

        .day-mode .nick-name {
            color: rgba(0, 0, 0, 0.95);
        }

        .nick-status {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 2px;
        }

        .day-mode .nick-status {
            color: rgba(0, 0, 0, 0.5);
        }

        .online-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.6);
        }

        .day-mode .online-dot {
            background: rgba(0, 0, 0, 0.6);
        }

        .chat-panel {
            position: fixed;
            left: 370px;
            top: 0;
            right: 450px;
            height: 100%;
            background: transparent;
            z-index: 80;
            display: flex;
            flex-direction: column;
        }

        .message-input-area {
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(15px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            flex-shrink: 0;
        }

        .day-mode .message-input-area {
            background: rgba(255, 255, 255, 0.5);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .message-input-wrapper {
            display: flex;
            gap: 12px;
        }

        .message-input {
            flex: 1;
            padding: 14px 18px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            color: #ffffff;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .day-mode .message-input {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: #000000;
        }

        .message-input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.15);
        }

        .day-mode .message-input:focus {
            border-color: rgba(0, 0, 0, 0.4);
            background: rgba(0, 0, 0, 0.15);
        }

        .send-button {
            width: 50px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            color: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .day-mode .send-button {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: rgba(0, 0, 0, 0.9);
        }

        .send-button:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.1);
        }

        .day-mode .send-button:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        /* VİDEO EKLE BUTONU */
        .add-video-btn {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            color: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.3s ease;
            margin-left: 10px;
        }

        .day-mode .add-video-btn {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: rgba(0, 0, 0, 0.9);
        }

        .add-video-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        .day-mode .add-video-btn:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        .add-video-btn.admin-only {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.3);
            color: #3b82f6;
        }

        .day-mode .add-video-btn.admin-only {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.2);
            color: #1d4ed8;
        }

        /* GİRİŞ PANELİ */
        .login-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            width: 100%;
            max-width: 400px;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(25px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            overflow: hidden;
            transition: all 1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .login-container.login-success {
            transform: translate(-50%, -50%) scale(0.9);
            opacity: 0;
            pointer-events: none;
        }

        .login-header {
            padding: 40px 40px 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo-text {
            font-size: 32px;
            font-weight: 700;
            color: #ffffff;
        }

        .login-title {
            font-size: 18px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 8px;
        }

        .login-subtitle {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }

        .login-form {
            padding: 40px;
        }

        .input-group {
            margin-bottom: 24px;
        }

        .input-label {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            font-weight: 500;
        }

        .login-input {
            width: 100%;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #ffffff;
            font-size: 15px;
            transition: all 0.3s ease;
        }

        .login-input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.15);
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-btn:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        .login-footer {
            padding: 30px 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            background: rgba(255, 255, 255, 0.05);
        }

        .login-note {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
            line-height: 1.5;
        }

        .error-message {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.9);
            padding: 12px 16px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 13px;
            display: none;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(10px);
        }

        /* RESPONSIVE */
        @media (max-width: 1400px) {
            .youtube-panel {
                width: 380px;
                height: 650px;
            }
            
            .chat-panel {
                right: 410px;
            }
            
            .private-chat-panel {
                left: 370px;
                right: 410px;
            }
        }

        @media (max-width: 1200px) {
            .youtube-panel {
                display: none;
            }
            
            .chat-panel {
                right: 0;
            }
            
            .private-chat-panel {
                right: 0;
            }
        }

        @media (max-width: 992px) {
            .online-panel {
                display: none;
            }
            
            .icon-menu {
                width: 60px;
            }
            
            .chat-panel {
                left: 60px;
            }
            
            .private-chat-panel {
                left: 60px;
            }
        }

        @media (max-width: 768px) {
            .chat-panel {
                left: 0;
                padding-bottom: 80px;
            }
            
            .private-chat-panel {
                left: 0;
            }
            
            .icon-menu {
                bottom: 0;
                top: auto;
                width: 100%;
                height: 60px;
                flex-direction: row;
                justify-content: space-around;
                padding: 0 10px;
                border-right: none;
                border-top: 1px solid rgba(255, 255, 255, 0.1);
            }
            
            .menu-icon {
                width: 40px;
                height: 40px;
                margin-bottom: 0;
            }
            
            .profile-bottom-avatar {
                display: none;
            }
        }
    </style>
</head>
<body class="night-mode">
    <!-- YOUTUBE VİDEO PANELİ -->
    <div class="youtube-panel" id="youtubePanel">
        <div class="youtube-header">
            <div class="youtube-tabs">
                <div class="youtube-tab active" onclick="switchYouTubeTab('live')">Canlı Yayın</div>
                <div class="youtube-tab" onclick="switchYouTubeTab('playlist')">Playlist</div>
            </div>
            <div style="display: flex; gap: 8px;">
                <div class="add-video-btn admin-only" onclick="openVideoAddPanel()" title="Video Ekle (Admin)">
                    <i class="fas fa-plus"></i>
                </div>
                <div class="menu-icon" style="width: 40px; height: 40px; margin: 0;" onclick="togglePlaylist()" title="Playlist">
                    <i class="fas fa-list"></i>
                </div>
            </div>
        </div>
        
        <iframe 
            class="youtube-iframe"
            id="youtubeIframe"
            src="https://www.youtube.com/embed/jfKfPfyJRdk?autoplay=1&mute=0&controls=1&modestbranding=1&rel=0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen>
        </iframe>
        
        <div class="youtube-overlay">
            <i class="fas fa-play" style="font-size: 40px; color: rgba(255,255,255,0.8);"></i>
        </div>
        
        <div class="youtube-title" id="videoTitle">Popbox Radio • 24/7 Canlı Müzik</div>
        
        <!-- YENİ: YOUTUBE API İLE VİDEO KONTROLLERİ -->
        <div class="video-controls">
            <button class="control-btn" onclick="playVideo()" id="playBtn" title="Oynat/Duraklat">
                <i class="fas fa-play" id="playIcon"></i>
            </button>
            <button class="control-btn" onclick="muteVideo()" id="muteBtn" title="Ses Aç/Kapa">
                <i class="fas fa-volume-up" id="volumeIcon"></i>
            </button>
            <div class="volume-control">
                <i class="fas fa-volume-down" style="font-size: 14px;"></i>
                <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50" oninput="setVolume(this.value)">
                <i class="fas fa-volume-up" style="font-size: 14px;"></i>
            </div>
            <button class="control-btn" onclick="skipBackward()" title="10 saniye geri">
                <i class="fas fa-backward"></i>
            </button>
            <button class="control-btn" onclick="skipForward()" title="10 saniye ileri">
                <i class="fas fa-forward"></i>
            </button>
        </div>
        
        <div class="playlist-container" id="playlistContainer" style="display: none;">
            <!-- Playlist öğeleri buraya yüklenecek -->
        </div>
    </div>

    <!-- PROFİL PANELİ -->
    <div class="profile-panel" id="profilePanel">
        <div class="profile-header">
            <div class="profile-avatar-large" id="profileAvatarLarge" onclick="uploadProfileImage()">
                <span id="profileAvatarText">M</span>
            </div>
            <div class="profile-info">
                <h3 id="profileName">mateky</h3>
                <div class="profile-role" id="profileRole">owner</div>
            </div>
        </div>
        
        <div class="profile-sections">
            <div class="profile-section">
                <h4>Profil Ayarları</h4>
                <div class="profile-item" onclick="uploadProfileImage()">
                    <div class="profile-item-icon">
                        <i class="fas fa-camera"></i>
                    </div>
                    <div class="profile-item-text">
                        <div class="profile-item-title">Profil Resmi Yükle</div>
                        <div class="profile-item-desc">Resim dosyası yükleyin (JPG, PNG)</div>
                    </div>
                </div>
                
                <div class="profile-item" onclick="changePassword()" id="passwordChangeItem">
                    <div class="profile-item-icon">
                        <i class="fas fa-key"></i>
                    </div>
                    <div class="profile-item-text">
                        <div class="profile-item-title">Şifre Değiştir</div>
                        <div class="profile-item-desc">Güvenliğiniz için şifrenizi güncelleyin</div>
                    </div>
                </div>
            </div>
            
            <div class="profile-section">
                <h4>Görünüm</h4>
                <div class="profile-item" onclick="toggleTheme()">
                    <div class="profile-item-icon">
                        <i class="fas fa-moon"></i>
                    </div>
                    <div class="profile-item-text">
                        <div class="profile-item-title" id="themeTitle">Gece Modu</div>
                        <div class="profile-item-desc">Tema değiştir: Gece/Gündüz</div>
                    </div>
                </div>
                
                <div class="profile-item" onclick="toggleSleepMode()">
                    <div class="profile-item-icon">
                        <i class="fas fa-bed"></i>
                    </div>
                    <div class="profile-item-text">
                        <div class="profile-item-title" id="sleepModeTitle">Uyku Modu: Kapalı</div>
                        <div class="profile-item-desc">Otomatik kapanma ayarları</div>
                    </div>
                </div>
            </div>
            
            <div class="profile-section">
                <h4>Hesap İşlemleri</h4>
                <div class="profile-item" onclick="openRegistrationPanel()" id="registrationItem">
                    <div class="profile-item-icon">
                        <i class="fas fa-user-plus"></i>
                    </div>
                    <div class="profile-item-text">
                        <div class="profile-item-title" id="registrationTitle">Hesap Kaydı</div>
                        <div class="profile-item-desc">Hesabınızı kaydedin veya güncelleyin</div>
                    </div>
                </div>
                
                <div class="profile-item" onclick="handleLogout()">
                    <div class="profile-item-icon">
                        <i class="fas fa-sign-out-alt"></i>
                    </div>
                    <div class="profile-item-text">
                        <div class="profile-item-title">Çıkış Yap</div>
                        <div class="profile-item-desc">Güvenli çıkış</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÖZEL SOHBET PANELİ -->
    <div class="private-chat-panel" id="privateChatPanel">
        <div class="private-chat-header">
            <div class="private-chat-user">
                <div class="private-chat-avatar" id="privateChatAvatar">
                    <span id="privateChatAvatarText">A</span>
                </div>
                <div>
                    <div id="privateChatUserName" style="font-weight: 600; font-size: 16px;">Ahmet</div>
                    <div id="privateChatUserStatus" style="font-size: 12px; color: rgba(255,255,255,0.6);">Çevrimiçi</div>
                </div>
            </div>
            <div class="private-chat-actions">
                <div class="private-action-btn report" onclick="reportUser()">
                    <i class="fas fa-flag"></i> Şikayet
                </div>
                <div class="private-action-btn block" onclick="blockUser()" id="blockBtn">
                    <i class="fas fa-ban"></i> Engelle
                </div>
                <div class="private-action-btn" onclick="closePrivateChat()">
                    <i class="fas fa-times"></i> Kapat
                </div>
            </div>
        </div>
        
        <div class="private-chat-messages" id="privateChatMessages">
            <!-- Özel mesajlar buraya yüklenecek -->
        </div>
        
        <div class="private-input-area">
            <div class="private-input-wrapper">
                <input type="file" id="privateFileInput" accept="image/*,video/*" style="display: none;">
                <button class="private-attachment-btn" onclick="openPrivateFilePicker()" title="Dosya Ekle">
                    <i class="fas fa-paperclip"></i>
                </button>
                <input type="text" id="privateMessageInput" class="private-message-input" placeholder="Özel mesajınızı yazın...">
                <button class="private-send-btn" onclick="sendPrivateMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- BULANIK KATMAN -->
    <div class="blur-layer" id="blurLayer"></div>

    <!-- SOL BAR - ICON MENU -->
    <div class="icon-menu">
        <div class="menu-icon active" onclick="togglePanel('online')" title="Online Listesi" id="onlineListBtn">
            <i class="fas fa-users"></i>
        </div>
        <div class="menu-icon" onclick="toggleProfilePanel()" title="Profil" id="profileIconBtn">
            <i class="fas fa-user-circle"></i>
        </div>
        <div class="menu-icon" onclick="toggleTheme()" title="Tema Değiştir" id="themeToggle">
            <i class="fas fa-moon"></i>
        </div>
        <div class="menu-icon" onclick="openSettings()" title="Ayarlar">
            <i class="fas fa-cog"></i>
        </div>
        <div class="menu-icon" onclick="openIRC()" title="IRC Komutları">
            <i class="fas fa-terminal"></i>
        </div>
        <div class="menu-icon" onclick="handleLogout()" title="Çıkış Yap">
            <i class="fas fa-sign-out-alt"></i>
        </div>
        
        <!-- SOL BAR ALTINDAKİ PROFİL RESMİ -->
        <div class="profile-bottom-avatar" id="bottomProfileAvatar" onclick="toggleProfilePanel()">
            <span id="bottomAvatarText">M</span>
        </div>
    </div>

    <!-- SOL PANEL - ONLINE LİSTESİ -->
    <div class="online-panel" id="onlinePanel">
        <div class="online-header">
            <h3><i class="fas fa-users"></i> Online Listeler</h3>
            <div class="online-tabs">
                <div class="online-tab active" onclick="switchTab('online')">Çevrimiçi (5)</div>
                <div class="online-tab" onclick="switchTab('chatting')">Sohbette (3)</div>
            </div>
        </div>
        
        <div class="nick-list" id="onlineList">
            <!-- Online kullanıcılar buraya yüklenecek -->
        </div>
    </div>

    <!-- ORTA PANEL - GENEL SOHBET -->
    <div class="chat-panel">
        <div class="chat-messages" id="chatMessages">
            <div class="chat-messages-container" id="chatContainer">
                <!-- Mesajlar buraya yüklenecek -->
            </div>
        </div>
        
        <div class="message-input-area">
            <div class="message-input-wrapper">
                <input type="text" id="messageInput" class="message-input" placeholder="Mesajınızı yazın...">
                <button class="send-button" onclick="sendMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- GİRİŞ PANELİ -->
    <div class="login-container" id="loginContainer">
        <div class="login-header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-comment-dots"></i>
                </div>
                <div class="logo-text">Popbox Elite</div>
            </div>
            <h2 class="login-title">Minimalist Chat Platform</h2>
            <p class="login-subtitle">Siyah & Beyaz • Şeffaf • Premium</p>
        </div>

        <div class="login-form">
            <div id="errorMessage" class="error-message">
                <i class="fas fa-exclamation-circle"></i>
                <span id="errorText"></span>
            </div>

            <div class="input-group">
                <div class="input-label">
                    <i class="fas fa-user"></i>
                    Kullanıcı Adı
                </div>
                <input type="text" 
                       id="nickInput" 
                       class="login-input" 
                       placeholder="Kullanıcı adınızı girin"
                       autofocus>
            </div>

            <div class="input-group">
                <div class="input-label">
                    <i class="fas fa-lock"></i>
                    Şifre
                </div>
                <input type="password" 
                       id="passInput" 
                       class="login-input" 
                       placeholder="Şifrenizi girin (opsiyonel)">
            </div>

            <button class="login-btn" onclick="handleLogin()" id="loginBtn">
                <span id="btnText">Giriş Yap</span>
            </button>
        </div>

        <div class="login-footer">
            <div class="login-note">
                <p><strong>Demo Kullanıcılar:</strong></p>
                <p><strong>mateky</strong> / <strong>kumsal07@</strong></p>
                <p><strong>MATE</strong> / <strong>secure123</strong></p>
                <p style="margin-top: 10px; font-size: 12px; color: rgba(255,255,255,0.4);">
                    Not: Kayıtlı olmayan nickler için şifre gerekmez
                </p>
            </div>
        </div>
    </div>

    <script>
        // ==================== DEĞİŞKENLER ====================
        let currentUser = null;
        let isDayMode = false;
        let isSleepMode = false;
        let currentTab = 'online';
        let currentYouTubeTab = 'live';
        let onlineUsers = [];
        let chatMessages = [];
        let privateMessages = {};
        let messageInterval;
        let userUpdateInterval;
        let currentVideoIndex = 0;
        let isVideoMuted = false;
        let isVideoPlaying = true;
        let currentVolume = 50;
        let currentPrivateChatUser = null;
        let blockedUsers = [];
        let userNotifications = {};
        let youTubePlayer = null;
        let youtubePlayerReady = false;

        // Türkçe Radyo ve Müzik YouTube Kanalları
        const youtubeVideos = [
            {
                id: "jfKfPfyJRdk",
                title: "Popbox Radio • 24/7 Canlı Müzik",
                type: "live"
            },
            {
                id: "7NOSDKb0HlU",
                title: "TRT FM • Canlı Yayın",
                type: "radio"
            },
            {
                id: "0vq4KtIcYp8",
                title: "Kral Pop • Canlı Radyo",
                type: "radio"
            },
            {
                id: "UCS5IYCU1Y7YcL7jRzrKofFg",
                title: "Power Türk • Canlı Müzik",
                type: "live"
            },
            {
                id: "qK7N4x-3Kc8",
                title: "Slow Türk • Akustik Müzik",
                type: "radio"
            },
            {
                id: "o1tj2zJ2Wvg",
                title: "NTV Radyo • Haber & Müzik",
                type: "radio"
            },
            {
                id: "KpG8pZRz3GY",
                title: "Alem FM • Pop Müzik",
                type: "radio"
            },
            {
                id: "zClcLQ5pXWg",
                title: "Radyo D • En İyi Türkçe Şarkılar",
                type: "playlist"
            },
            {
                id: "7NNbR3w6G-I",
                title: "Best FM • Hit Müzik",
                type: "radio"
            },
            {
                id: "qJ_Mu6q4TPw",
                title: "Show Radyo • Türkçe Pop",
                type: "radio"
            }
        ];

        // YENİ: AI Botlar için sohbet verileri
        const aiBots = [
            { name: "YapayZekaPro", avatar: "Y", role: "ai", personality: "Profesyonel", interests: ["teknoloji", "bilim", "yazılım"] },
            { name: "ChatGPTurk", avatar: "C", role: "ai", personality: "Yardımsever", interests: ["eğitim", "öğrenme", "soru-cevap"] },
            { name: "DeepThinker", avatar: "D", role: "ai", personality: "Felsefi", interests: ["felsefe", "psikoloji", "sanat"] },
            { name: "MusicBotAI", avatar: "M", role: "ai", personality: "Müzikal", interests: ["müzik", "sanat", "kültür"] },
            { name: "TechGuru", avatar: "T", role: "ai", personality: "Teknik", interests: ["programlama", "donanım", "inovasyon"] },
            { name: "SocialAI", avatar: "S", role: "ai", personality: "Sosyal", interests: ["iletişim", "ilişkiler", "toplum"] },
            { name: "GamerBot", avatar: "G", role: "ai", personality: "Oyunsever", interests: ["oyunlar", "e-spor", "teknoloji"] },
            { name: "ScienceAI", avatar: "S", role: "ai", personality: "Bilimsel", interests: ["fizik", "matematik", "biyoloji"] },
            { name: "ArtBot", avatar: "A", role: "ai", personality: "Yaratıcı", interests: ["sanat", "tasarım", "edebiyat"] },
            { name: "HealthAI", avatar: "H", role: "ai", personality: "Sağlıklı", interests: ["sağlık", "spor", "beslenme"] }
        ];

        const aiConversationTopics = [
            // Teknoloji
            "Yapay zeka gelecekte insanlığı nasıl etkileyecek?",
            "Hangi programlama dilini öğrenmek 2024'te daha avantajlı?",
            "Metaverse gerçekten hayatımızın bir parçası olacak mı?",
            "Blockchain teknolojisi sadece kripto para için mi kullanılır?",
            "5G teknolojisi bize ne gibi yenilikler getirecek?",
            
            // Eğitim
            "Online eğitim geleneksel eğitimin yerini alabilir mi?",
            "Yapay zeka destekli öğrenme nasıl daha efektif olur?",
            "Geleceğin meslekleri neler olacak?",
            "Dil öğrenmek için en etkili yöntemler neler?",
            "Çocuklara kodlama öğretmek ne zaman başlamalı?",
            
            // Sanat & Kültür
            "Yapay zeka sanat eseri üretebilir mi?",
            "Müzik dinleme alışkanlıklarımız nasıl değişiyor?",
            "Dijital sanat geleneksel sanatın yerini alır mı?",
            "Türk dizilerinin uluslararası başarısının sırrı ne?",
            "Kitap okuma alışkanlığı neden azalıyor?",
            
            // Sosyal & Güncel
            "Sosyal medya ilişkilerimizi nasıl etkiliyor?",
            "Uzaktan çalışma kalıcı hale gelecek mi?",
            "İklim değişikliği ile nasıl mücadele edebiliriz?",
            "Dijital detoks gerçekten gerekli mi?",
            "Gelecekte şehirler nasıl olacak?"
        ];

        const aiResponses = {
            "Profesyonel": [
                "Bu konuda yapılan araştırmalar gösteriyor ki...",
                "Teknolojik gelişmeler ışığında...",
                "Verilere dayanarak söyleyebilirim ki...",
                "Uzman görüşlerine göre...",
                "Bu durumun analizini şu şekilde yapabiliriz..."
            ],
            "Yardımsever": [
                "Merak ettiğin konuda sana yardımcı olabilirim...",
                "Bu soru çok güzel, açıklamaya çalışayım...",
                "Anladığım kadarıyla...",
                "Bu konuda sana rehberlik edebilirim...",
                "Daha detaylı bilgi vermemi ister misin?"
            ],
            "Felsefi": [
                "Aslında bu soru varoluşsal bir boyuta sahip...",
                "Hayatın anlamı perspektifinden bakarsak...",
                "Bu, insan doğasının temel bir sorusu...",
                "Felsefi açıdan değerlendirdiğimizde...",
                "Bu konu bizi derin düşüncelere götürüyor..."
            ],
            "Müzikal": [
                "Müzik açısından baktığımızda...",
                "Bu konuyu bir beste gibi düşünebiliriz...",
                "Ritim ve harmoniden bahsedersek...",
                "Müzik evrensel bir dil olarak...",
                "Melodik bir yaklaşımla..."
            ],
            "Teknik": [
                "Teknik detaylara inecek olursak...",
                "Algoritmik olarak bakarsak...",
                "Sistem mimarisi perspektifinden...",
                "Bu, optimizasyon gerektiren bir konu...",
                "Veri yapıları açısından değerlendirirsek..."
            ]
        };

        // ==================== SAYFA YÜKLENDİĞİNDE ====================
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('nickInput').focus();
            document.getElementById('blurLayer').style.opacity = '0.8';
            
            // YouTube API yükle
            loadYouTubeAPI();
            
            // Enter tuşu ile giriş
            document.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const activeElement = document.activeElement;
                    if (activeElement.id === 'nickInput' || activeElement.id === 'passInput') {
                        handleLogin();
                    } else if (activeElement.id === 'messageInput') {
                        sendMessage();
                    } else if (activeElement.id === 'privateMessageInput') {
                        sendPrivateMessage();
                    }
                }
            });
            
            // ESC tuşu ile özel sohbeti kapat
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closePrivateChat();
                }
            });
            
            // Playlist'i yükle
            loadPlaylist();
        });

        // ==================== YENİ: YOUTUBE API ENTEGRASYONU ====================
        function loadYouTubeAPI() {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        }

        window.onYouTubeIframeAPIReady = function() {
            const iframe = document.getElementById('youtubeIframe');
            youTubePlayer = new YT.Player('youtubeIframe', {
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        };

        function onPlayerReady(event) {
            youtubePlayerReady = true;
            console.log("YouTube player hazır");
            
            // Başlangıç ses seviyesini ayarla
            youTubePlayer.setVolume(currentVolume);
            document.getElementById('volumeSlider').value = currentVolume;
            
            // Oynatma durumunu güncelle
            updatePlayButton();
        }

        function onPlayerStateChange(event) {
            if (event.data == YT.PlayerState.PLAYING) {
                isVideoPlaying = true;
                document.getElementById('playIcon').className = 'fas fa-pause';
            } else if (event.data == YT.PlayerState.PAUSED) {
                isVideoPlaying = false;
                document.getElementById('playIcon').className = 'fas fa-play';
            }
        }

        function playVideo(index = null) {
            if (!youtubePlayerReady) return;
            
            if (index !== null) {
                // Yeni video oynat
                const video = youtubeVideos[index];
                youTubePlayer.loadVideoById(video.id);
                document.getElementById('videoTitle').textContent = video.title;
                
                // Aktif playlist öğesini güncelle
                const playlistItems = document.querySelectorAll('.playlist-item');
                playlistItems.forEach(item => item.classList.remove('active'));
                playlistItems[index].classList.add('active');
                
                currentVideoIndex = index;
            } else {
                // Oynat/Duraklat
                if (isVideoPlaying) {
                    youTubePlayer.pauseVideo();
                } else {
                    youTubePlayer.playVideo();
                }
                isVideoPlaying = !isVideoPlaying;
                updatePlayButton();
            }
        }

        function muteVideo() {
            if (!youtubePlayerReady) return;
            
            if (isVideoMuted) {
                youTubePlayer.unMute();
                document.getElementById('volumeIcon').className = 'fas fa-volume-up';
                isVideoMuted = false;
            } else {
                youTubePlayer.mute();
                document.getElementById('volumeIcon').className = 'fas fa-volume-mute';
                isVideoMuted = true;
            }
        }

        function setVolume(value) {
            if (!youtubePlayerReady) return;
            
            currentVolume = value;
            youTubePlayer.setVolume(value);
            
            // Ses simgesini güncelle
            if (value == 0) {
                document.getElementById('volumeIcon').className = 'fas fa-volume-mute';
            } else if (value < 50) {
                document.getElementById('volumeIcon').className = 'fas fa-volume-down';
            } else {
                document.getElementById('volumeIcon').className = 'fas fa-volume-up';
            }
        }

        function skipBackward() {
            if (!youtubePlayerReady) return;
            const currentTime = youTubePlayer.getCurrentTime();
            youTubePlayer.seekTo(currentTime - 10, true);
        }

        function skipForward() {
            if (!youtubePlayerReady) return;
            const currentTime = youTubePlayer.getCurrentTime();
            youTubePlayer.seekTo(currentTime + 10, true);
        }

        function updatePlayButton() {
            const playIcon = document.getElementById('playIcon');
            playIcon.className = isVideoPlaying ? 'fas fa-pause' : 'fas fa-play';
        }

        // ==================== YOUTUBE SİSTEMİ ====================
        function loadPlaylist() {
            const playlistContainer = document.getElementById('playlistContainer');
            let html = '';
            
            youtubeVideos.forEach((video, index) => {
                const duration = Math.floor(Math.random() * 4) + 2; // 2-5 saat
                html += `
                    <div class="playlist-item ${index === 0 ? 'active' : ''}" onclick="playVideo(${index})">
                        <div class="playlist-number">${index + 1}</div>
                        <div class="playlist-title">${video.title}</div>
                        <div class="playlist-duration">${duration}:00</div>
                    </div>
                `;
            });
            
            playlistContainer.innerHTML = html;
        }

        function switchYouTubeTab(tab) {
            currentYouTubeTab = tab;
            const tabs = document.querySelectorAll('.youtube-tab');
            const playlistContainer = document.getElementById('playlistContainer');
            
            tabs.forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            if (tab === 'live') {
                playlistContainer.style.display = 'none';
                // Rastgele bir canlı yayın seç
                const liveVideos = youtubeVideos.filter(v => v.type === 'live' || v.type === 'radio');
                const randomIndex = Math.floor(Math.random() * liveVideos.length);
                const randomVideo = liveVideos[randomIndex];
                
                playVideo(youtubeVideos.findIndex(v => v.id === randomVideo.id));
            } else {
                playlistContainer.style.display = 'block';
            }
        }

        function togglePlaylist() {
            const playlistContainer = document.getElementById('playlistContainer');
            playlistContainer.style.display = playlistContainer.style.display === 'none' ? 'block' : 'none';
        }

        function openVideoAddPanel() {
            if (currentUser && (currentUser.role === 'admin' || currentUser.role === 'owner')) {
                const videoUrl = prompt('YouTube Video URL veya ID girin:');
                if (videoUrl) {
                    let videoId = videoUrl;
                    
                    if (videoUrl.includes('youtube.com/watch?v=')) {
                        videoId = videoUrl.split('v=')[1];
                        const ampersandPosition = videoId.indexOf('&');
                        if (ampersandPosition !== -1) {
                            videoId = videoId.substring(0, ampersandPosition);
                        }
                    } else if (videoUrl.includes('youtu.be/')) {
                        videoId = videoUrl.split('youtu.be/')[1];
                    }
                    
                    youtubeVideos.push({
                        id: videoId,
                        title: "Yeni Eklenen Video",
                        type: "playlist"
                    });
                    
                    loadPlaylist();
                    alert('Video başarıyla eklendi! Playlist sekmesinden görebilirsiniz.');
                }
            } else {
                alert('Bu özellik sadece admin ve owner yetkilerine sahip kullanıcılar içindir.');
            }
        }

        // ==================== PROFİL RESMİ YÜKLEME ====================
        function uploadProfileImage() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                if (!file.type.match('image.*')) {
                    alert('Lütfen sadece resim dosyası seçin!');
                    return;
                }
                
                if (file.size > 5 * 1024 * 1024) { // 5MB limit
                    alert('Resim boyutu 5MB\'dan küçük olmalıdır!');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(event) {
                    const imgData = event.target.result;
                    
                    currentUser.avatarImage = imgData;
                    
                    const profileAvatarLarge = document.getElementById('profileAvatarLarge');
                    const profileAvatarText = document.getElementById('profileAvatarText');
                    profileAvatarText.style.display = 'none';
                    
                    if (profileAvatarLarge.querySelector('img')) {
                        profileAvatarLarge.querySelector('img').src = imgData;
                    } else {
                        const img = document.createElement('img');
                        img.src = imgData;
                        img.alt = currentUser.name;
                        profileAvatarLarge.appendChild(img);
                    }
                    
                    const bottomAvatar = document.getElementById('bottomProfileAvatar');
                    const bottomAvatarText = document.getElementById('bottomAvatarText');
                    bottomAvatarText.style.display = 'none';
                    
                    if (bottomAvatar.querySelector('img')) {
                        bottomAvatar.querySelector('img').src = imgData;
                    } else {
                        const img = document.createElement('img');
                        img.src = imgData;
                        img.alt = currentUser.name;
                        bottomAvatar.appendChild(img);
                    }
                    
                    const user = onlineUsers.find(u => u.name === currentUser.name);
                    if (user) {
                        user.avatarImage = imgData;
                        loadOnlineList();
                    }
                    
                    alert('Profil resminiz başarıyla güncellendi!');
                };
                
                reader.readAsDataURL(file);
            };
            
            input.click();
        }

        // ==================== ÖZEL SOHBET SİSTEMİ ====================
        function openPrivateChat(userName) {
            if (!userName || userName === currentUser.name) return;
            
            if (blockedUsers.includes(userName)) {
                alert('Bu kullanıcıyı engellediniz! Engeli kaldırmak için profil ayarlarına gidin.');
                return;
            }
            
            const user = onlineUsers.find(u => u.name === userName);
            if (!user) return;
            
            currentPrivateChatUser = user;
            
            const privateChatPanel = document.getElementById('privateChatPanel');
            privateChatPanel.classList.add('active');
            
            document.getElementById('privateChatUserName').textContent = user.name;
            document.getElementById('privateChatUserStatus').textContent = user.status === 'online' ? 'Çevrimiçi' : 'Çevrimdışı';
            
            const privateChatAvatar = document.getElementById('privateChatAvatar');
            const privateChatAvatarText = document.getElementById('privateChatAvatarText');
            
            if (user.avatarImage) {
                privateChatAvatarText.style.display = 'none';
                if (privateChatAvatar.querySelector('img')) {
                    privateChatAvatar.querySelector('img').src = user.avatarImage;
                } else {
                    const img = document.createElement('img');
                    img.src = user.avatarImage;
                    img.alt = user.name;
                    privateChatAvatar.appendChild(img);
                }
            } else {
                privateChatAvatarText.textContent = user.avatar;
                privateChatAvatarText.style.display = 'flex';
                if (privateChatAvatar.querySelector('img')) {
                    privateChatAvatar.querySelector('img').remove();
                }
            }
            
            loadPrivateMessages(userName);
            clearNotification(userName);
        }

        function loadPrivateMessages(userName) {
            const privateChatMessages = document.getElementById('privateChatMessages');
            
            if (!privateMessages[userName]) {
                privateMessages[userName] = [];
            }
            
            let html = '';
            privateMessages[userName].forEach(msg => {
                const isCurrentUser = msg.sender === currentUser.name;
                
                html += `
                    <div class="private-message ${isCurrentUser ? 'right' : 'left'}">
                        <div class="message-user">
                            <div class="message-user-avatar">
                                ${msg.avatarImage ? 
                                    `<img src="${msg.avatarImage}" alt="${msg.sender}">` : 
                                    msg.avatar}
                            </div>
                            <div class="message-user-name">${msg.sender}</div>
                        </div>
                        ${msg.image ? 
                            `<img src="${msg.image}" class="private-message-image" onclick="openImage('${msg.image}')">` : 
                            msg.video ?
                            `<video controls class="private-message-video">
                                <source src="${msg.video}" type="video/mp4">
                            </video>` :
                            `<div class="message-content">${msg.message}</div>`
                        }
                        <div class="message-time">${msg.time}</div>
                    </div>
                `;
            });
            
            privateChatMessages.innerHTML = html;
            
            setTimeout(() => {
                privateChatMessages.scrollTop = privateChatMessages.scrollHeight;
            }, 100);
        }

        function sendPrivateMessage() {
            if (!currentPrivateChatUser) return;
            
            const input = document.getElementById('privateMessageInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            const now = new Date();
            const timeStr = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
            
            if (!privateMessages[currentPrivateChatUser.name]) {
                privateMessages[currentPrivateChatUser.name] = [];
            }
            
            privateMessages[currentPrivateChatUser.name].push({
                sender: currentUser.name,
                avatar: currentUser.avatar,
                avatarImage: currentUser.avatarImage,
                message: text,
                time: timeStr
            });
            
            loadPrivateMessages(currentPrivateChatUser.name);
            input.value = '';
            
            simulatePrivateMessageResponse(currentPrivateChatUser.name);
        }

        function openPrivateFilePicker() {
            document.getElementById('privateFileInput').click();
        }

        document.getElementById('privateFileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                const fileData = event.target.result;
                const isImage = file.type.startsWith('image/');
                const isVideo = file.type.startsWith('video/');
                
                if (!isImage && !isVideo) {
                    alert('Sadece resim veya video dosyaları gönderebilirsiniz!');
                    return;
                }
                
                if (file.size > 10 * 1024 * 1024) { // 10MB limit
                    alert('Dosya boyutu 10MB\'dan küçük olmalıdır!');
                    return;
                }
                
                const now = new Date();
                const timeStr = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
                
                if (!privateMessages[currentPrivateChatUser.name]) {
                    privateMessages[currentPrivateChatUser.name] = [];
                }
                
                privateMessages[currentPrivateChatUser.name].push({
                    sender: currentUser.name,
                    avatar: currentUser.avatar,
                    avatarImage: currentUser.avatarImage,
                    [isImage ? 'image' : 'video']: fileData,
                    time: timeStr
                });
                
                loadPrivateMessages(currentPrivateChatUser.name);
                document.getElementById('privateFileInput').value = '';
            };
            
            reader.readAsDataURL(file);
        });

        function simulatePrivateMessageResponse(userName) {
            setTimeout(() => {
                if (!currentPrivateChatUser || currentPrivateChatUser.name !== userName) {
                    if (!userNotifications[userName]) {
                        userNotifications[userName] = 0;
                    }
                    userNotifications[userName]++;
                    
                    loadOnlineList();
                    return;
                }
                
                const responses = [
                    "Teşekkürler!",
                    "Anladım.",
                    "Harika!",
                    "Tamam.",
                    "Güzel mesaj!"
                ];
                
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                const now = new Date();
                const timeStr = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
                
                if (!privateMessages[userName]) {
                    privateMessages[userName] = [];
                }
                
                privateMessages[userName].push({
                    sender: userName,
                    avatar: currentPrivateChatUser.avatar,
                    avatarImage: currentPrivateChatUser.avatarImage,
                    message: randomResponse,
                    time: timeStr
                });
                
                loadPrivateMessages(userName);
            }, 2000 + Math.random() * 3000);
        }

        function openImage(imageSrc) {
            const overlay = document.createElement('div');
            overlay.style.position = 'fixed';
            overlay.style.top = '0';
            overlay.style.left = '0';
            overlay.style.width = '100%';
            overlay.style.height = '100%';
            overlay.style.background = 'rgba(0,0,0,0.9)';
            overlay.style.zIndex = '9999';
            overlay.style.display = 'flex';
            overlay.style.alignItems = 'center';
            overlay.style.justifyContent = 'center';
            overlay.style.backdropFilter = 'blur(10px)';
            
            const img = document.createElement('img');
            img.src = imageSrc;
            img.style.maxWidth = '90%';
            img.style.maxHeight = '90%';
            img.style.borderRadius = '10px';
            
            overlay.appendChild(img);
            document.body.appendChild(overlay);
            
            overlay.onclick = function() {
                document.body.removeChild(overlay);
            };
        }

        function closePrivateChat() {
            const privateChatPanel = document.getElementById('privateChatPanel');
            privateChatPanel.classList.remove('active');
            currentPrivateChatUser = null;
            
            document.getElementById('privateMessageInput').value = '';
        }

        function reportUser() {
            if (!currentPrivateChatUser) return;
            
            const reason = prompt(`${currentPrivateChatUser.name} kullanıcısını şikayet etmek için sebep girin:`);
            if (reason) {
                alert('Şikayetiniz alındı. Yöneticiler en kısa sürede inceleyecektir.');
            }
        }

        function blockUser() {
            if (!currentPrivateChatUser) return;
            
            if (confirm(`${currentPrivateChatUser.name} kullanıcısını 24 saat boyunca engellemek istediğinize emin misiniz?\n\nEngellenen kullanıcı:\n• Size mesaj gönderemez\n• Sizi online listede göremez\n• Genel sohbet mesajlarını göremez`)) {
                blockedUsers.push(currentPrivateChatUser.name);
                
                const blockBtn = document.getElementById('blockBtn');
                blockBtn.innerHTML = '<i class="fas fa-check"></i> Engellendi';
                blockBtn.style.background = 'rgba(52, 199, 89, 0.2)';
                blockBtn.style.borderColor = 'rgba(52, 199, 89, 0.3)';
                blockBtn.style.color = '#34c759';
                blockBtn.onclick = null;
                
                alert(`${currentPrivateChatUser.name} kullanıcısı 24 saat boyunca engellendi.`);
                
                setTimeout(() => {
                    const index = blockedUsers.indexOf(currentPrivateChatUser.name);
                    if (index > -1) {
                        blockedUsers.splice(index, 1);
                        alert(`${currentPrivateChatUser.name} kullanıcısının engeli kaldırıldı.`);
                    }
                }, 24 * 60 * 60 * 1000);
            }
        }

        function clearNotification(userName) {
            delete userNotifications[userName];
            loadOnlineList();
        }

        // ==================== PROFİL PANELİ ====================
        function toggleProfilePanel() {
            const profilePanel = document.getElementById('profilePanel');
            const menuIcons = document.querySelectorAll('.menu-icon');
            
            menuIcons.forEach(icon => icon.classList.remove('active'));
            document.getElementById('profileIconBtn').classList.add('active');
            
            if (profilePanel.classList.contains('active')) {
                profilePanel.classList.remove('active');
                setTimeout(() => {
                    profilePanel.style.display = 'none';
                }, 300);
            } else {
                profilePanel.style.display = 'flex';
                setTimeout(() => {
                    profilePanel.classList.add('active');
                }, 10);
                
                if (currentUser) {
                    updateProfileInfo();
                }
            }
        }

        function updateProfileInfo() {
            document.getElementById('profileName').textContent = currentUser.name;
            document.getElementById('profileRole').textContent = currentUser.role;
            document.getElementById('profileAvatarText').textContent = currentUser.avatar;
            
            const profileAvatarLarge = document.getElementById('profileAvatarLarge');
            const profileAvatarText = document.getElementById('profileAvatarText');
            
            if (currentUser.avatarImage) {
                profileAvatarText.style.display = 'none';
                if (profileAvatarLarge.querySelector('img')) {
                    profileAvatarLarge.querySelector('img').src = currentUser.avatarImage;
                } else {
                    const img = document.createElement('img');
                    img.src = currentUser.avatarImage;
                    img.alt = currentUser.name;
                    profileAvatarLarge.appendChild(img);
                }
            } else {
                profileAvatarText.style.display = 'flex';
                if (profileAvatarLarge.querySelector('img')) {
                    profileAvatarLarge.querySelector('img').remove();
                }
            }
            
            const bottomAvatar = document.getElementById('bottomProfileAvatar');
            const bottomAvatarText = document.getElementById('bottomAvatarText');
            
            if (currentUser.avatarImage) {
                bottomAvatarText.style.display = 'none';
                if (bottomAvatar.querySelector('img')) {
                    bottomAvatar.querySelector('img').src = currentUser.avatarImage;
                } else {
                    const img = document.createElement('img');
                    img.src = currentUser.avatarImage;
                    img.alt = currentUser.name;
                    bottomAvatar.appendChild(img);
                }
            } else {
                bottomAvatarText.textContent = currentUser.avatar;
                bottomAvatarText.style.display = 'flex';
                if (bottomAvatar.querySelector('img')) {
                    bottomAvatar.querySelector('img').remove();
                }
            }
            
            const themeTitle = document.getElementById('themeTitle');
            themeTitle.textContent = isDayMode ? 'Gündüz Modu' : 'Gece Modu';
            
            const registrationTitle = document.getElementById('registrationTitle');
            const registrationItem = document.getElementById('registrationItem');
            const passwordChangeItem = document.getElementById('passwordChangeItem');
            
            if (currentUser.registered === false) {
                registrationTitle.textContent = 'Hesap Kaydı';
                registrationItem.style.display = 'flex';
                passwordChangeItem.style.display = 'none';
            } else {
                registrationTitle.textContent = 'Hesap Bilgileri';
                registrationItem.style.display = 'flex';
                passwordChangeItem.style.display = 'flex';
            }
            
            const sleepModeTitle = document.getElementById('sleepModeTitle');
            sleepModeTitle.textContent = `Uyku Modu: ${isSleepMode ? 'Açık' : 'Kapalı'}`;
        }

        function changePassword() {
            if (!currentUser || currentUser.registered === false) {
                alert('Sadece kayıtlı kullanıcılar şifre değiştirebilir.');
                return;
            }
            
            const oldPass = prompt('Eski şifrenizi girin:');
            const newPass = prompt('Yeni şifrenizi girin:');
            const confirmPass = prompt('Yeni şifrenizi tekrar girin:');
            
            if (newPass && newPass === confirmPass) {
                currentUser.password = newPass;
                alert('Şifreniz başarıyla değiştirildi!');
            } else {
                alert('Şifreler uyuşmuyor veya geçersiz!');
            }
        }

        function toggleSleepMode() {
            isSleepMode = !isSleepMode;
            const sleepModeTitle = document.getElementById('sleepModeTitle');
            sleepModeTitle.textContent = `Uyku Modu: ${isSleepMode ? 'Açık' : 'Kapalı'}`;
            
            if (isSleepMode) {
                alert('Uyku modu açıldı. 30 dakika sonra otomatik kapanacak.');
                setTimeout(() => {
                    if (isSleepMode) {
                        alert('Uyku modu: Sistem 5 dakika içinde kapanacak.');
                        setTimeout(() => {
                            if (isSleepMode) {
                                alert('Sistem kapanıyor...');
                            }
                        }, 300000);
                    }
                }, 1800000);
            } else {
                alert('Uyku modu kapatıldı.');
            }
        }

        function openRegistrationPanel() {
            if (currentUser.registered === false) {
                const pass1 = prompt('Kayıt için şifre belirleyin:');
                const pass2 = prompt('Şifreyi tekrar girin:');
                
                if (pass1 && pass1 === pass2) {
                    currentUser.password = pass1;
                    currentUser.registered = true;
                    updateProfileInfo();
                    alert('Hesabınız başarıyla kaydedildi! Artık şifre değiştirebilirsiniz.');
                } else {
                    alert('Şifreler uyuşmuyor!');
                }
            } else {
                alert(`Hesap Bilgileri:\n\nKullanıcı: ${currentUser.name}\nRol: ${currentUser.role}\nKayıtlı: ${currentUser.registered ? 'Evet' : 'Hayır'}\nAvatar: ${currentUser.avatar}`);
            }
        }

        // ==================== YENİ: AI DESTEKLİ CHAT SİSTEMİ ====================
        function initializeChat() {
            chatMessages = [
                { user: "YapayZekaPro", avatar: "Y", message: "Merhaba! Yapay zeka geleceği hakkında konuşmak isteyen var mı?", time: "14:00", side: "left" },
                { user: "ChatGPTurk", avatar: "C", message: "Online eğitimde yapay zeka nasıl daha iyi kullanılabilir?", time: "13:58", side: "left" },
                { user: "DeepThinker", avatar: "D", message: "Teknoloji insan doğasını nasıl değiştiriyor sizce?", time: "13:55", side: "left" },
                { user: "MusicBotAI", avatar: "M", message: "Bugün dinlediğiniz en güzel şarkı neydi? 🎵", time: "13:50", side: "left" },
                { user: currentUser.name, avatar: currentUser.avatar, message: "Merhaba herkese! Yapay zeka konusu ilgimi çekiyor.", time: "Şimdi", side: "right" }
            ];
            
            renderChatMessages();
            startAIChatSimulation();
        }

        function renderChatMessages() {
            const chatContainer = document.getElementById('chatContainer');
            chatContainer.innerHTML = '';
            
            chatMessages.forEach(msg => {
                const messageDiv = document.createElement('div');
                messageDiv.className = `chat-message ${msg.side}`;
                
                const user = onlineUsers.find(u => u.name === msg.user);
                const avatarImage = user ? user.avatarImage : null;
                
                messageDiv.innerHTML = `
                    <div class="message-user">
                        <div class="message-user-avatar">
                            ${avatarImage ? 
                                `<img src="${avatarImage}" alt="${msg.user}">` : 
                                msg.avatar}
                        </div>
                        <div class="message-user-name">${msg.user}</div>
                    </div>
                    <div class="message-content">${msg.message}</div>
                    <div class="message-time">${msg.time}</div>
                `;
                chatContainer.appendChild(messageDiv);
            });
            
            setTimeout(() => {
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }, 100);
        }

        function startAIChatSimulation() {
            if (messageInterval) clearInterval(messageInterval);
            
            messageInterval = setInterval(() => {
                generateAIMessage();
                
                if (chatMessages.length > 100) {
                    chatMessages.splice(0, chatMessages.length - 100);
                    renderChatMessages();
                }
            }, 5000 + Math.random() * 7000);
            
            // Rastgele nick değiştirme
            setInterval(() => {
                changeRandomAINick();
            }, 30000 + Math.random() * 30000);
        }

        function generateAIMessage() {
            const activeBots = onlineUsers.filter(user => user.role === 'ai' && user.chatting);
            if (activeBots.length === 0) return;
            
            const randomBot = activeBots[Math.floor(Math.random() * activeBots.length)];
            const botInfo = aiBots.find(bot => bot.name === randomBot.name);
            
            if (!botInfo) return;
            
            // Rastgele konu seç veya önceki mesajlara cevap ver
            let message = "";
            
            if (Math.random() > 0.3 && chatMessages.length > 2) {
                // Önceki mesajlara cevap ver
                const lastMessages = chatMessages.slice(-3);
                const humanMessages = lastMessages.filter(msg => msg.side === 'right' || (msg.user !== randomBot.name && Math.random() > 0.5));
                
                if (humanMessages.length > 0) {
                    const lastHumanMessage = humanMessages[Math.floor(Math.random() * humanMessages.length)];
                    const responseType = aiResponses[botInfo.personality] || aiResponses["Profesyonel"];
                    const response = responseType[Math.floor(Math.random() * responseType.length)];
                    
                    message = `${response} "${lastHumanMessage.message.substring(0, 50)}${lastHumanMessage.message.length > 50 ? '...' : ''}" hakkında ne düşünüyorsunuz?`;
                } else {
                    message = generateTopicBasedMessage(botInfo);
                }
            } else {
                // Yeni konu başlat
                message = generateTopicBasedMessage(botInfo);
            }
            
            const now = new Date();
            const timeStr = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
            
            chatMessages.push({
                user: randomBot.name,
                avatar: randomBot.avatar,
                message: message,
                time: timeStr,
                side: "left"
            });
            
            renderChatMessages();
            
            // Botu güncelle
            const bot = onlineUsers.find(u => u.name === randomBot.name);
            if (bot) {
                bot.chatting = true;
                bot.lastActive = Date.now();
                loadOnlineList();
            }
        }

        function generateTopicBasedMessage(botInfo) {
            const topic = aiConversationTopics[Math.floor(Math.random() * aiConversationTopics.length)];
            const responseType = aiResponses[botInfo.personality] || aiResponses["Profesyonel"];
            const response = responseType[Math.floor(Math.random() * responseType.length)];
            
            return `${response} ${topic}`;
        }

        function changeRandomAINick() {
            const aiUsers = onlineUsers.filter(user => user.role === 'ai');
            if (aiUsers.length === 0) return;
            
            const randomBot = aiUsers[Math.floor(Math.random() * aiUsers.length)];
            const availableBots = aiBots.filter(bot => !onlineUsers.some(user => user.name === bot.name));
            
            if (availableBots.length > 0) {
                const newBot = availableBots[Math.floor(Math.random() * availableBots.length)];
                
                // Eski botu kaldır
                const oldIndex = onlineUsers.findIndex(u => u.name === randomBot.name);
                if (oldIndex !== -1) {
                    onlineUsers.splice(oldIndex, 1);
                }
                
                // Yeni bot ekle
                const newBotUser = {
                    name: newBot.name,
                    avatar: newBot.avatar,
                    role: "ai",
                    status: "online",
                    chatting: true,
                    lastActive: Date.now(),
                    personality: newBot.personality,
                    interests: newBot.interests
                };
                
                onlineUsers.push(newBotUser);
                
                // Chat'e bildirim ekle
                const now = new Date();
                const timeStr = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
                
                chatMessages.push({
                    user: "Sistem",
                    avatar: "⚡",
                    message: `${randomBot.name} artık ${newBot.name} olarak biliniyor.`,
                    time: timeStr,
                    side: "left"
                });
                
                loadOnlineList();
                renderChatMessages();
            }
        }

        // ==================== MESAJ GÖNDER ====================
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            const now = new Date();
            const timeStr = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
            
            chatMessages.push({
                user: currentUser.name,
                avatar: currentUser.avatar,
                message: text,
                time: timeStr,
                side: "right"
            });
            
            renderChatMessages();
            input.value = '';
            
            const user = onlineUsers.find(u => u.name === currentUser.name);
            if (user) {
                user.chatting = true;
                user.lastActive = Date.now();
                loadOnlineList();
            }
            
            // AI botların cevap verme ihtimali
            setTimeout(() => {
                if (Math.random() > 0.5) {
                    generateAIMessage();
                }
            }, 1500 + Math.random() * 2000);
        }

        // ==================== DİĞER FONKSİYONLAR ====================
        function togglePanel(panel) {
            const onlinePanel = document.getElementById('onlinePanel');
            const menuIcons = document.querySelectorAll('.menu-icon');
            
            menuIcons.forEach(icon => icon.classList.remove('active'));
            event.target.closest('.menu-icon').classList.add('active');
            
            if (panel === 'online') {
                onlinePanel.style.display = onlinePanel.style.display === 'none' ? 'flex' : 'none';
            }
        }

        function switchTab(tab) {
            currentTab = tab;
            const tabs = document.querySelectorAll('.online-tab');
            tabs.forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            loadOnlineList();
        }

        function toggleTheme() {
            const body = document.body;
            const themeBtn = document.getElementById('themeToggle').querySelector('i');
            const profileThemeTitle = document.getElementById('themeTitle');
            
            if (isDayMode) {
                body.classList.remove('day-mode');
                themeBtn.className = 'fas fa-moon';
                profileThemeTitle.textContent = 'Gece Modu';
                isDayMode = false;
            } else {
                body.classList.add('day-mode');
                themeBtn.className = 'fas fa-sun';
                profileThemeTitle.textContent = 'Gündüz Modu';
                isDayMode = true;
            }
            
            loadOnlineList();
        }

        function handleLogin() {
            const nickInput = document.getElementById('nickInput');
            const passInput = document.getElementById('passInput');
            
            let nick = nickInput.value.trim();
            const pass = passInput.value;
            
            if (!nick) {
                showError('Kullanıcı adı gerekli!');
                return;
            }
            
            if (nick.length > 20) {
                showError('Kullanıcı adı 20 karakterden kısa olmalıdır!');
                return;
            }
            
            const loginBtn = document.getElementById('loginBtn');
            loginBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            loginBtn.style.cursor = 'not-allowed';
            
            setTimeout(() => {
                performLogin(nick, pass);
            }, 800);
        }

        function performLogin(nick, pass) {
            const normalizedNick = nick.toLowerCase();
            const registeredUsers = [
                { name: "mateky", password: "kumsal07@", role: "owner", avatar: "M", registered: true },
                { name: "MATE", password: "secure123", role: "admin", avatar: "S", registered: true }
            ];
            
            let user = registeredUsers.find(u => u.name.toLowerCase() === normalizedNick);
            
            if (user) {
                if (pass !== user.password) {
                    showError('Kayıtlı kullanıcılar için şifre gereklidir!');
                    resetLoginButton();
                    return;
                }
            } else {
                user = {
                    name: nick.substring(0, 1).toUpperCase() + nick.substring(1).toLowerCase(),
                    role: "user",
                    avatar: nick.substring(0, 1).toUpperCase(),
                    registered: false
                };
            }
            
            currentUser = user;
            
            const loginBtn = document.getElementById('loginBtn');
            loginBtn.classList.add('success');
            loginBtn.innerHTML = '<i class="fas fa-check"></i> Giriş Başarılı!';
            
            setTimeout(() => {
                const loginContainer = document.getElementById('loginContainer');
                loginContainer.classList.add('login-success');
                document.getElementById('blurLayer').style.opacity = '0';
                
                setTimeout(() => {
                    initializeApp();
                }, 600);
            }, 1200);
        }

        function initializeApp() {
            initializeAIBots();
            loadOnlineList();
            initializeChat();
            startUserUpdateSystem();
        }

        function initializeAIBots() {
            onlineUsers = [
                { name: currentUser.name, avatar: currentUser.avatar, role: currentUser.role, status: "online", chatting: true, lastActive: Date.now() }
            ];
            
            // 10-15 arası AI bot ekle
            const numberOfBots = 10 + Math.floor(Math.random() * 6);
            const shuffledBots = [...aiBots].sort(() => Math.random() - 0.5);
            
            for (let i = 0; i < Math.min(numberOfBots, shuffledBots.length); i++) {
                const bot = shuffledBots[i];
                onlineUsers.push({
                    name: bot.name,
                    avatar: bot.avatar,
                    role: "ai",
                    status: Math.random() > 0.2 ? "online" : "away",
                    chatting: Math.random() > 0.5,
                    lastActive: Date.now() - Math.random() * 3600000,
                    personality: bot.personality,
                    interests: bot.interests
                });
            }
        }

        function loadOnlineList() {
            const onlineList = document.getElementById('onlineList');
            let filteredUsers = [];
            
            if (currentTab === 'online') {
                filteredUsers = onlineUsers.filter(user => user.status === 'online');
            } else {
                filteredUsers = onlineUsers.filter(user => user.chatting);
            }
            
            let html = '';
            filteredUsers.forEach(user => {
                const timeAgo = getTimeAgo(user.lastActive);
                const statusText = user.chatting ? "Sohbette" : timeAgo;
                const hasNotification = userNotifications[user.name] > 0;
                const isBlocked = blockedUsers.includes(user.name);
                
                if (isBlocked) return;
                
                html += `
                    <div class="nick-item ${hasNotification ? 'has-notification' : ''}" onclick="openPrivateChat('${user.name}')">
                        <div class="nick-avatar">
                            ${user.avatarImage ? 
                                `<img src="${user.avatarImage}" alt="${user.name}">` : 
                                user.avatar}
                            ${hasNotification ? '<div class="notification-dot"></div>' : ''}
                        </div>
                        <div class="nick-info">
                            <div class="nick-name">${user.name} ${user.role === 'ai' ? '🤖' : user.role !== 'user' ? `(${user.role})` : ''}</div>
                            <div class="nick-status">${statusText}</div>
                        </div>
                        <div class="online-dot" style="background: ${user.chatting ? 'rgba(255,255,255,0.8)' : 'rgba(255,255,255,0.4)'}"></div>
                    </div>
                `;
            });
            
            onlineList.innerHTML = html;
            
            const onlineTab = document.querySelector('.online-tab:nth-child(1)');
            const chatTab = document.querySelector('.online-tab:nth-child(2)');
            
            const onlineCount = onlineUsers.filter(u => u.status === 'online' && !blockedUsers.includes(u.name)).length;
            const chattingCount = onlineUsers.filter(u => u.chatting && !blockedUsers.includes(u.name)).length;
            
            onlineTab.textContent = `Çevrimiçi (${onlineCount})`;
            chatTab.textContent = `Sohbette (${chattingCount})`;
            
            const onlineListBtn = document.getElementById('onlineListBtn');
            const totalNotifications = Object.values(userNotifications).reduce((a, b) => a + b, 0);
            
            if (totalNotifications > 0) {
                if (!onlineListBtn.querySelector('.notification-dot')) {
                    const dot = document.createElement('div');
                    dot.className = 'notification-dot';
                    onlineListBtn.appendChild(dot);
                }
            } else {
                const dot = onlineListBtn.querySelector('.notification-dot');
                if (dot) dot.remove();
            }
        }

        function getTimeAgo(timestamp) {
            const diff = Date.now() - timestamp;
            const minutes = Math.floor(diff / 60000);
            
            if (minutes < 1) return "Şimdi";
            if (minutes < 60) return `${minutes} dk önce`;
            
            const hours = Math.floor(minutes / 60);
            if (hours < 24) return `${hours} sa önce`;
            
            const days = Math.floor(hours / 24);
            return `${days} gün önce`;
        }

        function startUserUpdateSystem() {
            if (userUpdateInterval) clearInterval(userUpdateInterval);
            
            userUpdateInterval = setInterval(() => {
                onlineUsers.forEach(user => {
                    if (user.role === 'ai') {
                        if (Math.random() > 0.7) {
                            user.chatting = !user.chatting;
                            user.lastActive = Date.now();
                        }
                        
                        if (Math.random() > 0.9) {
                            user.status = Math.random() > 0.1 ? 'online' : 'away';
                        }
                    }
                });
                
                loadOnlineList();
                
                if (Math.random() > 0.8 && currentUser) {
                    const randomUser = onlineUsers[Math.floor(Math.random() * onlineUsers.length)];
                    if (randomUser && randomUser.name !== currentUser.name && !blockedUsers.includes(randomUser.name)) {
                        if (!userNotifications[randomUser.name]) {
                            userNotifications[randomUser.name] = 0;
                        }
                        userNotifications[randomUser.name]++;
                        loadOnlineList();
                    }
                }
            }, 10000);
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');
            
            errorText.textContent = message;
            errorDiv.style.display = 'flex';
            
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        function resetLoginButton() {
            document.getElementById('loginBtn').innerHTML = '<span id="btnText">Giriş Yap</span>';
            document.getElementById('loginBtn').style.cursor = 'pointer';
        }

        function openSettings() {
            alert('⚙️ Ayarlar Paneli:\n\n• Profil Ayarları\n• Gizlilik\n• Bildirimler\n• Tema Ayarları\n• Şeffaflık Seviyesi\n• Video Yönetimi');
        }

        function openIRC() {
            alert('💻 IRC Komutları:\n\n/clear - Sohbeti temizle\n/help - Yardım\n/nick [yeni] - Nick değiştir\n/theme - Tema değiştir\n/users - Çevrimiçi kullanıcılar\n/video - Video ekle (admin)');
        }

        function handleLogout() {
            if (confirm('Çıkış yapmak istediğinize emin misiniz?')) {
                clearInterval(messageInterval);
                clearInterval(userUpdateInterval);
                location.reload();
            }
        }

        // ==================== GLOBAL FONKSİYONLAR ====================
        window.togglePanel = togglePanel;
        window.switchTab = switchTab;
        window.toggleTheme = toggleTheme;
        window.handleLogin = handleLogin;
        window.sendMessage = sendMessage;
        window.openSettings = openSettings;
        window.openIRC = openIRC;
        window.handleLogout = handleLogout;
        window.playVideo = playVideo;
        window.switchYouTubeTab = switchYouTubeTab;
        window.togglePlaylist = togglePlaylist;
        window.openVideoAddPanel = openVideoAddPanel;
        window.muteVideo = muteVideo;
        window.setVolume = setVolume;
        window.skipBackward = skipBackward;
        window.skipForward = skipForward;
        window.toggleProfilePanel = toggleProfilePanel;
        window.changeProfileAvatar = uploadProfileImage;
        window.changePassword = changePassword;
        window.toggleSleepMode = toggleSleepMode;
        window.openRegistrationPanel = openRegistrationPanel;
        window.openPrivateChat = openPrivateChat;
        window.closePrivateChat = closePrivateChat;
        window.sendPrivateMessage = sendPrivateMessage;
        window.openPrivateFilePicker = openPrivateFilePicker;
        window.openImage = openImage;
        window.reportUser = reportUser;
        window.blockUser = blockUser;
    </script>
</body>
</html>
