<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popbox Elite v2 - Live Stream</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-tertiary: #1a1a1a;
            --border-light: #222222;
            --border-medium: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --accent-blue: #3b82f6;
            --accent-green: #10b981;
            --accent-red: #ef4444;
            --accent-purple: #8b5cf6;
            --accent-cyan: #06b6d4;
            --shadow-heavy: 0 8px 32px rgba(0, 0, 0, 0.7);
            --radius-md: 8px;
            --radius-lg: 12px;
            --font-primary: 'Inter', sans-serif;
            --spacing-sm: 12px;
            --spacing-md: 18px;
            --spacing-lg: 24px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: var(--font-primary); background: var(--bg-primary); color: var(--text-primary); height: 100vh; overflow: hidden; }

        /* Gƒ∞Rƒ∞≈û EKRANI */
        .login-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, rgba(10, 10, 10, 0.98) 0%, rgba(26, 26, 26, 0.95) 100%);
            display: flex; align-items: center; justify-content: center; z-index: 5000;
            backdrop-filter: blur(20px);
        }

        .login-container {
            width: 90%; max-width: 400px; padding: var(--spacing-lg);
            background: rgba(17, 17, 17, 0.7); border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.7);
            animation: fadeInUp 0.6s ease-out;
        }

        .login-logo {
            width: 70px; height: 70px; background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            border-radius: 50%; margin: 0 auto var(--spacing-md); display: flex;
            align-items: center; justify-content: center; color: white;
            font-weight: 700; font-size: 28px;
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.4);
        }

        .login-title {
            font-size: 24px; font-weight: 700; text-align: center;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            -webkit-background-clip: text; background-clip: text; color: transparent;
            margin-bottom: var(--spacing-sm);
        }

        .login-input {
            width: 100%; padding: 12px 14px; background: rgba(26, 26, 26, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: var(--radius-md);
            color: var(--text-primary); font-size: 14px; margin-bottom: var(--spacing-md);
            font-family: inherit;
        }

        .login-btn {
            width: 100%; padding: 14px; background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            color: white; border: none; border-radius: var(--radius-md); font-size: 15px;
            font-weight: 600; cursor: pointer; transition: all 0.3s;
        }

        .login-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4); }

        .owner-access {
            margin-top: var(--spacing-md); padding: var(--spacing-sm);
            background: rgba(139, 92, 246, 0.1); border-radius: var(--radius-md);
            text-align: center; font-size: 11px; color: var(--accent-purple);
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        /* √úST BAR */
        .top-bar {
            height: 60px; background: var(--bg-secondary); border-bottom: 1px solid var(--border-light);
            padding: 0 var(--spacing-lg); display: flex; align-items: center;
            justify-content: space-between; position: relative; z-index: 100;
        }

        .logo { display: flex; align-items: center; gap: var(--spacing-sm); font-weight: 600; font-size: 18px; }
        .logo-icon { width: 36px; height: 36px; background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            color: white; font-weight: 700; font-size: 18px; }

        .user-menu { display: flex; align-items: center; gap: var(--spacing-md); }
        .user-info { display: flex; align-items: center; gap: var(--spacing-sm); cursor: pointer;
            padding: 6px 12px; border-radius: var(--radius-md); transition: background 0.2s; }
        .user-info:hover { background: var(--bg-tertiary); }

        .user-avatar {
            width: 32px; height: 32px; border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            display: flex; align-items: center; justify-content: center;
            color: white; font-weight: 600; font-size: 14px; overflow: hidden;
        }

        .user-avatar img { width: 100%; height: 100%; object-fit: cover; }

        .nav-btn {
            width: 40px; height: 40px; border-radius: 50%; background: var(--bg-tertiary);
            border: 1px solid var(--border-light); color: var(--text-secondary);
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            font-size: 16px; transition: all 0.2s;
        }

        .nav-btn:hover { background: var(--accent-purple); color: white; border-color: var(--accent-purple); }

        /* ANA LAYOUT */
        .app-container { display: flex; height: calc(100vh - 60px); }

        /* SOL PANEL */
        .online-panel {
            width: 300px; background: var(--bg-secondary); border-right: 1px solid var(--border-light);
            display: flex; flex-direction: column; overflow: hidden;
        }

        .panel-header { padding: var(--spacing-md) var(--spacing-lg); border-bottom: 1px solid var(--border-light); }
        .panel-title { font-size: 15px; font-weight: 600; display: flex; align-items: center; justify-content: space-between; }
        .online-count { font-size: 13px; color: var(--accent-cyan); font-weight: 600; }

        .user-list { flex: 1; overflow-y: auto; padding: 0 var(--spacing-lg); }
        .user-item {
            padding: var(--spacing-md) 0; border-bottom: 1px solid var(--border-light);
            display: flex; align-items: center; gap: var(--spacing-md); cursor: pointer;
            transition: all 0.2s;
        }

        .user-item:hover { background: var(--bg-tertiary); margin: 0 calc(var(--spacing-lg) * -1); padding: var(--spacing-md) var(--spacing-lg); }

        /* ORTA PANEL */
        .chat-panel { flex: 1; display: flex; flex-direction: column; background: var(--bg-primary); }
        .chat-header {
            padding: 0 var(--spacing-lg); height: 70px; border-bottom: 1px solid var(--border-light);
            display: flex; align-items: center; justify-content: space-between;
            background: var(--bg-secondary);
        }

        .chat-messages { flex: 1; padding: var(--spacing-lg); overflow-y: auto; display: flex; flex-direction: column; gap: var(--spacing-md); }
        .chat-input-area { padding: var(--spacing-lg); border-top: 1px solid var(--border-light); background: var(--bg-secondary); }

        .input-wrapper { display: flex; gap: var(--spacing-md); align-items: flex-end; }
        .message-input {
            flex: 1; background: var(--bg-tertiary); border: 1px solid var(--border-light);
            border-radius: var(--radius-md); padding: 12px 16px; color: var(--text-primary);
            font-family: inherit; font-size: 14px; resize: none; min-height: 44px;
            max-height: 120px; outline: none;
        }

        .send-btn {
            width: 44px; height: 44px; border-radius: var(--radius-md);
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            border: none; color: white; cursor: pointer; display: flex;
            align-items: center; justify-content: center;
        }

        /* SAƒû PANEL - VIDEO */
        .video-panel {
            width: 400px; background: #000; border-left: 1px solid var(--border-medium);
            display: flex; flex-direction: column; overflow: hidden;
        }

        .video-header {
            padding: var(--spacing-md) var(--spacing-lg); background: rgba(0, 0, 0, 0.9);
            color: white; border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex; justify-content: space-between; align-items: center;
        }

        .video-container { flex: 1; position: relative; overflow: hidden; background: #000; }
        #youtubePlayer { width: 100%; height: 100%; }

        /* MESAJ STƒ∞Lƒ∞ */
        .message { display: flex; flex-direction: column; max-width: 75%; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .message-incoming { align-self: flex-start; }
        .message-outgoing { align-self: flex-end; align-items: flex-end; }
        .message-text {
            font-size: 14px; line-height: 1.5; color: var(--text-primary);
            padding: 10px 14px; background: var(--bg-tertiary);
            border-radius: var(--radius-md); word-break: break-word;
        }
        .message-outgoing .message-text { background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan)); color: white; }
        .message-time { font-size: 10px; color: var(--text-secondary); margin-top: 4px; text-align: right; }

        /* UTILITIES */
        .hidden { display: none !important; }
        .action-btn {
            padding: 6px 12px; border-radius: var(--radius-md); border: 1px solid var(--border-medium);
            background: var(--bg-tertiary); color: var(--text-primary); font-size: 12px;
            cursor: pointer; transition: all 0.2s;
        }
        .action-btn:hover { background: var(--bg-primary); }
        .action-btn.primary { background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan)); color: white; border: none; }

        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-tertiary); }
        ::-webkit-scrollbar-thumb { background: var(--border-medium); border-radius: 3px; }
    </style>
</head>
<body>
    <!-- Gƒ∞Rƒ∞≈û EKRANI -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-logo">P</div>
            <h1 class="login-title">Popbox Elite v2</h1>
            <p style="text-align: center; color: var(--text-secondary); margin-bottom: var(--spacing-lg);">
                Kayƒ±tsƒ±z giri≈ü - Canlƒ± YouTube Yayƒ±nƒ±
            </p>
            
            <input id="nickInput" class="login-input" type="text" placeholder="Nick girin (≈üifresiz)" autofocus>
            <button class="login-btn" onclick="handleLogin()">
                <i class="fas fa-sign-in-alt"></i> Giri≈ü Yap
            </button>
            
            <div class="owner-access">
                <i class="fas fa-crown"></i> Owner giri≈üi: <strong>mateky</strong> / <strong>mateky123</strong>
            </div>
        </div>
    </div>

    <!-- ANA UYGULAMA -->
    <div id="app" class="hidden">
        <!-- √úST BAR -->
        <div class="top-bar">
            <div class="logo">
                <div class="logo-icon">P</div>
                <span>Popbox Live</span>
                <span style="font-size: 11px; color: var(--accent-purple); margin-left: 8px;">v2</span>
            </div>
            
            <div class="user-menu">
                <div class="user-info" id="userInfo">
                    <!-- Dinamik -->
                </div>
                
                <button class="nav-btn" onclick="toggleLiveStream()" id="liveBtn" title="Canlƒ± Yayƒ±n">
                    <i class="fas fa-broadcast-tower"></i>
                </button>
                
                <button class="nav-btn owner-btn" onclick="toggleOwnerPanel()" id="ownerBtn" style="display: none;">
                    <i class="fas fa-crown"></i>
                </button>
            </div>
        </div>

        <!-- ANA LAYOUT -->
        <div class="app-container">
            <!-- SOL PANEL - Online Listesi -->
            <div class="online-panel">
                <div class="panel-header">
                    <div class="panel-title">
                        √áevrimi√ßi Kullanƒ±cƒ±lar
                        <span class="online-count" id="onlineCount">0</span>
                    </div>
                </div>
                
                <div class="user-list" id="userList">
                    <!-- Kullanƒ±cƒ±lar buraya eklenecek -->
                </div>
            </div>

            <!-- ORTA PANEL - Ana Sohbet -->
            <div class="chat-panel">
                <div class="chat-header">
                    <div class="chat-info">
                        <h2 id="currentChannel">üéµ Popbox Music Live</h2>
                        <p id="channelTopic">YouTube canlƒ± yayƒ±nƒ± - T√ºm kanallarda ortak video</p>
                    </div>
                    
                    <div class="channel-controls">
                        <button class="action-btn" onclick="skipVideo()">
                            <i class="fas fa-forward"></i> Video Deƒüi≈ütir
                        </button>
                    </div>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <!-- Mesajlar buraya eklenecek -->
                </div>
                
                <div class="chat-input-area">
                    <div class="input-wrapper">
                        <textarea class="message-input" id="messageInput" placeholder="Mesaj yazƒ±n..." rows="1"></textarea>
                        <button class="send-btn" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SAƒû PANEL - Video -->
            <div class="video-panel">
                <div class="video-header">
                    <h3><i class="fas fa-play-circle"></i> Popbox Music Live</h3>
                    <div class="video-controls">
                        <button class="action-btn primary small" onclick="skipVideo()">
                            <i class="fas fa-sync-alt"></i> Deƒüi≈ütir
                        </button>
                    </div>
                </div>
                
                <div class="video-container">
                    <iframe id="youtubePlayer" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== Sƒ∞STEM YAPILANDIRMASI ====================
        let currentUser = null;
        let isOwner = false;
        let users = [];
        let messages = [];
        let registeredNicks = new Set();
        let currentVideoIndex = 0;
        let isLiveStreamActive = false;

        // Popbox Music YouTube videolarƒ± (sƒ±rayla deƒüi≈üecek)
        const popboxMusicVideos = [
            'd6pJmCVLs0U', // √ñrnek video 1
            'jfKfPfyJRdk', // Lofi girl
            '5qap5aO4i9A', // Chill music
            '0GcY4oE9iq8', // Jazz
            'MCkTebktHVc', // Popbox √∂zel
            'n61ULEU7CO0'  // Canlƒ± yayƒ±n benzeri
        ];

        // Ba≈ülangƒ±√ßta Owner (mateky) kullanƒ±cƒ±sƒ±nƒ± ekle
        const ownerUser = {
            id: 'mateky',
            name: 'mateky',
            avatar: 'üëë',
            role: 'owner',
            online: false,
            messages: 0,
            password: 'mateky123'
        };

        // ==================== Gƒ∞Rƒ∞≈û Sƒ∞STEMƒ∞ ====================
        function handleLogin() {
            const nickInput = document.getElementById('nickInput');
            const nick = nickInput.value.trim();
            
            if (!nick) {
                alert('L√ºtfen bir nick girin!');
                return;
            }
            
            // Nick koruma kontrol√º - KAYITSIZ Gƒ∞Rƒ∞≈û ƒ∞√áƒ∞N ≈ûƒ∞FRE GEREKMEZ
            const normalizedNick = nick.toLowerCase();
            
            // Owner giri≈üi kontrol√º
            if (normalizedNick === 'mateky') {
                // Owner i√ßin ≈üifre iste
                const password = prompt('Owner ≈üifresi girin:');
                if (password === 'mateky123') {
                    currentUser = { ...ownerUser, online: true };
                    isOwner = true;
                } else {
                    alert('Owner ≈üifresi yanlƒ±≈ü!');
                    return;
                }
            } else {
                // Kayƒ±tsƒ±z kullanƒ±cƒ± - ≈üifre gerekmez
                currentUser = {
                    id: normalizedNick + '_' + Date.now(),
                    name: nick,
                    avatar: nick.charAt(0).toUpperCase(),
                    role: 'user',
                    online: true,
                    messages: 0
                };
            }
            
            // Kullanƒ±cƒ±yƒ± users listesine ekle
            if (!users.find(u => u.id === currentUser.id)) {
                users.push(currentUser);
            }
            
            // Login ekranƒ±nƒ± kapat
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            
            // Sistemi ba≈ülat
            initializeSystem();
        }

        // ==================== Sƒ∞STEM BA≈ûLATMA ====================
        function initializeSystem() {
            updateUserInfo();
            loadUsers();
            loadYouTubeVideo();
            loadInitialMessages();
            
            if (isOwner) {
                document.getElementById('ownerBtn').style.display = 'flex';
                addSystemMessage('üëë Owner olarak giri≈ü yaptƒ±nƒ±z. Tanrƒ± modu aktif!');
            }
            
            // Ho≈ü geldin mesajƒ±
            addSystemMessage(`üéµ Ho≈ü geldin ${currentUser.name}! Popbox Music canlƒ± yayƒ±nƒ± aktif.`);
            
            // Online listesi g√ºncelleme
            setInterval(updateOnlineStatus, 30000);
            
            // YouTube video sƒ±rayla deƒüi≈ütirme (her 5 dakikada bir)
            setInterval(skipVideo, 300000);
            
            // Demo kullanƒ±cƒ±lar ekle
            addDemoUsers();
        }

        function addDemoUsers() {
            const demoUsers = [
                { id: 'user1_' + Date.now(), name: 'Ahmet', avatar: 'A', role: 'user', online: true, messages: 5 },
                { id: 'user2_' + Date.now(), name: 'Ay≈üe', avatar: 'A', role: 'user', online: true, messages: 12 },
                { id: 'user3_' + Date.now(), name: 'Mehmet', avatar: 'M', role: 'user', online: false, messages: 8 },
                { id: 'user4_' + Date.now(), name: 'Zeynep', avatar: 'Z', role: 'user', online: true, messages: 3 }
            ];
            
            demoUsers.forEach(user => {
                if (!users.find(u => u.name === user.name)) {
                    users.push(user);
                }
            });
            
            loadUsers();
        }

        // ==================== YOUTUBE VIDEO Sƒ∞STEMƒ∞ ====================
        function loadYouTubeVideo() {
            const videoId = popboxMusicVideos[currentVideoIndex];
            const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0&modestbranding=1`;
            
            document.getElementById('youtubePlayer').src = embedUrl;
            
            addSystemMessage(`üé¨ ≈ûu an √ßalan: Popbox Music Video ${currentVideoIndex + 1}`);
        }

        function skipVideo() {
            currentVideoIndex = (currentVideoIndex + 1) % popboxMusicVideos.length;
            loadYouTubeVideo();
            
            // T√ºm kullanƒ±cƒ±lara bildirim
            addSystemMessage(`‚è≠Ô∏è Video deƒüi≈ütirildi: Popbox Music Video ${currentVideoIndex + 1}`);
            
            if (isOwner) {
                // Owner log
                console.log(`Owner video deƒüi≈ütirdi: ${currentVideoIndex}`);
            }
        }

        // ==================== CANLI YAYIN Sƒ∞STEMƒ∞ ====================
        function toggleLiveStream() {
            if (!isOwner && currentUser.role !== 'admin') {
                alert('Canlƒ± yayƒ±n i√ßin yetkiniz yok!');
                return;
            }
            
            isLiveStreamActive = !isLiveStreamActive;
            
            if (isLiveStreamActive) {
                // Canlƒ± yayƒ±n ba≈ülat
                const liveVideoId = 'MCkTebktHVc'; // Canlƒ± yayƒ±n benzeri video
                document.getElementById('youtubePlayer').src = `https://www.youtube.com/embed/${liveVideoId}?autoplay=1&rel=0`;
                
                addSystemMessage('üî¥ CANLI YAYIN BA≈ûLADI! Popbox Music Live');
                document.getElementById('liveBtn').style.background = 'linear-gradient(135deg, var(--accent-red), var(--accent-orange))';
                document.getElementById('liveBtn').innerHTML = '<i class="fas fa-stop-circle"></i>';
            } else {
                // Normal videoya d√∂n
                loadYouTubeVideo();
                
                addSystemMessage('‚ö´ Canlƒ± yayƒ±n sona erdi.');
                document.getElementById('liveBtn').style.background = '';
                document.getElementById('liveBtn').innerHTML = '<i class="fas fa-broadcast-tower"></i>';
            }
        }

        // ==================== MESAJ Sƒ∞STEMƒ∞ ====================
        function loadInitialMessages() {
            // Demo mesajlar
            const demoMessages = [
                { user: { name: 'Sistem', avatar: 'ü§ñ', role: 'bot' }, text: 'Popbox Music Live yayƒ±nƒ±na ho≈ü geldiniz!', time: new Date(Date.now() - 3600000) },
                { user: { name: 'Ahmet', avatar: 'A', role: 'user' }, text: 'M√ºzik harika!', time: new Date(Date.now() - 1800000) },
                { user: { name: 'Ay≈üe', avatar: 'A', role: 'user' }, text: '√áok g√ºzel bir akƒ±≈ü, te≈üekk√ºrler!', time: new Date(Date.now() - 900000) }
            ];
            
            messages = demoMessages;
            renderMessages();
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            const message = {
                user: currentUser,
                text: text,
                time: new Date(),
                type: 'text'
            };
            
            messages.push(message);
            renderMessages();
            
            // ƒ∞statistik g√ºncelle
            currentUser.messages++;
            updateUserInfo();
            
            input.value = '';
            
            // Diƒüer kullanƒ±cƒ±lara bildirim (sim√ºlasyon)
            if (Math.random() > 0.5) {
                setTimeout(() => {
                    const demoUsers = users.filter(u => u.online && u.id !== currentUser.id);
                    if (demoUsers.length > 0) {
                        const randomUser = demoUsers[Math.floor(Math.random() * demoUsers.length)];
                        const responses = ['G√ºzel!', 'Katƒ±lƒ±yorum', 'üëç', 'Harika!'];
                        const response = responses[Math.floor(Math.random() * responses.length)];
                        
                        const responseMessage = {
                            user: randomUser,
                            text: response,
                            time: new Date(),
                            type: 'text'
                        };
                        
                        messages.push(responseMessage);
                        renderMessages();
                    }
                }, 1000 + Math.random() * 2000);
            }
        }

        function renderMessages() {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML = '';
            
            // Son 50 mesajƒ± g√∂ster
            const recentMessages = messages.slice(-50);
            
            recentMessages.forEach(msg => {
                const isOwn = msg.user.id === currentUser?.id;
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${isOwn ? 'message-outgoing' : 'message-incoming'}`;
                
                const timeStr = msg.time.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
                
                messageDiv.innerHTML = `
                    <div class="message-text">${escapeHtml(msg.text)}</div>
                    <div class="message-time">${msg.user.name} ‚Ä¢ ${timeStr}</div>
                `;
                
                chatMessages.appendChild(messageDiv);
            });
            
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function addSystemMessage(text) {
            const message = {
                user: { name: 'Sistem', avatar: 'ü§ñ', role: 'bot' },
                text: text,
                time: new Date(),
                type: 'system'
            };
            
            messages.push(message);
            renderMessages();
        }

        // ==================== KULLANICI Sƒ∞STEMƒ∞ ====================
        function loadUsers() {
            const userList = document.getElementById('userList');
            userList.innerHTML = '';
            
            const onlineUsers = users.filter(u => u.online);
            
            onlineUsers.forEach(user => {
                if (user.id === currentUser?.id) return;
                
                const userItem = document.createElement('div');
                userItem.className = 'user-item';
                userItem.onclick = () => openPrivateChat(user);
                
                userItem.innerHTML = `
                    <div class="user-avatar" style="background: ${user.online ? 'linear-gradient(135deg, var(--accent-green), var(--accent-cyan))' : 'var(--bg-tertiary)'};">
                        ${user.avatar}
                    </div>
                    <div class="user-info">
                        <div class="user-name">
                            ${user.name}
                            ${user.role !== 'user' ? `<span style="font-size: 10px; background: var(--accent-purple); color: white; padding: 1px 6px; border-radius: 10px;">${user.role}</span>` : ''}
                        </div>
                        <div class="user-status">${user.online ? 'üü¢ √áevrimi√ßi' : '‚ö´ √áevrimdƒ±≈üƒ±'}</div>
                    </div>
                `;
                
                userList.appendChild(userItem);
            });
            
            document.getElementById('onlineCount').textContent = onlineUsers.length;
        }

        function updateOnlineStatus() {
            // Sim√ºle edilmi≈ü √ßevrimdƒ±≈üƒ± kalma
            users.forEach(user => {
                if (user.id !== currentUser?.id && Math.random() > 0.7) {
                    user.online = false;
                }
            });
            loadUsers();
        }

        function updateUserInfo() {
            const userInfo = document.getElementById('userInfo');
            if (!userInfo || !currentUser) return;
            
            userInfo.innerHTML = `
                <div class="user-avatar" style="background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));">
                    ${currentUser.avatar}
                </div>
                <div style="text-align: right;">
                    <div class="user-name">${currentUser.name}</div>
                    <span style="font-size: 11px; color: ${currentUser.role === 'owner' ? 'var(--accent-purple)' : 'var(--text-secondary)'};">${currentUser.role}</span>
                </div>
            `;
        }

        // ==================== √ñZEL SOHBET Sƒ∞STEMƒ∞ (BASƒ∞T) ====================
        function openPrivateChat(user) {
            const message = prompt(`${user.name} kullanƒ±cƒ±sƒ±na √∂zel mesaj g√∂nder:`);
            if (message) {
                addSystemMessage(`üì© ${currentUser.name} -> ${user.name}: ${message}`);
                
                // Sim√ºle edilmi≈ü cevap
                setTimeout(() => {
                    const responses = ['Te≈üekk√ºrler!', 'Anladƒ±m.', 'Tamam.', 'G√ºzel.'];
                    const response = responses[Math.floor(Math.random() * responses.length)];
                    addSystemMessage(`üì© ${user.name} -> ${currentUser.name}: ${response}`);
                }, 1000 + Math.random() * 2000);
            }
        }

        // ==================== OWNER PANELƒ∞ ====================
        function toggleOwnerPanel() {
            if (!isOwner) {
                alert('Bu panele sadece Owner eri≈üebilir!');
                return;
            }
            
            // Basit owner paneli
            const actions = prompt(`
Owner Panel - Se√ßenekler:
1. T√ºm kullanƒ±cƒ±larƒ± √ßƒ±kar
2. Video listesini deƒüi≈ütir
3. Sistem mesajƒ± g√∂nder
4. Canlƒ± yayƒ±n ba≈ülat/durdur

Numara girin:`);
            
            switch(actions) {
                case '1':
                    if (confirm('T√ºm kullanƒ±cƒ±larƒ± √ßƒ±kartmak istediƒüinize emin misiniz?')) {
                        users.forEach(u => {
                            if (u.id !== currentUser.id) u.online = false;
                        });
                        loadUsers();
                        addSystemMessage('üö™ Owner t√ºm kullanƒ±cƒ±larƒ± √ßƒ±karttƒ±.');
                    }
                    break;
                case '2':
                    const newVideos = prompt('Yeni video ID\'leri (virg√ºlle ayƒ±rƒ±n):');
                    if (newVideos) {
                        const videoArray = newVideos.split(',').map(v => v.trim()).filter(v => v);
                        if (videoArray.length > 0) {
                            popboxMusicVideos.length = 0;
                            popboxMusicVideos.push(...videoArray);
                            currentVideoIndex = 0;
                            loadYouTubeVideo();
                            addSystemMessage('Owner video listesini g√ºncelledi.');
                        }
                    }
                    break;
                case '3':
                    const systemMsg = prompt('Sistem mesajƒ±:');
                    if (systemMsg) {
                        addSystemMessage(`üì¢ Sƒ∞STEM: ${systemMsg}`);
                    }
                    break;
                case '4':
                    toggleLiveStream();
                    break;
            }
        }

        // ==================== YARDIMCI FONKSƒ∞YONLAR ====================
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ==================== EVENT LISTENERS ====================
        document.addEventListener('DOMContentLoaded', function() {
            // Enter tu≈üu ile mesaj g√∂nderme
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            // Textarea otomatik y√ºkseklik
            document.getElementById('messageInput').addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = this.scrollHeight + 'px';
            });
            
            // Login enter tu≈üu
            document.getElementById('nickInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') handleLogin();
            });
            
            // Owner kullanƒ±cƒ±sƒ±nƒ± ba≈ülat
            registeredNicks.add('mateky');
            users.push(ownerUser);
        });
    </script>
</body>
</html>
