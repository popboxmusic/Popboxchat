<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popbox Elite</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* PROFESYONEL SÄ°YAH TEMA (GECE) */
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-tertiary: #1a1a1a;
            --bg-overlay: rgba(0, 0, 0, 0.85);
            
            --border-light: #222222;
            --border-medium: #2a2a2a;
            --border-dark: #333333;
            
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --text-tertiary: #888888;
            --text-muted: #666666;
            
            --accent-blue: #3b82f6;
            --accent-green: #10b981;
            --accent-red: #ef4444;
            --accent-orange: #f59e0b;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            
            --shadow-light: 0 1px 3px rgba(0, 0, 0, 0.3);
            --shadow-medium: 0 4px 12px rgba(0, 0, 0, 0.5);
            --shadow-heavy: 0 8px 32px rgba(0, 0, 0, 0.7);
            
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            
            --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --font-mono: 'JetBrains Mono', 'SF Mono', 'Roboto Mono', monospace;
            
            --spacing-xs: 6px;
            --spacing-sm: 12px;
            --spacing-md: 18px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
        }

        /* GÃœNDÃœZ TEMA */
        body.day-mode {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f1f5f9;
            --bg-overlay: rgba(255, 255, 255, 0.95);
            
            --border-light: #e2e8f0;
            --border-medium: #cbd5e1;
            --border-dark: #94a3b8;
            
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-tertiary: #64748b;
            --text-muted: #94a3b8;
            
            --shadow-light: 0 1px 3px rgba(0, 0, 0, 0.05);
            --shadow-medium: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-heavy: 0 8px 32px rgba(0, 0, 0, 0.12);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-primary);
            background: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            font-size: 14px;
            line-height: 1.5;
            font-weight: 400;
            transition: background 0.3s ease, color 0.3s ease;
        }

        /* GÄ°RÄ°Åž EKRANI - ÅžEFFAF VE BULANIK */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 5000;
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
        }

        .login-container {
            width: 100%;
            max-width: 400px;
            padding: var(--spacing-xl);
            background: rgba(17, 17, 17, 0.9);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transform: translateY(0);
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .login-header {
            text-align: center;
            margin-bottom: var(--spacing-xl);
        }

        .login-logo {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            border-radius: 50%;
            margin: 0 auto var(--spacing-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 24px;
            box-shadow: 0 8px 16px rgba(59, 130, 246, 0.3);
        }

        .login-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .login-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .login-input {
            width: 100%;
            padding: 14px 16px;
            background: rgba(26, 26, 26, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 14px;
            font-family: inherit;
            margin-bottom: var(--spacing-md);
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .login-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            background: rgba(17, 17, 17, 0.95);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
            transform: translateY(-1px);
        }

        .login-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            color: white;
            border: none;
            border-radius: var(--radius-md);
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: var(--spacing-md);
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }

        .login-btn:active {
            transform: translateY(0);
        }

        .login-note {
            text-align: center;
            margin-top: var(--spacing-lg);
            font-size: 12px;
            color: var(--text-tertiary);
            line-height: 1.6;
        }

        /* ÃœST BAR - Navigation */
        .top-bar {
            height: 60px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-light);
            padding: 0 var(--spacing-lg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-weight: 600;
            font-size: 18px;
            color: var(--text-primary);
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 16px;
        }

        /* ÃœST BAR'DA HÄ°KAYELER */
        .top-stories {
            flex: 1;
            display: flex;
            gap: var(--spacing-md);
            overflow-x: auto;
            padding: 0 var(--spacing-lg);
            margin: 0 var(--spacing-lg);
            max-width: calc(100vw - 400px);
            scrollbar-width: none;
        }

        .top-stories::-webkit-scrollbar {
            display: none;
        }

        .top-story-item {
            flex: 0 0 auto;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .top-story-item:hover {
            transform: scale(1.05);
        }

        .top-story-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            padding: 2px;
            background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .top-story-avatar-inner {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
            border: 2px solid var(--bg-secondary);
            overflow: hidden;
        }

        .top-story-avatar-inner img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .top-story-username {
            font-size: 10px;
            color: var(--text-tertiary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 50px;
        }

        .nav-controls {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .nav-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: transparent;
            border: 1px solid var(--border-light);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .nav-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            transform: translateY(-1px);
        }

        .nav-btn.disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .theme-toggle {
            position: relative;
            width: 60px;
            height: 28px;
            background: var(--bg-tertiary);
            border-radius: 14px;
            border: 1px solid var(--border-light);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-toggle::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 22px;
            height: 22px;
            background: var(--accent-blue);
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        body.day-mode .theme-toggle::after {
            transform: translateX(32px);
            background: var(--accent-orange);
        }

        /* OWNER SPY BUTTON (Sadece Owner iÃ§in) */
        .owner-spy-btn {
            display: none;
        }

        /* Ã–ZEL SOHBET LÄ°STESÄ° PANELÄ° */
        .private-chats-panel {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 400;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-end;
        }

        .private-chat-minimized {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            box-shadow: var(--shadow-medium);
        }

        .private-chat-minimized:hover {
            transform: scale(1.1);
        }

        .private-chat-minimized .unread-badge {
            position: absolute;
            top: -3px;
            right: -3px;
            background: var(--accent-red);
            color: white;
            font-size: 10px;
            min-width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            border: 2px solid var(--bg-secondary);
        }

        /* ANA LAYOUT */
        .app-container {
            display: flex;
            height: calc(100vh - 60px);
        }

        /* KANAL LÄ°STESÄ° PANELÄ° */
        .channels-panel {
            width: 280px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-light);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .panel-header {
            padding: var(--spacing-md) var(--spacing-lg);
            border-bottom: 1px solid var(--border-light);
        }

        .panel-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .panel-subtitle {
            font-size: 13px;
            color: var(--text-tertiary);
        }

        .channel-list {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing-sm) var(--spacing-lg);
        }

        .channel-item {
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            background: var(--bg-tertiary);
            margin-bottom: var(--spacing-sm);
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 4px solid transparent;
        }

        .channel-item:hover {
            background: var(--bg-secondary);
            border-left-color: var(--accent-blue);
        }

        .channel-item.active {
            background: var(--bg-primary);
            border-left-color: var(--accent-purple);
        }

        .channel-name {
            font-weight: 600;
            font-size: 14px;
            color: var(--text-primary);
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .channel-topic {
            font-size: 12px;
            color: var(--text-tertiary);
            line-height: 1.4;
            margin-bottom: var(--spacing-xs);
        }

        .channel-stats {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: var(--text-muted);
        }

        .channel-type-badge {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            background: var(--bg-secondary);
            color: var(--text-secondary);
        }

        .channel-type-badge.general {
            background: rgba(139, 92, 246, 0.1);
            color: var(--accent-purple);
        }

        .channel-type-badge.user {
            background: rgba(59, 130, 246, 0.1);
            color: var(--accent-blue);
        }

        /* CHAT PANEL */
        .chat-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
            position: relative;
        }

        .chat-header {
            padding: 0 var(--spacing-lg);
            height: 60px;
            border-bottom: 1px solid var(--border-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--bg-secondary);
        }

        .chat-info h2 {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .chat-info p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .header-actions {
            display: flex;
            gap: var(--spacing-xs);
            align-items: center;
        }

        .notification-btn {
            position: relative;
            background: none;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .notification-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .notification-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: var(--accent-red);
            color: white;
            font-size: 10px;
            min-width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            border: 2px solid var(--bg-secondary);
        }

        /* YOUTUBE VÄ°DEO PANEL */
        .video-panel {
            width: 400px;
            background: #000;
            border-left: 1px solid var(--border-dark);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .video-header {
            padding: var(--spacing-md) var(--spacing-lg);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .video-header h3 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .video-header p {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.7);
        }

        .video-controls-header {
            display: flex;
            gap: var(--spacing-xs);
        }

        .video-container {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: #000;
        }

        .youtube-player {
            width: 100%;
            height: 100%;
            border: none;
        }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            padding: var(--spacing-lg);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .video-container:hover .video-overlay {
            opacity: 1;
        }

        .video-actions {
            position: absolute;
            bottom: var(--spacing-md);
            left: 0;
            right: 0;
            padding: 0 var(--spacing-lg);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .video-btn {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-md);
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            transition: background 0.2s;
        }

        .video-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .video-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .video-info {
            padding: var(--spacing-md) var(--spacing-lg);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .video-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .video-stats {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        /* KANAL YÃ–NETÄ°M MODAL */
        .channel-manage-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-overlay);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            backdrop-filter: blur(5px);
        }

        .channel-manage-modal.active {
            display: flex;
        }

        .channel-manage-container {
            width: 500px;
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            overflow: hidden;
            border: 1px solid var(--border-light);
            box-shadow: var(--shadow-heavy);
        }

        .channel-manage-header {
            padding: var(--spacing-lg);
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .channel-manage-content {
            padding: var(--spacing-lg);
            max-height: 60vh;
            overflow-y: auto;
        }

        .manage-section {
            margin-bottom: var(--spacing-xl);
        }

        .manage-section h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 1px solid var(--border-light);
        }

        .user-permission-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            margin-bottom: var(--spacing-xs);
        }

        .user-permission-info {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .permission-badge {
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 10px;
            font-weight: 500;
        }

        .permission-badge.owner {
            background: rgba(139, 92, 246, 0.1);
            color: var(--accent-purple);
        }

        .permission-badge.admin {
            background: rgba(59, 130, 246, 0.1);
            color: var(--accent-blue);
        }

        .permission-badge.coadmin {
            background: rgba(245, 158, 11, 0.1);
            color: var(--accent-orange);
        }

        .permission-badge.operator {
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent-green);
        }

        /* YOUTUBE VÄ°DEO SEÃ‡Ä°M MODAL */
        .youtube-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-overlay);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3001;
            backdrop-filter: blur(5px);
        }

        .youtube-modal.active {
            display: flex;
        }

        .youtube-container {
            width: 600px;
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            overflow: hidden;
            border: 1px solid var(--border-light);
            box-shadow: var(--shadow-heavy);
        }

        .youtube-header {
            padding: var(--spacing-lg);
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .youtube-content {
            padding: var(--spacing-lg);
        }

        .youtube-input-group {
            margin-bottom: var(--spacing-lg);
        }

        .youtube-input-label {
            display: block;
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 6px;
        }

        .youtube-url-input {
            width: 100%;
            padding: 12px var(--spacing-md);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 14px;
        }

        .youtube-url-input:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .youtube-note {
            background: var(--bg-tertiary);
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-lg);
        }

        .youtube-note i {
            color: var(--accent-red);
            margin-right: 6px;
        }

        /* OWNER PANEL */
        .owner-panel {
            position: fixed;
            top: 60px;
            right: 0;
            width: 500px;
            height: calc(100vh - 60px);
            background: var(--bg-secondary);
            border-left: 1px solid var(--border-light);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 501;
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow-heavy);
        }

        .owner-panel.active {
            transform: translateX(0);
        }

        .owner-header {
            padding: var(--spacing-lg);
            background: linear-gradient(135deg, #1a1a1a, #2a0a44);
            color: white;
            border-bottom: 1px solid rgba(139, 92, 246, 0.3);
        }

        .owner-content {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing-lg);
        }

        .owner-section {
            margin-bottom: var(--spacing-xl);
        }

        .owner-section h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 1px solid var(--border-light);
        }

        /* CHAT MESSAGES */
        .chat-messages {
            flex: 1;
            padding: var(--spacing-lg);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .message {
            display: flex;
            flex-direction: column;
            max-width: 80%;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message-incoming {
            align-self: flex-start;
        }

        .message-outgoing {
            align-self: flex-end;
            align-items: flex-end;
        }

        .message-sender {
            font-weight: 600;
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .message-outgoing .message-sender {
            color: var(--accent-blue);
        }

        .message-text {
            font-size: 14px;
            line-height: 1.5;
            color: var(--text-primary);
            padding: 8px 12px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            word-break: break-word;
        }

        .message-outgoing .message-text {
            background: var(--accent-blue);
            color: white;
        }

        .message-time {
            font-size: 11px;
            color: var(--text-tertiary);
            margin-top: 4px;
            text-align: right;
        }

        .message-system {
            text-align: center;
            font-size: 13px;
            color: var(--text-secondary);
            font-style: italic;
            padding: var(--spacing-sm) 0;
        }

        .message-media {
            margin-top: 8px;
            border-radius: var(--radius-md);
            overflow: hidden;
            max-width: 300px;
            cursor: pointer;
        }

        .message-media img {
            width: 100%;
            height: auto;
            display: block;
            border-radius: var(--radius-md);
        }

        .chat-input-area {
            padding: var(--spacing-lg);
            border-top: 1px solid var(--border-light);
            background: var(--bg-secondary);
        }

        .input-wrapper {
            display: flex;
            gap: var(--spacing-md);
            align-items: flex-end;
        }

        .message-input {
            flex: 1;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 14px;
            resize: none;
            min-height: 44px;
            max-height: 120px;
            outline: none;
            transition: all 0.2s ease;
        }

        .message-input:focus {
            border-color: var(--accent-blue);
            background: var(--bg-secondary);
        }

        .message-input::placeholder {
            color: var(--text-muted);
        }

        .send-btn {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            background: var(--accent-blue);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .send-btn:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* ACTION BUTTONS */
        .action-btn {
            padding: 8px 16px;
            border-radius: var(--radius-md);
            border: 1px solid var(--border-medium);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .action-btn:hover {
            background: var(--bg-tertiary);
        }

        .action-btn.primary {
            background: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        .action-btn.primary:hover {
            background: #2563eb;
        }

        .action-btn.danger {
            background: var(--accent-red);
            color: white;
            border-color: var(--accent-red);
        }

        .action-btn.danger:hover {
            background: #dc2626;
        }

        /* UTILITIES */
        .hidden {
            display: none !important;
        }

        /* SCROLLBAR */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-medium);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--border-dark);
        }
    </style>
</head>
<body class="night-mode">
    <!-- GÄ°RÄ°Åž EKRANI -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <div class="login-logo">P</div>
                <h1 class="login-title">Popbox Elite</h1>
                <p class="login-subtitle">Owner Sistem - TÃ¼m Yetkiler Mateky</p>
            </div>
            
            <input id="nickInput" class="login-input" type="text" placeholder="KullanÄ±cÄ± adÄ±" autofocus>
            <input id="passInput" class="login-input" type="password" placeholder="Åžifre (opsiyonel)">
            
            <button class="login-btn" onclick="handleLogin()">GiriÅŸ Yap</button>
            
            <div class="login-note">
                <p>Owner giriÅŸi: <strong>owner</strong> / <strong>password</strong></p>
                <p>Admin giriÅŸi: <strong>admin</strong> / <strong>admin123</strong></p>
                <p>Normal kullanÄ±cÄ±lar iÃ§in ÅŸifre opsiyonel</p>
                <p>Nick korumasÄ±: popbox â‰  Popbox â‰  POPBOX</p>
            </div>
        </div>
    </div>

    <!-- ANA UYGULAMA -->
    <div id="app" class="hidden">
        <!-- ÃœST BAR -->
        <div class="top-bar">
            <div class="logo">
                <div class="logo-icon">P</div>
                <span>Popbox Elite</span>
            </div>
            
            <!-- HÄ°KAYELER -->
            <div class="top-stories" id="topStories">
                <!-- Hikayeler buraya eklenecek -->
            </div>
            
            <div class="nav-controls">
                <button class="nav-btn owner-spy-btn" onclick="openOwnerSpyPanel()" title="TÃ¼m Ã–zel MesajlarÄ± GÃ¶r" id="ownerSpyBtn">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="nav-btn" onclick="openNewChannelModal()" title="Yeni Kanal AÃ§">
                    <i class="fas fa-plus"></i>
                </button>
                <button class="nav-btn" onclick="toggleTheme()" title="Tema deÄŸiÅŸtir">
                    <i class="fas fa-moon"></i>
                </button>
                <div class="theme-toggle" onclick="toggleTheme()"></div>
                <button class="nav-btn" id="ownerBtn" title="Owner Paneli" onclick="toggleOwnerPanel()">
                    <i class="fas fa-crown"></i>
                </button>
            </div>
        </div>

        <!-- ANA LAYOUT -->
        <div class="app-container">
            <!-- SOL PANEL - Kanallar -->
            <div class="channels-panel">
                <div class="panel-header">
                    <div class="panel-title">
                        Kanallar
                        <span class="online-count" id="channelCount">0</span>
                    </div>
                    <p class="panel-subtitle">Ã‡evrimiÃ§i: <span id="onlineUsersCount">0</span></p>
                </div>
                
                <div class="channel-list" id="channelList">
                    <!-- Kanallar buraya eklenecek -->
                </div>
            </div>

            <!-- ORTA PANEL - Sohbet -->
            <div class="chat-panel">
                <div class="chat-header">
                    <div class="chat-info">
                        <h2 id="currentChannelName">#Genel</h2>
                        <p id="currentChannelTopic">Owner ve Admin yÃ¶netir</p>
                    </div>
                    
                    <div class="header-actions">
                        <button class="action-btn" onclick="manageChannel()" id="manageChannelBtn" style="display: none;">
                            <i class="fas fa-cog"></i> Kanal YÃ¶netimi
                        </button>
                        <button class="notification-btn" onclick="toggleNotifications()" id="notificationBtn">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge" id="notificationBadge">0</span>
                        </button>
                    </div>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <!-- Mesajlar buraya eklenecek -->
                </div>
                
                <div class="chat-input-area">
                    <div class="input-wrapper">
                        <textarea class="message-input" id="messageInput" placeholder="Mesaj yazÄ±n (IRC komutlarÄ± iÃ§in / kullanÄ±n)..." rows="1"></textarea>
                        <button class="send-btn" onclick="sendMessage()" title="GÃ¶nder" id="sendBtn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SAÄž PANEL - YouTube Video -->
            <div class="video-panel">
                <div class="video-header">
                    <div>
                        <h3><i class="fab fa-youtube"></i> YouTube Video</h3>
                        <p id="videoStatus">Popbox Music - Otomatik</p>
                    </div>
                    <div class="video-controls-header">
                        <button class="video-btn" onclick="openYoutubeModal()" id="changeVideoBtn" title="Video DeÄŸiÅŸtir">
                            <i class="fas fa-sync"></i>
                        </button>
                        <button class="video-btn" onclick="toggleLiveStream()" id="liveStreamBtn" title="CanlÄ± YayÄ±n BaÅŸlat">
                            <i class="fas fa-video"></i>
                        </button>
                    </div>
                </div>
                
                <div class="video-container">
                    <iframe id="youtubePlayer" class="youtube-player"
                            src="https://www.youtube.com/embed/videoseries?list=PLDIoUAh99Tm1z2pNUNdW2S6g_3jJC9UbH&autoplay=1&mute=1"
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen>
                    </iframe>
                    
                    <div class="video-overlay">
                        <div style="font-size: 24px; margin-bottom: var(--spacing-md);">
                            <i class="fab fa-youtube"></i>
                        </div>
                        <h3 style="margin-bottom: var(--spacing-sm);">YouTube Video</h3>
                        <p style="color: rgba(255,255,255,0.8); max-width: 300px;">
                            Sadece YouTube videolarÄ± yayÄ±nlanÄ±r
                        </p>
                    </div>
                    
                    <div class="video-actions">
                        <div style="color: white; font-size: 12px;">
                            <span id="currentVideoTitle">Popbox Music Playlist</span>
                        </div>
                    </div>
                </div>
                
                <div class="video-info">
                    <div class="video-title" id="videoTitle">Popbox Music - Chill Stream</div>
                    <div class="video-stats">
                        <span>ðŸŽµ YouTube</span>
                        <span id="videoControlInfo">Kanal YÃ¶neticisi DeÄŸiÅŸtirebilir</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- OWNER PANEL -->
        <div class="owner-panel" id="ownerPanel">
            <div class="owner-header">
                <div>
                    <div style="background: var(--accent-purple); color: white; padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600; display: inline-block; margin-bottom: 8px;">
                        OWNER MODE
                    </div>
                    <h3>Owner YÃ¶netim Paneli</h3>
                    <p>mateky - TÃ¼m Yetkiler</p>
                </div>
                <button class="nav-btn" onclick="toggleOwnerPanel()" style="background: rgba(255,255,255,0.1); color: white;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="owner-content">
                <div class="owner-section">
                    <h4><i class="fas fa-eye"></i> TÃ¼m Ã–zel MesajlarÄ± GÃ¶r</h4>
                    <div style="background: var(--bg-tertiary); padding: var(--spacing-md); border-radius: var(--radius-md); min-height: 200px; max-height: 300px; overflow-y: auto;" id="ownerSpyContent">
                        <!-- TÃ¼m Ã¶zel mesajlar burada -->
                    </div>
                </div>
                
                <div class="owner-section">
                    <h4><i class="fas fa-user-shield"></i> Admin YÃ¶netimi</h4>
                    <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap;">
                        <button class="action-btn primary" onclick="promoteToAdmin()">
                            <i class="fas fa-user-plus"></i> Admin Ata
                        </button>
                        <button class="action-btn danger" onclick="demoteAdmin()">
                            <i class="fas fa-user-minus"></i> Admin Sil
                        </button>
                    </div>
                </div>
                
                <div class="owner-section">
                    <h4><i class="fas fa-robot"></i> MATE Bot KontrolÃ¼</h4>
                    <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap;">
                        <button class="action-btn" onclick="addIRCCommand()">
                            <i class="fas fa-plus"></i> IRC Komutu Ekle
                        </button>
                        <button class="action-btn" onclick="removeIRCCommand()">
                            <i class="fas fa-minus"></i> IRC Komutu Sil
                        </button>
                        <button class="action-btn" onclick="mateBotMessage()">
                            <i class="fas fa-comment"></i> MATE MesajÄ±
                        </button>
                    </div>
                </div>
                
                <div class="owner-section">
                    <h4><i class="fas fa-flag"></i> Åžikayetler</h4>
                    <div style="background: var(--bg-tertiary); padding: var(--spacing-md); border-radius: var(--radius-md); min-height: 100px; max-height: 200px; overflow-y: auto;" id="complaintsList">
                        <!-- Åžikayetler burada -->
                    </div>
                </div>
            </div>
        </div>

        <!-- KANAL YÃ–NETÄ°M MODAL -->
        <div class="channel-manage-modal" id="channelManageModal">
            <div class="channel-manage-container">
                <div class="channel-manage-header">
                    <div>
                        <h3>Kanal YÃ¶netimi</h3>
                        <p id="manageModalTitle">#Genel</p>
                    </div>
                    <button class="nav-btn" onclick="closeChannelManageModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="channel-manage-content">
                    <div class="manage-section">
                        <h4>KullanÄ±cÄ± Ä°zinleri</h4>
                        <div id="userPermissionsList">
                            <!-- KullanÄ±cÄ± izinleri burada -->
                        </div>
                    </div>
                    
                    <div class="manage-section">
                        <h4>Kanal AyarlarÄ±</h4>
                        <div style="display: flex; flex-direction: column; gap: var(--spacing-md);">
                            <div>
                                <label style="display: block; font-size: 13px; color: var(--text-secondary); margin-bottom: 6px;">Kanal Konusu</label>
                                <input type="text" id="channelTopicInput" class="youtube-url-input" placeholder="Kanal konusu...">
                            </div>
                            
                            <div style="display: flex; gap: var(--spacing-sm);">
                                <button class="action-btn primary" onclick="saveChannelSettings()" style="flex: 1;">
                                    Kaydet
                                </button>
                                <button class="action-btn danger" onclick="deleteChannel()" id="deleteChannelBtn" style="flex: 1;">
                                    KanalÄ± Sil
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- YOUTUBE VÄ°DEO MODAL -->
        <div class="youtube-modal" id="youtubeModal">
            <div class="youtube-container">
                <div class="youtube-header">
                    <div>
                        <h3>YouTube Video DeÄŸiÅŸtir</h3>
                        <p>Sadece YouTube videolarÄ±</p>
                    </div>
                    <button class="nav-btn" onclick="closeYoutubeModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="youtube-content">
                    <div class="youtube-input-group">
                        <label class="youtube-input-label">YouTube Video URL veya Embed Linki</label>
                        <input type="text" id="youtubeUrlInput" class="youtube-url-input" placeholder="https://www.youtube.com/embed/..." value="https://www.youtube.com/embed/videoseries?list=PLDIoUAh99Tm1z2pNUNdW2S6g_3jJC9UbH">
                    </div>
                    
                    <div class="youtube-note">
                        <i class="fas fa-exclamation-triangle"></i>
                        <strong>Ã–nemli:</strong> Sadece YouTube embed linkleri kabul edilir. Ã–rnek: https://www.youtube.com/embed/videoID
                    </div>
                    
                    <div style="display: flex; gap: var(--spacing-sm); justify-content: flex-end;">
                        <button class="action-btn" onclick="closeYoutubeModal()">
                            Ä°ptal
                        </button>
                        <button class="action-btn primary" onclick="changeVideo()">
                            Video DeÄŸiÅŸtir
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== SÄ°STEM DEÄžÄ°ÅžKENLERÄ° ====================
        let currentUser = null;
        let godMode = false;
        let channels = [];
        let currentChannel = null;
        let users = [];
        let stories = [];
        let privateMessages = {};
        let complaints = [];
        let ircCommands = [];
        let nickRegistry = new Map();
        let userProfilePhotos = {};
        let notifications = [];
        let currentVideoUrl = "https://www.youtube.com/embed/videoseries?list=PLDIoUAh99Tm1z2pNUNdW2S6g_3jJC9UbH";
        let isLiveStream = false;
        let liveStreamUrl = "";

        // ==================== BAÅžLANGIÃ‡ VERÄ°LERÄ° ====================
        function initializeSystem() {
            // Temel kanallar
            channels = [
                {
                    id: 1,
                    name: "#Genel",
                    topic: "Owner ve Admin yÃ¶netir",
                    type: "general",
                    owner: "system",
                    admins: ["owner", "admin"],
                    coadmins: [],
                    operators: [],
                    users: [],
                    messages: [],
                    youtubeUrl: "https://www.youtube.com/embed/videoseries?list=PLDIoUAh99Tm1z2pNUNdW2S6g_3jJC9UbH",
                    videoTitle: "Popbox Music Playlist",
                    isLive: false,
                    liveUrl: "",
                    createdAt: new Date()
                }
            ];
            
            // Temel kullanÄ±cÄ±lar
            users = [
                { 
                    id: 1, 
                    name: "owner", 
                    role: "owner", 
                    online: true,
                    messages: 0,
                    stories: 0,
                    followers: 0,
                    following: 0,
                    channels: [],
                    isBot: false
                },
                { 
                    id: 2, 
                    name: "admin", 
                    role: "admin", 
                    online: false,
                    messages: 0,
                    stories: 0,
                    followers: 0,
                    following: 0,
                    channels: [],
                    isBot: false
                },
                { 
                    id: 3, 
                    name: "MATE", 
                    role: "security", 
                    online: true,
                    messages: 0,
                    stories: 0,
                    followers: 0,
                    following: 0,
                    channels: [],
                    isBot: true
                }
            ];
            
            // IRC komutlarÄ±
            ircCommands = [
                { command: "/join", description: "Kanala katÄ±l", example: "/join #kanal" },
                { command: "/part", description: "Kanaldan ayrÄ±l", example: "/part #kanal" },
                { command: "/msg", description: "Ã–zel mesaj gÃ¶nder", example: "/msg kullanici mesaj" },
                { command: "/whois", description: "KullanÄ±cÄ± bilgisi", example: "/whois kullanici" },
                { command: "/kick", description: "KullanÄ±cÄ±yÄ± at (admin/owner)", example: "/kick kullanici sebep" },
                { command: "/ban", description: "KullanÄ±cÄ±yÄ± yasakla (admin/owner)", example: "/ban kullanici sebep" },
                { command: "/topic", description: "Kanal konusunu deÄŸiÅŸtir", example: "/topic yeni konu" },
                { command: "/op", description: "OperatÃ¶r yetkisi ver (admin/owner)", example: "/op kullanici" },
                { command: "/deop", description: "OperatÃ¶r yetkisini al (admin/owner)", example: "/deop kullanici" },
                { command: "/nick", description: "Nick deÄŸiÅŸtir", example: "/nick yeni_nick" }
            ];
            
            // Nick registry'yi doldur
            users.forEach(user => {
                nickRegistry.set(user.name.toLowerCase(), user.name);
            });
            
            currentChannel = channels[0];
            updateChannelsList();
            updateChat();
            updateVideoControls();
            
            // Kanala kullanÄ±cÄ±yÄ± ekle
            if (!currentChannel.users.includes(currentUser.name)) {
                currentChannel.users.push(currentUser.name);
            }
            
            // HoÅŸ geldin mesajÄ±
            addSystemMessage(`${currentUser.name} kanala katÄ±ldÄ±.`);
            
            if (godMode) {
                addSystemMessage("ðŸ”’ OWNER MODE: TÃ¼m yetkiler aktif. mateky sistemin sahibidir.");
                document.getElementById('ownerSpyBtn').style.display = 'flex';
            }
            
            if (currentUser.role === "admin") {
                addSystemMessage("ðŸ” ADMIN MODE: Sistem yÃ¶netimi aktif.");
            }
            
            // MATE bot mesajÄ±
            setTimeout(() => {
                mateBotMessage(`HoÅŸ geldin ${currentUser.name}! MATE gÃ¼venlik botu olarak buradayÄ±m.`);
            }, 1000);
        }

        // ==================== GÄ°RÄ°Åž SÄ°STEMÄ° ====================
        function handleLogin() {
            const nickInput = document.getElementById('nickInput');
            const passInput = document.getElementById('passInput');
            
            let nick = nickInput.value.trim();
            const pass = passInput.value;
            
            if (!nick) {
                alert('KullanÄ±cÄ± adÄ± gerekli!');
                return;
            }
            
            // Nick korumasÄ± (bÃ¼yÃ¼k/kÃ¼Ã§Ã¼k harf duyarlÄ±)
            const normalizedNick = nick.toLowerCase();
            
            // Owner kontrolÃ¼
            if (normalizedNick === "owner" && pass === "password") {
                godMode = true;
                currentUser = users.find(u => u.name === "owner");
                currentUser.online = true;
            } 
            // Admin kontrolÃ¼
            else if (normalizedNick === "admin" && pass === "admin123") {
                currentUser = users.find(u => u.name === "admin");
                currentUser.online = true;
            }
            // Normal kullanÄ±cÄ±
            else {
                // Nick'in daha Ã¶nce alÄ±nÄ±p alÄ±nmadÄ±ÄŸÄ±nÄ± kontrol et
                const registeredNick = nickRegistry.get(normalizedNick);
                if (registeredNick && registeredNick !== nick) {
                    alert(`Bu nick zaten alÄ±nmÄ±ÅŸ! LÃ¼tfen baÅŸka bir nick seÃ§in.\nKayÄ±tlÄ±: ${registeredNick}`);
                    return;
                }
                
                // Mevcut kullanÄ±cÄ±yÄ± bul veya yeni oluÅŸtur
                let user = users.find(u => u.name.toLowerCase() === normalizedNick && u.id > 2);
                
                if (user) {
                    if (pass && pass !== user.password) {
                        alert('Åžifre yanlÄ±ÅŸ!');
                        return;
                    }
                    user.online = true;
                    currentUser = user;
                } else {
                    // Yeni kullanÄ±cÄ± oluÅŸtur
                    currentUser = {
                        id: users.length + 1,
                        name: nick,
                        role: "user",
                        online: true,
                        messages: 0,
                        stories: 0,
                        followers: 0,
                        following: 0,
                        channels: [],
                        password: pass || "",
                        isBot: false
                    };
                    users.push(currentUser);
                    nickRegistry.set(normalizedNick, nick);
                }
            }
            
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            
            initializeSystem();
        }

        // ==================== KANAL SÄ°STEMÄ° ====================
        function updateChannelsList() {
            const channelList = document.getElementById('channelList');
            const channelCount = document.getElementById('channelCount');
            const onlineUsersCount = document.getElementById('onlineUsersCount');
            
            channelList.innerHTML = '';
            
            // Ã‡evrimiÃ§i kullanÄ±cÄ± sayÄ±sÄ±nÄ± hesapla
            const onlineUsers = users.filter(u => u.online && !u.isBot).length;
            onlineUsersCount.textContent = onlineUsers;
            channelCount.textContent = channels.length;
            
            channels.forEach(channel => {
                const channelDiv = document.createElement('div');
                channelDiv.className = `channel-item ${channel.id === currentChannel.id ? 'active' : ''}`;
                channelDiv.onclick = () => switchChannel(channel.id);
                
                // Kanal sahibi/admine Ã¶zel badge
                let badgeClass = "channel-type-badge user";
                let badgeText = "KullanÄ±cÄ±";
                
                if (channel.type === "general") {
                    badgeClass = "channel-type-badge general";
                    badgeText = "Genel";
                }
                
                channelDiv.innerHTML = `
                    <div class="channel-name">
                        ${channel.name}
                        <span class="${badgeClass}">${badgeText}</span>
                    </div>
                    <div class="channel-topic">${channel.topic}</div>
                    <div class="channel-stats">
                        <span>ðŸ‘¥ ${channel.users.length}</span>
                        <span>ðŸ’¬ ${channel.messages.length}</span>
                        ${channel.owner === currentUser.name ? '<span style="color: var(--accent-orange);">â­ Sahip</span>' : ''}
                    </div>
                `;
                
                channelList.appendChild(channelDiv);
            });
        }

        function switchChannel(channelId) {
            currentChannel = channels.find(c => c.id === channelId);
            document.getElementById('currentChannelName').textContent = currentChannel.name;
            document.getElementById('currentChannelTopic').textContent = currentChannel.topic;
            
            // YouTube video gÃ¼ncelle
            if (currentChannel.youtubeUrl) {
                document.getElementById('youtubePlayer').src = currentChannel.youtubeUrl + "&autoplay=1&mute=1";
                document.getElementById('currentVideoTitle').textContent = currentChannel.videoTitle || "YouTube Video";
                document.getElementById('videoTitle').textContent = currentChannel.videoTitle || "YouTube Video";
            }
            
            // Video kontrol butonlarÄ±nÄ± gÃ¼ncelle
            updateVideoControls();
            
            // Kanal yÃ¶netim butonunu gÃ¶ster/gizle
            const manageBtn = document.getElementById('manageChannelBtn');
            if (canManageChannel()) {
                manageBtn.style.display = 'flex';
            } else {
                manageBtn.style.display = 'none';
            }
            
            updateChat();
            updateChannelsList();
        }

        function openNewChannelModal() {
            const channelName = prompt("Kanal adÄ± (Ã¶rn: #muzik, #sohbet):");
            if (!channelName || !channelName.startsWith('#')) {
                alert("Kanal adÄ± # ile baÅŸlamalÄ±dÄ±r!");
                return;
            }
            
            if (channels.some(c => c.name === channelName)) {
                alert("Bu kanal zaten var!");
                return;
            }
            
            const newChannel = {
                id: channels.length + 1,
                name: channelName,
                topic: `${currentUser.name} tarafÄ±ndan oluÅŸturuldu`,
                type: "user",
                owner: currentUser.name,
                admins: [],
                coadmins: [currentUser.name], // Kanal sahibi otomatik co-admin
                operators: [],
                users: [currentUser.name],
                messages: [],
                youtubeUrl: "https://www.youtube.com/embed/videoseries?list=PLDIoUAh99Tm1z2pNUNdW2S6g_3jJC9UbH",
                videoTitle: "Popbox Music Playlist",
                isLive: false,
                liveUrl: "",
                createdAt: new Date()
            };
            
            channels.push(newChannel);
            
            // KullanÄ±cÄ±nÄ±n kanal listesine ekle
            currentUser.channels.push(channelName);
            
            switchChannel(newChannel.id);
            addSystemMessage(`Kanal oluÅŸturuldu: ${channelName}`);
            addSystemMessage(`${currentUser.name} bu kanalÄ±n co-admin'i oldu.`);
            
            mateBotMessage(`ðŸ“¢ ${currentUser.name} yeni kanal aÃ§tÄ±: ${channelName}`);
        }

        function canManageChannel() {
            if (godMode) return true;
            if (currentUser.role === "admin") return true;
            if (currentChannel.owner === currentUser.name) return true;
            if (currentChannel.admins.includes(currentUser.name)) return true;
            if (currentChannel.coadmins.includes(currentUser.name)) return true;
            return false;
        }

        function canChangeVideo() {
            if (godMode) return true;
            if (currentUser.role === "admin") return true;
            if (currentChannel.owner === currentUser.name) return true;
            if (currentChannel.coadmins.includes(currentUser.name)) return true;
            return false;
        }

        function manageChannel() {
            if (!canManageChannel()) {
                alert("Bu kanalÄ± yÃ¶netme yetkiniz yok!");
                return;
            }
            
            document.getElementById('manageModalTitle').textContent = currentChannel.name;
            document.getElementById('channelTopicInput').value = currentChannel.topic;
            
            // Silme butonunu sadece owner/admin veya kanal sahibi gÃ¶rebilir
            const deleteBtn = document.getElementById('deleteChannelBtn');
            if (godMode || currentUser.role === "admin" || currentChannel.owner === currentUser.name) {
                deleteBtn.style.display = 'block';
            } else {
                deleteBtn.style.display = 'none';
            }
            
            updateUserPermissionsList();
            document.getElementById('channelManageModal').classList.add('active');
        }

        function updateUserPermissionsList() {
            const permissionsList = document.getElementById('userPermissionsList');
            permissionsList.innerHTML = '';
            
            // TÃ¼m kullanÄ±cÄ±larÄ± listele
            users.forEach(user => {
                if (user.isBot) return;
                
                const userDiv = document.createElement('div');
                userDiv.className = 'user-permission-item';
                
                let permission = "Ãœye";
                let badgeClass = "";
                
                if (currentChannel.owner === user.name) {
                    permission = "Sahip";
                    badgeClass = "permission-badge owner";
                } else if (currentChannel.admins.includes(user.name)) {
                    permission = "Admin";
                    badgeClass = "permission-badge admin";
                } else if (currentChannel.coadmins.includes(user.name)) {
                    permission = "Coadmin";
                    badgeClass = "permission-badge coadmin";
                } else if (currentChannel.operators.includes(user.name)) {
                    permission = "Operator";
                    badgeClass = "permission-badge operator";
                }
                
                userDiv.innerHTML = `
                    <div class="user-permission-info">
                        <div style="font-weight: 500;">${user.name}</div>
                        <div class="${badgeClass}">${permission}</div>
                    </div>
                    <div>
                        ${canChangeUserPermission(user.name) ? 
                            `<button class="action-btn" onclick="changeUserPermission('${user.name}')" style="padding: 4px 8px; font-size: 12px;">
                                DeÄŸiÅŸtir
                            </button>` : 
                            ''
                        }
                    </div>
                `;
                
                permissionsList.appendChild(userDiv);
            });
        }

        function canChangeUserPermission(targetUser) {
            if (godMode) return true;
            if (currentUser.role === "admin") return true;
            if (currentChannel.owner === currentUser.name) return true;
            if (currentUser.name === targetUser) return false; // Kendi iznini deÄŸiÅŸtiremez
            return false;
        }

        function changeUserPermission(userName) {
            if (!canChangeUserPermission(userName)) {
                alert("Bu kullanÄ±cÄ±nÄ±n iznini deÄŸiÅŸtirme yetkiniz yok!");
                return;
            }
            
            const user = users.find(u => u.name === userName);
            if (!user) return;
            
            const currentPerm = getCurrentPermission(userName);
            const newPerm = prompt(
                `${userName} iÃ§in yeni izin seviyesi:\n1. Ãœye\n2. Operator\n3. Coadmin\n4. Admin\n\nMevcut: ${currentPerm}`,
                currentPerm
            );
            
            if (!newPerm) return;
            
            // Eski izinleri kaldÄ±r
            currentChannel.coadmins = currentChannel.coadmins.filter(u => u !== userName);
            currentChannel.operators = currentChannel.operators.filter(u => u !== userName);
            currentChannel.admins = currentChannel.admins.filter(u => u !== userName);
            
            // Yeni izni ekle
            switch(newPerm.toLowerCase()) {
                case "admin":
                    if (godMode || currentUser.role === "admin" || currentChannel.owner === currentUser.name) {
                        currentChannel.admins.push(userName);
                        addSystemMessage(`${userName} artÄ±k bu kanalda admin.`);
                    }
                    break;
                case "coadmin":
                    currentChannel.coadmins.push(userName);
                    addSystemMessage(`${userName} artÄ±k bu kanalda coadmin.`);
                    break;
                case "operator":
                    currentChannel.operators.push(userName);
                    addSystemMessage(`${userName} artÄ±k bu kanalda operator.`);
                    break;
                case "Ã¼ye":
                    addSystemMessage(`${userName} artÄ±k sadece Ã¼ye.`);
                    break;
            }
            
            updateUserPermissionsList();
        }

        function getCurrentPermission(userName) {
            if (currentChannel.owner === userName) return "Sahip";
            if (currentChannel.admins.includes(userName)) return "Admin";
            if (currentChannel.coadmins.includes(userName)) return "Coadmin";
            if (currentChannel.operators.includes(userName)) return "Operator";
            return "Ãœye";
        }

        function saveChannelSettings() {
            const newTopic = document.getElementById('channelTopicInput').value.trim();
            if (newTopic) {
                currentChannel.topic = newTopic;
                document.getElementById('currentChannelTopic').textContent = newTopic;
                addSystemMessage(`${currentUser.name} kanal konusunu deÄŸiÅŸtirdi: ${newTopic}`);
            }
            
            closeChannelManageModal();
        }

        function deleteChannel() {
            if (!godMode && currentUser.role !== "admin" && currentChannel.owner !== currentUser.name) {
                alert("Bu kanalÄ± silme yetkiniz yok!");
                return;
            }
            
            if (currentChannel.type === "general") {
                alert("Genel kanal silinemez!");
                return;
            }
            
            if (confirm(`"${currentChannel.name}" kanalÄ±nÄ± silmek istediÄŸinize emin misiniz?`)) {
                const channelIndex = channels.findIndex(c => c.id === currentChannel.id);
                channels.splice(channelIndex, 1);
                
                // Genel kanala geÃ§
                switchChannel(1);
                addSystemMessage(`"${currentChannel.name}" kanalÄ± silindi.`);
                mateBotMessage(`ðŸ—‘ï¸ ${currentUser.name} "${currentChannel.name}" kanalÄ±nÄ± sildi.`);
                
                closeChannelManageModal();
            }
        }

        function closeChannelManageModal() {
            document.getElementById('channelManageModal').classList.remove('active');
        }

        // ==================== YOUTUBE VÄ°DEO SÄ°STEMÄ° ====================
        function updateVideoControls() {
            const changeVideoBtn = document.getElementById('changeVideoBtn');
            const liveStreamBtn = document.getElementById('liveStreamBtn');
            const videoControlInfo = document.getElementById('videoControlInfo');
            const videoStatus = document.getElementById('videoStatus');
            
            if (canChangeVideo()) {
                changeVideoBtn.classList.remove('disabled');
                liveStreamBtn.classList.remove('disabled');
                videoControlInfo.textContent = "Kanal YÃ¶neticisi DeÄŸiÅŸtirebilir";
                
                if (currentChannel.isLive) {
                    videoStatus.textContent = `${currentChannel.owner} - CanlÄ± YayÄ±n`;
                    liveStreamBtn.innerHTML = '<i class="fas fa-stop"></i>';
                } else {
                    videoStatus.textContent = currentChannel.videoTitle || "YouTube Video";
                    liveStreamBtn.innerHTML = '<i class="fas fa-video"></i>';
                }
            } else {
                changeVideoBtn.classList.add('disabled');
                liveStreamBtn.classList.add('disabled');
                videoControlInfo.textContent = "Sadece YÃ¶neticiler DeÄŸiÅŸtirebilir";
                
                if (currentChannel.isLive) {
                    videoStatus.textContent = `${currentChannel.owner} - CanlÄ± YayÄ±n`;
                } else {
                    videoStatus.textContent = "YouTube Video (Salt Okunur)";
                }
            }
        }

        function openYoutubeModal() {
            if (!canChangeVideo()) {
                alert("Video deÄŸiÅŸtirme yetkiniz yok! Sadece kanal yÃ¶neticileri video deÄŸiÅŸtirebilir.");
                return;
            }
            
            document.getElementById('youtubeUrlInput').value = currentChannel.youtubeUrl || "https://www.youtube.com/embed/videoseries?list=PLDIoUAh99Tm1z2pNUNdW2S6g_3jJC9UbH";
            document.getElementById('youtubeModal').classList.add('active');
        }

        function closeYoutubeModal() {
            document.getElementById('youtubeModal').classList.remove('active');
        }

        function changeVideo() {
            const youtubeUrl = document.getElementById('youtubeUrlInput').value.trim();
            
            if (!youtubeUrl) {
                alert("YouTube URL'si gerekli!");
                return;
            }
            
            // YouTube URL kontrolÃ¼
            if (!youtubeUrl.includes('youtube.com/embed') && !youtubeUrl.includes('youtu.be/')) {
                alert("GeÃ§erli bir YouTube embed linki girin! Ã–rnek: https://www.youtube.com/embed/videoID");
                return;
            }
            
            // Embed formatÄ±na Ã§evir
            let embedUrl = youtubeUrl;
            if (youtubeUrl.includes('youtu.be/')) {
                const videoId = youtubeUrl.split('youtu.be/')[1].split('?')[0];
                embedUrl = `https://www.youtube.com/embed/${videoId}`;
            }
            
            currentChannel.youtubeUrl = embedUrl + "&autoplay=1&mute=1";
            currentChannel.videoTitle = prompt("Video baÅŸlÄ±ÄŸÄ±:", "YouTube Video") || "YouTube Video";
            currentChannel.isLive = false;
            
            // GÃ¼ncelle
            document.getElementById('youtubePlayer').src = currentChannel.youtubeUrl;
            document.getElementById('currentVideoTitle').textContent = currentChannel.videoTitle;
            document.getElementById('videoTitle').textContent = currentChannel.videoTitle;
            document.getElementById('videoStatus').textContent = currentChannel.videoTitle;
            
            addSystemMessage(`${currentUser.name} video deÄŸiÅŸtirdi: ${currentChannel.videoTitle}`);
            mateBotMessage(`ðŸŽ¬ ${currentUser.name} "${currentChannel.name}" kanalÄ±nda video deÄŸiÅŸtirdi.`);
            
            closeYoutubeModal();
        }

        function toggleLiveStream() {
            if (!canChangeVideo()) {
                alert("CanlÄ± yayÄ±n yapma yetkiniz yok! Sadece kanal yÃ¶neticileri canlÄ± yayÄ±n yapabilir.");
                return;
            }
            
            if (currentChannel.isLive) {
                // CanlÄ± yayÄ±nÄ± durdur
                currentChannel.isLive = false;
                document.getElementById('youtubePlayer').src = currentChannel.youtubeUrl;
                document.getElementById('videoStatus').textContent = currentChannel.videoTitle;
                document.getElementById('liveStreamBtn').innerHTML = '<i class="fas fa-video"></i>';
                
                addSystemMessage(`${currentUser.name} canlÄ± yayÄ±nÄ± sonlandÄ±rdÄ±.`);
                mateBotMessage(`ðŸ“¡ ${currentUser.name} "${currentChannel.name}" kanalÄ±nda canlÄ± yayÄ±nÄ± sonlandÄ±rdÄ±.`);
            } else {
                // CanlÄ± yayÄ±n baÅŸlat
                const streamUrl = prompt("CanlÄ± yayÄ±n URL'si (YouTube Live):", "https://www.youtube.com/embed/live_stream?channel=UCXXXXX");
                
                if (streamUrl && streamUrl.includes('youtube.com/embed')) {
                    currentChannel.isLive = true;
                    currentChannel.liveUrl = streamUrl + "&autoplay=1&mute=1";
                    document.getElementById('youtubePlayer').src = currentChannel.liveUrl;
                    document.getElementById('videoStatus').textContent = `${currentUser.name} - CanlÄ± YayÄ±n`;
                    document.getElementById('liveStreamBtn').innerHTML = '<i class="fas fa-stop"></i>';
                    
                    addSystemMessage(`${currentUser.name} canlÄ± yayÄ±n baÅŸlattÄ±!`);
                    mateBotMessage(`ðŸŽ¥ ${currentUser.name} "${currentChannel.name}" kanalÄ±nda canlÄ± yayÄ±n baÅŸlattÄ±!`);
                }
            }
        }

        // ==================== SOHBET SÄ°STEMÄ° ====================
        function updateChat() {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML = '';
            
            currentChannel.messages.forEach(msg => {
                addMessageToChat(msg);
            });
        }

        function addMessageToChat(message) {
            const chatMessages = document.getElementById('chatMessages');
            
            if (message.type === 'system') {
                const systemDiv = document.createElement('div');
                systemDiv.className = 'message-system';
                systemDiv.textContent = `ðŸ“¢ ${message.text}`;
                chatMessages.appendChild(systemDiv);
            } else {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${message.sender === currentUser.name ? 'message-outgoing' : 'message-incoming'}`;
                
                const timeStr = message.time ? 
                    new Date(message.time).toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' }) : 
                    'ÅŸimdi';
                
                messageDiv.innerHTML = `
                    <div class="message-sender">${message.sender}</div>
                    <div class="message-text">${message.text}</div>
                    <div class="message-time">${timeStr}</div>
                `;
                
                chatMessages.appendChild(messageDiv);
            }
            
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function addSystemMessage(text) {
            const message = {
                type: 'system',
                text: text,
                time: new Date(),
                sender: 'System'
            };
            
            currentChannel.messages.push(message);
            addMessageToChat(message);
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            // IRC komutu kontrolÃ¼
            if (text.startsWith('/')) {
                handleIRCCommand(text);
                input.value = '';
                return;
            }
            
            const message = {
                type: 'user',
                sender: currentUser.name,
                text: text,
                time: new Date()
            };
            
            currentChannel.messages.push(message);
            addMessageToChat(message);
            input.value = '';
            
            // Mesaj sayÄ±sÄ±nÄ± gÃ¼ncelle
            currentUser.messages++;
            
            // MATE bot gÃ¼venlik kontrolÃ¼
            if (text.toLowerCase().includes('ÅŸikayet') || text.toLowerCase().includes('report')) {
                addNotification(`ðŸš¨ ${currentUser.name} ÅŸikayet iÃ§eren mesaj gÃ¶nderdi.`);
            }
        }

        // ==================== IRC KOMUT Ä°ÅžLEME ====================
        function handleIRCCommand(command) {
            const parts = command.split(' ');
            const cmd = parts[0].toLowerCase();
            const args = parts.slice(1);
            
            switch(cmd) {
                case '/join':
                    if (args.length < 1) {
                        alert("KullanÄ±m: /join #kanal");
                        return;
                    }
                    const channelName = args[0];
                    const channel = channels.find(c => c.name === channelName);
                    if (channel) {
                        switchChannel(channel.id);
                        if (!channel.users.includes(currentUser.name)) {
                            channel.users.push(currentUser.name);
                            updateChannelsList();
                            addSystemMessage(`${currentUser.name} kanala katÄ±ldÄ±.`);
                        }
                    } else {
                        alert("Kanal bulunamadÄ±!");
                    }
                    break;
                    
                case '/part':
                    if (currentChannel.type === "general") {
                        alert("Genel kanaldan ayrÄ±lamazsÄ±nÄ±z!");
                        return;
                    }
                    currentChannel.users = currentChannel.users.filter(u => u !== currentUser.name);
                    addSystemMessage(`${currentUser.name} kanaldan ayrÄ±ldÄ±.`);
                    switchChannel(1);
                    break;
                    
                case '/msg':
                    if (args.length < 2) {
                        alert("KullanÄ±m: /msg kullanici mesaj");
                        return;
                    }
                    const targetUser = args[0];
                    const msg = args.slice(1).join(' ');
                    
                    if (!privateMessages[targetUser]) {
                        privateMessages[targetUser] = [];
                    }
                    
                    privateMessages[targetUser].push({
                        from: currentUser.name,
                        to: targetUser,
                        message: msg,
                        time: new Date()
                    });
                    
                    alert(`Ã–zel mesaj gÃ¶nderildi: ${targetUser} - ${msg}`);
                    addNotification(`ðŸ“© ${targetUser} kullanÄ±cÄ±sÄ±na Ã¶zel mesaj gÃ¶nderildi.`);
                    break;
                    
                case '/whois':
                    if (args.length < 1) {
                        alert("KullanÄ±m: /whois kullanici");
                        return;
                    }
                    const user = users.find(u => u.name.toLowerCase() === args[0].toLowerCase());
                    if (user) {
                        alert(`
KullanÄ±cÄ±: ${user.name}
Rol: ${user.role}
Durum: ${user.online ? 'ðŸŸ¢ Ã‡evrimiÃ§i' : 'âš« Ã‡evrimdÄ±ÅŸÄ±'}
Mesaj: ${user.messages}
Hikaye: ${user.stories}
TakipÃ§i: ${user.followers}
Takip: ${user.following}
${user.isBot ? 'ðŸ¤– Sistem Botu' : ''}
                        `);
                    } else {
                        alert("KullanÄ±cÄ± bulunamadÄ±!");
                    }
                    break;
                    
                case '/kick':
                    if (!canManageChannel()) {
                        alert("Bu komut iÃ§in yetkiniz yok!");
                        return;
                    }
                    if (args.length < 1) {
                        alert("KullanÄ±m: /kick kullanici [sebep]");
                        return;
                    }
                    const kickUser = args[0];
                    const kickReason = args.slice(1).join(' ') || 'Sebep belirtilmedi';
                    
                    currentChannel.users = currentChannel.users.filter(u => u !== kickUser);
                    addSystemMessage(`${kickUser} kanaldan atÄ±ldÄ±. Sebep: ${kickReason}`);
                    mateBotMessage(`ðŸšª ${currentUser.name}, ${kickUser} kullanÄ±cÄ±sÄ±nÄ± "${currentChannel.name}" kanalÄ±ndan attÄ±.`);
                    break;
                    
                case '/ban':
                    if (!canManageChannel()) {
                        alert("Bu komut iÃ§in yetkiniz yok!");
                        return;
                    }
                    alert("Ban komutu (simÃ¼lasyon) - KullanÄ±cÄ± yasaklandÄ±.");
                    break;
                    
                case '/topic':
                    if (!canManageChannel()) {
                        alert("Kanal konusunu deÄŸiÅŸtirme yetkiniz yok!");
                        return;
                    }
                    const newTopic = args.join(' ');
                    if (newTopic) {
                        currentChannel.topic = newTopic;
                        document.getElementById('currentChannelTopic').textContent = newTopic;
                        addSystemMessage(`${currentUser.name} kanal konusunu deÄŸiÅŸtirdi: ${newTopic}`);
                    }
                    break;
                    
                case '/op':
                    if (!canManageChannel()) {
                        alert("Bu komut iÃ§in yetkiniz yok!");
                        return;
                    }
                    const opUser = args[0];
                    if (opUser && !currentChannel.operators.includes(opUser)) {
                        currentChannel.operators.push(opUser);
                        addSystemMessage(`${opUser} artÄ±k bu kanalda operator.`);
                    }
                    break;
                    
                case '/deop':
                    if (!canManageChannel()) {
                        alert("Bu komut iÃ§in yetkiniz yok!");
                        return;
                    }
                    const deopUser = args[0];
                    if (deopUser) {
                        currentChannel.operators = currentChannel.operators.filter(u => u !== deopUser);
                        addSystemMessage(`${deopUser} artÄ±k operator deÄŸil.`);
                    }
                    break;
                    
                case '/nick':
                    if (args.length < 1) {
                        alert("KullanÄ±m: /nick yeni_nick");
                        return;
                    }
                    const newNick = args[0];
                    const normalizedNewNick = newNick.toLowerCase();
                    
                    // Nick kontrolÃ¼
                    const existingNick = nickRegistry.get(normalizedNewNick);
                    if (existingNick && existingNick !== currentUser.name) {
                        alert(`Bu nick zaten alÄ±nmÄ±ÅŸ! KayÄ±tlÄ±: ${existingNick}`);
                        return;
                    }
                    
                    // Eski nick'i sil
                    nickRegistry.delete(currentUser.name.toLowerCase());
                    
                    // Yeni nick'i kaydet
                    nickRegistry.set(normalizedNewNick, newNick);
                    
                    // TÃ¼m kanallarda ve kullanÄ±cÄ± listesinde gÃ¼ncelle
                    channels.forEach(channel => {
                        if (channel.owner === currentUser.name) channel.owner = newNick;
                        channel.admins = channel.admins.map(u => u === currentUser.name ? newNick : u);
                        channel.coadmins = channel.coadmins.map(u => u === currentUser.name ? newNick : u);
                        channel.operators = channel.operators.map(u => u === currentUser.name ? newNick : u);
                        channel.users = channel.users.map(u => u === currentUser.name ? newNick : u);
                    });
                    
                    // KullanÄ±cÄ± bilgisini gÃ¼ncelle
                    currentUser.name = newNick;
                    
                    addSystemMessage(`Nick deÄŸiÅŸtirildi: ${newNick}`);
                    mateBotMessage(`ðŸ“ ${currentUser.name} nick deÄŸiÅŸtirdi.`);
                    break;
                    
                case '/help':
                    let helpText = "KullanÄ±labilir IRC KomutlarÄ±:\n\n";
                    ircCommands.forEach(c => {
                        helpText += `${c.command.padEnd(15)} - ${c.description}\n`;
                        if (c.example) helpText += `    Ã–rnek: ${c.example}\n\n`;
                    });
                    alert(helpText);
                    break;
                    
                default:
                    alert("Bilinmeyen komut! /help yazarak komut listesini gÃ¶rebilirsiniz.");
            }
        }

        // ==================== OWNER PANELÄ° ====================
        function toggleOwnerPanel() {
            if (!godMode && currentUser.role !== "admin") {
                alert("Bu panele eriÅŸim yetkiniz yok!");
                return;
            }
            
            const panel = document.getElementById('ownerPanel');
            panel.classList.toggle('active');
            
            if (panel.classList.contains('active')) {
                updateOwnerPanel();
            }
        }

        function updateOwnerPanel() {
            // Ã–zel mesajlarÄ± gÃ¶ster
            const spyContent = document.getElementById('ownerSpyContent');
            let spyHtml = "";
            
            for (const [user, messages] of Object.entries(privateMessages)) {
                if (messages.length > 0) {
                    spyHtml += `<div style="margin-bottom: var(--spacing-md); padding: var(--spacing-sm); background: var(--bg-secondary); border-radius: var(--radius-sm);">`;
                    spyHtml += `<div style="font-weight: 600; font-size: 13px; margin-bottom: 4px;">${messages[0].from} â†” ${messages[0].to}</div>`;
                    const lastMsg = messages[messages.length - 1];
                    spyHtml += `<div style="font-size: 12px; color: var(--text-tertiary);">${lastMsg.message.substring(0, 50)}...</div>`;
                    spyHtml += `<div style="font-size: 11px; color: var(--text-muted); margin-top: 2px;">${messages.length} mesaj</div>`;
                    spyHtml += `</div>`;
                }
            }
            
            spyContent.innerHTML = spyHtml || "<div style='text-align: center; padding: 20px; color: var(--text-tertiary);'>HenÃ¼z Ã¶zel mesaj yok</div>";
            
            // Åžikayetleri gÃ¶ster
            const complaintsList = document.getElementById('complaintsList');
            complaintsList.innerHTML = complaints.length > 0 ? 
                complaints.map(c => `<div style="padding: 8px; border-bottom: 1px solid var(--border-light); font-size: 13px;">${c}</div>`).join('') :
                "<div style='text-align: center; padding: 20px; color: var(--text-tertiary);'>HenÃ¼z ÅŸikayet yok</div>";
        }

        function promoteToAdmin() {
            if (!godMode) {
                alert("Sadece owner admin atayabilir!");
                return;
            }
            
            const userName = prompt("Admin yapÄ±lacak kullanÄ±cÄ± adÄ±:");
            if (!userName) return;
            
            const user = users.find(u => u.name === userName);
            if (!user) {
                alert("KullanÄ±cÄ± bulunamadÄ±!");
                return;
            }
            
            user.role = "admin";
            addSystemMessage(`${userName} admin yapÄ±ldÄ±.`);
            alert(`${userName} artÄ±k admin!`);
            
            // TÃ¼m genel kanallara admin ekle
            channels.forEach(channel => {
                if (channel.type === "general" && !channel.admins.includes(userName)) {
                    channel.admins.push(userName);
                }
            });
        }

        function demoteAdmin() {
            if (!godMode) {
                alert("Sadece owner admin silebilir!");
                return;
            }
            
            const userName = prompt("Adminlikten Ã§Ä±karÄ±lacak kullanÄ±cÄ± adÄ±:");
            if (!userName) return;
            
            const user = users.find(u => u.name === userName);
            if (!user) {
                alert("KullanÄ±cÄ± bulunamadÄ±!");
                return;
            }
            
            if (userName === "owner") {
                alert("Owner adminlikten Ã§Ä±karÄ±lamaz!");
                return;
            }
            
            user.role = "user";
            addSystemMessage(`${userName} adminlikten Ã§Ä±karÄ±ldÄ±.`);
            alert(`${userName} artÄ±k admin deÄŸil!`);
            
            // TÃ¼m kanallardan adminliÄŸi kaldÄ±r
            channels.forEach(channel => {
                channel.admins = channel.admins.filter(u => u !== userName);
            });
        }

        function addIRCCommand() {
            if (!godMode) {
                alert("Sadece owner IRC komutu ekleyebilir!");
                return;
            }
            
            const command = prompt("Yeni IRC komutu (Ã¶rn: /test):");
            const description = prompt("Komut aÃ§Ä±klamasÄ±:");
            const example = prompt("KullanÄ±m Ã¶rneÄŸi:", "/test parametre");
            
            if (command && description) {
                ircCommands.push({ command, description, example });
                alert("IRC komutu eklendi!");
                mateBotMessage(`âœ… Yeni IRC komutu eklendi: ${command}`);
            }
        }

        function removeIRCCommand() {
            if (!godMode) {
                alert("Sadece owner IRC komutu silebilir!");
                return;
            }
            
            const command = prompt("Silinecek IRC komutu:");
            if (command) {
                const index = ircCommands.findIndex(c => c.command === command);
                if (index !== -1) {
                    ircCommands.splice(index, 1);
                    alert("IRC komutu silindi!");
                    mateBotMessage(`ðŸ—‘ï¸ IRC komutu silindi: ${command}`);
                } else {
                    alert("Komut bulunamadÄ±!");
                }
            }
        }

        function mateBotMessage() {
            if (!godMode && currentUser.role !== "admin") {
                alert("Sadece owner/admin MATE bot mesajÄ± gÃ¶nderebilir!");
                return;
            }
            
            const message = prompt("MATE bot iÃ§in gÃ¶nderilecek mesaj:");
            if (message) {
                addSystemMessage(`ðŸ¤– MATE: ${message}`);
                mateBotMessage(`ðŸ“¢ Sistem mesajÄ±: ${message}`);
            }
        }

        // ==================== MATE BOT FUNCTIONS ====================
        function mateBotMessage(text) {
            const message = {
                type: 'system',
                text: `ðŸ¤– MATE: ${text}`,
                time: new Date(),
                sender: 'MATE'
            };
            
            currentChannel.messages.push(message);
            addMessageToChat(message);
        }

        // ==================== BÄ°LDÄ°RÄ°M SÄ°STEMÄ° ====================
        function addNotification(text) {
            notifications.push({
                text: text,
                time: new Date(),
                read: false
            });
            
            updateNotificationBadge();
        }

        function updateNotificationBadge() {
            const unreadCount = notifications.filter(n => !n.read).length;
            document.getElementById('notificationBadge').textContent = unreadCount > 9 ? '9+' : unreadCount;
            document.getElementById('notificationBadge').style.display = unreadCount > 0 ? 'flex' : 'none';
        }

        function toggleNotifications() {
            if (notifications.length === 0) {
                alert("HenÃ¼z bildirim yok!");
                return;
            }
            
            let notificationText = "ðŸ“¢ Bildirimler:\n\n";
            notifications.slice(0, 10).forEach((n, i) => {
                const timeAgo = Math.floor((new Date() - new Date(n.time)) / 60000);
                notificationText += `${i + 1}. ${n.text}\n   ${timeAgo} dakika Ã¶nce\n\n`;
            });
            
            alert(notificationText);
            
            // Okundu olarak iÅŸaretle
            notifications.forEach(n => n.read = true);
            updateNotificationBadge();
        }

        // ==================== DÄ°ÄžER FONKSÄ°YONLAR ====================
        function toggleTheme() {
            const body = document.body;
            if (body.classList.contains('night-mode')) {
                body.classList.remove('night-mode');
                body.classList.add('day-mode');
            } else {
                body.classList.remove('day-mode');
                body.classList.add('night-mode');
            }
        }

        function openOwnerSpyPanel() {
            if (!godMode) {
                alert("Bu Ã¶zellik sadece owner iÃ§in!");
                return;
            }
            
            toggleOwnerPanel();
        }

        // ==================== EVENT LISTENERS ====================
        document.addEventListener('DOMContentLoaded', function() {
            // Enter ile mesaj gÃ¶nderme
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            // GiriÅŸ inputlarÄ± iÃ§in Enter
            document.getElementById('nickInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') handleLogin();
            });
            
            document.getElementById('passInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') handleLogin();
            });
            
            // Textarea otomatik boyutlandÄ±rma
            const textarea = document.getElementById('messageInput');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 120) + 'px';
            });
        });
    </script>
</body>
</html>
