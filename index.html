<!-- CETCETY - TAM SÃœRÃœM (TÃœM Ã–ZELLÄ°KLER + FIREBASE + SPOTIFY) -->
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CETCETY â€¢ Tam SÃ¼rÃ¼m</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- YouTube API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    
    <style>
        /* ========== TEMEL STILLER ========== */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: #0f0f0f; color: #fff; overflow: hidden; height: 100vh; transition: 0.2s; }
        body.light-theme { background: #f5f5f5; color: #1a1a1a; }
        .app { display: flex; height: 100vh; width: 100vw; position: relative; }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #1a1a1a; }
        body.light-theme ::-webkit-scrollbar-track { background: #ddd; }
        ::-webkit-scrollbar-thumb { background: #3f3f3f; border-radius: 3px; }
        body.light-theme ::-webkit-scrollbar-thumb { background: #aaa; }

        /* ========== GÄ°RÄ°Åž EKRANI ========== */
        .login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(10px);
            display: flex; align-items: center; justify-content: center;
            z-index: 1000; transition: opacity 0.3s;
        }
        .login-overlay.hidden { display: none; }
        .login-panel {
            width: 360px; background: rgba(20,20,20,0.6); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px; padding: 32px; backdrop-filter: blur(10px); color: #fff;
        }
        body.light-theme .login-panel { background: rgba(255,255,255,0.7); border: 1px solid rgba(0,0,0,0.1); color: #333; }
        .login-panel h2 { text-align: center; margin-bottom: 24px; font-size: 24px; font-weight: 600; }
        .form-group { margin-bottom: 20px; }
        .login-panel label { display: block; margin-bottom: 8px; font-size: 13px; color: #aaa; }
        body.light-theme .login-panel label { color: #666; }
        .login-panel input {
            width: 100%; padding: 12px 16px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px; color: #fff; font-size: 14px; outline: none;
        }
        body.light-theme .login-panel input { background: rgba(255,255,255,0.5); border: 1px solid rgba(0,0,0,0.2); color: #333; }
        .login-panel input:focus { border-color: #ff0000; }
        
        .password-wrapper {
            position: relative;
            width: 100%;
        }
        .password-wrapper input { padding-right: 45px !important; }
        .password-toggle {
            position: absolute; right: 12px; top: 50%; transform: translateY(-50%);
            color: #aaa; cursor: pointer; font-size: 18px; z-index: 2;
        }
        .password-toggle:hover { color: #ff0000; }
        body.light-theme .password-toggle { color: #666; }
        
        .login-panel button {
            width: 100%; padding: 14px; background: #ff0000; border: none; border-radius: 8px;
            color: #fff; font-weight: 600; font-size: 16px; cursor: pointer; transition: 0.2s; margin-top: 8px;
        }
        .login-panel button:hover { background: #cc0000; }
        .login-info { text-align: center; margin-top: 16px; font-size: 12px; color: #aaa; }

        /* ========== SOL Ä°KON PANELÄ° ========== */
        .icon-panel {
            width: 72px; background: #0a0a0a; border-right: 1px solid #2a2a2a;
            display: flex; flex-direction: column; align-items: center; padding: 24px 0; gap: 24px;
            flex-shrink: 0; z-index: 20; transition: 0.2s;
        }
        body.light-theme .icon-panel { background: #fff; border-right: 1px solid #ddd; }
        .icon-item {
            width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center;
            justify-content: center; color: #aaa; cursor: pointer; transition: 0.2s; font-size: 20px; position: relative;
        }
        .icon-item:hover { background: #2a2a2a; color: #fff; }
        body.light-theme .icon-item:hover { background: #e0e0e0; color: #333; }
        .icon-item.active { color: #fff; background: #ff0000; }
        .icon-badge {
            position: absolute; top: -4px; right: -4px; width: 18px; height: 18px; border-radius: 50%;
            background: #ff4444; color: white; font-size: 10px; display: flex; align-items: center;
            justify-content: center; border: 2px solid #0a0a0a;
        }
        body.light-theme .icon-badge { border: 2px solid #fff; }
        .profile-avatar {
            margin-top: auto; width: 48px; height: 48px; border-radius: 50%;
            background: #1a1a1a; border: 2px solid #3f3f3f; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            font-weight: 600; color: #fff; position: relative;
        }
        body.light-theme .profile-avatar { background: #ddd; border: 2px solid #aaa; color: #333; }

        /* ========== ANA Ä°Ã‡ERÄ°K ========== */
        .main-content { flex: 1; display: flex; overflow: hidden; position: relative; }

        /* ========== SOL PANEL ========== */
        .left-panel {
            width: 320px; background: #0a0a0a; border-right: 1px solid #2a2a2a;
            display: flex; flex-direction: column; flex-shrink: 0; z-index: 15;
        }
        body.light-theme .left-panel { background: #fff; border-right: 1px solid #ddd; }
        .panel-header {
            padding: 16px 20px; border-bottom: 1px solid #2a2a2a;
            display: flex; align-items: center; justify-content: space-between;
        }
        body.light-theme .panel-header { border-bottom: 1px solid #ddd; }
        .panel-header h3 {
            display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 600; color: #fff;
        }
        body.light-theme .panel-header h3 { color: #333; }
        .panel-close {
            width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center;
            justify-content: center; color: #aaa; cursor: pointer;
        }
        .panel-close:hover { background: #2a2a2a; color: #fff; }
        body.light-theme .panel-close:hover { background: #ddd; color: #333; }
        .panel-content { flex: 1; overflow-y: auto; padding: 20px; }

        /* ========== SEKMELER ========== */
        .panel-tabs {
            display: flex; border-bottom: 1px solid #2a2a2a; background: #0a0a0a;
        }
        body.light-theme .panel-tabs { background: #fff; border-bottom: 1px solid #ddd; }
        .panel-tab {
            flex: 1; padding: 12px; text-align: center; font-size: 12px; font-weight: 600;
            color: #aaa; cursor: pointer; transition: 0.2s;
        }
        .panel-tab:hover { background: #1a1a1a; color: #fff; }
        .panel-tab.active { color: #fff; border-bottom: 2px solid #ff0000; }
        body.light-theme .panel-tab.active { color: #333; }

        /* ========== ARAMA ========== */
        .search-container {
            display: flex; align-items: center; background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 30px;
            padding: 0 16px; margin-bottom: 20px;
        }
        body.light-theme .search-container { background: #f0f0f0; border: 1px solid #ccc; }
        .search-container i { color: #aaa; font-size: 14px; }
        body.light-theme .search-container i { color: #666; }
        .search-input {
            flex: 1; background: transparent; border: none; color: #fff; font-size: 15px;
            padding: 14px 8px; outline: none;
        }
        body.light-theme .search-input { color: #333; }

        /* ========== FORM ========== */
        .form-group { margin-bottom: 16px; }
        .form-label { display: block; font-size: 12px; color: #aaa; margin-bottom: 6px; }
        body.light-theme .form-label { color: #666; }
        .form-input, .form-select {
            width: 100%; padding: 12px; background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 8px;
            color: #fff; font-size: 14px; outline: none;
        }
        body.light-theme .form-input, body.light-theme .form-select { background: #f0f0f0; border: 1px solid #ccc; color: #333; }
        .form-input:focus { border-color: #ff0000; }
        .form-button {
            width: 100%; padding: 12px; background: #ff0000; border: none; border-radius: 8px;
            color: #fff; font-weight: 600; font-size: 14px; cursor: pointer; transition: 0.2s;
        }
        .form-button:hover { background: #cc0000; }
        .form-button.secondary { background: #2a2a2a; color: #fff; }
        body.light-theme .form-button.secondary { background: #ddd; color: #333; }
        .form-button.secondary:hover { background: #3f3f3f; }
        .form-button.danger { background: #6d0000; }
        .form-button.danger:hover { background: #8a0000; }
        .info-box {
            background: #1a1a1a; border-left: 4px solid #ff0000; padding: 16px; border-radius: 8px; margin-bottom: 16px;
        }
        body.light-theme .info-box { background: #f9f9f9; }
        .info-box p { color: #aaa; font-size: 13px; line-height: 1.5; }
        body.light-theme .info-box p { color: #666; }

        /* ========== LÄ°STE Ã–ÄžELERÄ° ========== */
        .subscription-item, .channel-item, .chat-item, .online-item {
            display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px;
            cursor: pointer; margin-bottom: 4px; transition: 0.2s;
        }
        .subscription-item:hover, .channel-item:hover, .chat-item:hover, .online-item:hover { background: #1a1a1a; }
        body.light-theme .subscription-item:hover, body.light-theme .channel-item:hover,
        body.light-theme .chat-item:hover, body.light-theme .online-item:hover { background: #f0f0f0; }
        .subscription-item.active { background: #1a1a1a; border-left: 4px solid #ff0000; }
        .subscription-avatar, .channel-avatar, .chat-avatar, .online-avatar, .profile-avatar-panel {
            width: 36px; height: 36px; border-radius: 50%; background: #1a1a1a;
            display: flex; align-items: center; justify-content: center; color: #ff0000; font-size: 16px; flex-shrink: 0;
        }
        body.light-theme .subscription-avatar, body.light-theme .channel-avatar,
        body.light-theme .chat-avatar, body.light-theme .online-avatar,
        body.light-theme .profile-avatar-panel { background: #ddd; color: #ff0000; }
        .online-avatar { background: #0a5c36; color: #fff; }
        .profile-avatar-panel { background: #ff0000; color: #fff; }
        .subscription-info, .channel-info, .chat-info, .online-info { flex: 1; min-width: 0; }
        .subscription-name, .channel-name, .chat-name, .online-name {
            font-weight: 600; font-size: 14px; color: #fff; display: flex; align-items: center; gap: 6px;
        }
        body.light-theme .subscription-name, body.light-theme .channel-name,
        body.light-theme .chat-name, body.light-theme .online-name { color: #333; }
        .online-status { width: 8px; height: 8px; border-radius: 50%; background: #2ecc71; margin-left: 4px; }
        .subscription-meta, .channel-meta, .chat-meta, .online-meta {
            font-size: 11px; color: #aaa; margin-top: 2px; display: flex; align-items: center; gap: 8px;
        }
        body.light-theme .subscription-meta, body.light-theme .channel-meta,
        body.light-theme .chat-meta, body.light-theme .online-meta { color: #666; }
        .subscription-stats { font-size: 11px; color: #aaa; text-align: right; }
        
        /* ========== YETKÄ° BADGE'LERÄ° ========== */
        .badge {
            display: inline-flex; align-items: center; justify-content: center; padding: 2px 8px;
            border-radius: 12px; font-size: 10px; font-weight: 600; margin-left: 6px;
            background: rgba(0,0,0,0.3);
            border: 1px solid;
            backdrop-filter: blur(2px);
        }
        .badge-owner { color: #ffd700; border-color: rgba(255,215,0,0.5); }
        .badge-admin { color: #ff6b6b; border-color: rgba(255,107,107,0.5); }
        .badge-coadmin { color: #6495ed; border-color: rgba(100,149,237,0.5); }
        .badge-operator { color: #ffa500; border-color: rgba(255,165,0,0.5); }
        .badge-hidden { color: #aaa; border-color: rgba(170,170,170,0.5); }
        .badge-ow { color: #9370db; border-color: rgba(147,112,219,0.5); }

        /* ========== POPÃœLER ========== */
        .popular-channels { margin-top: 20px; padding-top: 20px; border-top: 1px solid #2a2a2a; }
        body.light-theme .popular-channels { border-top: 1px solid #ddd; }
        .popular-header { display: flex; align-items: center; gap: 8px; color: #ffd700; font-size: 13px; font-weight: 600; margin-bottom: 12px; }
        .popular-item { display: flex; align-items: center; gap: 12px; padding: 10px; border-radius: 8px; cursor: pointer; margin-bottom: 2px; }
        .popular-item:hover { background: #1a1a1a; }
        body.light-theme .popular-item:hover { background: #f0f0f0; }
        .popular-info { flex: 1; }
        .popular-name { font-weight: 500; font-size: 13px; color: #fff; display: flex; align-items: center; gap: 6px; }
        body.light-theme .popular-name { color: #333; }
        .popular-subscribers { font-size: 10px; color: #aaa; }
        .subscribe-btn {
            padding: 6px 12px; background: #ff0000; border: none; border-radius: 20px;
            color: #fff; font-size: 11px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 4px;
        }
        .subscribe-btn.subscribed { background: #272727; color: #ffd700; }
        body.light-theme .subscribe-btn.subscribed { background: #ddd; color: #666; }

        /* ========== CHAT PANELÄ° ========== */
        .chat-container {
            flex: 1; display: flex; flex-direction: column; min-width: 0; background: #0f0f0f;
            position: relative;
        }
        body.light-theme .chat-container { background: #f9f9f9; }
        .chat-header {
            padding: 16px 24px; border-bottom: 1px solid #2a2a2a; display: flex;
            align-items: center; justify-content: space-between;
        }
        body.light-theme .chat-header { border-bottom: 1px solid #ddd; }
        .chat-title { display: flex; align-items: center; gap: 12px; font-weight: 600; color: #fff; }
        body.light-theme .chat-title { color: #333; }
        .chat-title i { color: #ff0000; }
        .channel-info-bar { display: flex; align-items: center; gap: 16px; color: #aaa; font-size: 13px; }
        body.light-theme .channel-info-bar { color: #666; }
        .channel-subscribe-btn {
            padding: 6px 16px; background: #272727; border: 1px solid #3f3f3f; border-radius: 20px;
            color: #fff; font-size: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px;
            transition: all 0.2s;
        }
        body.light-theme .channel-subscribe-btn { background: #ddd; border: 1px solid #ccc; color: #333; }
        .channel-subscribe-btn.subscribed { background: #ff0000; border-color: #ff0000; color: #fff; }
        .messages {
            flex: 1; overflow-y: auto; padding: 24px; display: flex; flex-direction: column; gap: 16px;
        }
        .message {
            display: flex; flex-direction: column; max-width: 70%; animation: fadeIn 0.2s;
        }
        .message.right { align-self: flex-end; }
        .message-header { display: flex; align-items: center; gap: 8px; margin-bottom: 4px; }
        .message-sender { font-weight: 600; font-size: 13px; color: #fff; cursor: pointer; display: flex; align-items: center; gap: 4px; }
        body.light-theme .message-sender { color: #333; }
        .message-time { font-size: 11px; color: #aaa; }
        .message-text {
            font-size: 14px; line-height: 1.5; color: #fff; word-break: break-word;
            background: #2a2a2a; padding: 8px 12px; border-radius: 18px;
        }
        body.light-theme .message-text { background: #e0e0e0; color: #333; }
        .message.right .message-text { background: #ff0000; color: #fff; }
        .system-message {
            align-self: center; color: #aaa; font-size: 12px; padding: 8px 16px;
            background: #1a1a1a; border-radius: 20px; margin: 8px 0; border: 1px solid #2a2a2a;
        }
        body.light-theme .system-message { background: #e0e0e0; color: #666; border: 1px solid #ccc; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .message-input-container {
            padding: 20px 24px; background: #0a0a0a; border-top: 1px solid #2a2a2a;
        }
        body.light-theme .message-input-container { background: #fff; border-top: 1px solid #ddd; }
        .input-wrapper {
            display: flex; align-items: center; gap: 12px; background: #1a1a1a;
            border: 1px solid #2a2a2a; border-radius: 28px; padding: 4px 4px 4px 20px;
        }
        body.light-theme .input-wrapper { background: #f0f0f0; border: 1px solid #ccc; }
        .message-input {
            flex: 1; background: transparent; border: none; color: #fff; font-size: 14px;
            padding: 12px 0; resize: none; max-height: 80px; outline: none;
        }
        body.light-theme .message-input { color: #333; }
        .send-btn {
            width: 44px; height: 44px; border-radius: 50%; background: #2a2a2a; border: 1px solid #3f3f3f;
            color: #fff; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.2s;
        }
        .send-btn:hover { background: #ff0000; border-color: #ff0000; }

        /* ========== Ã–ZEL SOHBET PANELÄ° ========== */
        .private-chat-panel {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            width: 100%; height: 100%; background: #0a0a0a; display: none;
            flex-direction: column; z-index: 30;
        }
        body.light-theme .private-chat-panel { background: #fff; }
        .private-chat-panel.active { display: flex; }
        .private-chat-header {
            padding: 16px 20px; border-bottom: 1px solid #2a2a2a;
            display: flex; align-items: center; justify-content: space-between;
        }
        .private-chat-user { display: flex; align-items: center; gap: 12px; }
        .private-chat-avatar {
            width: 40px; height: 40px; border-radius: 50%; background: #1a1a1a;
            display: flex; align-items: center; justify-content: center; color: #ff0000;
        }
        .private-chat-info h4 { font-size: 14px; font-weight: 600; color: #fff; }
        .private-chat-info span { font-size: 11px; color: #aaa; }
        .private-chat-actions { display: flex; gap: 12px; }
        .private-chat-action {
            width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center;
            justify-content: center; color: #aaa; cursor: pointer;
        }
        .private-chat-action:hover { background: #1a1a1a; color: #fff; }
        body.light-theme .private-chat-action:hover { background: #ddd; color: #333; }
        .private-tabs {
            display: flex; border-bottom: 1px solid #2a2a2a;
        }
        .private-tab {
            flex: 1; padding: 12px; text-align: center; font-size: 12px; font-weight: 600;
            color: #aaa; cursor: pointer; transition: 0.2s;
        }
        .private-tab:hover { background: #1a1a1a; color: #fff; }
        .private-tab.active { color: #fff; border-bottom: 2px solid #ff0000; }
        body.light-theme .private-tab.active { color: #333; }
        .private-chat-messages {
            flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 16px;
        }
        .private-message {
            display: flex; flex-direction: column; max-width: 80%;
        }
        .private-message.right { align-self: flex-end; }
        .private-message-header { display: flex; align-items: center; gap: 8px; margin-bottom: 4px; }
        .private-message-sender { font-weight: 600; font-size: 12px; color: #fff; }
        .private-message-time { font-size: 10px; color: #aaa; }
        .private-message-text {
            font-size: 13px; line-height: 1.4; color: #fff; word-break: break-word;
            background: #2a2a2a; padding: 8px 12px; border-radius: 18px;
        }
        .private-message.right .private-message-text { background: #ff0000; color: #fff; }
        .private-message-media { margin-top: 8px; border-radius: 12px; overflow: hidden; }
        .private-message-media img, .private-message-media video {
            width: 100%; max-height: 200px; object-fit: cover; border-radius: 12px; cursor: pointer;
        }
        .delete-msg {
            position: absolute; top: -8px; right: -8px; width: 24px; height: 24px; border-radius: 50%;
            background: #ff4444; color: white; display: flex; align-items: center; justify-content: center;
            font-size: 12px; cursor: pointer; opacity: 0; transition: 0.2s; z-index: 5;
        }
        .private-message:hover .delete-msg { opacity: 1; }
        .private-input-container {
            padding: 20px; background: #0a0a0a; border-top: 1px solid #2a2a2a;
        }
        body.light-theme .private-input-container { background: #fff; border-top: 1px solid #ddd; }
        .private-input-wrapper { display: flex; flex-direction: column; gap: 12px; }
        .private-media-actions { display: flex; gap: 12px; padding: 0 4px; }
        .private-media-btn {
            width: 36px; height: 36px; border-radius: 50%; background: #1a1a1a;
            display: flex; align-items: center; justify-content: center; color: #aaa; cursor: pointer;
        }
        .private-media-btn:hover { background: #2a2a2a; color: #fff; }
        body.light-theme .private-media-btn { background: #ddd; color: #666; }
        body.light-theme .private-media-btn:hover { background: #ccc; color: #333; }
        .private-text-input { display: flex; gap: 12px; }
        .private-input {
            flex: 1; background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 24px;
            padding: 12px 16px; color: #fff; font-size: 13px; resize: none; outline: none;
        }
        body.light-theme .private-input { background: #f0f0f0; border: 1px solid #ccc; color: #333; }
        .private-send-btn {
            width: 44px; height: 44px; border-radius: 50%; background: #2a2a2a; border: 1px solid #3f3f3f;
            color: #fff; display: flex; align-items: center; justify-content: center; cursor: pointer;
        }
        .private-send-btn:hover { background: #ff0000; border-color: #ff0000; }

        /* ========== MEDYA PANELÄ° ========== */
        .media-panel {
            width: 420px; background: #0a0a0a; border-left: 1px solid #2a2a2a;
            display: flex; flex-direction: column; flex-shrink: 0;
        }
        body.light-theme .media-panel { background: #fff; border-left: 1px solid #ddd; }
        .media-header {
            padding: 16px 20px; border-bottom: 1px solid #2a2a2a; display: flex;
            align-items: center; justify-content: space-between;
        }
        body.light-theme .media-header { border-bottom: 1px solid #ddd; }
        .media-title { display: flex; align-items: center; gap: 8px; font-weight: 600; font-size: 14px; color: #fff; }
        body.light-theme .media-title { color: #333; }
        .media-controls { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
        .media-control {
            width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center;
            justify-content: center; color: #aaa; cursor: pointer;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.2s;
        }
        .media-control:hover { 
            background: #ff0000; 
            color: #fff; 
            border-color: #ff0000;
        }
        .media-control.disabled { 
            opacity: 0.3; 
            cursor: not-allowed; 
            pointer-events: none;
            background: rgba(255,255,255,0.05);
        }
        
        /* YouTube Player */
        .youtube-player { 
            width: 100%; 
            aspect-ratio: 16/9; 
            background: #000; 
            border-bottom: 1px solid #2a2a2a; 
            position: relative; 
            display: block;
        }
        #youtubeContainer { width: 100%; height: 100%; }
        
        /* Spotify Player */
        .spotify-player {
            width: 100%;
            aspect-ratio: 16/9;
            background: #121212;
            border-bottom: 1px solid #2a2a2a;
            display: none;
        }
        .spotify-iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0;
        }
        
        .player-controls {
            position: absolute;
            bottom: 16px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 20px;
            z-index: 10;
        }
        .player-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: rgba(0,0,0,0.7);
            border: 2px solid #fff;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: 0.2s;
            font-size: 18px;
        }
        .player-btn:hover { background: #ff0000; border-color: #ff0000; }
        
        .now-playing {
            padding: 12px 20px;
            background: #0f0f0f;
            border-bottom: 1px solid #2a2a2a;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 13px;
            color: #fff;
        }
        body.light-theme .now-playing { background: #f5f5f5; border-bottom: 1px solid #ddd; color: #333; }
        
        .playlist-container { flex: 1; overflow-y: auto; padding: 20px; }
        .playlist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #2a2a2a;
        }
        body.light-theme .playlist-header { border-bottom: 1px solid #ddd; }
        .playlist-title { display: flex; align-items: center; gap: 8px; font-weight: 600; font-size: 14px; color: #fff; }
        body.light-theme .playlist-title { color: #333; }
        .playlist-count { color: #aaa; font-size: 12px; }
        .playlist-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 4px;
            cursor: pointer;
            transition: 0.2s;
        }
        .playlist-item:hover { background: #1a1a1a; }
        body.light-theme .playlist-item:hover { background: #f0f0f0; }
        .playlist-item.active { background: #1a1a1a; border-left: 4px solid #ff0000; }
        .playlist-thumb {
            width: 48px;
            height: 48px;
            border-radius: 6px;
            background: #1a1a1a;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ff0000;
            font-size: 24px;
            flex-shrink: 0;
        }
        .spotify-thumb {
            background: #1DB954;
            color: #fff;
        }

        /* ========== MODAL PANEL ========== */
        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 24px;
            z-index: 2000;
            width: 400px;
            max-height: 80vh;
            overflow-y: auto;
        }
        .modal.active { display: block; }
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 1999;
        }
        .modal-overlay.active { display: block; }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .modal-header h3 { color: #ffd700; }
        .modal-close {
            cursor: pointer;
            color: #aaa;
        }
        .modal-close:hover { color: #fff; }
        .modal-section {
            margin-bottom: 20px;
            padding: 10px;
            background: #0a0a0a;
            border-radius: 8px;
        }
        .modal-section h4 {
            color: #fff;
            margin-bottom: 10px;
        }
        .modal-section h5 {
            margin-bottom: 8px;
        }
        .modal-input {
            width: 100%;
            padding: 8px;
            margin-bottom: 8px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 4px;
            color: #fff;
        }
        .modal-select {
            width: 100%;
            padding: 8px;
            margin-bottom: 8px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 4px;
            color: #fff;
        }
        .modal-btn {
            width: 100%;
            padding: 8px;
            border: none;
            border-radius: 4px;
            color: #fff;
            cursor: pointer;
            margin-bottom: 4px;
        }
        .modal-btn.primary { background: #ff0000; }
        .modal-btn.success { background: #00cc66; }
        .modal-btn.warning { background: #ffaa00; }
        .modal-btn.danger { background: #ff4444; }
        .modal-btn.info { background: #6495ed; }
        .modal-btn.orange { background: #ffa500; }
        .modal-btn.purple { background: #9370db; }
        .modal-btn:hover { opacity: 0.8; }

        /* Profil resmi yÃ¼kleme */
        .avatar-upload {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 0 auto 20px;
            cursor: pointer;
        }
        .avatar-upload img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #ff0000;
        }
        .avatar-upload .upload-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: 0.2s;
        }
        .avatar-upload:hover .upload-overlay {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- GÄ°RÄ°Åž EKRANI -->
    <div id="loginOverlay" class="login-overlay">
        <div class="login-panel">
            <h2>ðŸŽ§ CETCETY</h2>
            <div class="form-group">
                <label>KullanÄ±cÄ± AdÄ±</label>
                <input type="text" id="loginNick" placeholder="Ã¶rn: mateky" autocomplete="off">
            </div>
            <div class="form-group">
                <label>Åžifre</label>
                <div class="password-wrapper">
                    <input type="password" id="loginPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                    <i class="fas fa-eye password-toggle" id="togglePassword" onclick="togglePassword()"></i>
                </div>
            </div>
            <button onclick="login()">GiriÅŸ Yap / KayÄ±t Ol</button>
            <div class="login-info">KayÄ±tlÄ± nickler ÅŸifre ile. KayÄ±tsÄ±z nickler ÅŸifresiz.</div>
        </div>
    </div>

    <!-- ANA UYGULAMA -->
    <div id="app" class="app" style="display: none;">
        <!-- SOL Ä°KON PANELÄ° -->
        <div class="icon-panel">
            <div class="icon-item" onclick="showHome()" title="Ana Sayfa"><i class="fas fa-home"></i></div>
            <div class="icon-item" onclick="openSubscriptions()" title="Abonelikler"><i class="fas fa-bell"></i><span class="icon-badge" id="subscriptionBadge">0</span></div>
            <div class="icon-item" onclick="openChannelPanel()" title="Kanallar"><i class="fas fa-list-ul"></i><span class="icon-badge" id="channelCountBadge">0</span></div>
            <div class="icon-item" onclick="openChatListPanel()" title="Sohbetlerim"><i class="fas fa-comment"></i><span class="icon-badge" id="chatListBadge">0</span></div>
            <div class="icon-item" onclick="openCreateChannelPanel()" title="Kanal AÃ§"><i class="fas fa-plus-circle"></i></div>
            <div class="icon-item" onclick="openNotificationPanel()" title="Bildirimler"><i class="fas fa-bell"></i><span class="icon-badge" id="notificationBadge">0</span></div>
            <div class="icon-item" onclick="openSupportPanel()" title="Destek"><i class="fas fa-headset"></i></div>
            <div class="icon-item" onclick="toggleTheme()" id="themeIcon" title="Tema DeÄŸiÅŸtir"><i class="fas fa-moon"></i></div>
            <div class="profile-avatar" id="profileAvatar" onclick="openProfilePanel()"><span id="avatarText">?</span></div>
        </div>

        <div class="main-content">
            <!-- SOL PANEL (dinamik) -->
            <div class="left-panel" id="leftPanel"></div>

            <!-- CHAT PANELÄ° -->
            <div class="chat-container">
                <div class="chat-header">
                    <div class="chat-title">
                        <i class="fas fa-hashtag"></i>
                        <span id="currentChannelName">genel</span>
                        <span class="channel-info-bar">
                            <span id="channelUserCount">0</span> Ã§evrimiÃ§i â€¢ 
                            <span id="channelSubscribers">0</span> abone
                        </span>
                    </div>
                    <button id="subscribeChannelBtn" class="channel-subscribe-btn" onclick="toggleSubscribe()"><i class="fas fa-plus"></i> Abone Ol</button>
                </div>
                <div class="messages" id="messages">
                    <div class="system-message"><i class="fas fa-info-circle"></i> CETCETY'ye hoÅŸ geldin! /help yazarak komutlarÄ± gÃ¶rebilirsin.</div>
                </div>
                <div class="message-input-container">
                    <div class="input-wrapper">
                        <textarea id="messageInput" class="message-input" placeholder="Mesaj yazÄ±n... /help" rows="1" oninput="autoResize(this)"></textarea>
                        <div class="send-btn" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></div>
                    </div>
                </div>

                <!-- Ã–ZEL SOHBET PANELÄ° -->
                <div id="privateChatPanel" class="private-chat-panel">
                    <div class="private-chat-header">
                        <div class="private-chat-user">
                            <div class="private-chat-avatar" id="privateChatAvatar">ðŸ‘¤</div>
                            <div class="private-chat-info">
                                <h4 id="privateChatName">KullanÄ±cÄ±</h4>
                                <span id="privateChatStatus">Ã‡evrimiÃ§i</span>
                            </div>
                        </div>
                        <div class="private-chat-actions">
                            <div class="private-chat-action" onclick="blockUser()" title="Engelle"><i class="fas fa-ban"></i></div>
                            <div class="private-chat-action" onclick="reportUser()" title="Åžikayet Et"><i class="fas fa-flag"></i></div>
                            <div class="private-chat-action" onclick="closePrivateChat()" title="Kapat"><i class="fas fa-times"></i></div>
                        </div>
                    </div>
                    <div class="private-tabs">
                        <div class="private-tab active" onclick="switchPrivateTab('chat')">Sohbet</div>
                        <div class="private-tab" onclick="switchPrivateTab('voice')" title="YakÄ±nda">Sesli</div>
                        <div class="private-tab" onclick="switchPrivateTab('video')" title="YakÄ±nda">GÃ¶rÃ¼ntÃ¼lÃ¼</div>
                        <div class="private-tab" onclick="switchPrivateTab('file')" title="YakÄ±nda">Dosya</div>
                    </div>
                    <div class="private-chat-messages" id="privateChatMessages"></div>
                    <div class="private-input-container">
                        <div class="private-input-wrapper">
                            <div class="private-media-actions">
                                <div class="private-media-btn" onclick="triggerImageUpload()" title="Resim GÃ¶nder"><i class="fas fa-image"></i></div>
                                <div class="private-media-btn" onclick="triggerVideoUpload()" title="Video GÃ¶nder"><i class="fas fa-video"></i></div>
                                <input type="file" id="privateImageUpload" accept="image/*" style="display:none;" onchange="sendImageFile(this)">
                                <input type="file" id="privateVideoUpload" accept="video/*" style="display:none;" onchange="sendVideoFile(this)">
                            </div>
                            <div class="private-text-input">
                                <textarea id="privateMessageInput" class="private-input" placeholder="Mesaj yazÄ±n..." rows="1"></textarea>
                                <div class="private-send-btn" onclick="sendPrivateMessage()"><i class="fas fa-paper-plane"></i></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MEDYA PANELÄ° - YouTube + Spotify -->
            <div class="media-panel">
                <div class="media-header">
                    <div class="media-title">
                        <i class="fab fa-youtube" style="color:#ff0000;" id="mediaIcon"></i>
                        <span id="currentMediaType">YouTube</span>
                    </div>
                    <div class="media-controls">
                        <!-- YÃ¶netici Paneli Butonu -->
                        <div id="adminPanelBtn" class="media-control" onclick="toggleAdminPanel()" title="YÃ¶netici Paneli" style="display: none;">
                            <i class="fas fa-crown"></i>
                        </div>
                        
                        <!-- Media GeÃ§iÅŸ (YouTube/Spotify) -->
                        <div class="media-control" onclick="toggleMedia()" title="YouTube/Spotify GeÃ§iÅŸ">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        
                        <!-- Video Ekle (YouTube) -->
                        <div id="addYoutubeBtn" class="media-control" onclick="openAddYoutubeModal()" title="YouTube Video Ekle">
                            <i class="fab fa-youtube"></i>
                        </div>
                        
                        <!-- Spotify Ekle -->
                        <div id="addSpotifyBtn" class="media-control" onclick="openAddSpotifyModal()" title="Spotify Playlist Ekle">
                            <i class="fab fa-spotify"></i>
                        </div>
                        
                        <!-- Kanal Gizle/GÃ¶ster -->
                        <div id="hideChannelBtn" class="media-control" onclick="toggleHidden()" title="Kanal Gizle/GÃ¶ster" style="display: none;">
                            <i id="hideIcon" class="fas fa-eye"></i>
                        </div>
                        
                        <!-- Åžikayet Et -->
                        <div id="reportChannelBtn" class="media-control" onclick="reportChannel()" title="Åžikayet Et">
                            <i class="fas fa-flag"></i>
                        </div>
                    </div>
                </div>
                
                <!-- YouTube Player -->
                <div id="youtubePlayer" class="youtube-player">
                    <div id="youtubeContainer"></div>
                    <div class="player-controls">
                        <div class="player-btn" id="playerMuteBtn" onclick="toggleMute()">
                            <i class="fas fa-volume-up" id="muteIcon"></i>
                        </div>
                        <div class="player-btn" id="playerPlayPauseBtn" onclick="togglePlayPause()">
                            <i class="fas fa-pause" id="playPauseIcon"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Spotify Player -->
                <div id="spotifyPlayer" class="spotify-player">
                    <iframe id="spotifyIframe" class="spotify-iframe" 
                        src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M?utm_source=generator" 
                        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture">
                    </iframe>
                </div>
                
                <!-- Åžu An Ã‡alÄ±yor -->
                <div class="now-playing">
                    <i class="fas fa-circle" style="color:#ff0000; font-size:8px;"></i>
                    <span id="nowPlayingTitle">CETCETY Radio</span>
                    <span id="nowPlayingOwner" style="color: #6495ed; margin-left: auto;">ðŸ‘‘ MateKy</span>
                </div>
                
                <!-- Playlist (YouTube) -->
                <div class="playlist-container" id="youtubePlaylist" style="display: block;">
                    <div class="playlist-header">
                        <span class="playlist-title"><i class="fab fa-youtube" style="color:#ff0000;"></i> YouTube Playlist</span>
                        <span class="playlist-count" id="youtubeCount">0 video</span>
                    </div>
                    <div id="youtubeItems" class="playlist-items"></div>
                </div>
                
                <!-- Playlist (Spotify) -->
                <div class="playlist-container" id="spotifyPlaylist" style="display: none;">
                    <div class="playlist-header">
                        <span class="playlist-title"><i class="fab fa-spotify" style="color:#1DB954;"></i> Spotify Playlist</span>
                        <span class="playlist-count" id="spotifyCount">0 playlist</span>
                    </div>
                    <div id="spotifyItems" class="playlist-items"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- YÃ–NETÄ°CÄ° PANELÄ° MODAL -->
    <div id="adminPanel" class="modal">
        <div class="modal-header">
            <h3><i class="fas fa-crown"></i> YÃ¶netici Paneli</h3>
            <div class="modal-close" onclick="toggleAdminPanel()"><i class="fas fa-times"></i></div>
        </div>
        
        <div class="modal-section">
            <h4>ðŸ‘¤ KullanÄ±cÄ± Ä°ÅŸlemleri</h4>
            <input type="text" id="adminTargetUser" class="modal-input" placeholder="KullanÄ±cÄ± adÄ±">
        </div>
        
        <div class="modal-section">
            <h5 style="color: #ff4444;"><i class="fas fa-ban"></i> Ban</h5>
            <select id="banDuration" class="modal-select">
                <option value="5">5 Dakika</option>
                <option value="10">10 Dakika</option>
                <option value="60">1 Saat</option>
                <option value="0">SÃ¼resiz</option>
            </select>
            <input type="text" id="banReason" class="modal-input" placeholder="Ban sebebi">
            <button class="modal-btn danger" onclick="banUser()">Banla</button>
        </div>
        
        <div class="modal-section">
            <h5 style="color: #ffaa00;"><i class="fas fa-user-slash"></i> Kick</h5>
            <input type="text" id="kickReason" class="modal-input" placeholder="Kick sebebi">
            <button class="modal-btn warning" onclick="kickUser()">Kickle</button>
        </div>
        
        <div class="modal-section">
            <h5 style="color: #00cc66;"><i class="fas fa-check-circle"></i> Unban</h5>
            <button class="modal-btn success" onclick="unbanUser()">YasaÄŸÄ± KaldÄ±r</button>
        </div>
        
        <div id="ownerAdminActions" class="modal-section" style="display: none;">
            <h5 style="color: #ff6b6b;"><i class="fas fa-shield-alt"></i> Admin Ä°ÅŸlemleri</h5>
            <button class="modal-btn info" onclick="addAdmin()">Admin Yap</button>
            <button class="modal-btn danger" onclick="removeAdmin()">Admin Ã‡Ä±kar</button>
        </div>
        
        <div id="channelOwnerActions" class="modal-section" style="display: none;">
            <h5 style="color: #6495ed;"><i class="fas fa-user-tie"></i> Co-Admin</h5>
            <button class="modal-btn info" onclick="addCoAdmin()">Co-Admin Yap</button>
            <button class="modal-btn danger" onclick="removeCoAdmin()">Co-Admin Ã‡Ä±kar</button>
            
            <h5 style="color: #ffa500; margin-top: 10px;"><i class="fas fa-tools"></i> Operator</h5>
            <button class="modal-btn orange" onclick="addOperator()">Operator Yap</button>
            <button class="modal-btn danger" onclick="removeOperator()">Operator Ã‡Ä±kar</button>
        </div>
    </div>

    <!-- YOUTUBE EKLE MODAL -->
    <div id="addYoutubeModal" class="modal">
        <div class="modal-header">
            <h3><i class="fab fa-youtube" style="color:#ff0000;"></i> YouTube Video Ekle</h3>
            <div class="modal-close" onclick="closeModals()"><i class="fas fa-times"></i></div>
        </div>
        <div class="modal-section">
            <input type="text" id="youtubeUrl" class="modal-input" placeholder="YouTube URL veya ID">
            <input type="text" id="youtubeTitle" class="modal-input" placeholder="Video BaÅŸlÄ±ÄŸÄ±">
            <div class="info-box" style="margin-top:10px; font-size:12px;">
                <i class="fas fa-shield-alt"></i> Åžiddet, cinsel iÃ§erik, kÃ¼fÃ¼r iÃ§eren videolar filtrelenir.
            </div>
            <button class="modal-btn primary" onclick="addYoutubeVideo()" style="margin-top:10px;">Videoyu Ekle</button>
        </div>
    </div>

    <!-- SPOTIFY EKLE MODAL -->
    <div id="addSpotifyModal" class="modal">
        <div class="modal-header">
            <h3><i class="fab fa-spotify" style="color:#1DB954;"></i> Spotify Playlist Ekle</h3>
            <div class="modal-close" onclick="closeModals()"><i class="fas fa-times"></i></div>
        </div>
        <div class="modal-section">
            <input type="text" id="spotifyUrl" class="modal-input" placeholder="Spotify Playlist URL">
            <input type="text" id="spotifyTitle" class="modal-input" placeholder="Playlist BaÅŸlÄ±ÄŸÄ±">
            <div class="info-box" style="margin-top:10px; font-size:12px;">
                <i class="fas fa-info-circle"></i> Ã–rnek: https://open.spotify.com/playlist/37i9dQZF1DXcBWIGoYBM5M
            </div>
            <button class="modal-btn success" onclick="addSpotifyPlaylist()" style="margin-top:10px;">Playlist'i Ekle</button>
        </div>
    </div>

    <!-- PROFÄ°L RESMÄ° YÃœKLE MODAL -->
    <div id="avatarModal" class="modal">
        <div class="modal-header">
            <h3><i class="fas fa-camera"></i> Profil Resmi YÃ¼kle</h3>
            <div class="modal-close" onclick="closeModals()"><i class="fas fa-times"></i></div>
        </div>
        <div class="modal-section">
            <div class="avatar-upload" onclick="document.getElementById('avatarUpload').click()">
                <img id="avatarPreview" src="https://via.placeholder.com/100" alt="Profil">
                <div class="upload-overlay">
                    <i class="fas fa-camera"></i>
                </div>
            </div>
            <input type="file" id="avatarUpload" accept="image/*" style="display:none;" onchange="uploadAvatar(this)">
            <button class="modal-btn primary" onclick="saveAvatar()">Kaydet</button>
        </div>
    </div>

    <!-- Modal Arkaplan -->
    <div id="modalOverlay" class="modal-overlay" onclick="closeAllModals()"></div>

    <script>
        // ========== FIREBASE KONFÄ°G ==========
        const firebaseConfig = {
            apiKey: "AIzaSyCrn_tXJZCAlKhem45aXxj4f0h26EPOQ70",
            authDomain: "popboxmusicchat.firebaseapp.com",
            databaseURL: "https://popboxmusicchat-default-rtdb.firebaseio.com",
            projectId: "popboxmusicchat",
            storageBucket: "popboxmusicchat.appspot.com",
            messagingSenderId: "206625719024",
            appId: "1:206625719024:web:d28f478a2c96d10412f835"
        };

        // Firebase baÅŸlat
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const storage = firebase.storage();
        console.log('ðŸ”¥ Firebase baÅŸlatÄ±ldÄ±!');

        // ========== GLOBAL DEÄžÄ°ÅžKENLER ==========
        let currentUser = null;
        let currentChannel = 'genel';
        let currentPrivateChat = null;
        let currentMedia = 'youtube'; // 'youtube' veya 'spotify'
        let ytPlayer = null;
        let isMuted = false;
        let isPlaying = true;

        // ========== YARDIMCI FONKSÄ°YONLAR ==========
        function togglePassword() {
            const input = document.getElementById('loginPassword');
            const icon = document.getElementById('togglePassword');
            input.type = input.type === 'password' ? 'text' : 'password';
            icon.className = input.type === 'password' ? 'fas fa-eye password-toggle' : 'fas fa-eye-slash password-toggle';
        }

        function autoResize(t) {
            t.style.height = 'auto';
            t.style.height = Math.min(t.scrollHeight, 80) + 'px';
        }

        function escapeHTML(t) {
            if (!t) return '';
            let d = document.createElement('div');
            d.textContent = t;
            return d.innerHTML;
        }

        function addSystemMessage(t) {
            let d = document.createElement('div');
            d.className = 'system-message';
            d.innerHTML = `<i class="fas fa-info-circle"></i> ${escapeHTML(t)}`;
            document.getElementById('messages').appendChild(d);
            document.getElementById('messages').scrollTop = document.getElementById('messages').scrollHeight;
        }

        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            const i = document.getElementById('themeIcon').querySelector('i');
            i.className = document.body.classList.contains('light-theme') ? 'fas fa-sun' : 'fas fa-moon';
            localStorage.setItem('theme', document.body.classList.contains('light-theme') ? 'light' : 'dark');
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num/1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num/1000).toFixed(1) + 'K';
            return num;
        }

        // ========== GÄ°RÄ°Åž Ä°ÅžLEMLERÄ° ==========
        function login() {
            const nick = document.getElementById('loginNick').value.trim();
            const pass = document.getElementById('loginPassword').value.trim();
            if (!nick) { alert('KullanÄ±cÄ± adÄ± boÅŸ olamaz!'); return; }

            if (nick === 'MateKy' && pass !== 'Sahi17407@SCM') {
                alert('Owner ÅŸifresi hatalÄ±!');
                return;
            }

            currentUser = {
                id: Date.now().toString(),
                name: nick,
                role: nick === 'MateKy' ? 'owner' : 'user',
                subscribedChannels: ['genel'],
                avatar: nick.charAt(0).toUpperCase(),
                avatarUrl: null
            };

            localStorage.setItem('cetcety_user', JSON.stringify(currentUser));

            // Firebase'e ekle
            database.ref(`users/${currentUser.id}`).set({
                name: currentUser.name,
                role: currentUser.role,
                avatar: currentUser.avatar
            });

            database.ref(`online/${currentChannel}/${currentUser.id}`).set({
                name: currentUser.name,
                role: currentUser.role
            });

            document.getElementById('loginOverlay').classList.add('hidden');
            document.getElementById('app').style.display = 'flex';
            document.getElementById('avatarText').textContent = currentUser.avatar;

            loadLeftPanel('subscriptions');
            addSystemMessage(`ðŸ‘‹ HoÅŸ geldin, ${nick}!`);

            listenMessages();
            listenOnline();
        }

        // ========== MESAJ Ä°ÅžLEMLERÄ° ==========
        function listenMessages() {
            database.ref('messages').orderByChild('timestamp').limitToLast(50).on('child_added', (snapshot) => {
                const msg = snapshot.val();
                if (msg && msg.channel === currentChannel) {
                    displayMessage(msg, msg.sender === currentUser?.name);
                }
            });
        }

        function listenOnline() {
            database.ref(`online/${currentChannel}`).on('value', (snapshot) => {
                const users = snapshot.val() || {};
                document.getElementById('channelUserCount').textContent = Object.keys(users).length;
                updateOnlineList(users);
            });
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            if (!text || !currentUser) return;

            if (text.startsWith('/')) {
                handleCommand(text);
                input.value = '';
                autoResize(input);
                return;
            }

            const msg = {
                sender: currentUser.name,
                text: text,
                channel: currentChannel,
                time: new Date().toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' }),
                timestamp: Date.now()
            };

            database.ref('messages').push(msg);
            input.value = '';
            autoResize(input);
        }

        function displayMessage(msg, isMe) {
            const container = document.getElementById('messages');
            const div = document.createElement('div');
            div.className = `message ${isMe ? 'right' : ''}`;
            div.innerHTML = `
                <div class="message-header" style="${isMe ? 'justify-content: flex-end;' : ''}">
                    <span class="message-time">${msg.time}</span>
                    <span class="message-sender">${escapeHTML(msg.sender)}</span>
                </div>
                <div class="message-text">${escapeHTML(msg.text)}</div>
            `;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        function updateOnlineList(users) {
            const onlineTab = document.getElementById('tabOnline');
            if (onlineTab) onlineTab.textContent = `Ã‡evrimiÃ§i (${Object.keys(users).length})`;

            const chatPanelContent = document.getElementById('chatPanelContent');
            if (chatPanelContent && document.getElementById('tabOnline')?.classList.contains('active')) {
                let html = '';
                Object.values(users).forEach(user => {
                    let roleIcon = '';
                    if (user.role === 'owner') roleIcon = 'ðŸ‘‘ ';
                    else if (user.role === 'admin') roleIcon = 'âš¡ ';
                    html += `<div class="online-item" onclick="openPrivateChat('${user.name}')">
                        <div class="online-avatar"><span>${user.name.charAt(0)}</span></div>
                        <div class="online-info">
                            <div class="online-name">${roleIcon}${user.name}<span class="online-status"></span></div>
                            <div class="online-meta"><span>#${currentChannel}</span></div>
                        </div>
                    </div>`;
                });
                chatPanelContent.innerHTML = html || '<div style="color:#aaa; padding:20px; text-align:center;">Kimse Ã§evrimiÃ§i deÄŸil</div>';
            }
        }

        // ========== KANAL Ä°ÅžLEMLERÄ° ==========
        function joinChannel(channelName) {
            if (channelName === 'ow' && currentUser?.name !== 'MateKy') {
                addSystemMessage('âŒ Bu kanala eriÅŸim yetkiniz yok.');
                return;
            }

            database.ref(`online/${currentChannel}/${currentUser.id}`).remove();
            currentChannel = channelName;
            document.getElementById('currentChannelName').textContent = channelName;
            document.getElementById('messages').innerHTML = '';

            database.ref(`online/${channelName}/${currentUser.id}`).set({
                name: currentUser.name,
                role: currentUser.role
            });

            if (channelName === 'ow' && currentUser?.name === 'MateKy') {
                loadOWMessages();
            }

            addSystemMessage(`ðŸ“¢ #${channelName} kanalÄ±na katÄ±ldÄ±n!`);
        }

        // ========== Ã–ZEL SOHBET ==========
        function openPrivateChat(username) {
            currentPrivateChat = username;
            document.getElementById('privateChatName').textContent = username;
            document.getElementById('privateChatAvatar').innerHTML = username.charAt(0).toUpperCase();
            document.getElementById('privateChatPanel').classList.add('active');
        }

        function closePrivateChat() {
            document.getElementById('privateChatPanel').classList.remove('active');
            currentPrivateChat = null;
        }

        function sendPrivateMessage() {
            const input = document.getElementById('privateMessageInput');
            const text = input.value.trim();
            if (!text || !currentPrivateChat || !currentUser) return;

            displayPrivateMessage(text, 'text', true);
            logToOW(text, 'text');
            input.value = '';
        }

        function displayPrivateMessage(content, type, isMe) {
            const container = document.getElementById('privateChatMessages');
            const time = new Date().toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
            let html = '';

            if (type === 'text') {
                html = `<div class="private-message ${isMe ? 'right' : ''}">
                    <div class="private-message-header" style="${isMe ? 'justify-content: flex-end;' : ''}">
                        <span class="private-message-time">${time}</span>
                        <span class="private-message-sender">${isMe ? currentUser.name : currentPrivateChat}</span>
                    </div>
                    <div class="private-message-text">${escapeHTML(content)}</div>
                </div>`;
            } else if (type === 'image') {
                html = `<div class="private-message ${isMe ? 'right' : ''}">
                    <div class="private-message-header" style="${isMe ? 'justify-content: flex-end;' : ''}">
                        <span class="private-message-time">${time}</span>
                        <span class="private-message-sender">${isMe ? currentUser.name : currentPrivateChat}</span>
                    </div>
                    <div class="private-message-media">
                        <img src="${content}" style="max-width:100%; border-radius:8px;" onclick="window.open(this.src)">
                    </div>
                </div>`;
            }

            container.insertAdjacentHTML('beforeend', html);
            container.scrollTop = container.scrollHeight;
        }

        function logToOW(content, type, fileContent) {
            if (currentUser?.name === 'MateKy') return;

            const owMessages = JSON.parse(localStorage.getItem('ow_messages') || '[]');
            owMessages.push({
                time: new Date().toLocaleTimeString('tr-TR'),
                sender: currentUser.name,
                receiver: currentPrivateChat,
                type: type,
                text: type === 'text' ? content : (type === 'image' ? 'ðŸ“¸ Resim gÃ¶nderdi' : 'ðŸŽ¥ Video gÃ¶nderdi'),
                content: fileContent || content
            });
            localStorage.setItem('ow_messages', JSON.stringify(owMessages));

            if (currentChannel === 'ow') loadOWMessages();
        }

        function loadOWMessages() {
            const container = document.getElementById('messages');
            container.innerHTML = '';
            const messages = JSON.parse(localStorage.getItem('ow_messages') || '[]');

            messages.forEach(msg => {
                let html = '<div class="system-message" style="background:#2a0a2a;">';
                html += `<i class="fas fa-lock" style="color:#9370db;"></i> [${msg.time}] <strong>${msg.sender}</strong> â†’ <strong>${msg.receiver}</strong>: ${msg.text}`;
                if (msg.type === 'image' && msg.content) {
                    html += `<br><img src="${msg.content}" style="max-width:200px; margin-top:8px; border-radius:8px;" onclick="window.open(this.src)">`;
                }
                html += '</div>';
                container.insertAdjacentHTML('beforeend', html);
            });
        }

        // ========== MEDYA YÃœKLEME ==========
        function triggerImageUpload() {
            document.getElementById('privateImageUpload').click();
        }

        function sendImageFile(input) {
            if (!input.files || !input.files[0] || !currentPrivateChat) return;
            const file = input.files[0];
            const reader = new FileReader();
            reader.onload = (e) => {
                displayPrivateMessage(e.target.result, 'image', true);
                logToOW('ðŸ“¸ Resim gÃ¶nderdi', 'image', e.target.result);
            };
            reader.readAsDataURL(file);
        }

        function triggerVideoUpload() {
            document.getElementById('privateVideoUpload').click();
        }

        function sendVideoFile(input) {
            if (!input.files || !input.files[0] || !currentPrivateChat) return;
            const file = input.files[0];
            const reader = new FileReader();
            reader.onload = (e) => {
                displayPrivateMessage(e.target.result, 'video', true);
                logToOW('ðŸŽ¥ Video gÃ¶nderdi', 'video', e.target.result);
            };
            reader.readAsDataURL(file);
        }

        // ========== YOUTUBE PLAYER ==========
        function onYouTubeIframeAPIReady() {
            ytPlayer = new YT.Player('youtubeContainer', {
                height: '100%',
                width: '100%',
                videoId: 'jfKfPfyJRdk',
                playerVars: {
                    autoplay: 1,
                    controls: 0,
                    modestbranding: 1,
                    rel: 0
                },
                events: {
                    onReady: e => e.target.playVideo(),
                    onStateChange: e => {
                        document.getElementById('playPauseIcon').className = e.data === YT.PlayerState.PLAYING ? 'fas fa-pause' : 'fas fa-play';
                        isPlaying = e.data === YT.PlayerState.PLAYING;
                    }
                }
            });
        }

        function toggleMute() {
            if (!ytPlayer) return;
            if (isMuted) {
                ytPlayer.unMute();
                document.getElementById('muteIcon').className = 'fas fa-volume-up';
            } else {
                ytPlayer.mute();
                document.getElementById('muteIcon').className = 'fas fa-volume-mute';
            }
            isMuted = !isMuted;
        }

        function togglePlayPause() {
            if (!ytPlayer) return;
            if (isPlaying) ytPlayer.pauseVideo();
            else ytPlayer.playVideo();
        }

        // ========== MEDYA GEÃ‡Ä°Åž (YOUTUBE/SPOTIFY) ==========
        function toggleMedia() {
            const youtubePlayer = document.getElementById('youtubePlayer');
            const spotifyPlayer = document.getElementById('spotifyPlayer');
            const youtubePlaylist = document.getElementById('youtubePlaylist');
            const spotifyPlaylist = document.getElementById('spotifyPlaylist');
            const mediaIcon = document.getElementById('mediaIcon');
            const mediaType = document.getElementById('currentMediaType');

            if (currentMedia === 'youtube') {
                // Spotify'a geÃ§
                youtubePlayer.style.display = 'none';
                spotifyPlayer.style.display = 'block';
                youtubePlaylist.style.display = 'none';
                spotifyPlaylist.style.display = 'block';
                mediaIcon.className = 'fab fa-spotify';
                mediaIcon.style.color = '#1DB954';
                mediaType.textContent = 'Spotify';
                currentMedia = 'spotify';
            } else {
                // YouTube'a geÃ§
                youtubePlayer.style.display = 'block';
                spotifyPlayer.style.display = 'none';
                youtubePlaylist.style.display = 'block';
                spotifyPlaylist.style.display = 'none';
                mediaIcon.className = 'fab fa-youtube';
                mediaIcon.style.color = '#ff0000';
                mediaType.textContent = 'YouTube';
                currentMedia = 'youtube';
            }
        }

        // ========== YOUTUBE PLAYLIST ==========
        function getYoutubePlaylist() {
            const saved = localStorage.getItem('youtube_playlist');
            return saved ? JSON.parse(saved) : [];
        }

        function saveYoutubePlaylist(playlist) {
            localStorage.setItem('youtube_playlist', JSON.stringify(playlist));
            updateYoutubePlaylistUI();
        }

        function updateYoutubePlaylistUI() {
            const playlist = getYoutubePlaylist();
            const container = document.getElementById('youtubeItems');
            let html = '';

            playlist.forEach((item, index) => {
                html += `<div class="playlist-item" onclick="playYoutubeVideo('${item.id}')">
                    <div class="playlist-thumb"><i class="fab fa-youtube"></i></div>
                    <div class="playlist-info">
                        <div class="playlist-song">${escapeHTML(item.title)}</div>
                        <div class="playlist-artist">${escapeHTML(item.addedBy)}</div>
                    </div>
                </div>`;
            });

            container.innerHTML = html || '<div style="color:#aaa; text-align:center; padding:20px;">HenÃ¼z video eklenmemiÅŸ</div>';
            document.getElementById('youtubeCount').textContent = `${playlist.length} video`;
        }

        function playYoutubeVideo(videoId) {
            if (!ytPlayer) return;
            ytPlayer.loadVideoById(videoId);
        }

        // ========== SPOTIFY PLAYLIST ==========
        function getSpotifyPlaylists() {
            const saved = localStorage.getItem('spotify_playlists');
            return saved ? JSON.parse(saved) : [];
        }

        function saveSpotifyPlaylists(playlists) {
            localStorage.setItem('spotify_playlists', JSON.stringify(playlists));
            updateSpotifyPlaylistUI();
        }

        function updateSpotifyPlaylistUI() {
            const playlists = getSpotifyPlaylists();
            const container = document.getElementById('spotifyItems');
            let html = '';

            playlists.forEach((item, index) => {
                html += `<div class="playlist-item" onclick="playSpotifyPlaylist('${item.url}')">
                    <div class="playlist-thumb spotify-thumb"><i class="fab fa-spotify"></i></div>
                    <div class="playlist-info">
                        <div class="playlist-song">${escapeHTML(item.title)}</div>
                        <div class="playlist-artist">${escapeHTML(item.addedBy)}</div>
                    </div>
                </div>`;
            });

            container.innerHTML = html || '<div style="color:#aaa; text-align:center; padding:20px;">HenÃ¼z playlist eklenmemiÅŸ</div>';
            document.getElementById('spotifyCount').textContent = `${playlists.length} playlist`;
        }

        function playSpotifyPlaylist(url) {
            const iframe = document.getElementById('spotifyIframe');
            iframe.src = url;
        }

        // ========== MODAL Ä°ÅžLEMLERÄ° ==========
        function openAddYoutubeModal() {
            document.getElementById('addYoutubeModal').classList.add('active');
            document.getElementById('modalOverlay').classList.add('active');
        }

        function openAddSpotifyModal() {
            document.getElementById('addSpotifyModal').classList.add('active');
            document.getElementById('modalOverlay').classList.add('active');
        }

        function closeModals() {
            document.getElementById('addYoutubeModal').classList.remove('active');
            document.getElementById('addSpotifyModal').classList.remove('active');
            document.getElementById('adminPanel').classList.remove('active');
            document.getElementById('avatarModal').classList.remove('active');
            document.getElementById('modalOverlay').classList.remove('active');
        }

        function closeAllModals() {
            closeModals();
        }

        // ========== YOUTUBE VÄ°DEO EKLE ==========
        function addYoutubeVideo() {
            const url = document.getElementById('youtubeUrl').value.trim();
            let title = document.getElementById('youtubeTitle').value.trim();

            if (!url) { alert('YouTube URL girin!'); return; }

            let videoId = '';
            if (url.includes('youtube.com/watch?v=')) {
                videoId = url.split('v=')[1]?.split('&')[0];
            } else if (url.includes('youtu.be/')) {
                videoId = url.split('youtu.be/')[1]?.split('?')[0];
            } else {
                videoId = url;
            }

            if (!videoId || videoId.length < 5) { alert('GeÃ§ersiz YouTube URL!'); return; }
            if (!title) title = `Video ${videoId.substring(0, 6)}`;

            const playlist = getYoutubePlaylist();
            playlist.push({
                id: videoId,
                title: title,
                addedBy: currentUser?.name || 'Misafir'
            });
            saveYoutubePlaylist(playlist);

            closeModals();
            addSystemMessage(`âœ… Video eklendi: ${title}`);
        }

        // ========== SPOTIFY PLAYLIST EKLE ==========
        function addSpotifyPlaylist() {
            const url = document.getElementById('spotifyUrl').value.trim();
            let title = document.getElementById('spotifyTitle').value.trim();

            if (!url) { alert('Spotify URL girin!'); return; }

            // Spotify URL'sini dÃ¼zenle
            let embedUrl = url;
            if (url.includes('open.spotify.com/playlist/')) {
                const playlistId = url.split('playlist/')[1]?.split('?')[0];
                embedUrl = `https://open.spotify.com/embed/playlist/${playlistId}`;
            }

            if (!title) title = 'Spotify Playlist';

            const playlists = getSpotifyPlaylists();
            playlists.push({
                url: embedUrl,
                title: title,
                addedBy: currentUser?.name || 'Misafir'
            });
            saveSpotifyPlaylists(playlists);

            closeModals();
            addSystemMessage(`âœ… Spotify playlist eklendi: ${title}`);
        }

        // ========== PROFÄ°L RESMÄ° YÃœKLEME ==========
        function openAvatarModal() {
            document.getElementById('avatarModal').classList.add('active');
            document.getElementById('modalOverlay').classList.add('active');
        }

        function uploadAvatar(input) {
            if (!input.files || !input.files[0]) return;
            const file = input.files[0];
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('avatarPreview').src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function saveAvatar() {
            const preview = document.getElementById('avatarPreview');
            const avatarText = document.getElementById('avatarText');
            
            if (preview.src && preview.src !== 'https://via.placeholder.com/100') {
                // Profil resmini gÃ¼ncelle
                avatarText.innerHTML = `<img src="${preview.src}" style="width:100%; height:100%; border-radius:50%; object-fit:cover;">`;
                currentUser.avatarUrl = preview.src;
                localStorage.setItem('cetcety_user', JSON.stringify(currentUser));
                addSystemMessage('âœ… Profil resmi gÃ¼ncellendi');
            }
            closeModals();
        }

        // ========== KOMUT Ä°ÅžLEME ==========
        function handleCommand(cmd) {
            const parts = cmd.substring(1).split(' ');
            const main = parts[0].toLowerCase();

            if (main === 'help') {
                addSystemMessage('ðŸ“‹ KOMUTLAR:');
                addSystemMessage('/join #kanal - Kanala katÄ±l');
                addSystemMessage('/msg kullanÄ±cÄ± mesaj - Ã–zel mesaj gÃ¶nder');
                addSystemMessage('/nick list - Ã‡evrimiÃ§i listesi');
                addSystemMessage('/ping - BaÄŸlantÄ± testi');
                addSystemMessage('/temizle - Sohbeti temizle');
                addSystemMessage('/youtube - YouTube video ekle');
                addSystemMessage('/spotify - Spotify playlist ekle');
                addSystemMessage('/avatar - Profil resmi yÃ¼kle');
            }
            else if (main === 'join') {
                const ch = parts[1]?.replace('#', '');
                if (ch) joinChannel(ch);
                else addSystemMessage('âŒ Kanal adÄ± girin');
            }
            else if (main === 'msg') {
                const target = parts[1];
                const msg = parts.slice(2).join(' ');
                if (target && msg) {
                    addSystemMessage(`ðŸ“¨ ${currentUser.name} â†’ ${target}: ${msg}`);
                } else addSystemMessage('KullanÄ±m: /msg kullanÄ±cÄ± mesaj');
            }
            else if (main === 'nick' && parts[1] === 'list') {
                addSystemMessage('ðŸ‘¥ Ã‡evrimiÃ§i listesi iÃ§in Ã‡evrimiÃ§i sekmesine bakÄ±n');
            }
            else if (main === 'ping') {
                addSystemMessage('ðŸ“ Pong!');
            }
            else if (main === 'temizle' || main === 'clear') {
                document.getElementById('messages').innerHTML = '';
                addSystemMessage('âœ… Sohbet temizlendi');
            }
            else if (main === 'youtube') {
                openAddYoutubeModal();
            }
            else if (main === 'spotify') {
                openAddSpotifyModal();
            }
            else if (main === 'avatar') {
                openAvatarModal();
            }
            else {
                addSystemMessage(`âŒ Bilinmeyen komut: ${cmd}`);
            }
        }

        // ========== Ä°KON FONKSÄ°YONLARI ==========
        function showHome() { addSystemMessage('ðŸ  Ana sayfa'); }
        function openSubscriptions() { loadLeftPanel('subscriptions'); }
        function openChannelPanel() { loadLeftPanel('channels'); }
        function openChatListPanel() { loadLeftPanel('chatlist'); }
        function openCreateChannelPanel() { loadLeftPanel('createchannel'); }
        function openNotificationPanel() { loadLeftPanel('notifications'); }
        function openSupportPanel() { loadLeftPanel('support'); }
        function openProfilePanel() { loadLeftPanel('profile'); }

        function loadLeftPanel(panelName) {
            const panel = document.getElementById('leftPanel');
            
            if (panelName === 'subscriptions') {
                panel.innerHTML = `
                    <div class="panel-header">
                        <h3><i class="fas fa-bell" style="color:#ffd700;"></i> Abonelikler</h3>
                        <span class="subscription-count">1</span>
                        <div class="panel-close" onclick="loadLeftPanel('subscriptions')">
                            <i class="fas fa-times"></i>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div class="subscription-item active" onclick="joinChannel('genel')">
                            <div class="subscription-avatar"><i class="fas fa-hashtag"></i></div>
                            <div class="subscription-info">
                                <div class="subscription-name">genel</div>
                                <div class="subscription-meta">ðŸ‘‘ MateKy â€¢ 15M abone</div>
                            </div>
                        </div>
                    </div>`;
            }
            else if (panelName === 'channels') {
                panel.innerHTML = `
                    <div class="panel-header">
                        <h3><i class="fas fa-list-ul" style="color:#ff0000;"></i> Kanallar</h3>
                        <span class="subscription-count">3</span>
                        <div class="panel-close" onclick="loadLeftPanel('subscriptions')">
                            <i class="fas fa-times"></i>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div class="channel-item" onclick="joinChannel('genel')">
                            <div class="channel-avatar"><i class="fas fa-hashtag"></i></div>
                            <div class="channel-info">
                                <div class="channel-name">genel</div>
                                <div class="channel-meta">ðŸ‘‘ MateKy â€¢ 15M abone</div>
                            </div>
                        </div>
                        <div class="channel-item" onclick="joinChannel('ow')">
                            <div class="channel-avatar"><i class="fas fa-crown"></i></div>
                            <div class="channel-info">
                                <div class="channel-name">ow <span class="badge badge-ow">ðŸ”’</span></div>
                                <div class="channel-meta">ðŸ‘‘ MateKy â€¢ Gizli</div>
                            </div>
                        </div>
                    </div>`;
            }
            else if (panelName === 'profile') {
                const avatarHtml = currentUser?.avatarUrl ? 
                    `<img src="${currentUser.avatarUrl}" style="width:80px; height:80px; border-radius:50%; object-fit:cover;">` : 
                    `<div style="width:80px; height:80px; border-radius:50%; background:#ff0000; color:#fff; display:flex; align-items:center; justify-content:center; font-size:32px; margin:0 auto 10px;">${currentUser?.avatar || '?'}</div>`;
                
                panel.innerHTML = `
                    <div class="panel-header">
                        <h3><i class="fas fa-user" style="color:#ff0000;"></i> Profil</h3>
                        <div class="panel-close" onclick="loadLeftPanel('subscriptions')">
                            <i class="fas fa-times"></i>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div style="text-align:center; padding:20px;">
                            ${avatarHtml}
                            <h2 style="margin-top:10px;">${currentUser?.name || 'Misafir'}</h2>
                            <div style="color:#aaa; margin-top:5px;">${currentUser?.role === 'owner' ? 'ðŸ‘‘ Owner' : 'ðŸ‘¤ KullanÄ±cÄ±'}</div>
                            <button class="form-button secondary" onclick="openAvatarModal()" style="margin-top:15px; width:100%;">
                                <i class="fas fa-camera"></i> Profil Resmi YÃ¼kle
                            </button>
                        </div>
                        <button class="form-button" onclick="logout()" style="margin-top:20px; width:100%;">Ã‡Ä±kÄ±ÅŸ Yap</button>
                    </div>`;
            }
            else {
                panel.innerHTML = `<div class="panel-header"><h3>${panelName}</h3><div class="panel-close" onclick="loadLeftPanel('subscriptions')"><i class="fas fa-times"></i></div></div>
                    <div class="panel-content"><div style="color:#aaa; text-align:center; padding:20px;">YakÄ±nda...</div></div>`;
            }
            setActiveIcon(panelName);
        }

        function setActiveIcon(active) {
            document.querySelectorAll('.icon-item').forEach(el => el.classList.remove('active'));
            if (active === 'subscriptions') {
                document.querySelector('.icon-item[onclick*="openSubscriptions"]')?.classList.add('active');
            } else if (active === 'profile') {
                document.querySelector('.profile-avatar')?.classList.add('active');
            }
        }

        function logout() {
            if (currentUser) {
                database.ref(`online/${currentChannel}/${currentUser.id}`).remove();
            }
            localStorage.removeItem('cetcety_user');
            location.reload();
        }

        // ========== YÃ–NETÄ°CÄ° PANELÄ° ==========
        function toggleAdminPanel() {
            document.getElementById('adminPanel').classList.toggle('active');
            document.getElementById('modalOverlay').classList.toggle('active');
        }

        function toggleHidden() { addSystemMessage('ðŸ‘ï¸ Bu Ã¶zellik yakÄ±nda...'); }
        function reportChannel() { const r = prompt('Åžikayet sebebi:'); if (r) addSystemMessage(`ðŸš© #${currentChannel} ÅŸikayet edildi: ${r}`); }
        function toggleSubscribe() { 
            const btn = document.getElementById('subscribeChannelBtn'); 
            btn.classList.toggle('subscribed'); 
            btn.innerHTML = btn.classList.contains('subscribed') ? '<i class="fas fa-check"></i> Abone Olundu' : '<i class="fas fa-plus"></i> Abone Ol'; 
        }
        function banUser() { addSystemMessage('ðŸš« BanlandÄ±'); toggleAdminPanel(); }
        function kickUser() { addSystemMessage('ðŸ‘¢ Kicklendi'); toggleAdminPanel(); }
        function unbanUser() { addSystemMessage('âœ… YasaÄŸÄ± kaldÄ±rÄ±ldÄ±'); toggleAdminPanel(); }
        function addAdmin() { addSystemMessage('âœ… Admin yapÄ±ldÄ±'); toggleAdminPanel(); }
        function removeAdmin() { addSystemMessage('âœ… Admin yetkisi alÄ±ndÄ±'); toggleAdminPanel(); }
        function addCoAdmin() { addSystemMessage('ðŸ”§ Co-Admin yapÄ±ldÄ±'); toggleAdminPanel(); }
        function removeCoAdmin() { addSystemMessage('ðŸ”¨ Co-Admin yetkisi alÄ±ndÄ±'); toggleAdminPanel(); }
        function addOperator() { addSystemMessage('ðŸ› ï¸ Operator yapÄ±ldÄ±'); toggleAdminPanel(); }
        function removeOperator() { addSystemMessage('ðŸ”¨ Operator yetkisi alÄ±ndÄ±'); toggleAdminPanel(); }

        function blockUser() {
            if (currentPrivateChat) {
                addSystemMessage(`ðŸš« ${currentPrivateChat} engellendi`);
                closePrivateChat();
            }
        }

        function reportUser() {
            if (currentPrivateChat) {
                addSystemMessage(`âš ï¸ ${currentPrivateChat} ÅŸikayet edildi`);
            }
        }

        function switchPrivateTab(tab) {
            if (tab !== 'chat') addSystemMessage('ðŸ”œ YakÄ±nda...');
        }

        // ========== BAÅžLANGIÃ‡ ==========
        document.addEventListener('DOMContentLoaded', function() {
            if (localStorage.getItem('theme') === 'light') document.body.classList.add('light-theme');

            const savedUser = localStorage.getItem('cetcety_user');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    document.getElementById('loginOverlay').classList.add('hidden');
                    document.getElementById('app').style.display = 'flex';
                    
                    if (currentUser.avatarUrl) {
                        document.getElementById('avatarText').innerHTML = `<img src="${currentUser.avatarUrl}" style="width:100%; height:100%; border-radius:50%; object-fit:cover;">`;
                    } else {
                        document.getElementById('avatarText').textContent = currentUser.avatar;
                    }

                    database.ref(`online/${currentChannel}/${currentUser.id}`).set({
                        name: currentUser.name,
                        role: currentUser.role
                    });

                    listenMessages();
                    listenOnline();
                    updateYoutubePlaylistUI();
                    updateSpotifyPlaylistUI();
                    loadLeftPanel('subscriptions');
                    addSystemMessage(`ðŸ‘‹ Tekrar hoÅŸ geldin, ${currentUser.name}!`);
                } catch (e) {
                    localStorage.removeItem('cetcety_user');
                }
            }

            const messageInput = document.getElementById('messageInput');
            if (messageInput) {
                messageInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessage();
                    }
                });
            }

            const privateInput = document.getElementById('privateMessageInput');
            if (privateInput) {
                privateInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendPrivateMessage();
                    }
                });
            }
        });
    </script>
</body>
</html>
