<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Popbox Music Chat - Geli≈ümi≈ü Sohbet Platformu</title>
    <!-- FIREBASE SDK v8 -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <style>
        /* YOUTUBE MUSIC TEMA (Varsayƒ±lan) */
        :root {
            /* YouTube Music Renkleri */
            --youtube-red: #ff0000;
            --youtube-dark: #0f0f0f;
            --youtube-light-dark: #212121;
            --youtube-chat-bg: #181818;
            --youtube-chat-input: #272727;
            --youtube-text: #ffffff;
            --youtube-text-secondary: #aaa;
            --youtube-hover: #272727;
            
            /* UI Renkleri */
            --primary: #ff0000;
            --secondary: #ff5555;
            --private: #9c27b0;
            --coadmin: #ff9800;
            --operator: #3b82f6;
            --owner: #ff4081;
            --online: #4caf50;
            --firebase: #ffa000;
            --ban-color: #ff3333;
            --story-color: #ff6b6b;
            --report-color: #ff4444;
            
            /* Layout */
            --bg-primary: var(--youtube-dark);
            --bg-secondary: var(--youtube-chat-bg);
            --text-primary: var(--youtube-text);
            --text-secondary: var(--youtube-text-secondary);
            --input-bg: var(--youtube-chat-input);
            --header-bg: var(--youtube-dark);
            --border-color: rgba(255,255,255,0.1);
            
            /* Mesaj Renkleri */
            --message-user-bg: rgba(255,255,255,0.05);
            --message-admin-bg: rgba(255,0,0,0.15);
            --message-coadmin-bg: rgba(255,152,0,0.15);
            --message-operator-bg: rgba(59,130,246,0.15);
            --message-owner-bg: rgba(255,64,129,0.15);
            --message-system-bg: rgba(255,255,255,0.05);
            --message-private-bg: rgba(156,39,176,0.15);
            --message-ban-bg: rgba(255,51,51,0.15);
            --message-story-bg: rgba(255,107,107,0.15);
            --message-report-bg: rgba(255,68,68,0.15);
        }
        
        /* GECE TEMA (Koyu) */
        body.night-mode {
            --bg-primary: #1a1a2e;
            --bg-secondary: #2d2d44;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --input-bg: rgba(0,0,0,0.3);
            --header-bg: rgba(0,0,0,0.4);
            --border-color: rgba(79, 195, 247, 0.2);
            
            --primary: #4fc3f7;
            --secondary: #ff5555;
            --private: #9c27b0;
            --coadmin: #ff9800;
            --operator: #3b82f6;
            --owner: #ff4081;
            --online: #4caf50;
            --firebase: #ffa000;
            --ban-color: #ff3333;
            --story-color: #ff6b6b;
            --report-color: #ff4444;
            
            --message-user-bg: rgba(255,255,255,0.07);
            --message-admin-bg: rgba(255,85,85,0.1);
            --message-coadmin-bg: rgba(255,152,0,0.1);
            --message-operator-bg: rgba(59,130,246,0.1);
            --message-owner-bg: rgba(255,64,129,0.1);
            --message-system-bg: rgba(76,175,80,0.1);
            --message-private-bg: rgba(156,39,176,0.1);
            --message-ban-bg: rgba(255,51,51,0.1);
            --message-story-bg: rgba(255,107,107,0.1);
            --message-report-bg: rgba(255,68,68,0.1);
        }
        
        /* G√úND√úZ TEMA (A√ßƒ±k) */
        body.light-mode {
            --bg-primary: #f5f5f5;
            --bg-secondary: #ffffff;
            --text-primary: #333333;
            --text-secondary: #666666;
            --input-bg: rgba(0,0,0,0.05);
            --header-bg: rgba(79, 195, 247, 0.1);
            --border-color: rgba(0,0,0,0.1);
            
            --primary: #2196f3;
            --secondary: #f44336;
            --private: #9c27b0;
            --coadmin: #ff9800;
            --operator: #3b82f6;
            --owner: #ff4081;
            --online: #4caf50;
            --firebase: #ffa000;
            --ban-color: #ff3333;
            --story-color: #ff6b6b;
            --report-color: #ff4444;
            
            --message-user-bg: rgba(0,0,0,0.05);
            --message-admin-bg: rgba(244,67,54,0.15);
            --message-coadmin-bg: rgba(255,152,0,0.15);
            --message-operator-bg: rgba(59,130,246,0.15);
            --message-owner-bg: rgba(255,64,129,0.15);
            --message-system-bg: rgba(76,175,80,0.15);
            --message-private-bg: rgba(156,39,176,0.15);
            --message-ban-bg: rgba(255,51,51,0.15);
            --message-story-bg: rgba(255,107,107,0.15);
            --message-report-bg: rgba(255,68,68,0.15);
        }
        
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            height: 100%;
            width: 100%;
            overflow: hidden;
            position: fixed;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        /* HEADER - YouTube Music Style */
        .youtube-header {
            height: 64px;
            background: var(--header-bg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            border-bottom: 1px solid var(--border-color);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            flex-shrink: 0;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .header-left, .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: bold;
            color: var(--primary);
            font-size: 22px;
        }
        
        .logo-icon {
            color: var(--primary);
            font-size: 28px;
        }
        
        .user-badges {
            display: flex;
            gap: 6px;
        }
        
        .badge {
            font-size: 12px;
            padding: 4px 10px;
            border-radius: 16px;
            display: none;
            color: white;
            font-weight: 500;
        }
        
        .badge.admin { background: var(--secondary); }
        .badge.coadmin { background: var(--coadmin); }
        .badge.operator { background: var(--operator); }
        .badge.owner { background: var(--owner); }
        .badge.story { background: var(--story-color); }
        
        /* STORY/Hƒ∞KAYE B√ñL√úM√ú */
        .story-section {
            position: relative;
        }
        
        .story-toggle-btn {
            background: none;
            border: none;
            color: var(--story-color);
            font-size: 22px;
            cursor: pointer;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.2s ease;
        }
        
        .story-toggle-btn:hover {
            transform: scale(1.1);
        }
        
        .story-toggle-btn.active {
            color: var(--owner);
        }
        
        .story-toggle-badge {
            position: absolute;
            top: 0;
            right: 0;
            background: var(--story-color);
            color: white;
            font-size: 10px;
            font-weight: bold;
            min-width: 18px;
            height: 18px;
            border-radius: 9px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 4px;
            display: none;
        }
        
        /* Bƒ∞LDƒ∞Rƒ∞M Sƒ∞STEMƒ∞ */
        .notification-section {
            position: relative;
        }
        
        .notification-icon {
            position: relative;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 22px;
            cursor: pointer;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .notification-icon:hover {
            transform: scale(1.1);
        }
        
        .notification-badge {
            position: absolute;
            top: 0;
            right: 0;
            background: #ff0000;
            color: white;
            font-size: 10px;
            font-weight: bold;
            min-width: 18px;
            height: 18px;
            border-radius: 9px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 4px;
            display: none;
        }
        
        /* ANA LAYOUT */
        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
            margin-top: 64px;
            height: calc(100vh - 64px);
            transition: all 0.3s ease;
        }
        
        /* VIDEO CONTAINER */
        .video-container {
            background: #000;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        .video-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            background: #000;
        }
        
        #youtube-player {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .video-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: linear-gradient(45deg, var(--primary), var(--coadmin));
            color: white;
        }
        
        /* CHAT CONTAINER - GENƒ∞≈û */
        .chat-container {
            background: var(--bg-secondary);
            border-left: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            flex: 1;
            height: 100%;
            transition: all 0.3s ease;
            min-width: 400px;
        }
        
        .chat-header {
            height: 64px;
            padding: 0 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--border-color);
            flex-shrink: 0;
            background: var(--bg-secondary);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }
        
        .chat-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
        }
        
        .chat-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        
        .story-create-btn {
            background: var(--story-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.2s ease;
        }
        
        .story-create-btn:hover {
            transform: scale(1.1);
        }
        
        .online-count {
            background: rgba(0,0,0,0.1);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
            color: var(--text-primary);
        }
        
        /* GENƒ∞≈û MESAJLAR ALANI */
        .messages-area {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 16px;
            min-height: 0;
            background: var(--bg-secondary);
            transition: all 0.3s ease;
        }
        
        .yt-message {
            background: var(--message-user-bg);
            padding: 12px 16px;
            border-radius: 12px;
            position: relative;
            animation: fadeIn 0.3s ease;
            border-left: 4px solid var(--primary);
            transition: all 0.3s ease;
            margin-bottom: 4px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .yt-message.admin {
            background: var(--message-admin-bg);
            border-left-color: var(--secondary);
        }
        
        .yt-message.coadmin {
            background: var(--message-coadmin-bg);
            border-left-color: var(--coadmin);
        }
        
        .yt-message.operator {
            background: var(--message-operator-bg);
            border-left-color: var(--operator);
        }
        
        .yt-message.owner {
            background: var(--message-owner-bg);
            border-left-color: var(--owner);
        }
        
        .yt-message.system {
            background: var(--message-system-bg);
            border-left-color: var(--online);
            text-align: center;
            font-size: 15px;
        }
        
        .message-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .message-user {
            font-weight: 600;
            font-size: 15px;
            color: var(--text-primary);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 8px;
            border-radius: 6px;
            transition: background 0.2s;
        }
        
        .message-user:hover {
            background: rgba(0,0,0,0.1);
        }
        
        .message-time {
            color: var(--text-secondary);
            font-size: 13px;
        }
        
        .message-content {
            font-size: 15px;
            line-height: 1.5;
            word-break: break-word;
            color: var(--text-primary);
        }
        
        .delete-btn {
            background: rgba(255,85,85,0.2);
            color: var(--secondary);
            border: none;
            border-radius: 6px;
            padding: 4px 10px;
            font-size: 12px;
            cursor: pointer;
            margin-left: 8px;
            display: none;
            transition: all 0.2s ease;
        }
        
        .delete-btn:hover {
            background: rgba(255,85,85,0.3);
        }
        
        .yt-message:hover .delete-btn {
            display: inline-block;
        }
        
        /* CHAT INPUT */
        .chat-input-area {
            padding: 20px 24px;
            border-top: 1px solid var(--border-color);
            background: var(--bg-secondary);
            flex-shrink: 0;
            transition: all 0.3s ease;
        }
        
        .input-wrapper {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        
        #message-input {
            flex: 1;
            padding: 14px 20px;
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 24px;
            color: var(--text-primary);
            font-size: 15px;
            outline: none;
            min-height: 48px;
            max-height: 150px;
            resize: none;
            transition: all 0.3s ease;
            font-family: inherit;
        }
        
        #message-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(255,0,0,0.1);
        }
        
        #message-input::placeholder {
            color: var(--text-secondary);
        }
        
        .send-button {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--primary);
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            flex-shrink: 0;
            transition: all 0.3s ease;
            font-size: 20px;
        }
        
        .send-button:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(255,0,0,0.3);
        }
        
        /* ONLINE USERS SIDEBAR */
        .users-sidebar {
            width: 300px;
            background: var(--bg-secondary);
            border-left: 1px solid var(--border-color);
            padding: 20px;
            overflow-y: auto;
            display: none;
            flex-direction: column;
            gap: 10px;
            flex-shrink: 0;
            transition: all 0.3s ease;
            position: absolute;
            right: 0;
            top: 64px;
            bottom: 0;
            z-index: 999;
            box-shadow: -5px 0 20px rgba(0,0,0,0.3);
        }
        
        .users-sidebar.active {
            display: flex;
        }
        
        .users-title {
            font-size: 16px;
            color: var(--text-secondary);
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .close-sidebar {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .user-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 4px solid var(--online);
            background: rgba(0,0,0,0.05);
            color: var(--text-primary);
            margin-bottom: 4px;
        }
        
        .user-item:hover {
            background: rgba(0,0,0,0.1);
            transform: translateX(-2px);
        }
        
        /* Gƒ∞Rƒ∞≈û EKRANI - BLUR EFFECT */
        #login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            transition: all 0.3s ease;
        }
        
        .login-container {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            padding: 40px;
            width: 90%;
            max-width: 450px;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            transition: all 0.3s ease;
            backdrop-filter: blur(30px);
        }
        
        .login-title {
            text-align: center;
            margin-bottom: 32px;
            color: var(--primary);
            font-size: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        
        .login-input {
            width: 100%;
            padding: 16px 20px;
            margin-bottom: 16px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .login-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255,0,0,0.2);
            background: rgba(255,255,255,0.15);
        }
        
        .login-button {
            width: 100%;
            padding: 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 12px;
            transition: all 0.3s ease;
        }
        
        .login-button:hover {
            background: #ff3333;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255,0,0,0.3);
        }
        
        .login-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        /* TEMA BUTONU */
        .theme-toggle {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            border: none;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1001;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            font-size: 20px;
        }
        
        .theme-toggle:hover {
            background: rgba(255,255,255,0.2);
            transform: scale(1.1) rotate(30deg);
        }
        
        /* ONLINE Lƒ∞STE BUTONU */
        .online-list-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 24px;
            padding: 10px 20px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px;
        }
        
        .online-list-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: scale(1.05);
        }
        
        /* MOBƒ∞L LAYOUT */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
                margin-top: 64px;
                height: calc(100vh - 64px);
            }
            
            .video-container {
                width: 100%;
                height: 35vh !important;
            }
            
            .chat-container {
                width: 100%;
                height: 65vh !important;
                min-width: unset;
                border-left: none;
                border-top: 1px solid var(--border-color);
            }
            
            .messages-area {
                padding: 16px;
                padding-bottom: 80px;
            }
            
            .chat-input-area {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: var(--bg-secondary);
                border-top: 1px solid var(--border-color);
                z-index: 100;
                padding: 16px;
            }
            
            .users-sidebar {
                display: none;
                position: fixed;
                top: 64px;
                left: 0;
                width: 100%;
                height: calc(100vh - 64px);
                z-index: 200;
            }
            
            .youtube-header {
                padding: 0 16px;
            }
            
            .header-left, .header-right {
                gap: 12px;
            }
            
            .logo {
                font-size: 18px;
            }
            
            .online-list-btn {
                padding: 8px 12px;
            }
        }
        
        /* WEB LAYOUT */
        @media (min-width: 769px) {
            .video-container {
                flex: 2;
                width: 40%;
            }
            
            .chat-container {
                flex: 3;
                width: 60%;
            }
        }
        
        /* B√úY√úK EKRAN */
        @media (min-width: 1200px) {
            .video-container {
                flex: 1;
                width: 30%;
            }
            
            .chat-container {
                flex: 2;
                width: 70%;
            }
        }
        
        /* SCROLLBAR */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.1);
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* UTILITY */
        .hidden {
            display: none !important;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="youtube-music-mode">
    <!-- HEADER -->
    <div class="youtube-header">
        <div class="header-left">
            <button class="mobile-menu-btn" onclick="toggleUserList()" style="background:none; border:none; color:var(--text-primary); font-size:24px; cursor:pointer; padding:8px; display:none;">üë•</button>
            <div class="logo">
                <span class="logo-icon">üéµ</span>
                <span>Popbox Music</span>
                <div class="user-badges">
                    <span class="badge owner" id="ownerBadge">ü§¥ OWNER</span>
                    <span class="badge admin" id="adminBadge">‚≠êÔ∏è ADMIN</span>
                    <span class="badge coadmin" id="coadminBadge">‚ö°Ô∏è CO-ADMIN</span>
                    <span class="badge operator" id="operatorBadge">üõ†Ô∏è OPERATOR</span>
                </div>
            </div>
        </div>
        <div class="header-right">
            <button class="online-list-btn" onclick="toggleUserList()">
                <span>üë•</span>
                <span id="onlineCount">0</span>
            </button>
            <button class="theme-toggle" onclick="toggleTheme()" title="Tema deƒüi≈ütir">üé®</button>
        </div>
    </div>
    
    <!-- ANA CONTAINER -->
    <div class="main-container">
        <!-- VIDEO B√ñL√úM√ú -->
        <div class="video-container">
            <div class="video-wrapper">
                <div id="youtube-player"></div>
                <div class="video-placeholder">
                    <div style="font-size: 60px; margin-bottom: 20px;">üéµ</div>
                    <div style="font-size: 24px; font-weight: 600;">Popbox Music Live</div>
                    <div style="font-size: 16px; opacity: 0.8; margin-top: 12px;">Canlƒ± m√ºzik dinleme ve sohbet</div>
                </div>
            </div>
        </div>
        
        <!-- GENƒ∞≈û CHAT B√ñL√úM√ú -->
        <div class="chat-container">
            <div class="chat-header">
                <div class="chat-title">üé§ Genel Sohbet</div>
                <div class="chat-actions">
                    <div class="online-count">
                        <span id="chatOnlineCount">0</span> ki≈üi online
                    </div>
                </div>
            </div>
            
            <div class="messages-area" id="messages">
                <div class="yt-message system">
                    üéâ Popbox Music Live'e ho≈ü geldiniz! Canlƒ± sohbete katƒ±lƒ±n ve m√ºzik keyfini birlikte ya≈üayƒ±n.
                </div>
            </div>
            
            <div class="chat-input-area">
                <div class="input-wrapper">
                    <textarea 
                        id="message-input" 
                        placeholder="Mesajƒ±nƒ±zƒ± yazƒ±n... (Enter ile g√∂nder, Shift+Enter ile yeni satƒ±r)"
                        rows="1"
                        oninput="autoResize(this)"
                    ></textarea>
                    <button class="send-button" onclick="sendMessage()">
                        ‚Üó
                    </button>
                </div>
            </div>
        </div>
        
        <!-- ONLINE KULLANICILAR SIDEBAR -->
        <div class="users-sidebar" id="usersSidebar">
            <div class="users-title">
                <span>üéß Online Dinleyiciler</span>
                <button class="close-sidebar" onclick="toggleUserList()">√ó</button>
            </div>
            <div id="userList">
                <!-- Kullanƒ±cƒ±lar buraya eklenecek -->
            </div>
        </div>
    </div>
    
    <!-- Gƒ∞Rƒ∞≈û EKRANI -->
    <div id="login-screen">
        <div class="login-container">
            <div class="login-title">
                <span class="logo-icon">üéµ</span>
                Popbox Music Live
            </div>
            
            <div class="login-subtitle" style="color: rgba(255,255,255,0.8); text-align: center; margin-bottom: 24px; font-size: 15px;">
                üî• Firebase Realtime Chat<br>
                üéß Canlƒ± M√ºzik Dinleme<br>
                üí¨ Geni≈ü Sohbet Alanƒ±<br>
                üëë Yetkili Sistemi
            </div>
            
            <input 
                type="text" 
                id="login-nick" 
                class="login-input" 
                placeholder="Kullanƒ±cƒ± adƒ±nƒ±z"
                autocomplete="off"
                autofocus
            >
            
            <div id="login-error" style="color: #ff5555; margin: 16px 0; font-size: 14px; text-align: center; display: none;"></div>
            
            <button class="login-button" onclick="login()" id="login-btn">
                üéµ M√ºzik Dinlemeye Ba≈üla
            </button>
            
            <div style="margin-top: 24px; text-align: center; font-size: 13px; color: rgba(255,255,255,0.6);">
                üé® Saƒü √ºstten tema deƒüi≈ütirebilirsiniz
            </div>
        </div>
    </div>

    <script>
        // ========== G√úVENLƒ∞K KONFƒ∞G√úRASYONU ==========
        const SECURE_CONFIG = {
            DEFAULT_ADMINS: ['popbox', 'popboxmusic'],
            OWNER_CONFIG: {
                username: 'MateKy',
                role: 'owner',
                isHidden: true
            }
        };

        // ========== FIREBASE KONFƒ∞G√úRASYONU ==========
        const firebaseConfig = {
            apiKey: "AIzaSyCrn_tXJZCAlKhem45aXxj4f0h26EPOQ70",
            authDomain: "popboxmusicchat.firebaseapp.com",
            databaseURL: "https://popboxmusicchat-default-rtdb.firebaseio.com",
            projectId: "popboxmusicchat",
            storageBucket: "popboxmusicchat.firebasestorage.app",
            messagingSenderId: "206625719024",
            appId: "1:206625719024:web:d28f478a2c96d10412f835",
            measurementId: "G-SB1K22FLEX"
        };
        
        // ========== GLOBAL DEƒûƒ∞≈ûKENLER ==========
        let database;
        let usersRef;
        let messagesRef;
        let isFirebaseConnected = false;
        let currentUser = null;
        let isAdmin = false;
        let isOwner = false;
        let player = null;
        let originalTitle = document.title;
        
        // ========== SHA-256 ≈ûƒ∞FRELEME ==========
        async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }
        
        // ========== OWNER ≈ûƒ∞FRE Sƒ∞STEMƒ∞ ==========
        async function initOwnerPassword() {
            try {
                const ownerPassword = "Sahi17407@SCM";
                const salt = "popbox_secure_salt_2024";
                const combinedPassword = ownerPassword + salt;
                const hashedPassword = await sha256(combinedPassword);
                
                window.ownerPasswordHash = {
                    hash: hashedPassword,
                    salt: salt
                };
                
            } catch (error) {
                console.error("≈ûifre sistemi hatasƒ±:", error);
            }
        }
        
        async function verifyOwnerPassword(inputPassword) {
            try {
                if (!window.ownerPasswordHash) {
                    await initOwnerPassword();
                }
                
                const inputHash = await sha256(inputPassword + window.ownerPasswordHash.salt);
                return inputHash === window.ownerPasswordHash.hash;
                
            } catch (error) {
                return false;
            }
        }
        
        // ========== NICK NORMALƒ∞ZASYON FONKSƒ∞YONU ==========
        function normalizeNick(nick) {
            return nick ? nick.toLowerCase().trim() : '';
        }
        
        // ========== AYNI NICK KONTROL√ú ==========
        async function checkExistingUsers(inputNick) {
            if (!usersRef) return [];
            
            try {
                const snapshot = await usersRef.once('value');
                const users = snapshot.val() || {};
                const similarUsers = [];
                
                const normalizedInput = normalizeNick(inputNick);
                
                Object.keys(users).forEach(username => {
                    if (normalizeNick(username) === normalizedInput) {
                        similarUsers.push(username);
                    }
                });
                
                return similarUsers;
            } catch (error) {
                return [];
            }
        }
        
        // ========== FIREBASE BA≈ûLATMA ==========
        function initializeFirebase() {
            try {
                firebase.initializeApp(firebaseConfig);
                database = firebase.database();
                
                const connectedRef = database.ref(".info/connected");
                connectedRef.on("value", function(snap) {
                    if (snap.val() === true) {
                        isFirebaseConnected = true;
                        showLoginSuccess("üî• Firebase baƒülantƒ±sƒ± kuruldu!");
                        
                        usersRef = database.ref('onlineUsers');
                        messagesRef = database.ref('messages');
                        
                        initOwnerPassword();
                        
                    } else {
                        isFirebaseConnected = false;
                        showLoginError("Firebase baƒülantƒ±sƒ± kesildi!");
                    }
                });
                
            } catch (error) {
                console.error("Firebase ba≈ülatma hatasƒ±:", error);
                showLoginError("Firebase ba≈ülatma hatasƒ±!");
            }
        }
        
        // ========== TEMEL FONKSƒ∞YONLAR ==========
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 150) + 'px';
        }
        
        function toggleUserList() {
            const sidebar = document.getElementById('usersSidebar');
            sidebar.classList.toggle('active');
        }
        
        function toggleTheme() {
            const body = document.body;
            const themeBtn = document.querySelector('.theme-toggle');
            
            if (body.classList.contains('youtube-music-mode')) {
                body.classList.remove('youtube-music-mode');
                body.classList.add('night-mode');
                themeBtn.textContent = 'üåô';
                localStorage.setItem('theme', 'night');
            } else if (body.classList.contains('night-mode')) {
                body.classList.remove('night-mode');
                body.classList.add('light-mode');
                themeBtn.textContent = '‚òÄÔ∏è';
                localStorage.setItem('theme', 'light');
            } else {
                body.classList.remove('light-mode');
                body.classList.add('youtube-music-mode');
                themeBtn.textContent = 'üé®';
                localStorage.setItem('theme', 'youtube');
            }
        }
        
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'youtube';
            const body = document.body;
            const themeBtn = document.querySelector('.theme-toggle');
            
            body.classList.remove('youtube-music-mode', 'night-mode', 'light-mode');
            
            if (savedTheme === 'night') {
                body.classList.add('night-mode');
                themeBtn.textContent = 'üåô';
            } else if (savedTheme === 'light') {
                body.classList.add('light-mode');
                themeBtn.textContent = '‚òÄÔ∏è';
            } else {
                body.classList.add('youtube-music-mode');
                themeBtn.textContent = 'üé®';
            }
        }
        
        // ========== Gƒ∞Rƒ∞≈û Sƒ∞STEMƒ∞ ==========
        async function login() {
            const nickInput = document.getElementById('login-nick');
            const rawNick = nickInput.value.trim();
            const loginBtn = document.getElementById('login-btn');
            
            if (!rawNick) {
                showLoginError('‚ùå L√ºtfen bir kullanƒ±cƒ± adƒ± girin!');
                return;
            }
            
            if (rawNick.length < 2 || rawNick.length > 20) {
                showLoginError('‚ùå Kullanƒ±cƒ± adƒ± 2-20 karakter arasƒ±nda olmalƒ±!');
                return;
            }
            
            if (!isFirebaseConnected || !usersRef) {
                showLoginError('‚ùå Firebase baƒülantƒ±sƒ± yok! L√ºtfen bekleyin...');
                return;
            }
            
            loginBtn.disabled = true;
            loginBtn.innerHTML = '<span class="loading"></span> Kontrol ediliyor...';
            showLoginError('');
            
            try {
                const normalizedNick = normalizeNick(rawNick);
                
                // Owner kontrol√º (case-insensitive)
                const isOwnerUser = normalizedNick === normalizeNick(SECURE_CONFIG.OWNER_CONFIG.username);
                
                // Aynƒ± nick kontrol√º
                const similarUsers = await checkExistingUsers(rawNick);
                const hasSimilar = similarUsers.length > 0;
                
                if (hasSimilar && !isOwnerUser) {
                    showLoginError(
                        `‚ö†Ô∏è BU NICK ZATEN KULLANIMDA!\n\n` +
                        `L√ºtfen farklƒ± bir kullanƒ±cƒ± adƒ± se√ßin.\n` +
                        `Mevcut benzer: ${similarUsers.join(', ')}`
                    );
                    loginBtn.disabled = false;
                    loginBtn.textContent = 'üéµ M√ºzik Dinlemeye Ba≈üla';
                    return;
                }
                
                if (isOwnerUser) {
                    // Owner i√ßin ≈üifre iste
                    const password = prompt('üîê Owner ≈üifresini girin:');
                    if (!password) {
                        loginBtn.disabled = false;
                        loginBtn.textContent = 'üéµ M√ºzik Dinlemeye Ba≈üla';
                        return;
                    }
                    
                    const passwordValid = await verifyOwnerPassword(password);
                    if (!passwordValid) {
                        showLoginError('‚ùå Hatalƒ± ≈üifre!');
                        loginBtn.disabled = false;
                        loginBtn.textContent = 'üéµ M√ºzik Dinlemeye Ba≈üla';
                        return;
                    }
                    
                    // Ger√ßek owner nick'i kullan
                    const realOwnerNick = SECURE_CONFIG.OWNER_CONFIG.username;
                    await completeLogin(realOwnerNick, 'owner');
                    
                } else {
                    // Normal kullanƒ±cƒ±
                    await completeLogin(rawNick, 'user');
                }
                
            } catch (error) {
                console.error('Giri≈ü hatasƒ±:', error);
                showLoginError(`‚ùå Giri≈ü hatasƒ±: ${error.message}`);
                loginBtn.disabled = false;
                loginBtn.textContent = 'üéµ M√ºzik Dinlemeye Ba≈üla';
            }
        }
        
        async function completeLogin(username, role) {
            const existingSnapshot = await usersRef.child(username).once('value');
            const existingUser = existingSnapshot.val();
            
            const now = Date.now();
            
            if (existingUser) {
                const lastSeen = existingUser.lastSeen || 0;
                const timeDiff = now - lastSeen;
                
                if (timeDiff < 30000) {
                    const seconds = Math.floor(timeDiff / 1000);
                    showLoginError(
                        `‚õî "${username}" ≈ûU ANDA AKTƒ∞F!\n\n` +
                        `Son aktivite: ${seconds} saniye √∂nce\n` +
                        `üí° L√ºtfen ba≈üka bir kullanƒ±cƒ± adƒ± se√ßin`
                    );
                    
                    const loginBtn = document.getElementById('login-btn');
                    loginBtn.disabled = false;
                    loginBtn.textContent = 'üéµ M√ºzik Dinlemeye Ba≈üla';
                    return;
                }
            }
            
            const userInfo = {
                name: username,
                lastSeen: now,
                joinedAt: now,
                ip: generateFakeIP(),
                userAgent: navigator.userAgent.substring(0, 80),
                isOnline: true,
                timestamp: now,
                role: role,
                isHidden: role === 'owner'
            };
            
            await usersRef.child(username).set(userInfo);
            
            currentUser = {
                name: username,
                role: role
            };
            
            // Yetki badge'leri
            if (role === 'owner') {
                isOwner = true;
                document.getElementById('ownerBadge').style.display = 'inline-block';
            } else if (role === 'admin') {
                isAdmin = true;
                document.getElementById('adminBadge').style.display = 'inline-block';
            }
            
            usersRef.child(username).onDisconnect().remove();
            
            document.getElementById('login-screen').style.display = 'none';
            
            initApp();
            
            addSystemMessage(`üéâ ${currentUser.name} sohbete katƒ±ldƒ±!`);
            
            if (isOwner) {
                addSystemMessage('ü§¥ Owner olarak giri≈ü yaptƒ±nƒ±z!');
            }
        }
        
        function generateFakeIP() {
            return `192.168.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`;
        }
        
        function showLoginError(message) {
            const errorMsg = document.getElementById('login-error');
            errorMsg.textContent = message;
            errorMsg.style.display = 'block';
        }
        
        function showLoginSuccess(message) {
            console.log(message);
        }
        
        // ========== UYGULAMA BA≈ûLATMA ==========
        function initApp() {
            document.getElementById('message-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            if (typeof YT !== 'undefined') {
                initYouTubePlayer();
            } else {
                setTimeout(initYouTubePlayer, 1000);
            }
            
            if (usersRef) {
                usersRef.on('value', (snapshot) => {
                    updateOnlineUsers(snapshot.val());
                });
            }
            
            if (messagesRef) {
                messagesRef.limitToLast(100).on('value', (snapshot) => {
                    updateMessages(snapshot.val());
                });
            }
            
            setInterval(() => {
                if (currentUser && usersRef) {
                    usersRef.child(currentUser.name).update({
                        lastSeen: Date.now(),
                        isOnline: true
                    });
                }
            }, 10000);
            
            window.addEventListener('beforeunload', function() {
                if (currentUser && usersRef) {
                    usersRef.child(currentUser.name).remove();
                }
            });
            
            // Mobile menu button visibility
            if (window.innerWidth <= 768) {
                document.querySelector('.mobile-menu-btn').style.display = 'block';
                document.querySelector('.online-list-btn').style.display = 'none';
            }
        }
        
        // ========== YOUTUBE PLAYER ==========
        function initYouTubePlayer() {
            if (typeof YT !== 'undefined' && YT.Player) {
                player = new YT.Player('youtube-player', {
                    height: '100%',
                    width: '100%',
                    videoId: 'i75BZYOAPl4',
                    playerVars: {
                        'autoplay': 1,
                        'controls': 1,
                        'rel': 0,
                        'modestbranding': 1,
                        'playsinline': 1
                    },
                    events: {
                        'onReady': function(event) {
                            document.querySelector('.video-placeholder').style.display = 'none';
                        }
                    }
                });
            }
        }
        
        // ========== ONLINE KULLANICILAR ==========
        function updateOnlineUsers(users) {
            if (!users) users = {};
            
            const now = Date.now();
            let onlineCount = 0;
            const activeUsers = [];
            
            Object.entries(users).forEach(([username, userData]) => {
                if (!userData) return;
                
                if (username === SECURE_CONFIG.OWNER_CONFIG.username && userData.isHidden && 
                    (!currentUser || currentUser.name !== SECURE_CONFIG.OWNER_CONFIG.username)) {
                    return;
                }
                
                const timeDiff = now - (userData.lastSeen || 0);
                const secondsAgo = Math.floor(timeDiff / 1000);
                
                if (secondsAgo < 30) {
                    onlineCount++;
                    activeUsers.push({
                        username: username,
                        ...userData,
                        secondsAgo: secondsAgo
                    });
                }
            });
            
            document.getElementById('onlineCount').textContent = onlineCount;
            document.getElementById('chatOnlineCount').textContent = onlineCount;
            
            updateUserList(activeUsers);
        }
        
        function updateUserList(users) {
            const container = document.getElementById('userList');
            
            if (!users || users.length === 0) {
                container.innerHTML = '<div style="color:var(--text-secondary); text-align:center; padding:20px;">Hen√ºz kimse online deƒüil</div>';
                return;
            }
            
            users.sort((a, b) => a.secondsAgo - b.secondsAgo);
            
            let html = '';
            users.forEach(user => {
                const isCurrentUser = user.username === (currentUser?.name || '');
                const isOwnerUser = user.username === SECURE_CONFIG.OWNER_CONFIG.username;
                
                let badge = '';
                if (isOwnerUser) badge = 'ü§¥';
                
                html += `
                    <div class="user-item" onclick="openUserMenu('${user.username}')">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 8px; height: 8px; border-radius: 50%; background: #4caf50;"></div>
                            <strong>${isCurrentUser ? 'üë§ ' : ''}${badge} ${user.username}</strong>
                        </div>
                        <div style="font-size: 12px; color: var(--text-secondary);">
                            ${user.secondsAgo < 5 ? '≈ûimdi' : user.secondsAgo + 'sn'}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function openUserMenu(username) {
            if (username === currentUser?.name) return;
            
            if (isOwner || isAdmin) {
                const action = prompt(`üë§ ${username}\n\n1. √ñzel mesaj g√∂nder\n2. Kullanƒ±cƒ±yƒ± banla\n3. Yetki ver\n\nSe√ßiminiz:`);
                if (action === '1') {
                    alert('√ñzel mesaj sistemi aktif deƒüil');
                }
            } else {
                alert(`üë§ ${username}\n\nBu kullanƒ±cƒ±ya mesaj g√∂ndermek i√ßin admin olmalƒ±sƒ±nƒ±z.`);
            }
        }
        
        // ========== MESAJ G√ñNDERME ==========
        async function sendMessage() {
            if (!isFirebaseConnected) {
                addSystemMessage('‚ùå Firebase baƒülantƒ±sƒ± yok!');
                return;
            }
            
            const input = document.getElementById('message-input');
            const text = input.value.trim();
            
            if (!text) return;
            
            if (text.startsWith('/')) {
                handleCommand(text);
                input.value = '';
                autoResize(input);
                return;
            }
            
            const messageData = {
                sender: currentUser.name,
                text: text,
                type: isOwner ? 'owner' : (isAdmin ? 'admin' : 'user'),
                timestamp: Date.now(),
                time: new Date().toLocaleTimeString('tr-TR', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                })
            };
            
            try {
                await messagesRef.push(messageData);
                input.value = '';
                autoResize(input);
                
                if (usersRef) {
                    usersRef.child(currentUser.name).update({
                        lastSeen: Date.now()
                    });
                }
            } catch (error) {
                console.error('Mesaj g√∂nderme hatasƒ±:', error);
                addSystemMessage('‚ùå Mesaj g√∂nderilemedi!');
            }
        }
        
        function updateMessages(messages) {
            const container = document.getElementById('messages');
            if (!messages) return;
            
            const messagesArray = [];
            Object.entries(messages).forEach(([messageId, value]) => {
                messagesArray.push({
                    id: messageId,
                    ...value
                });
            });
            
            messagesArray.sort((a, b) => a.timestamp - b.timestamp);
            const recentMessages = messagesArray.slice(-100);
            
            container.innerHTML = '';
            
            recentMessages.forEach(msg => {
                const messageDiv = document.createElement('div');
                let messageClass = `yt-message ${msg.type || 'user'}`;
                
                let senderName = msg.sender;
                if (msg.type === 'owner') {
                    senderName = 'ü§¥ ' + senderName;
                } else if (msg.type === 'admin') {
                    senderName = '‚≠êÔ∏è ' + senderName;
                }
                
                messageDiv.className = messageClass;
                messageDiv.id = `msg_${msg.id}`;
                
                let deleteButton = '';
                if (currentUser && 
                    (msg.sender === currentUser.name || isAdmin || isOwner)) {
                    deleteButton = `<button class="delete-btn" onclick="deleteMessage('${msg.id}')">üóëÔ∏è</button>`;
                }
                
                messageDiv.innerHTML = `
                    <div class="message-header">
                        <span class="message-user" onclick="openUserMenu('${msg.sender}')">
                            ${senderName}
                        </span>
                        <div>
                            <span class="message-time">${msg.time || '--:--'}</span>
                            ${deleteButton}
                        </div>
                    </div>
                    <div class="message-content">${msg.text}</div>
                `;
                
                container.appendChild(messageDiv);
            });
            
            container.scrollTop = container.scrollHeight;
        }
        
        async function deleteMessage(messageId) {
            if (!messagesRef || !currentUser) return;
            
            try {
                const snapshot = await messagesRef.child(messageId).once('value');
                const message = snapshot.val();
                
                if (!message) {
                    addSystemMessage('‚ùå Mesaj bulunamadƒ±!');
                    return;
                }
                
                const canDelete = message.sender === currentUser.name || isAdmin || isOwner;
                
                if (!canDelete) {
                    addSystemMessage('‚õî Sadece kendi mesajlarƒ±nƒ±zƒ± silebilirsiniz!');
                    return;
                }
                
                if (confirm('Bu mesajƒ± silmek istediƒüinize emin misiniz?')) {
                    await messagesRef.child(messageId).remove();
                    
                    const messageDiv = document.getElementById(`msg_${messageId}`);
                    if (messageDiv) {
                        messageDiv.style.opacity = '0.5';
                        messageDiv.style.textDecoration = 'line-through';
                        messageDiv.innerHTML = '<em style="color:var(--text-secondary);">(mesaj silindi)</em>';
                        
                        setTimeout(() => {
                            if (messageDiv.parentNode) {
                                messageDiv.remove();
                            }
                        }, 2000);
                    }
                }
                
            } catch (error) {
                console.error('Mesaj silme hatasƒ±:', error);
                addSystemMessage('‚ùå Mesaj silinemedi!');
            }
        }
        
        // ========== KOMUT Sƒ∞STEMƒ∞ ==========
        function handleCommand(cmd) {
            const parts = cmd.substring(1).split(' ');
            const command = parts[0].toLowerCase();
            const args = parts.slice(1);
            
            switch(command) {
                case 'temizle':
                    if (!isAdmin && !isOwner) {
                        addSystemMessage('‚õî Sadece yetkililer temizleyebilir!');
                        return;
                    }
                    clearChat();
                    break;
                    
                case 'yardƒ±m':
                case 'help':
                    showHelp();
                    break;
                    
                case 'kullanƒ±cƒ±lar':
                case 'users':
                    showUsersList();
                    break;
                    
                case 'ping':
                    addSystemMessage('üèì Pong! Baƒülantƒ± aktif.');
                    break;
                    
                case '√ßƒ±kƒ±≈ü':
                case 'logout':
                    logout();
                    break;
                    
                default:
                    addSystemMessage(`‚ùå Bilinmeyen komut: ${command}`);
            }
        }
        
        async function clearChat() {
            if (!messagesRef) return;
            
            if (confirm('T√ºm mesajlarƒ± temizlemek istediƒüinize emin misiniz?')) {
                try {
                    await messagesRef.remove();
                    const container = document.getElementById('messages');
                    container.innerHTML = '<div class="yt-message system">‚úÖ Sohbet temizlendi!</div>';
                } catch (error) {
                    addSystemMessage('‚ùå Temizleme hatasƒ±!');
                }
            }
        }
        
        function showHelp() {
            let help = 'üéµ <strong>POPBOX MUSIC KOMUTLARI:</strong><br><br>';
            
            if (isOwner || isAdmin) {
                help += '‚≠êÔ∏è <strong>YETKƒ∞Lƒ∞ KOMUTLARI:</strong><br>';
                help += '‚Ä¢ /temizle - Sohbeti temizle<br>';
            }
            
            help += 'üë§ <strong>HERKES ƒ∞√áƒ∞N:</strong><br>';
            help += '‚Ä¢ /kullanƒ±cƒ±lar - Online kullanƒ±cƒ±larƒ± g√∂ster<br>';
            help += '‚Ä¢ /yardƒ±m - Bu mesajƒ± g√∂ster<br>';
            help += '‚Ä¢ /ping - Baƒülantƒ± testi<br>';
            help += '‚Ä¢ /√ßƒ±kƒ±≈ü - √áƒ±kƒ±≈ü yap<br><br>';
            
            help += 'üí° <strong>KULLANIM:</strong><br>';
            help += '‚Ä¢ Mesaj g√∂ndermek i√ßin Enter\'a basƒ±n<br>';
            help += '‚Ä¢ Yeni satƒ±r i√ßin Shift+Enter<br>';
            help += '‚Ä¢ Kendi mesajƒ±nƒ±zƒ± silebilirsiniz<br>';
            help += '‚Ä¢ Online kullanƒ±cƒ±larƒ± g√∂rmek i√ßin saƒü √ºstteki butonu kullanƒ±n';
            
            addSystemMessage(help);
        }
        
        function showUsersList() {
            const container = document.getElementById('userList');
            const items = container.querySelectorAll('.user-item');
            
            if (items.length === 0) {
                addSystemMessage('üë§ Hen√ºz online kullanƒ±cƒ± yok');
                return;
            }
            
            let userList = 'üë• <strong>ONLINE KULLANICILAR:</strong><br><br>';
            items.forEach(item => {
                const username = item.querySelector('strong').textContent.replace('üë§ ', '');
                userList += `${username}<br>`;
            });
            
            addSystemMessage(userList);
        }
        
        function addSystemMessage(text) {
            const container = document.getElementById('messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'yt-message system';
            messageDiv.innerHTML = text;
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }
        
        // ========== √áIKI≈û ==========
        function logout() {
            if (currentUser && usersRef) {
                usersRef.child(currentUser.name).remove();
            }
            location.reload();
        }
        
        // ========== SAYFA Y√úKLENDƒ∞ƒûƒ∞NDE ==========
        window.addEventListener('load', function() {
            originalTitle = document.title;
            loadTheme();
            
            initializeFirebase();
            
            document.getElementById('login-nick').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') login();
            });
            
            document.addEventListener('click', function(e) {
                const sidebar = document.getElementById('usersSidebar');
                if (sidebar.classList.contains('active')) {
                    if (!sidebar.contains(e.target) && 
                        !e.target.closest('.online-list-btn') &&
                        !e.target.closest('.mobile-menu-btn')) {
                        sidebar.classList.remove('active');
                    }
                }
            });
            
            function onYouTubeIframeAPIReady() {
                initYouTubePlayer();
            }
            window.onYouTubeIframeAPIReady = onYouTubeIframeAPIReady;
            
            // Mobil kontrol
            window.addEventListener('resize', function() {
                if (window.innerWidth <= 768) {
                    document.querySelector('.mobile-menu-btn').style.display = 'block';
                    document.querySelector('.online-list-btn').style.display = 'none';
                } else {
                    document.querySelector('.mobile-menu-btn').style.display = 'none';
                    document.querySelector('.online-list-btn').style.display = 'flex';
                }
            });
        });
    </script>
    
    <!-- YouTube IFrame API -->
    <script src="https://www.youtube.com/iframe_api"></script>
</body>
</html>
