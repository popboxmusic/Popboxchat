<!DOCTYPE html>  
<html lang="tr">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">  
    <title>Popbox Music Chat - Geli≈ümi≈ü Sohbet Platformu</title>  
    <!-- FIREBASE SDK v8 -->  
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>  
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>  
    
    <style>  
        /* YOUTUBE LIVE TEMA (Varsayƒ±lan) - KORUNACAK */  
        :root {  
            /* YouTube Live Renkleri - KORUNACAK */  
            --youtube-red: #ff0000;  
            --youtube-dark: #0f0f0f;  
            --youtube-light-dark: #272727;  
            --youtube-chat-bg: #0f0f0f;  
            --youtube-chat-input: #272727;  
            --youtube-text: #f1f1f1;  
            --youtube-text-secondary: #aaa;  
            
            /* UI Renkleri */  
            --primary: #ff0000;  
            --secondary: #ff5555;  
            --private: #9c27b0;  
            --coadmin: #ff9800;  
            --operator: #3b82f6;  
            --owner: #ff4081;  
            --online: #4caf50;  
            --firebase: #ffa000;  
            --ban-color: #ff3333;  
            --story-color: #ff6b6b;  
            --report-color: #ff4444;  
            --subscriber-color: #ff4081;  
            --premium-color: #ffd700;  
            --member-color: #4caf50;  
            --channel-color: #2196f3;  
            
            /* Layout - DEEPSEEK STILI UYGULANACAK */  
            --bg-primary: var(--youtube-dark);  
            --bg-secondary: var(--youtube-chat-bg);  
            --text-primary: var(--youtube-text);  
            --text-secondary: var(--youtube-text-secondary);  
            --input-bg: var(--youtube-chat-input);  
            --header-bg: var(--youtube-dark);  
            --border-color: rgba(255,255,255,0.1);  
            
            /* Blur efekti */  
            --blur-bg: rgba(0, 0, 0, 0.7);  
            --blur-intensity: blur(15px);  
            
            /* Mesaj Renkleri */  
            --message-user-bg: rgba(255,255,255,0.05);  
            --message-admin-bg: rgba(255,0,0,0.15);  
            --message-coadmin-bg: rgba(255,152,0,0.15);  
            --message-operator-bg: rgba(59,130,246,0.15);  
            --message-owner-bg: rgba(255,64,129,0.15);  
            --message-system-bg: rgba(255,255,255,0.05);  
            --message-private-bg: rgba(156,39,176,0.15);  
            --message-ban-bg: rgba(255,51,51,0.15);  
            --message-story-bg: rgba(255,107,107,0.15);  
            --message-report-bg: rgba(255,68,68,0.15);  
            --message-subscriber-bg: rgba(255,64,129,0.15);  
            --message-member-bg: rgba(76,175,80,0.15);  
            --message-channel-bg: rgba(33,150,243,0.15);  
        }  
        
        /* GECE TEMA (Koyu) */  
        body.night-mode {  
            --bg-primary: #1a1a2e;  
            --bg-secondary: #2d2d44;  
            --text-primary: #ffffff;  
            --text-secondary: #cccccc;  
            --input-bg: rgba(0,0,0,0.3);  
            --header-bg: rgba(0,0,0,0.4);  
            --border-color: rgba(79, 195, 247, 0.2);  
            --blur-bg: rgba(26, 26, 46, 0.8);  
            
            --primary: #4fc3f7;  
            --secondary: #ff5555;  
            --private: #9c27b0;  
            --coadmin: #ff9800;  
            --operator: #3b82f6;  
            --owner: #ff4081;  
            --online: #4caf50;  
            --firebase: #ffa000;  
            --ban-color: #ff3333;  
            --story-color: #ff6b6b;  
            --report-color: #ff4444;  
            --subscriber-color: #ff4081;  
            --premium-color: #ffd700;  
            --member-color: #4caf50;  
            --channel-color: #2196f3;  
            
            --message-user-bg: rgba(255,255,255,0.07);  
            --message-admin-bg: rgba(255,85,85,0.1);  
            --message-coadmin-bg: rgba(255,152,0,0.1);  
            --message-operator-bg: rgba(59,130,246,0.1);  
            --message-owner-bg: rgba(255,64,129,0.1);  
            --message-system-bg: rgba(76,175,80,0.1);  
            --message-private-bg: rgba(156,39,176,0.1);  
            --message-ban-bg: rgba(255,51,51,0.1);  
            --message-story-bg: rgba(255,107,107,0.1);  
            --message-report-bg: rgba(255,68,68,0.1);  
            --message-subscriber-bg: rgba(255,64,129,0.1);  
            --message-member-bg: rgba(76,175,80,0.1);  
            --message-channel-bg: rgba(33,150,243,0.1);  
        }  
        
        /* G√úND√úZ TEMA (A√ßƒ±k) */  
        body.light-mode {  
            --bg-primary: #f5f5f5;  
            --bg-secondary: #ffffff;  
            --text-primary: #333333;  
            --text-secondary: #666666;  
            --input-bg: rgba(0,0,0,0.05);  
            --header-bg: rgba(79, 195, 247, 0.1);  
            --border-color: rgba(0,0,0,0.1);  
            --blur-bg: rgba(245, 245, 245, 0.8);  
            
            --primary: #2196f3;  
            --secondary: #f44336;  
            --private: #9c27b0;  
            --coadmin: #ff9800;  
            --operator: #3b82f6;  
            --owner: #ff4081;  
            --online: #4caf50;  
            --firebase: #ffa000;  
            --ban-color: #ff3333;  
            --story-color: #ff6b6b;  
            --report-color: #ff4444;  
            --subscriber-color: #ff4081;  
            --premium-color: #ffd700;  
            --member-color: #4caf50;  
            --channel-color: #2196f3;  
            
            --message-user-bg: rgba(0,0,0,0.05);  
            --message-admin-bg: rgba(244,67,54,0.15);  
            --message-coadmin-bg: rgba(255,152,0,0.15);  
            --message-operator-bg: rgba(59,130,246,0.15);  
            --message-owner-bg: rgba(255,64,129,0.15);  
            --message-system-bg: rgba(76,175,80,0.15);  
            --message-private-bg: rgba(156,39,176,0.15);  
            --message-ban-bg: rgba(255,51,51,0.15);  
            --message-story-bg: rgba(255,107,107,0.15);  
            --message-report-bg: rgba(255,68,68,0.15);  
            --message-subscriber-bg: rgba(255,64,129,0.15);  
            --message-member-bg: rgba(76,175,80,0.15);  
            --message-channel-bg: rgba(33,150,243,0.15);  
        }  
        
        * {   
            margin: 0;   
            padding: 0;   
            box-sizing: border-box;  
            -webkit-tap-highlight-color: transparent;  
        }  
        
        html, body {  
            height: 100%;  
            width: 100%;  
            overflow: hidden;  
            position: fixed;  
        }  
        
        body {  
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;  
            background: var(--bg-primary);  
            color: var(--text-primary);  
            display: flex;  
            flex-direction: column;  
            overflow: hidden;  
            transition: all 0.3s ease;  
        }  
        
        /* BLUR EFFECT */  
        .blur-background {  
            background: var(--blur-bg) !important;  
            backdrop-filter: var(--blur-intensity) !important;  
            -webkit-backdrop-filter: var(--blur-intensity) !important;  
        }  
        
        /* HEADER - BLUR EFFECT */  
        .youtube-header {  
            height: 56px;  
            background: var(--header-bg);  
            display: flex;  
            align-items: center;  
            justify-content: space-between;  
            padding: 0 16px;  
            border-bottom: 1px solid var(--border-color);  
            position: fixed;  
            top: 0;  
            left: 0;  
            right: 0;  
            z-index: 1000;  
            flex-shrink: 0;  
            transition: all 0.3s ease;  
            backdrop-filter: blur(20px);  
            -webkit-backdrop-filter: blur(20px);  
        }  
        
        .header-left, .header-right {  
            display: flex;  
            align-items: center;  
            gap: 12px;  
        }  
        
        .logo {  
            display: flex;  
            align-items: center;  
            gap: 8px;  
            font-weight: 500;  
            color: var(--text-primary);  
            font-size: 18px;  
        }  
        
        .logo-icon {  
            color: var(--primary);  
            font-size: 24px;  
        }  
        
        .user-badges {  
            display: flex;  
            gap: 4px;  
        }  
        
        .badge {  
            font-size: 11px;  
            padding: 2px 6px;  
            border-radius: 10px;  
            display: none;  
            color: white;  
            font-weight: 500;  
        }  
        
        .badge.admin { background: var(--secondary); }  
        .badge.coadmin { background: var(--coadmin); }  
        .badge.operator { background: var(--operator); }  
        .badge.owner { background: var(--owner); }  
        .badge.story { background: var(--story-color); }  
        .badge.subscriber { background: var(--subscriber-color); }  
        .badge.premium { background: var(--premium-color); color: #000; }  
        .badge.member { background: var(--member-color); }  
        .badge.channel { background: var(--channel-color); }  
        
        /* STORY/Hƒ∞KAYE B√ñL√úM√ú - INSTAGRAM STYLE */  
        .story-section {  
            position: relative;  
        }  
        
        .story-toggle-btn {  
            background: none;  
            border: none;  
            color: var(--story-color);  
            font-size: 20px;  
            cursor: pointer;  
            padding: 6px;  
            display: flex;  
            align-items: center;  
            justify-content: center;  
            position: relative;  
            border-radius: 8px;  
            transition: background 0.2s;  
        }  
        
        .story-toggle-btn:hover {  
            background: rgba(255,255,255,0.1);  
        }  
        
        .story-toggle-btn.active {  
            color: var(--owner);  
        }  
        
        .story-toggle-badge {  
            position: absolute;  
            top: 0;  
            right: 0;  
            background: var(--story-color);  
            color: white;  
            font-size: 10px;  
            font-weight: bold;  
            min-width: 16px;  
            height: 16px;  
            border-radius: 8px;  
            display: flex;  
            align-items: center;  
            justify-content: center;  
            padding: 0 4px;  
            display: none;  
        }  
        
        .story-container {  
            background: rgba(0, 0, 0, 0.95);  
            backdrop-filter: blur(20px);  
            -webkit-backdrop-filter: blur(20px);  
            border-bottom: 1px solid var(--border-color);  
            overflow-x: auto;  
            white-space: nowrap;  
            display: none;  
            position: fixed;  
            top: 56px;  
            left: 0;  
            right: 0;  
            z-index: 999;  
            transition: all 0.3s ease;  
            max-height: 0;  
            opacity: 0;  
            padding: 0;  
        }  
        
        .story-container.active {  
            display: block;  
            max-height: 120px;  
            opacity: 1;  
            padding: 10px 16px;  
        }  
        
        .story-wrapper {  
            display: inline-flex;  
            gap: 16px;  
            padding: 8px;  
        }  
        
        .story-item {  
            display: flex;  
            flex-direction: column;  
            align-items: center;  
            gap: 8px;  
            cursor: pointer;  
            min-width: 80px;  
            transition: all 0.3s ease;  
        }  
        
        .story-avatar {  
            width: 60px;  
            height: 60px;  
            border-radius: 50%;  
            position: relative;  
            border: 3px solid transparent;  
            background: linear-gradient(45deg, var(--story-color), var(--owner)) border-box;  
            -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);  
            mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);  
            -webkit-mask-composite: xor;  
            mask-composite: exclude;  
            display: flex;  
            align-items: center;  
            justify-content: center;  
            font-size: 24px;  
        }  
        
        .story-avatar.seen {  
            background: linear-gradient(45deg, var(--text-secondary), var(--text-secondary)) border-box;  
        }  
        
        .story-avatar.my-story {  
            border: 3px solid var(--story-color);  
            background: none;  
            -webkit-mask: none;  
            mask: none;  
        }  
        
        .story-user {  
            font-size: 12px;  
            font-weight: 500;  
            color: var(--text-primary);  
            text-align: center;  
            max-width: 80px;  
            overflow: hidden;  
            text-overflow: ellipsis;  
        }  
        
        .story-badge {  
            position: absolute;  
            bottom: -5px;  
            right: -5px;  
            background: var(--story-color);  
            color: white;  
            width: 20px;  
            height: 20px;  
            border-radius: 50%;  
            display: flex;  
            align-items: center;  
            justify-content: center;  
            font-size: 11px;  
            font-weight: bold;  
            border: 2px solid var(--bg-secondary);  
        }  
        
        /* PROFƒ∞L A√áILIR ALANI */  
        .profile-section {  
            position: relative;  
        }  
        
        .profile-btn {  
            background: none;  
            border: none;  
            color: var(--text-primary);  
            font-size: 20px;  
            cursor: pointer;  
            padding: 6px;  
            display: flex;  
            align-items: center;  
            justify-content: center;  
            border-radius: 8px;  
            transition: background 0.2s;  
            position: relative;  
        }  
        
        .profile-btn:hover {  
            background: rgba(255,255,255,0.1);  
        }  
        
        .profile-panel {  
            position: absolute;  
            top: 100%;  
            right: 0;  
            width: 320px;  
            background: var(--bg-secondary);  
            border: 1px solid var(--border-color);  
            border-radius: 12px;  
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);  
            z-index: 1001;  
            display: none;  
            flex-direction: column;  
            overflow: hidden;  
            backdrop-filter: blur(20px);  
            -webkit-backdrop-filter: blur(20px);  
        }  
        
        .profile-panel.active {  
            display: flex;  
        }  
        
        .profile-header {  
            padding: 20px;  
            background: linear-gradient(135deg, var(--primary), var(--secondary));  
            color: white;  
            display: flex;  
            align-items: center;  
            gap: 15px;  
        }  
        
        .profile-avatar {  
            width: 60px;  
            height: 60px;  
            border-radius: 50%;  
            background: rgba(255,255,255,0.2);  
            display: flex;  
            align-items: center;  
            justify-content: center;  
            font-size: 28px;  
            border: 3px solid rgba(255,255,255,0.3);  
        }  
        
        .profile-info {  
            flex: 1;  
        }  
        
        .profile-username {  
            font-weight: 600;  
            font-size: 18px;  
            margin-bottom: 4px;  
        }  
        
        .profile-role {  
            font-size: 13px;  
            opacity: 0.9;  
        }  
        
        .profile-body {  
            padding: 20px;  
            max-height: 400px;  
            overflow-y: auto;  
        }  
        
        .profile-stats {  
            display: grid;  
            grid-template-columns: 1fr 1fr;  
            gap: 15px;  
            margin-bottom: 20px;  
        }  
        
        .stat-item {  
            text-align: center;  
            padding: 15px;  
            background: rgba(0,0,0,0.05);  
            border-radius: 10px;  
            transition: transform 0.2s;  
        }  
        
        .stat-item:hover {  
            transform: translateY(-2px);  
        }  
        
        body.night-mode .stat-item {  
            background: rgba(255,255,255,0.05);  
        }  
        
        .stat-value {  
            font-size: 22px;  
            font-weight: 600;  
            color: var(--primary);  
        }  
        
        .stat-label {  
            font-size: 13px;  
            color: var(--text-secondary);  
        }  
        
        .profile-actions {  
            display: flex;  
            flex-direction: column;  
            gap: 10px;  
        }  
        
        .profile-action-btn {  
            padding: 14px 18px;  
            background: rgba(0,0,0,0.05);  
            border: none;  
            border-radius: 10px;  
            color: var(--text-primary);  
            text-align: left;  
            cursor: pointer;  
            transition: all 0.2s;  
            display: flex;  
            align-items: center;  
            gap: 12px;  
            font-size: 14px;  
        }  
        
        .profile-action-btn:hover {  
            background: rgba(0,0,0,0.1);  
            transform: translateX(5px);  
        }  
        
        body.night-mode .profile-action-btn {  
            background: rgba(255,255,255,0.05);  
        }  
        
        body.night-mode .profile-action-btn:hover {  
            background: rgba(255,255,255,0.1);  
        }  
        
        .profile-action-btn.subscribe {  
            background: var(--subscriber-color);  
            color: white;  
        }  
        
        .profile-action-btn.premium {  
            background: linear-gradient(135deg, var(--premium-color), #ff9800);  
            color: #000;  
        }  
        
        .profile-action-btn.owner-panel {  
            background: linear-gradient(135deg, var(--owner), #e91e63);  
            color: white;  
        }  
        
        .profile-action-btn.admin-panel {  
            background: linear-gradient(135deg, var(--secondary), #ff9800);  
            color: white;  
        }  
        
        .subscriber-badge {  
            background: var(--subscriber-color);  
            color: white;  
            padding: 4px 10px;  
            border-radius: 12px;  
            font-size: 11px;  
            font-weight: 600;  
        }  
        
        .premium-badge {  
            background: linear-gradient(135deg, var(--premium-color), #ff9800);  
            color: #000;  
            padding: 4px 10px;  
            border-radius: 12px;  
            font-size: 11px;  
            font-weight: 600;  
        }  
        
        .member-badge {  
            background: var(--member-color);  
            color: white;  
            padding: 4px 10px;  
            border-radius: 12px;  
            font-size: 11px;  
            font-weight: 600;  
        }  
        
        /* YOUTUBE STYLE ABONELƒ∞K Sƒ∞STEMƒ∞ */  
        .subscription-modal {  
            position: fixed;  
            top: 50%;  
            left: 50%;  
            transform: translate(-50%, -50%);  
            background: var(--bg-secondary);  
            border: 1px solid var(--border-color);  
            border-radius: 20px;  
            z-index: 3000;  
            display: none;  
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);  
            backdrop-filter: blur(25px);  
            -webkit-backdrop-filter: blur(25px);  
            width: 90%;  
            max-width: 450px;  
            overflow: hidden;  
        }  
        
        .subscription-header {  
            padding: 25px;  
            background: linear-gradient(135deg, #ff0000, #cc0000);  
            color: white;  
            text-align: center;  
            position: relative;  
            overflow: hidden;  
        }  
        
        .subscription-header:before {  
            content: '';  
            position: absolute;  
            top: 0;  
            left: 0;  
            right: 0;  
            bottom: 0;  
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);  
            animation: shine 3s infinite;  
        }  
        
        @keyframes shine {  
            0% { transform: translateX(-100%); }  
            100% { transform: translateX(100%); }  
        }  
        
        .subscription-body {  
            padding: 25px;  
        }  
        
        .subscription-plan {  
            padding: 20px;  
            border: 2px solid var(--border-color);  
            border-radius: 15px;  
            margin-bottom: 20px;  
            cursor: pointer;  
            transition: all 0.3s;  
            position: relative;  
            overflow: hidden;  
        }  
        
        .subscription-plan:hover {  
            border-color: var(--primary);  
            transform: translateY(-5px);  
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);  
        }  
        
        .subscription-plan.selected {  
            border-color: var(--subscriber-color);  
            background: linear-gradient(135deg, rgba(255,64,129,0.1), rgba(255,64,129,0.05));  
            box-shadow: 0 10px 30px rgba(255,64,129,0.2);  
        }  
        
        .subscription-plan.premium.selected {  
            border-color: var(--premium-color);  
            background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(255,215,0,0.05));  
            box-shadow: 0 10px 30px rgba(255,215,0,0.3);  
        }  
        
        .subscription-plan.member.selected {  
            border-color: var(--member-color);  
            background: linear-gradient(135deg, rgba(76,175,80,0.1), rgba(76,175,80,0.05));  
            box-shadow: 0 10px 30px rgba(76,175,80,0.2);  
        }  
        
        .plan-badge {  
            position: absolute;  
            top: 10px;  
            right: 10px;  
            padding: 4px 10px;  
            border-radius: 20px;  
            font-size: 11px;  
            font-weight: 600;  
        }  
        
        .plan-badge.member {  
            background: var(--member-color);  
            color: white;  
        }  
        
        .plan-badge.subscriber {  
            background: var(--subscriber-color);  
            color: white;  
        }  
        
        .plan-badge.premium {  
            background: var(--premium-color);  
            color: #000;  
        }  
        
        .plan-title {  
            font-size: 20px;  
            font-weight: 600;  
            margin-bottom: 10px;  
            display: flex;  
            align-items: center;  
            gap: 10px;  
        }  
        
        .plan-price {  
            font-size: 28px;  
            font-weight: 700;  
            margin-bottom: 10px;  
        }  
        
        .plan-price.free {  
            color: var(--text-primary);  
        }  
        
        .plan-price.member {  
            color: var(--member-color);  
        }  
        
        .plan-price.subscriber {  
            color: var(--subscriber-color);  
        }  
        
        .plan-price.premium {  
            color: var(--premium-color);  
            background: linear-gradient(135deg, var(--premium-color), #ff9800);  
            -webkit-background-clip: text;  
            -webkit-text-fill-color: transparent;  
            background-clip: text;  
        }  
        
        .plan-period {  
            font-size: 14px;  
            color: var(--text-secondary);  
            margin-left: 5px;  
        }  
        
        .plan-features {  
            font-size: 14px;  
            color: var(--text-secondary);  
        }  
        
        .plan-features li {  
            margin-bottom: 6px;  
            list-style: none;  
            padding-left: 24px;  
            position: relative;  
        }  
        
        .plan-features li:before {  
            content: "‚úì";  
            position: absolute;  
            left: 0;  
            color: var(--subscriber-color);  
            font-weight: bold;  
        }  
        
        .subscription-plan.member .plan-features li:before {  
            color: var(--member-color);  
        }  
        
        .subscription-plan.premium .plan-features li:before {  
            color: var(--premium-color);  
        }  
        
        /* OWNER Y√ñNETƒ∞M PANELƒ∞ */  
        .owner-panel {  
            position: fixed;  
            top: 50%;  
            left: 50%;  
            transform: translate(-50%, -50%);  
            width: 90%;  
            max-width: 1000px;  
            height: 80vh;  
            background: var(--bg-secondary);  
            border: 1px solid var(--border-color);  
            border-radius: 20px;  
            z-index: 3001;  
            display: none;  
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);  
            backdrop-filter: blur(25px);  
            -webkit-backdrop-filter: blur(25px);  
            overflow: hidden;  
        }  
        
        .owner-tabs {  
            display: flex;  
            background: var(--header-bg);  
            border-bottom: 1px solid var(--border-color);  
            padding: 0;  
        }  
        
        .owner-tab {  
            padding: 15px 20px;  
            background: none;  
            border: none;  
            color: var(--text-secondary);  
            cursor: pointer;  
            font-size: 14px;  
            font-weight: 500;  
            border-bottom: 3px solid transparent;  
            transition: all 0.3s;  
        }  
        
        .owner-tab:hover {  
            background: rgba(255,255,255,0.05);  
        }  
        
        .owner-tab.active {  
            color: var(--owner);  
            border-bottom-color: var(--owner);  
            background: rgba(255,64,129,0.1);  
        }  
        
        .owner-tab-content {  
            display: none;  
            padding: 20px;  
            height: calc(80vh - 53px);  
            overflow-y: auto;  
        }  
        
        .owner-tab-content.active {  
            display: block;  
        }  
        
        .admin-controls {  
            display: grid;  
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));  
            gap: 15px;  
            margin-bottom: 20px;  
        }  
        
        .control-group {  
            background: rgba(0,0,0,0.05);  
            padding: 15px;  
            border-radius: 10px;  
        }  
        
        .control-group h4 {  
            margin-bottom: 10px;  
            color: var(--primary);  
        }  
        
        .control-input {  
            width: 100%;  
            padding: 10px;  
            margin: 5px 0;  
            background: var(--input-bg);  
            border: 1px solid var(--border-color);  
            border-radius: 8px;  
            color: var(--text-primary);  
        }  
        
        .control-btn {  
            padding: 8px 15px;  
            margin: 5px;  
            background: var(--primary);  
            color: white;  
            border: none;  
            border-radius: 8px;  
            cursor: pointer;  
            transition: all 0.2s;  
        }  
        
        .control-btn:hover {  
            opacity: 0.9;  
            transform: translateY(-2px);  
        }  
        
        .control-btn.ban {  
            background: var(--ban-color);  
        }  
        
        .control-btn.kick {  
            background: var(--coadmin);  
        }  
        
        .control-btn.warn {  
            background: var(--warning-color, #ff9800);  
        }  
        
        /* PRIVATE MESSAGE STYLES */  
        .private-modal {  
            position: fixed;  
            top: 50%;  
            left: 50%;  
            transform: translate(-50%, -50%);  
            width: 90%;  
            max-width: 500px;  
            height: 70vh;  
            background: var(--bg-secondary);  
            border: 1px solid var(--border-color);  
            border-radius: 15px;  
            z-index: 3000;  
            display: none;  
            flex-direction: column;  
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);  
            backdrop-filter: blur(20px);  
            -webkit-backdrop-filter: blur(20px);  
        }  
        
        .private-header {  
            padding: 15px 20px;  
            background: linear-gradient(135deg, var(--private), #7b1fa2);  
            color: white;  
            display: flex;  
            justify-content: space-between;  
            align-items: center;  
            border-radius: 15px 15px 0 0;  
        }  
        
        .private-messages {  
            flex: 1;  
            overflow-y: auto;  
            padding: 20px;  
            display: flex;  
            flex-direction: column;  
            gap: 10px;  
        }  
        
        .private-message {  
            max-width: 80%;  
            padding: 10px 15px;  
            border-radius: 15px;  
            word-wrap: break-word;  
        }  
        
        .private-message.sent {  
            align-self: flex-end;  
            background: var(--private);  
            color: white;  
            border-bottom-right-radius: 5px;  
        }  
        
        .private-message.received {  
            align-self: flex-start;  
            background: rgba(0,0,0,0.1);  
            color: var(--text-primary);  
            border-bottom-left-radius: 5px;  
        }  
        
        .private-input-area {  
            padding: 15px;  
            border-top: 1px solid var(--border-color);  
            display: flex;  
            gap: 10px;  
            align-items: flex-end;  
        }  
        
        .private-input-area textarea {  
            flex: 1;  
            padding: 12px 15px;  
            background: var(--input-bg);  
            border: 1px solid var(--border-color);  
            border-radius: 12px;  
            color: var(--text-primary);  
            resize: none;  
            min-height: 44px;  
            max-height: 100px;  
        }  
        
        .image-upload-btn {  
            width: 44px;  
            height: 44px;  
            border-radius: 12px;  
            background: var(--primary);  
            border: none;  
            color: white;  
            display: flex;  
            align-items: center;  
            justify-content: center;  
            cursor: pointer;  
            font-size: 20px;  
        }  
        
        /* MESSAGE STYLES */  
        .message-image {  
            max-width: 100%;  
            max-height: 300px;  
            border-radius: 10px;  
            margin-top: 8px;  
            cursor: pointer;  
            transition: transform 0.3s;  
        }  
        
        .message-image:hover {  
            transform: scale(1.02);  
        }  
        
        .image-modal {  
            position: fixed;  
            top: 0;  
            left: 0;  
            width: 100%;  
            height: 100%;  
            background: rgba(0,0,0,0.9);  
            display: none;  
            justify-content: center;  
            align-items: center;  
            z-index: 4000;  
        }  
        
        .image-modal img {  
            max-width: 90%;  
            max-height: 90%;  
            border-radius: 10px;  
        }  
        
        .close-image-modal {  
            position: absolute;  
            top: 20px;  
            right: 20px;  
            background: rgba(255,255,255,0.1);  
            color: white;  
            border: none;  
            width: 40px;  
            height: 40px;  
            border-radius: 50%;  
            font-size: 24px;  
            cursor: pointer;  
        }  
        
        /* Gƒ∞Rƒ∞≈û EKRANI - BLUR EFFECT */  
        #login-screen {  
            position: fixed;  
            top: 0;  
            left: 0;  
            width: 100%;  
            height: 100%;  
            background: var(--bg-primary);  
            display: flex;  
            align-items: center;  
            justify-content: center;  
            z-index: 2000;  
            transition: all 0.3s ease;  
        }  
        
        .login-container {  
            background: var(--blur-bg);  
            border-radius: 20px;  
            padding: 40px;  
            width: 90%;  
            max-width: 450px;  
            border: 1px solid var(--border-color);  
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);  
            transition: all 0.3s ease;  
            backdrop-filter: var(--blur-intensity);  
            -webkit-backdrop-filter: var(--blur-intensity);  
        }  
        
        .login-title {  
            text-align: center;  
            margin-bottom: 30px;  
            color: var(--primary);  
            font-size: 28px;  
            display: flex;  
            align-items: center;  
            justify-content: center;  
            gap: 10px;  
            font-weight: 600;  
        }  
        
        .login-input {  
            width: 100%;  
            padding: 16px 20px;  
            margin-bottom: 15px;  
            background: var(--input-bg);  
            border: 1px solid var(--border-color);  
            border-radius: 12px;  
            color: var(--text-primary);  
            font-size: 16px;  
            outline: none;  
            transition: all 0.3s ease;  
            backdrop-filter: blur(10px);  
        }  
        
        .login-input:focus {  
            border-color: var(--primary);  
            box-shadow: 0 0 0 3px rgba(255,0,0,0.1);  
        }  
        
        /* CHAT INPUT AREA */  
        .chat-input-area {  
            padding: 16px;  
            border-top: 1px solid var(--border-color);  
            background: var(--bg-secondary);  
            flex-shrink: 0;  
            transition: all 0.3s ease;  
            backdrop-filter: blur(10px);  
        }  
        
        .input-wrapper {  
            display: flex;  
            gap: 12px;  
            align-items: flex-end;  
        }  
        
        #message-input {  
            flex: 1;  
            padding: 12px 16px;  
            background: var(--input-bg);  
            border: 1px solid var(--border-color);  
            border-radius: 12px;  
            color: var(--text-primary);  
            font-size: 14px;  
            outline: none;  
            min-height: 44px;  
            max-height: 120px;  
            resize: none;  
            transition: all 0.3s ease;  
            backdrop-filter: blur(5px);  
        }  
        
        /* FIREBASE BADGE - T√úM SAYFA ALTINDA */  
        .firebase-badge {  
            position: fixed;  
            bottom: 15px;  
            right: 15px;  
            background: var(--firebase);  
            color: white;  
            padding: 10px 20px;  
            border-radius: 15px;  
            font-size: 12px;  
            z-index: 1000;  
            display: flex;  
            align-items: center;  
            gap: 8px;  
            backdrop-filter: blur(10px);  
            cursor: pointer;  
            transition: all 0.3s;  
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);  
        }  
        
        .firebase-badge:hover {  
            transform: translateY(-3px);  
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);  
        }  
        
        .firebase-badge.hidden {  
            opacity: 0.5;  
            transform: scale(0.9);  
        }  
        
        /* STORY MODAL - INSTAGRAM STYLE */  
        .story-modal {  
            position: fixed;  
            top: 0;  
            left: 0;  
            width: 100%;  
            height: 100%;  
            background: #000;  
            z-index: 4001;  
            display: none;  
        }  
        
        .story-progress {  
            position: absolute;  
            top: 10px;  
            left: 10px;  
            right: 10px;  
            height: 3px;  
            background: rgba(255,255,255,0.3);  
            border-radius: 3px;  
            overflow: hidden;  
        }  
        
        .story-progress-bar {  
            height: 100%;  
            background: white;  
            width: 0%;  
            transition: width 0.1s linear;  
        }  
        
        .story-content {  
            position: absolute;  
            top: 0;  
            left: 0;  
            width: 100%;  
            height: 100%;  
            display: flex;  
            justify-content: center;  
            align-items: center;  
        }  
        
        .story-image {  
            max-width: 100%;  
            max-height: 100%;  
            object-fit: contain;  
        }  
        
        .story-text {  
            color: white;  
            font-size: 24px;  
            text-align: center;  
            padding: 20px;  
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);  
        }  
        
        .story-info {  
            position: absolute;  
            bottom: 20px;  
            left: 20px;  
            right: 20px;  
            color: white;  
            display: flex;  
            justify-content: space-between;  
            align-items: center;  
        }  
        
        .story-actions {  
            display: flex;  
            gap: 15px;  
        }  
        
        .story-action-btn {  
            background: none;  
            border: none;  
            color: white;  
            font-size: 24px;  
            cursor: pointer;  
        }  
        
        .story-report-btn {  
            position: absolute;  
            top: 20px;  
            right: 20px;  
            background: rgba(255,255,255,0.1);  
            color: white;  
            border: none;  
            padding: 8px 15px;  
            border-radius: 20px;  
            cursor: pointer;  
            backdrop-filter: blur(10px);  
        }  
        
        /* CHANNEL SYSTEM */  
        .channels-sidebar {  
            width: 250px;  
            background: var(--bg-secondary);  
            border-right: 1px solid var(--border-color);  
            padding: 20px;  
            overflow-y: auto;  
            display: none;  
            flex-direction: column;  
            gap: 10px;  
        }  
        
        .channel-item {  
            padding: 12px 15px;  
            background: rgba(0,0,0,0.05);  
            border-radius: 10px;  
            cursor: pointer;  
            transition: all 0.2s;  
            border-left: 4px solid var(--channel-color);  
        }  
        
        .channel-item:hover {  
            background: rgba(0,0,0,0.1);  
            transform: translateX(5px);  
        }  
        
        .channel-item.active {  
            background: var(--message-channel-bg);  
            border-left-color: var(--channel-color);  
        }  
        
        /* KANAL OLU≈ûTURMA MODALI */  
        .channel-create-modal {  
            position: fixed;  
            top: 50%;  
            left: 50%;  
            transform: translate(-50%, -50%);  
            width: 90%;  
            max-width: 400px;  
            background: var(--bg-secondary);  
            border: 1px solid var(--border-color);  
            border-radius: 15px;  
            z-index: 3000;  
            display: none;  
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);  
            backdrop-filter: blur(20px);  
        }  
        
        /* MATEB BOT PANEL */  
        .mateb-bot-panel {  
            position: fixed;  
            top: 50%;  
            left: 50%;  
            transform: translate(-50%, -50%);  
            width: 90%;  
            max-width: 600px;  
            height: 70vh;  
            background: var(--bg-secondary);  
            border: 1px solid var(--border-color);  
            border-radius: 20px;  
            z-index: 3000;  
            display: none;  
            flex-direction: column;  
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);  
            backdrop-filter: blur(25px);  
        }  
        
        .bot-logs {  
            flex: 1;  
            overflow-y: auto;  
            padding: 20px;  
            font-family: monospace;  
            font-size: 12px;  
        }  
        
        .bot-log-entry {  
            margin-bottom: 5px;  
            padding: 8px;  
            border-radius: 5px;  
            background: rgba(0,0,0,0.05);  
        }  
        
        .bot-log-entry.warning {  
            background: rgba(255,152,0,0.1);  
            border-left: 3px solid var(--coadmin);  
        }  
        
        .bot-log-entry.danger {  
            background: rgba(255,51,51,0.1);  
            border-left: 3px solid var(--ban-color);  
        }  
        
        .bot-log-entry.success {  
            background: rgba(76,175,80,0.1);  
            border-left: 3px solid var(--online);  
        }  
        
        /* RESPONSIVE STYLES */  
        @media (max-width: 768px) {  
            .login-container {  
                padding: 30px 20px;  
            }  
            
            .subscription-modal {  
                width: 95%;  
            }  
            
            .owner-panel {  
                width: 95%;  
                height: 90vh;  
            }  
            
            .private-modal {  
                width: 95%;  
                height: 80vh;  
            }  
            
            .profile-panel {  
                width: 300px;  
                right: 10px;  
            }  
        }  
        
        @media (max-width: 480px) {  
            .profile-panel {  
                width: calc(100vw - 40px);  
                right: 20px;  
            }  
            
            .subscription-plan {  
                padding: 15px;  
            }  
            
            .plan-title {  
                font-size: 18px;  
            }  
            
            .plan-price {  
                font-size: 24px;  
            }  
        }  
        
        /* ANIMATIONS */  
        @keyframes slideIn {  
            from {  
                opacity: 0;  
                transform: translateY(-20px);  
            }  
            to {  
                opacity: 1;  
                transform: translateY(0);  
            }  
        }  
        
        @keyframes fadeIn {  
            from { opacity: 0; }  
            to { opacity: 1; }  
        }  
        
        @keyframes pulse {  
            0%, 100% { opacity: 1; }  
            50% { opacity: 0.5; }  
        }  
        
        .animate-slideIn {  
            animation: slideIn 0.3s ease;  
        }  
        
        .animate-fadeIn {  
            animation: fadeIn 0.3s ease;  
        }  
        
        .animate-pulse {  
            animation: pulse 2s infinite;  
        }  
        
        /* CUSTOM SCROLLBAR */  
        ::-webkit-scrollbar {  
            width: 8px;  
            height: 8px;  
        }  
        
        ::-webkit-scrollbar-track {  
            background: rgba(0,0,0,0.1);  
            border-radius: 10px;  
        }  
        
        ::-webkit-scrollbar-thumb {  
            background: rgba(0,0,0,0.3);  
            border-radius: 10px;  
        }  
        
        ::-webkit-scrollbar-thumb:hover {  
            background: rgba(0,0,0,0.5);  
        }  
        
        /* UTILITY CLASSES */  
        .hidden {  
            display: none !important;  
        }  
        
        .loading {  
            display: inline-block;  
            width: 20px;  
            height: 20px;  
            border: 2px solid rgba(255,255,255,0.3);  
            border-radius: 50%;  
            border-top-color: white;  
            animation: spin 1s ease-in-out infinite;  
        }  
        
        @keyframes spin {  
            to { transform: rotate(360deg); }  
        }  
        
        .tooltip {  
            position: relative;  
        }  
        
        .tooltip-text {  
            position: absolute;  
            bottom: 125%;  
            left: 50%;  
            transform: translateX(-50%);  
            background: rgba(0,0,0,0.8);  
            color: white;  
            padding: 5px 10px;  
            border-radius: 5px;  
            font-size: 12px;  
            white-space: nowrap;  
            display: none;  
            z-index: 1000;  
        }  
        
        .tooltip:hover .tooltip-text {  
            display: block;  
        }  
    </style>  
</head>  
<body class="youtube-live-mode">  
    <!-- BAƒûLANTI KONTROL -->  
    <div class="connection-check" id="connectionCheck">  
        üîÑ Baƒülantƒ± kontrol ediliyor...  
    </div>  
    
    <!-- ACƒ∞L Gƒ∞Rƒ∞≈û BUTONU -->  
    <div class="emergency-login" id="emergencyLogin" onclick="emergencyLogin()">  
        üî• Acil Giri≈ü (Firebase Sorunu)  
    </div>  
    
    <!-- FIREBASE BADGE - T√úM SAYFA ALTINDA -->  
    <div class="firebase-badge" id="firebaseBadge" onclick="toggleFirebaseBadge()">  
        <span>üî•</span> Firebase Active  
        <span style="margin-left: auto; font-size: 10px; opacity: 0.7;">‚ñ≤</span>  
    </div>  
    
    <!-- HEADER -->  
    <div class="youtube-header blur-background">  
        <div class="header-left">  
            <button class="mobile-menu-btn" onclick="toggleUserList()">üë•</button>  
            <div class="logo">  
                <span class="logo-icon">‚ñ∂Ô∏è</span>  
                <span>Popbox Live</span>  
                <div class="user-badges">  
                    <span class="badge owner" id="ownerBadge">OWNER ü§¥</span>  
                    <span class="badge admin" id="adminBadge">ADMIN ‚≠êÔ∏è</span>  
                    <span class="badge coadmin" id="coadminBadge">CO-ADMIN ‚ö°Ô∏è</span>  
                    <span class="badge operator" id="operatorBadge">OPERATOR üõ†Ô∏è</span>  
                    <span class="badge story" id="storyBadge" style="display: none;">STORY üì±</span>  
                    <span class="badge subscriber" id="subscriberBadge" style="display: none;">ABONE ‚ù§Ô∏è</span>  
                    <span class="badge premium" id="premiumBadge" style="display: none;">PREMIUM üëë</span>  
                    <span class="badge member" id="memberBadge" style="display: none;">MEMBER ‚úîÔ∏è</span>  
                </div>  
            </div>  
        </div>  
        <div class="header-right">  
            <!-- PROFƒ∞L BUTONU -->  
            <div class="profile-section">  
                <button class="profile-btn tooltip" onclick="toggleProfilePanel()" title="Profilim">  
                    üë§  
                    <span class="tooltip-text">Profil</span>  
                </button>  
                <div class="profile-panel blur-background" id="profilePanel">  
                    <div class="profile-header">  
                        <div class="profile-avatar" id="profileAvatar">  
                            üë§  
                        </div>  
                        <div class="profile-info">  
                            <div class="profile-username" id="profileUsername">Misafir</div>  
                            <div class="profile-role" id="profileRole">Kullanƒ±cƒ±</div>  
                        </div>  
                    </div>  
                    <div class="profile-body">  
                        <div class="profile-stats">  
                            <div class="stat-item">  
                                <div class="stat-value" id="statMessages">0</div>  
                                <div class="stat-label">Mesaj</div>  
                            </div>  
                            <div class="stat-item">  
                                <div class="stat-value" id="statStories">0</div>  
                                <div class="stat-label">Story</div>  
                            </div>  
                            <div class="stat-item">  
                                <div class="stat-value" id="statLikes">0</div>  
                                <div class="stat-label">Beƒüeni</div>  
                            </div>  
                            <div class="stat-item">  
                                <div class="stat-value" id="statSubscribers">0</div>  
                                <div class="stat-label">Abone</div>  
                            </div>  
                        </div>  
                        <div class="profile-actions">  
                            <button class="profile-action-btn" onclick="openSubscriptionModal()">  
                                <span>‚ù§Ô∏è</span>  
                                <span>Abone Ol</span>  
                                <span style="margin-left: auto;" id="subscriptionStatus">√úcretsiz</span>  
                            </button>  
                            <button class="profile-action-btn" onclick="openStoryCreateModal()">  
                                <span>üì±</span>  
                                <span>Story Ekle</span>  
                            </button>  
                            <button class="profile-action-btn" onclick="viewMyStories()">  
                                <span>üìñ</span>  
                                <span>Story'lerim</span>  
                            </button>  
                            <button class="profile-action-btn" onclick="openPrivateChat('PopboxChatBot')">  
                                <span>ü§ñ</span>  
                                <span>Bot ile Sohbet</span>  
                            </button>  
                            <button class="profile-action-btn" onclick="toggleTheme()">  
                                <span>üé®</span>  
                                <span>Tema Deƒüi≈ütir</span>  
                            </button>  
                            
                            <!-- Y√ñNETƒ∞Cƒ∞ BUTONLARI -->  
                            <button class="profile-action-btn admin-panel" onclick="openAdminPanel()" id="adminPanelBtn" style="display: none;">  
                                <span>‚öôÔ∏è</span>  
                                <span>Y√∂netim Paneli</span>  
                            </button>  
                            
                            <button class="profile-action-btn owner-panel" onclick="openOwnerPanel()" id="ownerPanelBtn" style="display: none;">  
                                <span>ü§¥</span>  
                                <span>Owner Paneli</span>  
                            </button>  
                            
                            <button class="profile-action-btn" onclick="openMatebBotPanel()" id="matebBotBtn">  
                                <span>üõ°Ô∏è</span>  
                                <span>MateB G√ºvenlik</span>  
                            </button>  
                            
                            <button class="profile-action-btn" onclick="logout()">  
                                <span>üö™</span>  
                                <span>√áƒ±kƒ±≈ü Yap</span>  
                            </button>  
                        </div>  
                    </div>  
                </div>  
            </div>  
            
            <!-- STORY BUTONU -->  
            <div class="story-section">  
                <button class="story-toggle-btn tooltip" onclick="toggleStorySection()" title="Story/Hikaye">  
                    üì±  
                    <span class="story-toggle-badge" id="storyToggleBadge">0</span>  
                    <span class="tooltip-text">Story'ler</span>  
                </button>  
            </div>  
            
            <!-- ≈ûƒ∞KAYET Bƒ∞LDƒ∞Rƒ∞Mƒ∞ -->  
            <div class="report-notification" id="reportNotification">  
                <button class="notification-icon tooltip" onclick="toggleReportPanel()" title="≈ûikayetler">  
                    ‚ö†Ô∏è  
                    <span class="report-badge" id="reportBadge">0</span>  
                    <span class="tooltip-text">≈ûikayetler</span>  
                </button>  
                <div class="notification-panel blur-background" id="reportPanel">  
                    <div class="notification-header">  
                        <span>≈ûikayetler</span>  
                        <button onclick="closeReportPanel()" style="background:none; border:none; color:var(--text-primary); cursor:pointer;">√ó</button>  
                    </div>  
                    <div class="notification-list" id="reportList">  
                        <!-- ≈ûikayetler buraya eklenecek -->  
                    </div>  
                    <div class="notification-footer">  
                        <button class="clear-notifications-btn" onclick="openReportsModal()">T√ºm√ºn√º G√∂r</button>  
                    </div>  
                </div>  
            </div>  
            
            <!-- Bƒ∞LDƒ∞Rƒ∞M PANELƒ∞ -->  
            <div class="notification-section">  
                <button class="notification-icon tooltip" onclick="toggleNotificationPanel(event)" title="Bildirimler">  
                    üîî  
                    <span class="notification-badge" id="notificationBadge">0</span>  
                    <span class="tooltip-text">Bildirimler</span>  
                </button>  
                <div class="notification-panel blur-background" id="notificationPanel">  
                    <div class="notification-header">  
                        <span>Bildirimler</span>  
                        <button onclick="closeNotificationPanel()" style="background:none; border:none; color:var(--text-primary); cursor:pointer;">√ó</button>  
                    </div>  
                    <div class="notification-list" id="notificationList">  
                        <!-- Bildirimler buraya eklenecek -->  
                    </div>  
                    <div class="notification-footer">  
                        <button class="clear-notifications-btn" onclick="clearAllNotifications()">T√ºm√ºn√º Temizle</button>  
                    </div>  
                </div>  
            </div>  
            
            <!-- CHANNELS BUTON -->  
            <button class="online-list-btn tooltip" onclick="toggleChannelsSidebar()" title="Kanallar">  
                <span>#Ô∏è‚É£</span>  
                <span id="channelsCount">0</span>  
                <span class="tooltip-text">Kanallar</span>  
            </button>  
            
            <button class="online-list-btn tooltip" onclick="toggleUserList()" title="Online Kullanƒ±cƒ±lar">  
                <span>üë•</span>  
                <span id="onlineCount">0</span>  
                <span class="tooltip-text">Online Kullanƒ±cƒ±lar</span>  
            </button>  
            
            <button class="theme-toggle tooltip" onclick="toggleTheme()" title="Tema deƒüi≈ütir">  
                üé®  
                <span class="tooltip-text">Tema</span>  
            </button>  
        </div>  
    </div>  
    
    <!-- STORY/Hƒ∞KAYE B√ñL√úM√ú - INSTAGRAM STYLE -->  
    <div class="story-container blur-background" id="storyContainer">  
        <div class="story-wrapper" id="storyWrapper">  
            <!-- My Story Button -->  
            <div class="story-item" onclick="openMyStory()">  
                <div class="story-avatar my-story">  
                    +  
                </div>  
                <div class="story-user">Story Ekle</div>  
            </div>  
            <!-- Story'ler buraya eklenecek -->  
        </div>  
    </div>  
    
    <!-- ANA CONTAINER -->  
    <div class="main-container">  
        <!-- KANALLAR SIDEBAR -->  
        <div class="channels-sidebar blur-background" id="channelsSidebar">  
            <div class="users-title">  
                <span>Kanallar</span>  
                <button class="close-sidebar" onclick="toggleChannelsSidebar()">√ó</button>  
            </div>  
            <button class="profile-action-btn" onclick="openChannelCreateModal()" style="margin-bottom: 15px;">  
                <span>‚ûï</span>  
                <span>Kanal Olu≈ütur</span>  
            </button>  
            <div id="channelList">  
                <!-- Kanallar buraya eklenecek -->  
            </div>  
        </div>  
        
        <!-- VIDEO B√ñL√úM√ú -->  
        <div class="video-container">  
            <div class="video-wrapper">  
                <div id="youtube-player"></div>  
                <div class="video-placeholder blur-background">  
                    <div style="font-size: 48px; margin-bottom: 16px;">üéµ</div>  
                    <div style="font-size: 20px; font-weight: 500;">Popbox Music Live</div>  
                    <div style="font-size: 14px; opacity: 0.8; margin-top: 8px;">Canlƒ± yayƒ±n y√ºkleniyor...</div>  
                </div>  
            </div>  
        </div>  
        
        <!-- CHAT B√ñL√úM√ú -->  
        <div class="chat-container">  
            <div class="chat-header blur-background">  
                <div class="chat-title" id="currentChannel"># Genel</div>  
                <div class="chat-actions">  
                    <button class="story-create-btn tooltip" onclick="openStoryCreateModal()" title="Yeni Story Olu≈ütur">  
                        +  
                        <span class="tooltip-text">Story Ekle</span>  
                    </button>  
                    <div class="online-count">  
                        <span id="chatOnlineCount">0</span> ki≈üi  
                    </div>  
                </div>  
            </div>  
            
            <div class="messages-area" id="messages">  
                <div class="yt-message system">  
                    üéâ Popbox Music Live'e ho≈ü geldiniz! Canlƒ± sohbete katƒ±lƒ±n.  
                </div>  
            </div>  
            
            <div class="chat-input-area blur-background">  
                <div class="input-wrapper">  
                    <input type="file" id="imageUpload" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">  
                    <button class="image-upload-btn tooltip" onclick="document.getElementById('imageUpload').click()" title="Resim g√∂nder">  
                        üì∑  
                        <span class="tooltip-text">Resim Ekle</span>  
                    </button>  
                    <textarea   
                        id="message-input"   
                        placeholder="Mesajƒ±nƒ±zƒ± yazƒ±n veya / komutlarƒ± kullanƒ±n..."  
                        rows="1"  
                        oninput="autoResize(this)"  
                    ></textarea>  
                    <button class="send-button tooltip" onclick="sendMessage()" title="G√∂nder (Enter)">  
                        ‚Üó  
                        <span class="tooltip-text">G√∂nder</span>  
                    </button>  
                </div>  
            </div>  
        </div>  
        
        <!-- ONLINE KULLANICILAR SIDEBAR -->  
        <div class="users-sidebar blur-background" id="usersSidebar">  
            <div class="users-title">  
                <span>Canlƒ± Katƒ±lƒ±mcƒ±lar</span>  
                <button class="close-sidebar" onclick="toggleUserList()">√ó</button>  
            </div>  
            <div id="userList">  
                <!-- Kullanƒ±cƒ±lar buraya eklenecek -->  
            </div>  
        </div>  
    </div>  
    
    <!-- Gƒ∞Rƒ∞≈û EKRANI - BLUR EFFECT -->  
    <div id="login-screen" class="blur-background">  
        <div class="login-container animate-slideIn">  
            <div class="login-title">  
                <span class="logo-icon">‚ñ∂Ô∏è</span>  
                Popbox Live  
            </div>  
            
            <div class="login-subtitle" style="color: var(--text-secondary); text-align: center; margin-bottom: 20px; font-size: 14px;">  
                üî• Firebase Realtime Chat<br>  
                üëë T√ºm y√∂netici yetkileri<br>  
                üì± Instagram Style Story<br>  
                ‚ù§Ô∏è YouTube Abonelik Sistemi<br>  
                üõ°Ô∏è MateB G√ºvenlik Botu<br>  
                #Ô∏è‚É£ Kanal Sistemi  
            </div>  
            
            <div style="background: rgba(255, 0, 0, 0.1); padding: 10px; border-radius: 8px; margin-bottom: 15px; border-left: 3px solid #ff0000;">  
                <strong>‚ö†Ô∏è Giri≈ü Sorunu √á√∂z√ºm√º:</strong><br>  
                <small>Firebase baƒülantƒ±sƒ± yoksa "Acil Giri≈ü" butonunu kullanƒ±n</small>  
            </div>  
            
            <input   
                type="text"   
                id="login-nick"   
                class="login-input"   
                placeholder="Kullanƒ±cƒ± adƒ±nƒ±z"  
                autocomplete="off"  
                onkeyup="checkUsernameRealTime()"  
            >  
            
            <input   
                type="password"   
                id="login-password"   
                class="login-input"   
                placeholder="≈ûifre (sadece kayƒ±tlƒ± kullanƒ±cƒ±lar)"  
                autocomplete="off"  
                style="display: none;"  
            >  
            
            <div id="password-info" style="color: var(--text-secondary); font-size: 14px; margin-bottom: 12px; display: none;">  
                üîê Bu kullanƒ±cƒ± kayƒ±tlƒ±dƒ±r, l√ºtfen ≈üifrenizi girin  
            </div>  
            
            <div id="similar-users-warning" style="color: var(--coadmin); font-size: 14px; margin-bottom: 12px; display: none; background: rgba(255,152,0,0.1); padding: 10px; border-radius: 8px; border-left: 3px solid var(--coadmin);">  
                ‚ö†Ô∏è Bu nick benzeri zaten kullanƒ±lƒ±yor!  
            </div>  
            
            <div id="nick-suggestion" style="color: var(--online); font-size: 14px; margin-bottom: 12px; display: none; background: rgba(76,175,80,0.1); padding: 10px; border-radius: 8px; border-left: 3px solid var(--online);">  
                üí° √ñnerilen nick: <span id="suggested-nick" style="font-weight: bold; cursor: pointer; text-decoration: underline;"></span>  
            </div>  
            
            <button class="login-button" onclick="login()" id="login-btn">  
                Sohbete Katƒ±l  
            </button>  
            
            <button class="login-button" onclick="simpleLogin()" id="simple-login-btn" style="background: #666; margin-top: 10px; display: none;">  
                üî• Basit Giri≈ü (Firebase Yok)  
            </button>  
            
            <div id="login-error" class="error-message"></div>  
            <div id="login-success" class="success-message"></div>  
            
            <div style="margin-top: 20px; text-align: center; font-size: 12px; color: var(--text-secondary);">  
                üé® Tema deƒüi≈ütirebilirsiniz<br>  
                üë§ Profilden abone olabilirsiniz<br>  
                üì± Story ekleyip beƒüeni toplayabilirsiniz  
            </div>  
        </div>  
    </div>  
    
    <!-- RESƒ∞M G√ñSTERƒ∞M MODALI -->  
    <div class="image-modal" id="imageModal" onclick="closeImageModal()">  
        <img id="modalImage" src="" alt="Resim">  
        <button class="close-image-modal" onclick="closeImageModal()">√ó</button>  
    </div>  
    
    <!-- STORY G√ñSTERƒ∞M MODALI - INSTAGRAM STYLE -->  
    <div class="story-modal" id="storyModal">  
        <div class="story-progress" id="storyProgress">  
            <div class="story-progress-bar" id="storyProgressBar"></div>  
        </div>  
        <div class="story-content" id="storyContent"></div>  
        <div class="story-info" id="storyInfo">  
            <div class="story-user-info" id="storyUserInfo"></div>  
            <div class="story-actions">  
                <button class="story-action-btn" onclick="likeStory()">‚ù§Ô∏è <span id="storyLikeCount">0</span></button>  
                <button class="story-action-btn" onclick="reportCurrentStory()">‚ö†Ô∏è</button>  
            </div>  
        </div>  
        <button class="story-report-btn" onclick="closeStoryModal()">‚úï</button>  
    </div>  
    
    <!-- OWNER Y√ñNETƒ∞M PANELƒ∞ -->  
    <div class="owner-panel blur-background" id="ownerPanel">  
        <div class="owner-tabs">  
            <button class="owner-tab active" onclick="switchOwnerTab('privateMessages')">üì® √ñzel Mesajlar</button>  
            <button class="owner-tab" onclick="switchOwnerTab('adminControl')">üëë Admin Kontrol</button>  
            <button class="owner-tab" onclick="switchOwnerTab('userManagement')">üë• Kullanƒ±cƒ± Y√∂netimi</button>  
            <button class="owner-tab" onclick="switchOwnerTab('channelManagement')">#Ô∏è‚É£ Kanal Y√∂netimi</button>  
            <button class="owner-tab" onclick="switchOwnerTab('botControl')">ü§ñ Bot Kontrol</button>  
        </div>  
        
        <div class="owner-tab-content active" id="privateMessagesTab">  
            <div style="margin-bottom: 15px;">  
                <h3>üì® T√ºm √ñzel Mesajlarƒ± G√∂r√ºnt√ºle</h3>  
                <div id="allPrivateMessages" style="height: 300px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 10px; padding: 10px; background: rgba(0,0,0,0.05);">  
                    <!-- T√ºm √∂zel mesajlar buraya eklenecek -->  
                </div>  
            </div>  
        </div>  
        
        <div class="owner-tab-content" id="adminControlTab">  
            <div class="admin-controls">  
                <div class="control-group">  
                    <h4>üëë Admin Ekle/Sil</h4>  
                    <input type="text" id="adminUsername" class="control-input" placeholder="Kullanƒ±cƒ± adƒ±">  
                    <select id="adminRole" class="control-input">  
                        <option value="operator">Operat√∂r</option>  
                        <option value="coadmin">Co-Admin</option>  
                        <option value="admin">Admin</option>  
                    </select>  
                    <button class="control-btn" onclick="addAdmin()">Ekle</button>  
                    <button class="control-btn ban" onclick="removeAdmin()">Kaldƒ±r</button>  
                </div>  
                
                <div class="control-group">  
                    <h4>üö´ Kullanƒ±cƒ± Ban</h4>  
                    <input type="text" id="banUsername" class="control-input" placeholder="Kullanƒ±cƒ± adƒ±">  
                    <select id="banDuration" class="control-input">  
                        <option value="300000">5 Dakika</option>  
                        <option value="1800000">30 Dakika</option>  
                        <option value="3600000">1 Saat</option>  
                        <option value="86400000">1 G√ºn</option>  
                        <option value="604800000">1 Hafta</option>  
                        <option value="2592000000">1 Ay</option>  
                        <option value="9999999999">S√ºresiz</option>  
                    </select>  
                    <input type="text" id="banReason" class="control-input" placeholder="Ban sebebi">  
                    <button class="control-btn ban" onclick="banUser()">Banla</button>  
                    <button class="control-btn" onclick="unbanUser()">Ban Kaldƒ±r</button>  
                </div>  
                
                <div class="control-group">  
                    <h4>‚ö†Ô∏è Uyarƒ±/Kick</h4>  
                    <input type="text" id="warnUsername" class="control-input" placeholder="Kullanƒ±cƒ± adƒ±">  
                    <input type="text" id="warnReason" class="control-input" placeholder="Uyarƒ± sebebi">  
                    <button class="control-btn warn" onclick="warnUser()">Uyarƒ± Ver</button>  
                    <button class="control-btn kick" onclick="kickUser()">Kick At</button>  
                </div>  
                
                <div class="control-group">  
                    <h4>üõ°Ô∏è G√ºvenlik</h4>  
                    <button class="control-btn" onclick="viewUserIPs()">IP Listesi</button>  
                    <button class="control-btn" onclick="viewUserActivities()">Aktivite Loglarƒ±</button>  
                    <button class="control-btn" onclick="clearAllChat()">Chat'i Temizle</button>  
                </div>  
            </div>  
        </div>  
        
        <div class="owner-tab-content" id="userManagementTab">  
            <h3>üë• T√ºm Kullanƒ±cƒ±lar</h3>  
            <div id="allUsersList" style="height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 10px; padding: 10px; background: rgba(0,0,0,0.05);">  
                <!-- T√ºm kullanƒ±cƒ±lar buraya eklenecek -->  
            </div>  
        </div>  
        
        <div class="owner-tab-content" id="channelManagementTab">  
            <h3>#Ô∏è‚É£ Kanal Y√∂netimi</h3>  
            <div style="margin-bottom: 15px;">  
                <input type="text" id="newChannelName" class="control-input" placeholder="Yeni kanal adƒ±" style="width: 200px;">  
                <button class="control-btn" onclick="createChannel()">Kanal Olu≈ütur</button>  
            </div>  
            <div id="allChannelsList" style="height: 300px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 10px; padding: 10px; background: rgba(0,0,0,0.05);">  
                <!-- T√ºm kanallar buraya eklenecek -->  
            </div>  
        </div>  
        
        <div class="owner-tab-content" id="botControlTab">  
            <h3>ü§ñ MateB Bot Kontrol</h3>  
            <div style="margin-bottom: 15px;">  
                <button class="control-btn" onclick="bot.sendWelcome('T√ºmKullanƒ±cƒ±lar')">Ho≈ü Geldin Mesajƒ±</button>  
                <button class="control-btn" onclick="bot.sendSystemAnnouncement()">Sistem Duyurusu</button>  
                <button class="control-btn" onclick="bot.scanForSpam()">Spam Taramasƒ±</button>  
            </div>  
            <div id="botLogs" style="height: 300px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 10px; padding: 10px; background: rgba(0,0,0,0.05); font-family: monospace; font-size: 12px;">  
                <!-- Bot loglarƒ± buraya eklenecek -->  
            </div>  
        </div>  
        
        <div style="padding: 15px; border-top: 1px solid var(--border-color); text-align: right;">  
            <button class="control-btn" onclick="closeOwnerPanel()">Kapat</button>  
        </div>  
    </div>  
    
    <!-- MATEB BOT PANEL -->  
    <div class="mateb-bot-panel blur-background" id="matebBotPanel">  
        <div class="owner-header" style="padding: 20px; background: linear-gradient(135deg, #4caf50, #2e7d32); color: white; border-radius: 20px 20px 0 0;">  
            <h2 style="margin: 0;">üõ°Ô∏è MateB G√ºvenlik Botu</h2>  
            <p style="margin: 5px 0 0 0; opacity: 0.9;">24/7 G√ºvenlik ve Moderas
</div>  
            <div class="bot-logs" id="matebBotLogs">  
                <!-- Bot loglarƒ± buraya eklenecek -->  
            </div>  
            <div style="padding: 15px; border-top: 1px solid var(--border-color); text-align: right;">  
                <button class="control-btn" onclick="closeMatebBotPanel()">Kapat</button>  
                <button class="control-btn" onclick="bot.clearLogs()">Loglarƒ± Temizle</button>  
            </div>  
        </div>  
        
        <!-- YOUTUBE STYLE ABONELƒ∞K MODALI -->  
        <div class="subscription-modal blur-background" id="subscriptionModal">  
            <div class="subscription-header">  
                <h2 style="margin: 0; font-size: 24px;">‚ù§Ô∏è YouTube Abonelik Sistemi</h2>  
                <p style="margin: 8px 0 0 0; opacity: 0.9;">√ñzel √∂zelliklerin kilidini a√ßƒ±n!</p>  
            </div>  
            <div class="subscription-body">  
                <div class="subscription-plan" onclick="selectSubscriptionPlan('standart')" id="planStandart">  
                    <div class="plan-title">üë§ Standart</div>  
                    <div class="plan-price free">√úCRETSƒ∞Z</div>  
                    <ul class="plan-features">  
                        <li>Standart sohbet √∂zellikleri</li>  
                        <li>1 g√ºnl√ºk story s√ºresi</li>  
                        <li>Temel emoji desteƒüi</li>  
                        <li>Normal mesaj limiti</li>  
                    </ul>  
                </div>  
                
                <div class="subscription-plan member" onclick="selectSubscriptionPlan('member')" id="planMember">  
                    <div class="plan-badge member">√úYE</div>  
                    <div class="plan-title">‚úîÔ∏è √úye</div>  
                    <div class="plan-price member">29.99‚Ç∫<span class="plan-period">/ay</span></div>  
                    <ul class="plan-features">  
                        <li>√úye rozeti ve rengi</li>  
                        <li>7 g√ºnl√ºk story s√ºresi</li>  
                        <li>Arttƒ±rƒ±lmƒ±≈ü mesaj limiti</li>  
                        <li>√ñzel emoji paketi</li>  
                        <li>Geli≈ümi≈ü profil</li>  
                    </ul>  
                </div>  
                
                <div class="subscription-plan" onclick="selectSubscriptionPlan('abone')" id="planAbone">  
                    <div class="plan-badge subscriber">ABONE</div>  
                    <div class="plan-title">‚ù§Ô∏è Abone</div>  
                    <div class="plan-price subscriber">49.99‚Ç∫<span class="plan-period">/ay</span></div>  
                    <ul class="plan-features">  
                        <li>√ñzel abone rozeti</li>  
                        <li>√ñzel mesaj rengi</li>  
                        <li>14 g√ºnl√ºk story s√ºresi</li>  
                        <li>Sƒ±nƒ±rsƒ±z emoji</li>  
                        <li>√ñzel abone listesi</li>  
                        <li>Erken eri≈üim √∂zellikleri</li>  
                    </ul>  
                </div>  
                
                <div class="subscription-plan premium" onclick="selectSubscriptionPlan('premium')" id="planPremium">  
                    <div class="plan-badge premium">PREMIUM</div>  
                    <div class="plan-title">üëë Premium</div>  
                    <div class="plan-price premium">99.99‚Ç∫<span class="plan-period">/ay</span></div>  
                    <ul class="plan-features">  
                        <li>Premium rozet ve animasyon</li>  
                        <li>30 g√ºnl√ºk story s√ºresi</li>  
                        <li>Sƒ±nƒ±rsƒ±z mesaj ve story</li>  
                        <li>√ñzel y√∂netici desteƒüi</li>  
                        <li>T√ºm √∂zelliklere eri≈üim</li>  
                        <li>√ñzel komut eri≈üimi</li>  
                        <li>VIP davetiyeleri</li>  
                    </ul>  
                </div>  
                
                <div class="modal-buttons" style="margin-top: 20px;">  
                    <button class="control-btn" style="background: var(--subscriber-color); width: 100%; padding: 15px; font-size: 16px;" onclick="activateSubscription()">  
                        ABONE OL  
                    </button>  
                    <button class="control-btn" style="background: #666; width: 100%; margin-top: 10px;" onclick="closeSubscriptionModal()">  
                        ƒ∞PTAL  
                    </button>  
                </div>  
            </div>  
        </div>  
        
        <!-- √ñZEL SOHBET MODALI -->  
        <div class="private-modal blur-background" id="privateModal">  
            <div class="private-header">  
                <div id="privateWith">üîí √ñzel Sohbet</div>  
                <button onclick="closePrivateChat()" style="background: none; border: none; color: white; font-size: 24px; cursor: pointer;">  
                    √ó  
                </button>  
            </div>  
            <div class="private-messages" id="privateMessages"></div>  
            <div class="private-input-area">  
                <input type="file" id="privateImageUpload" accept="image/*" style="display: none;" onchange="handlePrivateImageUpload(event)">  
                <button class="image-upload-btn" onclick="document.getElementById('privateImageUpload').click()" title="Resim g√∂nder">  
                    üì∑  
                </button>  
                <textarea   
                    id="private-input"   
                    placeholder="√ñzel mesaj yazƒ±n..."  
                    rows="1"  
                    oninput="autoResize(this)"  
                ></textarea>  
                <button class="send-button" style="background: var(--private);" onclick="sendPrivateMessage()">  
                    ‚Üó  
                </button>  
            </div>  
        </div>  
        
        <!-- KANAL OLU≈ûTURMA MODALI -->  
        <div class="channel-create-modal blur-background" id="channelCreateModal">  
            <div class="subscription-header">  
                <h2 style="margin: 0;">#Ô∏è‚É£ Yeni Kanal Olu≈ütur</h2>  
            </div>  
            <div class="subscription-body">  
                <input type="text" id="channelName" class="login-input" placeholder="Kanal adƒ± (√∂rn: #m√ºzik)">  
                <textarea id="channelDescription" class="login-input" placeholder="Kanal a√ßƒ±klamasƒ±" rows="3"></textarea>  
                <select id="channelType" class="login-input">  
                    <option value="public">Herkese A√ßƒ±k</option>  
                    <option value="private">√ñzel</option>  
                    <option value="protected">≈ûifreli</option>  
                </select>  
                <input type="password" id="channelPassword" class="login-input" placeholder="Kanal ≈üifresi (isteƒüe baƒülƒ±)" style="display: none;">  
                <div class="modal-buttons" style="margin-top: 20px;">  
                    <button class="control-btn" style="background: var(--channel-color); width: 100%;" onclick="createNewChannel()">  
                        Kanal Olu≈ütur  
                    </button>  
                    <button class="control-btn" style="background: #666; width: 100%; margin-top: 10px;" onclick="closeChannelCreateModal()">  
                        ƒ∞ptal  
                    </button>  
                </div>  
            </div>  
        </div>  
        
        <!-- STORY OLU≈ûTURMA MODALI - INSTAGRAM STYLE -->  
        <div class="subscription-modal blur-background" id="storyCreateModal">  
            <div class="subscription-header" style="background: linear-gradient(135deg, var(--story-color), #ff4757);">  
                <h2 style="margin: 0;">üì± Yeni Story/Hikaye</h2>  
                <p style="margin: 8px 0 0 0; opacity: 0.9;">Instagram gibi 24 saatlik hikaye</p>  
            </div>  
            <div class="subscription-body">  
                <div style="margin-bottom: 20px;">  
                    <div style="font-weight: 500; margin-bottom: 10px;">Story Tipi:</div>  
                    <div style="display: flex; gap: 10px;">  
                        <button class="control-btn" id="storyTypeText" onclick="selectStoryType('text')" style="flex: 1;">üìù Metin</button>  
                        <button class="control-btn" id="storyTypeImage" onclick="selectStoryType('image')" style="flex: 1;">üñºÔ∏è Resim</button>  
                    </div>  
                </div>  
                
                <div id="storyTextSection">  
                    <textarea   
                        id="story-text"   
                        class="login-input"   
                        placeholder="Story metnini yazƒ±n..."  
                        rows="4"  
                    ></textarea>  
                    <div style="margin-top: 10px;">  
                        <button class="control-btn" onclick="changeStoryColor('#ff6b6b')" style="background: #ff6b6b;">Kƒ±rmƒ±zƒ±</button>  
                        <button class="control-btn" onclick="changeStoryColor('#4ecdc4')" style="background: #4ecdc4;">Mavi</button>  
                        <button class="control-btn" onclick="changeStoryColor('#ffe66d')" style="background: #ffe66d;">Sarƒ±</button>  
                        <button class="control-btn" onclick="changeStoryColor('#1a535c')" style="background: #1a535c;">Koyu</button>  
                    </div>  
                </div>  
                
                <div id="storyImageSection" style="display: none;">  
                    <input type="file" id="story-image-upload" accept="image/*" class="login-input" onchange="handleStoryImageUpload(event)">  
                    <div id="story-image-preview" style="margin: 15px 0; text-align: center;">  
                        <img id="preview-image" style="max-width: 100%; max-height: 200px; border-radius: 10px; display: none;">  
                    </div>  
                </div>  
                
                <div style="margin-top: 20px;">  
                    <div style="font-weight: 500; margin-bottom: 10px;">G√∂r√ºn√ºrl√ºk:</div>  
                    <select id="storyVisibility" class="login-input">  
                        <option value="public">Herkese A√ßƒ±k üåç</option>  
                        <option value="followers">Sadece Takip√ßilerim üë•</option>  
                        <option value="private">Sadece Se√ßtiklerim üîí</option>  
                    </select>  
                </div>  
                
                <div class="modal-buttons" style="margin-top: 20px;">  
                    <button class="control-btn" style="background: var(--story-color); width: 100%; padding: 15px;" onclick="createStory()">  
                        üì± STORY YAYINLA  
                    </button>  
                    <button class="control-btn" style="background: #666; width: 100%; margin-top: 10px;" onclick="closeStoryCreateModal()">  
                        ƒ∞PTAL  
                    </button>  
                </div>  
            </div>  
        </div>  
        
        <!-- OVERLAY -->  
        <div id="overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 2999; backdrop-filter: blur(5px);"></div>  
        
        <!-- SES ELEMANI -->  
        <audio id="notificationSound" style="display: none;">  
            <source src="https://assets.mixkit.co/sfx/preview/mixkit-software-interface-start-2574.mp3" type="audio/mpeg">  
        </audio>  

    <script>  
        // ========== G√úVENLƒ∞K KONFƒ∞G√úRASYONU ==========  
        const SECURE_CONFIG = {  
            DEFAULT_ADMINS: ['popbox', 'popboxmusic', 'admin', 'moderator'],  
            OWNER_CONFIG: {  
                username: 'MateKy',  
                role: 'owner',  
                password: 'Sahi17407@SCM',  
                isHidden: true  
            },  
            BOT_CONFIG: {  
                name: 'MateB Security Bot',  
                securityLevel: 'high',  
                welcomeMessages: [  
                    "üéâ {user} aramƒ±za ho≈ü geldin! G√ºvenli sohbetin keyfini √ßƒ±kar!",  
                    "üõ°Ô∏è Merhaba {user}! MateB botu sizi koruyor.",  
                    "üëã Ho≈ü geldin {user}! Kurallara uymayƒ± unutmayƒ±n!"  
                ],  
                autoMessages: [  
                    "üí° ƒ∞pucu: /yardƒ±m yazarak t√ºm komutlarƒ± g√∂rebilirsin!",  
                    "üë• Online kullanƒ±cƒ±larƒ± g√∂rmek i√ßin /online yazƒ±n!",  
                    "‚ù§Ô∏è Abone olarak √∂zel √∂zelliklere eri≈üin! /abone",  
                    "üì± Instagram gibi story payla≈üƒ±n! /story",  
                    "üîí √ñzel sohbet i√ßin kullanƒ±cƒ±ya saƒü tƒ±klayƒ±n!"  
                ],  
                messageInterval: 300000,  
                welcomeDelay: 1000,  
                maxMessagesPerHour: 3  
            },  
            YOUTUBE_SUBSCRIPTION_PLANS: {  
                standart: {  
                    name: 'Standart',  
                    price: 0,  
                    badge: '',  
                    color: 'user',  
                    storyDuration: 24,  
                    features: [  
                        'Standart sohbet √∂zellikleri',  
                        '1 g√ºnl√ºk story s√ºresi',  
                        'Temel emoji desteƒüi',  
                        'Normal mesaj limiti'  
                    ]  
                },  
                member: {  
                    name: '√úye',  
                    price: 29.99,  
                    badge: '‚úîÔ∏è',  
                    color: 'member',  
                    storyDuration: 168,  
                    features: [  
                        '√úye rozeti ve rengi',  
                        '7 g√ºnl√ºk story s√ºresi',  
                        'Arttƒ±rƒ±lmƒ±≈ü mesaj limiti',  
                        '√ñzel emoji paketi',  
                        'Geli≈ümi≈ü profil'  
                    ]  
                },  
                abone: {  
                    name: 'Abone',  
                    price: 49.99,  
                    badge: '‚ù§Ô∏è',  
                    color: 'subscriber',  
                    storyDuration: 336,  
                    features: [  
                        '√ñzel abone rozeti',  
                        '√ñzel mesaj rengi',  
                        '14 g√ºnl√ºk story s√ºresi',  
                        'Sƒ±nƒ±rsƒ±z emoji',  
                        '√ñzel abone listesi',  
                        'Erken eri≈üim √∂zellikleri'  
                    ]  
                },  
                premium: {  
                    name: 'Premium',  
                    price: 99.99,  
                    badge: 'üëë',  
                    color: 'premium',  
                    storyDuration: 720,  
                    features: [  
                        'Premium rozet ve animasyon',  
                        '30 g√ºnl√ºk story s√ºresi',  
                        'Sƒ±nƒ±rsƒ±z mesaj ve story',  
                        '√ñzel y√∂netici desteƒüi',  
                        'T√ºm √∂zelliklere eri≈üim',  
                        '√ñzel komut eri≈üimi',  
                        'VIP davetiyeleri'  
                    ]  
                }  
            },  
            STORY_CONFIG: {  
                duration: 24 * 60 * 60 * 1000, // 24 saat  
                maxPerUser: 10,  
                maxImageSize: 5 * 1024 * 1024, // 5MB  
                allowedTypes: ['image/jpeg', 'image/png', 'image/gif']  
            },  
            CHANNEL_CONFIG: {  
                maxChannels: 20,  
                defaultChannels: ['#genel', '#m√ºzik', '#oyun', '#eƒülence']  
            }  
        };  

        // ========== FIREBASE KONFƒ∞G√úRASYONU ==========  
        const firebaseConfig = {  
            apiKey: "AIzaSyCrn_tXJZCAlKhem45aXxj4f0h26EPOQ70",  
            authDomain: "popboxmusicchat.firebaseapp.com",  
            databaseURL: "https://popboxmusicchat-default-rtdb.firebaseio.com",  
            projectId: "popboxmusicchat",  
            storageBucket: "popboxmusicchat.firebasestorage.app",  
            messagingSenderId: "206625719024",  
            appId: "1:206625719024:web:d28f478a2c96d10412f835",  
            measurementId: "G-SB1K22FLEX"  
        };  
          
        // ========== GLOBAL DEƒûƒ∞≈ûKENLER ==========  
        let database;  
        let usersRef, messagesRef, privateChatsRef, coAdminsRef, bansRef;  
        let registeredUsersRef, operatorsRef, userLocksRef, adminPasswordsRef;  
        let customCommandsRef, adminListRef, storiesRef, storyLikesRef;  
        let storyReportsRef, subscriptionsRef, userStatsRef, followersRef;  
        let channelsRef, channelMessagesRef, channelUsersRef;  
          
        let isFirebaseConnected = false;  
        let firebaseInitialized = false;  
        let currentUser = null;  
        let isAdmin = false, isCoAdmin = false, isOperator = false, isOwner = false;  
        let isSubscriber = false, isPremium = false, isMember = false;  
        let player = null;  
        let privateChatWith = null;  
        let currentPrivateChatId = null;  
        let coAdminList = [], operatorList = [], adminList = [];  
        let bannedUsers = {}, registeredUsers = {}, customCommands = {};  
        let originalTitle = document.title;  
        let ownerPrivateMessages = {}, allPrivateMessages = [];  
        let activePrivateChatListeners = {};  
        let ownerPasswordHash = null;  
        let stories = [], storyLikes = {}, storyReports = {};  
        let currentStoryIndex = 0, currentStories = [];  
        let storyProgressInterval = null, storyVisibility = 'public';  
        let currentStoryId = null, storySectionOpen = false;  
        let currentReportStoryId = null, selectedReportReason = '';  
        let userStats = {}, userSubscriptions = {}, followers = {}, following = {};  
        let selectedSubscriptionPlan = 'standart';  
        let profilePanelOpen = false;  
        let notificationCount = 0, notifications = [];  
        let reportCount = 0, reports = [];  
        let notificationPanelOpen = false, reportPanelOpen = false;  
        let fallbackMode = false;  
        let connectionTimeout = null;  
        let connectionRetries = 0;  
        const MAX_RETRIES = 3;  
        let channels = {}, currentChannel = '#genel';  
        let storyCurrentColor = '#ff6b6b';  
        let storyCurrentType = 'text';  
          
        // ========== ACƒ∞L Gƒ∞Rƒ∞≈û Sƒ∞STEMƒ∞ ==========  
        function showEmergencyLogin() {  
            const emergencyBtn = document.getElementById('emergencyLogin');  
            const simpleLoginBtn = document.getElementById('simple-login-btn');  
              
            if (emergencyBtn) emergencyBtn.style.display = 'block';  
            if (simpleLoginBtn) simpleLoginBtn.style.display = 'block';  
        }  
          
        function emergencyLogin() {  
            fallbackMode = true;  
            document.getElementById('emergencyLogin').style.display = 'none';  
              
            const loginError = document.getElementById('login-error');  
            if (loginError) {  
                loginError.innerHTML = '‚ö†Ô∏è <strong>ACƒ∞L Gƒ∞Rƒ∞≈û MODU:</strong><br>Firebase baƒülantƒ±sƒ± olmadan giri≈ü yapƒ±lƒ±yor.<br>√ñzellikler sƒ±nƒ±rlƒ± olacaktƒ±r.';  
                loginError.style.display = 'block';  
            }  
              
            const simpleBtn = document.getElementById('simple-login-btn');  
            if (simpleBtn) simpleBtn.style.display = 'block';  
        }  
          
        function simpleLogin() {  
            const nick = document.getElementById('login-nick').value.trim();  
              
            if (!nick) {  
                showLoginError('‚ùå L√ºtfen bir kullanƒ±cƒ± adƒ± girin!');  
                return;  
            }  
              
            currentUser = {  
                name: nick,  
                role: 'user',  
                isRegistered: false,  
                isFallback: true,  
                subscription: 'standart'  
            };  
              
            document.getElementById('login-screen').style.display = 'none';  
              
            addSystemMessage(`üéâ Ho≈ü geldin, ${nick}! (Acil Giri≈ü Modu)`);  
            addSystemMessage('‚ö†Ô∏è Firebase baƒülantƒ±sƒ± yok. Bazƒ± √∂zellikler sƒ±nƒ±rlƒ±.');  
              
            initBasicApp();  
              
            setTimeout(initYouTubePlayer, 500);  
        }  
          
        // ========== FIREBASE BAƒûLANTI KONTROL√ú ==========  
        function checkFirebaseConnection() {  
            const checkElement = document.getElementById('connectionCheck');  
            if (checkElement) {  
                checkElement.style.display = 'block';  
                checkElement.innerHTML = 'üîÑ Firebase baƒülantƒ±sƒ± kontrol ediliyor...';  
            }  
              
            connectionTimeout = setTimeout(() => {  
                if (!isFirebaseConnected && !firebaseInitialized) {  
                    console.warn('‚ö†Ô∏è Firebase baƒülantƒ± zaman a≈üƒ±mƒ±');  
                      
                    if (checkElement) {  
                        checkElement.innerHTML = '‚ùå Firebase baƒülantƒ±sƒ± saƒülanamadƒ±';  
                        checkElement.style.background = 'rgba(255, 85, 85, 0.7)';  
                    }  
                      
                    showEmergencyLogin();  
                      
                    connectionRetries++;  
                    if (connectionRetries < MAX_RETRIES) {  
                        setTimeout(initializeFirebase, 3000);  
                    }  
                }  
            }, 10000);  
        }  
          
        // ========== FIREBASE BADGE KONTROL√ú ==========  
        function toggleFirebaseBadge() {  
            const badge = document.getElementById('firebaseBadge');  
            badge.classList.toggle('hidden');  
            localStorage.setItem('firebaseBadgeHidden', badge.classList.contains('hidden'));  
        }  
          
        // ========== SHA-256 ≈ûƒ∞FRELEME ==========  
        async function sha256(message) {  
            const msgBuffer = new TextEncoder().encode(message);  
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);  
            const hashArray = Array.from(new Uint8Array(hashBuffer));  
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');  
        }  
          
        // ========== FIREBASE BA≈ûLATMA ==========  
        function initializeFirebase() {  
            try {  
                console.log("üî• Firebase ba≈ülatƒ±lƒ±yor...");  
                  
                if (typeof firebase === 'undefined') {  
                    console.error("‚ùå Firebase SDK y√ºklenemedi");  
                    showEmergencyLogin();  
                    return;  
                }  
                  
                try {  
                    firebase.initializeApp(firebaseConfig);  
                    firebaseInitialized = true;  
                    console.log("‚úÖ Firebase ba≈ülatƒ±ldƒ±");  
                } catch (firebaseError) {  
                    if (firebaseError.code === 'app/duplicate-app') {  
                        console.log("‚ÑπÔ∏è Firebase zaten ba≈ülatƒ±lmƒ±≈ü");  
                        firebaseInitialized = true;  
                    } else {  
                        throw firebaseError;  
                    }  
                }  
                  
                database = firebase.database();  
                  
                const connectedRef = database.ref(".info/connected");  
                connectedRef.on("value", function(snap) {  
                    if (snap.val() === true) {  
                        console.log("‚úÖ Firebase'e BAƒûLANDI!");  
                        isFirebaseConnected = true;  
                          
                        if (connectionTimeout) {  
                            clearTimeout(connectionTimeout);  
                        }  
                          
                        // Firebase referanslarƒ±  
                        usersRef = database.ref('onlineUsers');  
                        messagesRef = database.ref('messages');  
                        privateChatsRef = database.ref('privateChats');  
                        coAdminsRef = database.ref('coAdmins');  
                        bansRef = database.ref('bans');  
                        registeredUsersRef = database.ref('registeredUsers');  
                        operatorsRef = database.ref('operators');  
                        userLocksRef = database.ref('userLocks');  
                        adminPasswordsRef = database.ref('adminPasswords');  
                        customCommandsRef = database.ref('customCommands');  
                        adminListRef = database.ref('adminList');  
                        storiesRef = database.ref('stories');  
                        storyLikesRef = database.ref('storyLikes');  
                        storyReportsRef = database.ref('storyReports');  
                        subscriptionsRef = database.ref('subscriptions');  
                        userStatsRef = database.ref('userStats');  
                        followersRef = database.ref('followers');  
                        channelsRef = database.ref('channels');  
                        channelMessagesRef = database.ref('channelMessages');  
                        channelUsersRef = database.ref('channelUsers');  
                          
                        initOwnerPassword();  
                        loadCustomCommands();  
                        updateBannedUsers();  
                        startBanMonitoring();  
                        startUserLocksCleanup();  
                          
                        loadStories();  
                        loadStoryLikes();  
                        loadStoryReports();  
                        loadChannels();  
                          
                        document.getElementById('emergencyLogin').style.display = 'none';  
                        document.getElementById('simple-login-btn').style.display = 'none';  
                          
                    } else {  
                        console.log("‚ùå Firebase baƒülantƒ±sƒ± KESƒ∞LDƒ∞");  
                        isFirebaseConnected = false;  
                    }  
                });  
                  
            } catch (error) {  
                console.error("‚ùå Firebase ba≈ülatma hatasƒ±:", error);  
                  
                setTimeout(() => {  
                    showEmergencyLogin();  
                }, 2000);  
            }  
        }  
          
        // ========== MATEB G√úVENLƒ∞K BOTU ==========  
        class MateBSecurityBot {  
            constructor() {  
                this.name = SECURE_CONFIG.BOT_CONFIG.name;  
                this.securityLevel = SECURE_CONFIG.BOT_CONFIG.securityLevel;  
                this.logs = [];  
                this.suspiciousActivities = [];  
                this.autoMessageInterval = null;  
                this.securityScanInterval = null;  
            }  
              
            log(message, type = 'info') {  
                const timestamp = new Date().toLocaleTimeString();  
                const logEntry = {  
                    timestamp: timestamp,  
                    message: message,  
                    type: type  
                };  
                  
                this.logs.push(logEntry);  
                  
                // Log'u aray√ºze ekle  
                const logsContainer = document.getElementById('matebBotLogs');  
                if (logsContainer) {  
                    const logElement = document.createElement('div');  
                    logElement.className = `bot-log-entry ${type}`;  
                    logElement.innerHTML = `[${timestamp}] ${message}`;  
                    logsContainer.appendChild(logElement);  
                    logsContainer.scrollTop = logsContainer.scrollHeight;  
                }  
                  
                console.log(`[MateB Bot] ${message}`);  
            }  
              
            sendWelcome(user) {  
                const messages = SECURE_CONFIG.BOT_CONFIG.welcomeMessages;  
                const randomMessage = messages[Math.floor(Math.random() * messages.length)];  
                const formattedMessage = randomMessage.replace('{user}', user);  
                  
                this.sendMessage(formattedMessage);  
                this.log(`${user} kullanƒ±cƒ±sƒ±na ho≈ü geldin mesajƒ± g√∂nderildi`, 'success');  
            }  
              
            sendAutoMessage() {  
                const messages = SECURE_CONFIG.BOT_CONFIG.autoMessages;  
                const randomMessage = messages[Math.floor(Math.random() * messages.length)];  
                this.sendMessage(randomMessage);  
            }  
              
            sendMessage(text) {  
                if (!messagesRef) return;  
                  
                const messageData = {  
                    sender: this.name,  
                    text: text,  
                    type: 'system',  
                    timestamp: Date.now(),  
                    time: new Date().toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' }),  
                    isBot: true  
                };  
                  
                messagesRef.push(messageData);  
            }  
              
            scanForSpam() {  
                this.log('Spam taramasƒ± ba≈ülatƒ±ldƒ±', 'warning');  
                // Burada spam tarama algoritmasƒ± olacak  
            }  
              
            checkUserActivity(user, activity) {  
                // Kullanƒ±cƒ± aktivitelerini kontrol et  
                this.log(`${user} kullanƒ±cƒ±sƒ± ${activity} aktivitesini ger√ßekle≈ütirdi`, 'info');  
            }  
              
            startAutoMessages() {  
                if (this.autoMessageInterval) {  
                    clearInterval(this.autoMessageInterval);  
                }  
                  
                this.autoMessageInterval = setInterval(() => {  
                    this.sendAutoMessage();  
                }, SECURE_CONFIG.BOT_CONFIG.messageInterval);  
                  
                this.log('Otomatik mesaj sistemi ba≈ülatƒ±ldƒ±', 'success');  
            }  
              
            startSecurityScans() {  
                if (this.securityScanInterval) {  
                    clearInterval(this.securityScanInterval);  
                }  
                  
                this.securityScanInterval = setInterval(() => {  
                    this.scanForSpam();  
                }, 60000);  
            }  
              
            sendSystemAnnouncement() {  
                const announcement = "üì¢ Sistem Duyurusu: L√ºtfen sohbet kurallarƒ±na uyunuz. Spam, k√ºf√ºr ve uygunsuz i√ßerik yasaktƒ±r.";  
                this.sendMessage(announcement);  
                this.log('Sistem duyurusu g√∂nderildi', 'info');  
            }  
              
            clearLogs() {  
                this.logs = [];  
                const logsContainer = document.getElementById('matebBotLogs');  
                if (logsContainer) {  
                    logsContainer.innerHTML = '';  
                }  
                this.log('Loglar temizlendi', 'info');  
            }  
              
            stopAll() {  
                if (this.autoMessageInterval) {  
                    clearInterval(this.autoMessageInterval);  
                    this.autoMessageInterval = null;  
                }  
                  
                if (this.securityScanInterval) {  
                    clearInterval(this.securityScanInterval);  
                    this.securityScanInterval = null;  
                }  
                  
                this.log('T√ºm sistemler durduruldu', 'warning');  
            }  
        }  
          
        let bot = new MateBSecurityBot();  
          
        // ========== TEMEL FONKSƒ∞YONLAR ==========  
        function autoResize(textarea) {  
            textarea.style.height = 'auto';  
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';  
        }  
          
        function toggleUserList() {  
            const sidebar = document.getElementById('usersSidebar');  
            sidebar.classList.toggle('active');  
        }  
          
        function toggleChannelsSidebar() {  
            const sidebar = document.getElementById('channelsSidebar');  
            sidebar.classList.toggle('active');  
        }  
          
        function toggleFirebaseBadge() {  
            const badge = document.getElementById('firebaseBadge');  
            badge.classList.toggle('hidden');  
        }  
          
        // ========== Gƒ∞Rƒ∞≈û Sƒ∞STEMƒ∞ ==========  
        async function login() {  
            if (fallbackMode) {  
                simpleLogin();  
                return;  
            }  
              
            const nickInput = document.getElementById('login-nick');  
            const passwordInput = document.getElementById('login-password');  
            const rawNick = nickInput.value.trim();  
            const password = passwordInput.value;  
            const loginBtn = document.getElementById('login-btn');  
              
            if (!rawNick) {  
                showLoginError('‚ùå L√ºtfen bir kullanƒ±cƒ± adƒ± girin!');  
                return;  
            }  
              
            if (rawNick.length < 2 || rawNick.length > 20) {  
                showLoginError('‚ùå Kullanƒ±cƒ± adƒ± 2-20 karakter arasƒ±nda olmalƒ±!');  
                return;  
            }  
              
            if (!isFirebaseConnected || !usersRef) {  
                showLoginError('‚ùå Firebase baƒülantƒ±sƒ± yok! L√ºtfen "Acil Giri≈ü" butonunu kullanƒ±n.');  
                return;  
            }  
              
            loginBtn.disabled = true;  
            loginBtn.innerHTML = '<span class="loading"></span> Kontrol ediliyor...';  
            showLoginError('');  
            showLoginSuccess('');  
              
            try {  
                const normalizedNick = rawNick.toLowerCase().trim();  
                  
                // Owner kontrol√º  
                const isOwnerUser = normalizedNick === SECURE_CONFIG.OWNER_CONFIG.username.toLowerCase();  
                  
                if (isOwnerUser) {  
                    if (!password) {  
                        showLoginError('üîê Owner ≈üifresi gerekli!');  
                        loginBtn.disabled = false;  
                        loginBtn.textContent = 'Sohbete Katƒ±l';  
                        return;  
                    }  
                      
                    if (password !== SECURE_CONFIG.OWNER_CONFIG.password) {  
                        showLoginError('‚ùå Hatalƒ± ≈üifre!');  
                        loginBtn.disabled = false;  
                        loginBtn.textContent = 'Sohbete Katƒ±l';  
                        return;  
                    }  
                      
                    await completeLogin(SECURE_CONFIG.OWNER_CONFIG.username, 'owner', true, null);  
                    return;  
                }  
                  
                // Normal kullanƒ±cƒ± giri≈üi  
                const finalNick = await getAvailableNick(rawNick);  
                await completeLogin(finalNick, 'user', false, null);  
                  
            } catch (error) {  
                console.error('Giri≈ü hatasƒ±:', error);  
                showLoginError(`‚ùå Giri≈ü hatasƒ±: ${error.message}`);  
                loginBtn.disabled = false;  
                loginBtn.textContent = 'Sohbete Katƒ±l';  
            }  
        }  
          
        async function completeLogin(username, role, isRegistered, userData) {  
            // Abonelik kontrol√º  
            await checkSubscription(username);  
              
            const userInfo = {  
                name: username,  
                lastSeen: Date.now(),  
                joinedAt: Date.now(),  
                isOnline: true,  
                timestamp: Date.now(),  
                role: role,  
                isRegistered: isRegistered,  
                subscription: currentUser ? currentUser.subscription : 'standart',  
                currentChannel: currentChannel  
            };  
              
            await usersRef.child(username).set(userInfo);  
              
            currentUser = {  
                name: username,  
                role: role,  
                isRegistered: isRegistered,  
                subscription: userInfo.subscription,  
                data: userInfo  
            };  
              
            // Yetki ve abonelik badge'leri  
            updateUserBadges();  
              
            // Disconnect handler  
            usersRef.child(username).onDisconnect().remove();  
              
            document.getElementById('login-screen').style.display = 'none';  
              
            initApp();  
              
            addSystemMessage(`üéâ Ho≈ü geldin, ${currentUser.name}!`);  
              
            if (role === 'owner') {  
                isOwner = true;  
                document.getElementById('ownerPanelBtn').style.display = 'block';  
                addSystemMessage('ü§¥ Owner olarak giri≈ü yaptƒ±nƒ±z!');  
            }  
              
            if (role === 'admin') {  
                isAdmin = true;  
                document.getElementById('adminPanelBtn').style.display = 'block';  
                addSystemMessage('‚≠êÔ∏è Admin olarak giri≈ü yaptƒ±nƒ±z!');  
            }  
              
            // Abonelik mesajƒ±  
            if (currentUser.subscription === 'premium') {  
                isPremium = true;  
                addSystemMessage('üëë Premium abone olarak giri≈ü yaptƒ±nƒ±z!');  
            } else if (currentUser.subscription === 'abone') {  
                isSubscriber = true;  
                addSystemMessage('‚ù§Ô∏è Abone olarak giri≈ü yaptƒ±nƒ±z!');  
            } else if (currentUser.subscription === 'member') {  
                isMember = true;  
                addSystemMessage('‚úîÔ∏è √úye olarak giri≈ü yaptƒ±nƒ±z!');  
            }  
              
            // Bot ho≈ü geldin mesajƒ±  
            setTimeout(() => {  
                if (!isOwner) {  
                    bot.sendWelcome(username);  
                }  
            }, 1000);  
              
            // Bot'u ba≈ülat  
            bot.startAutoMessages();  
            bot.startSecurityScans();  
        }  
          
        function updateUserBadges() {  
            if (currentUser.role === 'owner') {  
                isOwner = true;  
                document.getElementById('ownerBadge').style.display = 'inline-block';  
            } else if (currentUser.role === 'admin') {  
                isAdmin = true;  
                document.getElementById('adminBadge').style.display = 'inline-block';  
            } else if (currentUser.role === 'coadmin') {  
                isCoAdmin = true;  
                document.getElementById('coadminBadge').style.display = 'inline-block';  
            } else if (currentUser.role === 'operator') {  
                isOperator = true;  
                document.getElementById('operatorBadge').style.display = 'inline-block';  
            }  
              
            if (currentUser.subscription === 'premium') {  
                isPremium = true;  
                document.getElementById('premiumBadge').style.display = 'inline-block';  
            } else if (currentUser.subscription === 'abone') {  
                isSubscriber = true;  
                document.getElementById('subscriberBadge').style.display = 'inline-block';  
            } else if (currentUser.subscription === 'member') {  
                isMember = true;  
                document.getElementById('memberBadge').style.display = 'inline-block';  
            }  
        }  
          
        // ========== ABONELƒ∞K Sƒ∞STEMƒ∞ ==========  
        function openSubscriptionModal() {  
            if (!currentUser) {  
                addSystemMessage('‚õî √ñnce giri≈ü yapmalƒ±sƒ±nƒ±z!');  
                return;  
            }  
              
            document.getElementById('subscriptionModal').style.display = 'block';  
            document.getElementById('overlay').style.display = 'block';  
              
            // Mevcut planƒ± se√ßili yap  
            selectSubscriptionPlan(currentUser.subscription || 'standart');  
        }  
          
        function closeSubscriptionModal() {  
            document.getElementById('subscriptionModal').style.display = 'none';  
            document.getElementById('overlay').style.display = 'none';  
        }  
          
        function selectSubscriptionPlan(plan) {  
            selectedSubscriptionPlan = plan;  
              
            // T√ºm planlarƒ±n se√ßimini kaldƒ±r  
            document.getElementById('planStandart').classList.remove('selected');  
            document.getElementById('planMember').classList.remove('selected');  
            document.getElementById('planAbone').classList.remove('selected');  
            document.getElementById('planPremium').classList.remove('selected');  
              
            // Se√ßilen planƒ± i≈üaretle  
            const planElement = document.getElementById(`plan${capitalizeFirstLetter(plan)}`);  
            if (planElement) {  
                planElement.classList.add('selected');  
            }  
        }  
          
        async function activateSubscription() {  
            if (!currentUser) return;  
              
            if (selectedSubscriptionPlan === 'standart') {  
                closeSubscriptionModal();  
                addSystemMessage('‚úÖ Zaten standart pakettesiniz!');  
                return;  
            }  
              
            // Demo i√ßin hemen aktif ediyoruz  
            try {  
                const subscriptionData = {  
                    plan: selectedSubscriptionPlan,  
                    activatedAt: Date.now(),  
                    expiresAt: Date.now() + (30 * 24 * 60 * 60 * 1000), // 30 g√ºn  
                    price: SECURE_CONFIG.YOUTUBE_SUBSCRIPTION_PLANS[selectedSubscriptionPlan].price  
                };  
                  
                await subscriptionsRef.child(currentUser.name).set(subscriptionData);  
                  
                currentUser.subscription = selectedSubscriptionPlan;  
                  
                // Badge g√ºncelleme  
                updateUserBadges();  
                  
                closeSubscriptionModal();  
                updateProfilePanel();  
                  
                addSystemMessage(`‚úÖ ${SECURE_CONFIG.YOUTUBE_SUBSCRIPTION_PLANS[selectedSubscriptionPlan].name} paketine ba≈üarƒ±yla abone oldunuz!`);  
                  
            } catch (error) {  
                console.error('Abonelik hatasƒ±:', error);  
                addSystemMessage('‚ùå Abonelik i≈ülemi ba≈üarƒ±sƒ±z!');  
            }  
        }  
          
        // ========== STORY Sƒ∞STEMƒ∞ - INSTAGRAM STYLE ==========  
        function toggleStorySection() {  
            const container = document.getElementById('storyContainer');  
            const toggleBtn = document.querySelector('.story-toggle-btn');  
              
            storySectionOpen = !storySectionOpen;  
              
            if (storySectionOpen) {  
                container.classList.add('active');  
                toggleBtn.classList.add('active');  
                updateStoryContainer();  
            } else {  
                container.classList.remove('active');  
                toggleBtn.classList.remove('active');  
            }  
        }  
          
        function selectStoryType(type) {  
            storyCurrentType = type;  
              
            document.getElementById('storyTextSection').style.display = type === 'text' ? 'block' : 'none';  
            document.getElementById('storyImageSection').style.display = type === 'image' ? 'block' : 'none';  
              
            document.getElementById('storyTypeText').style.background = type === 'text' ? var(--primary) : '#666';  
            document.getElementById('storyTypeImage').style.background = type === 'image' ? var(--primary) : '#666';  
        }  
          
        function changeStoryColor(color) {  
            storyCurrentColor = color;  
            document.getElementById('story-text').style.color = color;  
        }  
          
        async function createStory() {  
            if (!currentUser) return;  
              
            const storyText = document.getElementById('story-text').value.trim();  
            const visibility = document.getElementById('storyVisibility').value;  
              
            if (storyCurrentType === 'text' && !storyText) {  
                addSystemMessage('‚ùå Story metni bo≈ü olamaz!');  
                return;  
            }  
              
            try {  
                const storyData = {  
                    sender: currentUser.name,  
                    type: storyCurrentType,  
                    text: storyText,  
                    color: storyCurrentColor,  
                    visibility: visibility,  
                    timestamp: Date.now(),  
                    expiresAt: Date.now() + SECURE_CONFIG.STORY_CONFIG.duration,  
                    likes: 0,  
                    views: 0  
                };  
                  
                const newStoryRef = await storiesRef.push(storyData);  
                  
                // Kullanƒ±cƒ± istatistiklerini g√ºncelle  
                await updateUserStats(currentUser.name, 'stories');  
                  
                closeStoryCreateModal();  
                addSystemMessage('‚úÖ Story ba≈üarƒ±yla yayƒ±nlandƒ±!');  
                  
                // Story container'ƒ± g√ºncelle  
                loadStories();  
                  
            } catch (error) {  
                console.error('Story olu≈üturma hatasƒ±:', error);  
                addSystemMessage('‚ùå Story olu≈üturulamadƒ±!');  
            }  
        }  
          
        function openStoryModal(username) {  
            const userStories = stories.filter(story => story.sender === username && story.expiresAt > Date.now());  
            if (userStories.length === 0) return;  
              
            currentStories = userStories;  
            currentStoryIndex = 0;  
            showStory(currentStoryIndex);  
              
            document.getElementById('storyModal').style.display = 'block';  
            document.getElementById('overlay').style.display = 'block';  
              
            // Story progress ba≈ülat  
            startStoryProgress();  
        }  
          
        function showStory(index) {  
            if (index >= currentStories.length) {  
                closeStoryModal();  
                return;  
            }  
              
            const story = currentStories[index];  
            currentStoryId = story.id;  
              
            const storyContent = document.getElementById('storyContent');  
            const storyUserInfo = document.getElementById('storyUserInfo');  
              
            if (story.type === 'text') {  
                storyContent.innerHTML = `  
                    <div class="story-text" style="color: ${story.color}; font-size: 32px; background: rgba(0,0,0,0.5); padding: 30px; border-radius: 20px;">  
                        ${story.text}  
                    </div>  
                `;  
            } else if (story.type === 'image') {  
                storyContent.innerHTML = `  
                    <img src="${story.imageUrl}" class="story-image" alt="Story Image">  
                `;  
            }  
              
            storyUserInfo.innerHTML = `  
                <div style="display: flex; align-items: center; gap: 10px;">  
                    <div style="width: 40px; height: 40px; border-radius: 50%; background: ${getUserColor(story.sender)}; display: flex; align-items: center; justify-content: center; font-size: 18px;">  
                        ${story.sender.charAt(0).toUpperCase()}  
                    </div>  
                    <div>  
                        <div style="font-weight: bold;">${story.sender}</div>  
                        <div style="font-size: 12px; opacity: 0.8;">${formatTime(story.timestamp)}</div>  
                    </div>  
                </div>  
            `;  
              
            // Beƒüeni sayƒ±sƒ±nƒ± g√ºncelle  
            const likes = storyLikes[story.id] || [];  
            document.getElementById('storyLikeCount').textContent = likes.length;  
        }  
          
        function startStoryProgress() {  
            if (storyProgressInterval) {  
                clearInterval(storyProgressInterval);  
            }  
              
            const progressBar = document.getElementById('storyProgressBar');  
            progressBar.style.width = '0%';  
              
            let progress = 0;  
            const duration = 5000; // 5 saniye  
            const interval = 50; // 50ms  
            const increment = (interval / duration) * 100;  
              
            storyProgressInterval = setInterval(() => {  
                progress += increment;  
                progressBar.style.width = progress + '%';  
                  
                if (progress >= 100) {  
                    currentStoryIndex++;  
                    if (currentStoryIndex < currentStories.length) {  
                        showStory(currentStoryIndex);  
                    } else {  
                        closeStoryModal();  
                    }  
                }  
            }, interval);  
        }  
          
        function likeStory() {  
            if (!currentUser || !currentStoryId) return;  
              
            const story = stories.find(s => s.id === currentStoryId);  
            if (!story) return;  
              
            // Beƒüeni i≈ülemi  
            const likes = storyLikes[currentStoryId] || [];  
            if (!likes.includes(currentUser.name)) {  
                likes.push(currentUser.name);  
                storyLikes[currentStoryId] = likes;  
                  
                // Firebase'e kaydet  
                storyLikesRef.child(currentStoryId).set(likes);  
                  
                document.getElementById('storyLikeCount').textContent = likes.length;  
                addSystemMessage('‚ù§Ô∏è Story beƒüenildi!');  
            }  
        }  
          
        // ========== KANAL Sƒ∞STEMƒ∞ ==========  
        async function loadChannels() {  
            try {  
                const snapshot = await channelsRef.once('value');  
                const channelsData = snapshot.val() || {};  
                  
                // Varsayƒ±lan kanallarƒ± ekle  
                SECURE_CONFIG.CHANNEL_CONFIG.defaultChannels.forEach(channelName => {  
                    if (!channelsData[channelName]) {  
                        channelsData[channelName] = {  
                            name: channelName,  
                            creator: 'System',  
                            createdAt: Date.now(),  
                            type: 'public',  
                            description: `${channelName} kanalƒ±`  
                        };  
                    }  
                });  
                  
                channels = channelsData;  
                updateChannelsList();  
                  
            } catch (error) {  
                console.error('Kanallar y√ºklenirken hata:', error);  
            }  
        }  
          
        function updateChannelsList() {  
            const channelList = document.getElementById('channelList');  
            const channelsCount = document.getElementById('channelsCount');  
              
            if (!channelList) return;  
              
            channelList.innerHTML = '';  
            let count = 0;  
              
            Object.entries(channels).forEach(([channelName, channelData]) => {  
                count++;  
                  
                const channelItem = document.createElement('div');  
                channelItem.className = `channel-item ${currentChannel === channelName ? 'active' : ''}`;  
                channelItem.innerHTML = `  
                    <div style="font-weight: 500;">${channelName}</div>  
                    <div style="font-size: 12px; color: var(--text-secondary);">${channelData.description || ''}</div>  
                `;  
                  
                channelItem.onclick = () => switchChannel(channelName);  
                channelList.appendChild(channelItem);  
            });  
              
            if (channelsCount) {  
                channelsCount.textContent = count;  
            }  
        }  
          
        function switchChannel(channelName) {  
            currentChannel = channelName;  
            document.getElementById('currentChannel').textContent = channelName;  
              
            // Kanal mesajlarƒ±nƒ± y√ºkle  
            loadChannelMessages(channelName);  
              
            // Kullanƒ±cƒ±nƒ±n bulunduƒüu kanalƒ± g√ºncelle  
            if (currentUser && usersRef) {  
                usersRef.child(currentUser.name).update({  
                    currentChannel: channelName  
                });  
            }  
              
            updateChannelsList();  
        }  
          
        // ========== OWNER PANELƒ∞ ==========  
        function openOwnerPanel() {  
            if (!isOwner) return;  
              
            document.getElementById('ownerPanel').style.display = 'block';  
            document.getElementById('overlay').style.display = 'block';  
              
            // T√ºm √∂zel mesajlarƒ± y√ºkle  
            loadAllPrivateMessages();  
        }  
          
        function closeOwnerPanel() {  
            document.getElementById('ownerPanel').style.display = 'none';  
            document.getElementById('overlay').style.display = 'none';  
        }  
          
        function switchOwnerTab(tabName) {  
            // T√ºm tab'larƒ± gizle  
            document.querySelectorAll('.owner-tab-content').forEach(tab => {  
                tab.classList.remove('active');  
            });  
              
            document.querySelectorAll('.owner-tab').forEach(tab => {  
                tab.classList.remove('active');  
            });  
              
            // Se√ßili tab'ƒ± g√∂ster  
            document.getElementById(tabName + 'Tab').classList.add('active');  
            document.querySelector(`.owner-tab[onclick*="${tabName}"]`).classList.add('active');  
        }  
          
        async function loadAllPrivateMessages() {  
            try {  
                const snapshot = await privateChatsRef.once('value');  
                const allMessages = snapshot.val() || {};  
                  
                const container = document.getElementById('allPrivateMessages');  
                container.innerHTML = '';  
                  
                Object.entries(allMessages).forEach(([chatId, messages]) => {  
                    if (messages && typeof messages === 'object') {  
                        Object.entries(messages).forEach(([messageId, message]) => {  
                            if (message && message.sender && message.text) {  
                                const messageDiv = document.createElement('div');  
                                messageDiv.style.padding = '10px';  
                                messageDiv.style.margin = '5px 0';  
                                messageDiv.style.background = 'rgba(0,0,0,0.1)';  
                                messageDiv.style.borderRadius = '5px';  
                                messageDiv.innerHTML = `  
                                    <strong>${message.sender}</strong> -> <strong>${message.receiver || 'Bilinmiyor'}</strong><br>  
                                    ${message.text}<br>  
                                    <small>${formatTime(message.timestamp)}</small>  
                                `;  
                                container.appendChild(messageDiv);  
                            }  
                        });  
                    }  
                });  
                  
            } catch (error) {  
                console.error('√ñzel mesajlar y√ºklenirken hata:', error);  
            }  
        }  
          
        // ========== MATEB BOT PANELƒ∞ ==========  
        function openMatebBotPanel() {  
            document.getElementById('matebBotPanel').style.display = 'block';  
            document.getElementById('overlay').style.display = 'block';  
        }  
          
        function closeMatebBotPanel() {  
            document.getElementById('matebBotPanel').style.display = 'none';  
            document.getElementById('overlay').style.display = 'none';  
        }  
          
        // ========== RESƒ∞M G√ñNDERME Sƒ∞STEMƒ∞ ==========  
        function handleImageUpload(event) {  
            const file = event.target.files[0];  
            if (!file) return;  
              
            if (!file.type.startsWith('image/')) {  
                addSystemMessage('‚ùå Sadece resim dosyalarƒ± y√ºkleyebilirsiniz!');  
                return;  
            }  
              
            if (file.size > 10 * 1024 * 1024) { // 10MB  
                addSystemMessage('‚ùå Resim boyutu 10MB\'dan k√º√ß√ºk olmalƒ±!');  
                return;  
            }  
              
            const reader = new FileReader();  
            reader.onload = function(e) {  
                const imageUrl = e.target.result;  
                sendMessageWithImage(imageUrl);  
            };  
            reader.readAsDataURL(file);  
        }  
          
        function sendMessageWithImage(imageUrl) {  
            if (!currentUser) return;  
              
            const messageData = {  
                sender: currentUser.name,  
                text: '',  
                imageUrl: imageUrl,  
                type: currentUser.role,  
                timestamp: Date.now(),  
                time: new Date().toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' })  
            };  
              
            if (messagesRef) {  
                messagesRef.push(messageData);  
            }  
        }  
          
        function openImageModal(imageUrl) {  
            document.getElementById('modalImage').src = imageUrl;  
            document.getElementById('imageModal').style.display = 'flex';  
        }  
          
        function closeImageModal() {  
            document.getElementById('imageModal').style.display = 'none';  
            document.getElementById('modalImage').src = '';  
        }  
          
        // ========== MESAJ G√ñNDERME ==========  
        function sendMessage() {  
            if (!currentUser) return;  
              
            const input = document.getElementById('message-input');  
            const text = input.value.trim();  
              
            if (!text) return;  
              
            if (text.startsWith('/')) {  
                handleCommand(text);  
                input.value = '';  
                autoResize(input);  
                return;  
            }  
              
            let messageType = 'user';  
            if (isOwner) messageType = 'owner';  
            else if (isAdmin) messageType = 'admin';  
            else if (isCoAdmin) messageType = 'coadmin';  
            else if (isOperator) messageType = 'operator';  
            else if (isPremium) messageType = 'premium';  
            else if (isSubscriber) messageType = 'subscriber';  
            else if (isMember) messageType = 'member';  
              
            const messageData = {  
                sender: currentUser.name,  
                text: text,  
                type: messageType,  
                timestamp: Date.now(),  
                time: new Date().toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' }),  
                channel: currentChannel  
            };  
              
            try {  
                if (messagesRef) {  
                    messagesRef.push(messageData);  
                }  
                  
                input.value = '';  
                autoResize(input);  
                  
                // Kullanƒ±cƒ± istatistiklerini g√ºncelle  
                updateUserStats(currentUser.name, 'messages');  
                  
            } catch (error) {  
                console.error('Mesaj g√∂nderme hatasƒ±:', error);  
                addSystemMessage('‚ùå Mesaj g√∂nderilemedi!');  
            }  
        }  
          
        // ========== IRC KOMUTLARI ==========  
        function handleCommand(command) {  
            const parts = command.split(' ');  
            const cmd = parts[0].toLowerCase();  
            const args = parts.slice(1);  
              
            switch(cmd) {  
                case '/yardƒ±m':  
                    showHelp();  
                    break;  
                case '/online':  
                    showOnlineUsers();  
                    break;  
                case '/me':  
                    sendAction(args.join(' '));  
                    break;  
                case '/kick':  
                    if (isAdmin || isOwner || isCoAdmin) {  
                        kickUserCommand(args[0], args.slice(1).join(' '));  
                    } else {  
                        addSystemMessage('‚õî Bu komutu kullanma yetkiniz yok!');  
                    }  
                    break;  
                case '/ban':  
                    if (isAdmin || isOwner) {  
                        banUserCommand(args[0], args.slice(1).join(' '));  
                    } else {  
                        addSystemMessage('‚õî Bu komutu kullanma yetkiniz yok!');  
                    }  
                    break;  
                case '/unban':  
                    if (isAdmin || isOwner) {  
                        unbanUserCommand(args[0]);  
                    } else {  
                        addSystemMessage('‚õî Bu komutu kullanma yetkiniz yok!');  
                    }  
                    break;  
                case '/clear':  
                    if (isAdmin || isOwner || isCoAdmin) {  
                        clearChat();  
                    } else {  
                        addSystemMessage('‚õî Bu komutu kullanma yetkiniz yok!');  
                    }  
                    break;  
                case '/topic':  
                    if (isAdmin || isOwner || isCoAdmin) {  
                        changeTopic(args.join(' '));  
                    } else {  
                        addSystemMessage('‚õî Bu komutu kullanma yetkiniz yok!');  
                    }  
                    break;  
                case '/mode':  
                    if (isAdmin || isOwner) {  
                        changeMode(args[0], args[1]);  
                    } else {  
                        addSystemMessage('‚õî Bu komutu kullanma yetkiniz yok!');  
                    }  
                    break;  
                case '/msg':  
                    if (args.length >= 2) {  
                        openPrivateChat(args[0]);  
                        setTimeout(() => {  
                            document.getElementById('private-input').value = args.slice(1).join(' ');  
                            sendPrivateMessage();  
                        }, 100);  
                    }  
                    break;  
                case '/join':  
                    switchChannel(args[0] || '#genel');  
                    break;  
                case '/list':  
                    listChannels();  
                    break;  
                case '/whois':  
                    whoisUser(args[0]);  
                    break;  
                case '/nick':  
                    changeNick(args[0]);  
                    break;  
                case '/away':  
                    setAway(args.join(' '));  
                    break;  
                case '/back':  
                    setBack();  
                    break;  
                case '/ignore':  
                    ignoreUser(args[0]);  
                    break;  
                case '/unignore':  
                    unignoreUser(args[0]);  
                    break;  
                case '/rules':  
                    showRules();  
                    break;  
                case '/report':  
                    reportUser(args[0], args.slice(1).join(' '));  
                    break;  
                case '/abone':  
                    openSubscriptionModal();  
                    break;  
                case '/story':  
                    openStoryCreateModal();  
                    break;  
                case '/mystories':  
                    viewMyStories();  
                    break;  
                default:  
                    addSystemMessage(`‚ùå Bilinmeyen komut: ${cmd}. /yardƒ±m yazƒ±n.`);  
            }  
        }  
          
        function showHelp() {  
            const helpMessage = `  
                üìã POPBOX CHAT KOMUTLARI:  
                
                üë§ GENEL KOMUTLAR:  
                /yardƒ±m - T√ºm komutlarƒ± g√∂ster  
                /online - Online kullanƒ±cƒ±larƒ± listele  
                /me <mesaj> - Aksiyon mesajƒ± g√∂nder  
                /msg <nick> <mesaj> - √ñzel mesaj g√∂nder  
                /nick <yeni_nick> - Nick deƒüi≈ütir  
                /ignore <nick> - Kullanƒ±cƒ±yƒ± engelle  
                
                üéÆ CHAT KOMUTLARI:  
                /join <#kanal> - Kanala katƒ±l  
                /list - T√ºm kanallarƒ± listele  
                /topic <konu> - Kanal konusunu deƒüi≈ütir  
                /away <mesaj> - Uzakta olduƒüunu belirt  
                /back - Geri d√∂nd√ºƒü√ºn√º belirt  
                
                üëë Y√ñNETƒ∞Cƒ∞ KOMUTLARI:  
                /kick <nick> <sebep> - Kullanƒ±cƒ±yƒ± at  
                /ban <nick> <sebep> - Kullanƒ±cƒ±yƒ± banla  
                /unban <nick> - Banƒ± kaldƒ±r  
                /clear - Sohbeti temizle  
                /mode <kanal> <mod> - Kanal modunu deƒüi≈ütir  
                
                üì± √ñZEL KOMUTLAR:  
                /abone - Abonelik paketlerini g√∂ster  
                /story - Yeni story olu≈ütur  
                /mystories - Story'lerimi g√∂r√ºnt√ºle  
                /report <nick> <sebep> - Kullanƒ±cƒ±yƒ± ≈üikayet et  
                
                üõ°Ô∏è G√úVENLƒ∞K:  
                /rules - Sohbet kurallarƒ±nƒ± g√∂ster  
                /whois <nick> - Kullanƒ±cƒ± bilgilerini g√∂ster  
            `;  
              
            addSystemMessage(helpMessage);  
        }  
          
        // ========== √áIKI≈û ==========  
        function logout() {  
            if (currentUser && usersRef) {  
                usersRef.child(currentUser.name).remove();  
            }  
              
            bot.stopAll();  
              
            location.reload();  
        }  
          
        // ========== TEMA Sƒ∞STEMƒ∞ ==========  
        function toggleTheme() {  
            const body = document.body;  
            const themeBtn = document.querySelector('.theme-toggle');  
              
            if (body.classList.contains('youtube-live-mode')) {  
                body.classList.remove('youtube-live-mode');  
                body.classList.add('night-mode');  
                themeBtn.textContent = 'üåô';  
                themeBtn.title = 'Gece modu';  
                localStorage.setItem('theme', 'night');  
            } else if (body.classList.contains('night-mode')) {  
                body.classList.remove('night-mode');  
                body.classList.add('light-mode');  
                themeBtn.textContent = '‚òÄÔ∏è';  
                themeBtn.title = 'G√ºnd√ºz modu';  
                localStorage.setItem('theme', 'light');  
            } else {  
                body.classList.remove('light-mode');  
                body.classList.add('youtube-live-mode');  
                themeBtn.textContent = 'üé¨';  
                themeBtn.title = 'YouTube Live temasƒ±';  
                localStorage.setItem('theme', 'youtube');  
            }  
        }  
          
        function loadTheme() {  
            const savedTheme = localStorage.getItem('theme') || 'youtube';  
            const body = document.body;  
            const themeBtn = document.querySelector('.theme-toggle');  
              
            body.classList.remove('youtube-live-mode', 'night-mode', 'light-mode');  
              
            if (savedTheme === 'night') {  
                body.classList.add('night-mode');  
                themeBtn.textContent = 'üåô';  
                themeBtn.title = 'Gece modu';  
            } else if (savedTheme === 'light') {  
                body.classList.add('light-mode');  
                themeBtn.textContent = '‚òÄÔ∏è';  
                themeBtn.title = 'G√ºnd√ºz modu';  
            } else {  
                body.classList.add('youtube-live-mode');  
                themeBtn.textContent = 'üé¨';  
                themeBtn.title = 'YouTube Live temasƒ±';  
            }  
        }  
          
        // ========== UTILITY FONKSƒ∞YONLAR ==========  
        function capitalizeFirstLetter(string) {  
            return string.charAt(0).toUpperCase() + string.slice(1);  
        }  
          
        function formatTime(timestamp) {  
            const date = new Date(timestamp);  
            return date.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });  
        }  
          
        function getUserColor(username) {  
            if (username === SECURE_CONFIG.OWNER_CONFIG.username) return '#ff4081';  
            if (adminList.includes(username)) return '#ff0000';  
            if (coAdminList.includes(username)) return '#ff9800';  
            if (operatorList.includes(username)) return '#3b82f6';  
            return '#4caf50';  
        }  
          
        function addSystemMessage(text) {  
            const container = document.getElementById('messages');  
            const messageDiv = document.createElement('div');  
            messageDiv.className = 'yt-message system';  
            messageDiv.innerHTML = `  
                <div class="message-content">${text}</div>  
            `;  
              
            container.appendChild(messageDiv);  
            container.scrollTop = container.scrollHeight;  
        }  
          
        // ========== SAYFA Y√úKLENDƒ∞ƒûƒ∞NDE ==========  
        window.addEventListener('load', function() {  
            console.log("üì± Popbox Chat y√ºklendi!");  
              
            originalTitle = document.title;  
            loadTheme();  
              
            checkFirebaseConnection();  
            initializeFirebase();  
              
            document.getElementById('login-nick').focus();  
              
            // Enter tu≈üu ile giri≈ü  
            document.getElementById('login-nick').addEventListener('keypress', function(e) {  
                if (e.key === 'Enter') login();  
            });  
              
            document.getElementById('login-password').addEventListener('keypress', function(e) {  
                if (e.key === 'Enter') login();  
            });  
              
            // Enter tu≈üu ile mesaj g√∂nderme  
            document.getElementById('message-input').addEventListener('keypress', function(e) {  
                if (e.key === 'Enter' && !e.shiftKey) {  
                    e.preventDefault();  
                    sendMessage();  
                }  
            });  
              
            // Enter tu≈üu ile √∂zel mesaj g√∂nderme  
            document.getElementById('private-input').addEventListener('keypress', function(e) {  
                if (e.key === 'Enter' && !e.shiftKey) {  
                    e.preventDefault();  
                    sendPrivateMessage();  
                }  
            });  
              
            // Overlay click  
            document.getElementById('overlay').addEventListener('click', function(e) {  
                if (e.target === this) {  
                    closeAllModals();  
                }  
            });  
              
            // YouTube Player  
            function onYouTubeIframeAPIReady() {  
                console.log("üé¨ YouTube API hazƒ±r!");  
                initYouTubePlayer();  
            }  
            window.onYouTubeIframeAPIReady = onYouTubeIframeAPIReady;  
              
            // Firebase badge durumu  
            const badgeHidden = localStorage.getItem('firebaseBadgeHidden') === 'true';  
            if (badgeHidden) {  
                document.getElementById('firebaseBadge').classList.add('hidden');  
            }  
        });  
          
        function closeAllModals() {  
            document.getElementById('overlay').style.display = 'none';  
            document.querySelectorAll('.subscription-modal, .owner-panel, .private-modal, .channel-create-modal, .story-modal, .mateb-bot-panel, .image-modal').forEach(modal => {  
                modal.style.display = 'none';  
            });  
        }  
          
        // YouTube Player  
        function initYouTubePlayer() {  
            if (typeof YT === 'undefined' || typeof YT.Player === 'undefined') {  
                setTimeout(initYouTubePlayer, 100);  
                return;  
            }  
              
            player = new YT.Player('youtube-player', {  
                height: '100%',  
                width: '100%',  
                videoId: 'dQw4w9WgXcQ', // √ñrnek video  
                playerVars: {  
                    autoplay: 1,  
                    controls: 1,  
                    modestbranding: 1,  
                    rel: 0,  
                    showinfo: 0  
                },  
                events: {  
                    'onReady': onPlayerReady,  
                    'onStateChange': onPlayerStateChange  
                }  
            });  
        }  
          
        function onPlayerReady(event) {  
            console.log("‚úÖ YouTube Player hazƒ±r!");  
        }  
          
        function onPlayerStateChange(event) {  
            // Player state deƒüi≈üiklikleri  
        }  
    </script>  
      
    <!-- YouTube IFrame API -->  
    <script src="https://www.youtube.com/iframe_api"></script>  
</body>  
</html>
