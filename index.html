<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Popbox â€¢ Yetkili Medya Paneli</title>
    
    <!-- FONTS & ICONS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- FIREBASE -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    
    <!-- YOUTUBE API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    
    <!-- POPBOX CSS -->
    <link rel="stylesheet" href="https://raw.githubusercontent.com/popboxmusic/Popboxchat/main/popbox.css">
    <link rel="stylesheet" href="https://raw.githubusercontent.com/popboxmusic/Popboxchat/main/mobile.css">
    
    <!-- POPBOX JS MODÃœLLERÄ° - DOÄžRU SIRALAMA -->
    <script src="https://raw.githubusercontent.com/popboxmusic/Popboxchat/main/firebase-config.js"></script>
    <script src="https://raw.githubusercontent.com/popboxmusic/Popboxchat/main/popbox-core.js"></script>
    <script src="https://raw.githubusercontent.com/popboxmusic/Popboxchat/main/yetki.js"></script>
    <script src="https://raw.githubusercontent.com/popboxmusic/Popboxchat/main/yetkiler.js"></script>
    <script src="https://raw.githubusercontent.com/popboxmusic/Popboxchat/main/irc-commands.js"></script>
    <script src="https://raw.githubusercontent.com/popboxmusic/Popboxchat/main/komutlar.js"></script>
    <script src="https://raw.githubusercontent.com/popboxmusic/Popboxchat/main/giriÅŸ.js"></script>
    <script src="https://raw.githubusercontent.com/popboxmusic/Popboxchat/main/theme.js"></script>
    <script src="https://raw.githubusercontent.com/popboxmusic/Popboxchat/main/mobile.js"></script>
    <script src="https://raw.githubusercontent.com/popboxmusic/Popboxchat/main/matebot.js"></script>
</head>
<body>
    <!-- LOGIN -->
    <div id="loginOverlay" class="login-overlay">
        <div id="loginYoutubeBg" class="login-youtube-bg">
            <iframe id="loginYoutubeIframe" src="https://www.youtube.com/embed/jfKfPfyJRdk?autoplay=1&mute=1&controls=0&modestbranding=1&rel=0&disablekb=1&fs=0&iv_load_policy=3&playsinline=1&loop=1&playlist=jfKfPfyJRdk" allow="autoplay; encrypted-media"></iframe>
        </div>
        
        <div class="login-box">
            <div class="login-logo">
                <i class="fab fa-youtube"></i>
            </div>
            <h2 class="login-title">Popbox</h2>
            <p class="login-subtitle">Yetkili medya kontrol paneli</p>
            
            <input type="text" id="nickname" class="login-input" placeholder="KullanÄ±cÄ± adÄ±" autocomplete="off">
            
            <div class="password-wrapper">
                <input type="password" id="password" class="login-input" placeholder="Åžifre" autocomplete="off">
                <i class="fas fa-eye password-toggle" id="passwordToggle"></i>
            </div>
            
            <div id="loginError" class="login-error"></div>
            
            <button id="loginBtn" class="login-btn">
                <i class="fas fa-sign-in-alt"></i> GiriÅŸ Yap
            </button>
            
            <p style="color: #666; font-size: 12px; text-align: center;">
                ðŸ‘‘ MateKy (owner) â€¢ âš¡ popbox (admin) â€¢ âš¡ popboxmusic (admin) â€¢ ðŸ”§ coadmin
            </p>
        </div>
    </div>

    <!-- ANA UYGULAMA -->
    <div id="app" class="app hidden">
        <!-- SOL MENÃœ -->
        <div class="sidebar">
            <!-- TEMA BUTONU -->
            <div id="themeToggle" class="menu-item" onclick="toggleTheme()" title="Tema deÄŸiÅŸtir">
                <i id="themeIcon" class="fas fa-moon"></i>
            </div>
            
            <!-- KULLANICILAR -->
            <div class="menu-item active" onclick="showUsersPanel(); closeAllModals();" title="KullanÄ±cÄ±lar">
                <i class="fas fa-users"></i>
                <span id="onlineUserBadge" class="notification-badge" style="display: none;">0</span>
            </div>
            
            <!-- BÄ°LDÄ°RÄ°MLER -->
            <div class="menu-item" onclick="toggleNotificationPanel(); closeAllModals();" title="Bildirimler">
                <i class="fas fa-bell"></i>
                <span id="notificationBadge" class="notification-badge" style="display: none;">0</span>
            </div>
            
            <!-- POPBOX MEDYA -->
            <div class="menu-item" onclick="focusMediaPanel()" title="Popbox Medya">
                <i class="fab fa-youtube" style="color: #ff0000;"></i>
            </div>
            
            <!-- KANAL LÄ°STESÄ° -->
            <div class="menu-item" onclick="showComingSoon('Kanal listesi yakÄ±nda aktif olacak!')" title="Kanallar (yakÄ±nda)">
                <i class="fas fa-list-ul"></i>
            </div>
            
            <!-- OWNER PANEL BUTONU -->
            <div id="ownerPanelBtn" class="menu-item" style="display: none; border: 2px solid #ffd700;" 
                 onclick="window.location.href='owner.html?user=MateKy&pwd=Sahi17407@SCM'" title="ðŸ‘‘ Owner Paneli">
                <i class="fas fa-crown" style="color: #ffd700;"></i>
            </div>
            
            <!-- PROFÄ°L -->
            <div class="user-avatar" id="userAvatar" onclick="openProfilePanel()" title="Profil AyarlarÄ±">
                <span id="avatarText"></span>
                <img id="avatarImg" src="" style="display:none;">
            </div>
        </div>

        <!-- KULLANICI PANELÄ° -->
        <div class="users-panel">
            <div class="panel-header">
                <h3><i class="fas fa-users"></i> KullanÄ±cÄ±lar</h3>
                <div class="online-tabs">
                    <div class="tab active" onclick="switchUserTab('online')" id="onlineTab">Ã‡evrimiÃ§i (0)</div>
                    <div class="tab" onclick="switchUserTab('chatting')" id="chattingTab">Sohbette (0)</div>
                </div>
            </div>
            <div class="user-list" id="userList"></div>
        </div>

        <!-- CHAT PANELÄ° -->
        <div class="chat-panel">
            <div class="chat-header">
                <div class="chat-title">
                    <i class="fas fa-hashtag"></i>
                    <span id="currentChannel">genel</span>
                    <span id="onlineCount" style="color:#aaa; font-size:13px; margin-left:8px;"></span>
                </div>
                <div id="privateChatControls" style="display: none; gap: 8px;">
                    <button class="control-btn" onclick="blockUser24h()" title="24 saat engelle">
                        <i class="fas fa-ban"></i>
                    </button>
                    <button class="control-btn" onclick="reportUser()" title="Åžikayet et">
                        <i class="fas fa-flag"></i>
                    </button>
                    <button class="control-btn" onclick="closePrivateChat()" title="Pencereyi kapat">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <div class="messages" id="messages"></div>
            
            <div class="message-input-container">
                <div class="input-wrapper">
                    <textarea id="messageInput" class="message-input" placeholder="Mesaj yazÄ±n..." rows="1" oninput="autoResize(this)"></textarea>
                    <div class="media-btn" id="mediaUploadBtn" onclick="openMediaUploadModal()" title="Resim/Video gÃ¶nder" style="display: none;">
                        <i class="fas fa-paperclip"></i>
                    </div>
                    <div class="send-btn" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- MEDYA PANELÄ° -->
        <div class="media-panel">
            <div class="media-header">
                <div class="media-tabs">
                    <div class="media-tab" onclick="switchMediaTab('youtube')" id="youtubeTab">
                        <i class="fab fa-youtube"></i>
                    </div>
                    <div class="media-tab spotify" onclick="switchMediaTab('spotify')" id="spotifyTab">
                        <i class="fab fa-spotify"></i>
                    </div>
                    <div class="media-tab live" onclick="switchMediaTab('live')" id="liveTab">
                        <i class="fas fa-video"></i>
                    </div>
                </div>
                <div class="media-controls">
                    <div class="control-btn" id="addMediaBtn" onclick="openAddMediaModal()" title="Ekle">
                        <i class="fas fa-plus"></i>
                    </div>
                    <span class="admin-badge" id="adminBadge">SADECE YETKÄ°LÄ°</span>
                    <div class="control-btn" id="clearPlaylistBtn" onclick="clearPlaylist()" title="Temizle">
                        <i class="fas fa-trash"></i>
                    </div>
                </div>
            </div>
            
            <!-- ÅžU AN YAYINDA -->
            <div id="nowPlayingBar" class="now-playing-bar">
                <i class="fas fa-circle" style="color: #ff0000; font-size: 10px;"></i>
                <span id="nowPlayingText">YouTube: Popbox Radio â€¢ 24/7 CanlÄ± MÃ¼zik</span>
                <span id="startedByText" style="color: #aaa; margin-left: auto;">ðŸ‘‘ MateKy</span>
            </div>
            
            <!-- YOUTUBE PLAYER -->
            <div id="youtubePlayer" class="youtube-player">
                <div id="youtubeContainer"></div>
                <div id="userYoutubeControls" class="user-youtube-controls">
                    <div class="user-youtube-btn" id="youtubeMuteBtn" onclick="toggleMute()" title="Ses aÃ§/kapat">
                        <i class="fas fa-volume-up" id="muteIcon"></i>
                    </div>
                    <div class="user-youtube-btn" id="youtubePlayPauseBtn" onclick="togglePlayPause()" title="Oynat/durdur">
                        <i class="fas fa-pause" id="playPauseIcon"></i>
                    </div>
                </div>
            </div>
            
            <!-- SPOTIFY PLAYER -->
            <div id="spotifyPlayer" class="spotify-player">
                <iframe id="spotifyIframe" src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M?utm_source=generator" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture" loading="lazy"></iframe>
            </div>
            
            <!-- CANLI YAYIN PLAYER -->
            <div id="livePlayer" class="live-player">
                <video id="liveVideo" autoplay playsinline></video>
                <div class="live-status">
                    <i class="fas fa-circle"></i> CANLI YAYIN
                </div>
                <div class="live-controls">
                    <div class="live-btn" id="switchCameraBtn" onclick="switchCamera()" title="Kamera deÄŸiÅŸtir">
                        <i class="fas fa-camera-retro"></i>
                    </div>
                    <div class="live-btn stop" id="stopLiveBtn" onclick="stopLiveStream()" title="YayÄ±nÄ± durdur">
                        <i class="fas fa-stop"></i>
                    </div>
                </div>
            </div>
            
            <!-- PLAYLIST -->
            <div class="playlist" id="playlist"></div>
        </div>
    </div> <!-- APP BÄ°TÄ°ÅžÄ° -->

    <!-- MODALLAR -->
    <div id="addMediaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">YouTube Video Ekle</h3>
                <button class="modal-close" onclick="closeAddMediaModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <input type="text" id="mediaUrl" class="modal-input" placeholder="Video/Playlist URL'si veya ID'si">
            <input type="text" id="mediaTitle" class="modal-input" placeholder="BaÅŸlÄ±k">
            <button id="addMediaConfirmBtn" class="modal-btn" onclick="addToPlaylist()">
                <i class="fas fa-plus"></i> Playlist'e Ekle
            </button>
        </div>
    </div>

    <div id="mediaUploadModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-paperclip"></i> Resim/Video GÃ¶nder</h3>
                <button class="modal-close" onclick="closeMediaUploadModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="media-upload-btn" onclick="document.getElementById('mediaFileInput').click()">
                <i class="fas fa-cloud-upload-alt"></i> Dosya SeÃ§
            </div>
            <input type="file" id="mediaFileInput" accept="image/*,video/*" style="display: none;">
            <div style="display: flex; gap: 8px; margin-top: 16px;">
                <input type="text" id="mediaCaption" class="modal-input" placeholder="BaÅŸlÄ±k (isteÄŸe baÄŸlÄ±)" style="margin-bottom: 0;">
            </div>
            <img id="mediaPreview" src="#" alt="Ã–nizleme">
            <button class="modal-btn" onclick="sendPrivateMedia()" style="margin-top: 16px;">
                <i class="fas fa-paper-plane"></i> GÃ¶nder
            </button>
        </div>
    </div>

    <div id="liveStreamModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-video" style="color: #ff4444;"></i> CanlÄ± YayÄ±n BaÅŸlat</h3>
                <button class="modal-close" onclick="closeLiveStreamModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <input type="text" id="liveTitle" class="modal-input" placeholder="YayÄ±n baÅŸlÄ±ÄŸÄ±">
            <textarea id="liveDescription" class="modal-input" placeholder="YayÄ±n aÃ§Ä±klamasÄ±" rows="3" style="resize: none;"></textarea>
            <button class="modal-btn live" onclick="startLiveStream()">
                <i class="fas fa-video"></i> YayÄ±nÄ± BaÅŸlat
            </button>
        </div>
    </div>

    <div id="profilePanelModal" class="modal">
        <div class="modal-content" style="width: 500px; max-width: 95%;">
            <div class="modal-header">
                <h3><i class="fas fa-user-circle"></i> Profil AyarlarÄ±</h3>
                <button class="modal-close" onclick="closeProfilePanelModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div style="padding: 20px;">
                <!-- Profil iÃ§eriÄŸi JS ile doldurulacak -->
            </div>
        </div>
    </div>

    <div id="complaintModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-flag" style="color: #ff4444;"></i> KullanÄ±cÄ± Åžikayet Et</h3>
                <button class="modal-close" onclick="closeComplaintModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="complaintUserInfo" style="margin-bottom: 16px; padding: 12px; background: #0f0f0f; border-radius: 8px;">
                <span id="complaintUsername" style="font-weight: 600;"></span> kullanÄ±cÄ±sÄ±nÄ± ÅŸikayet ediyorsunuz.
            </div>
            <div class="complaint-reason">
                <label>Åžikayet Sebebi</label>
                <select id="complaintReason" class="modal-input">
                    <option value="spam">Spam / Reklam</option>
                    <option value="harassment">Taciz / Hakaret</option>
                    <option value="inappropriate">Uygunsuz Ä°Ã§erik</option>
                    <option value="other">DiÄŸer</option>
                </select>
            </div>
            <div class="complaint-reason">
                <label>AÃ§Ä±klama (Ä°steÄŸe baÄŸlÄ±)</label>
                <textarea id="complaintDescription" class="modal-input" rows="3" placeholder="DetaylÄ± aÃ§Ä±klama..."></textarea>
            </div>
            <button class="modal-btn" onclick="submitComplaint()" style="background: #ff4444;">
                <i class="fas fa-paper-plane"></i> Åžikayeti GÃ¶nder
            </button>
        </div>
    </div>

    <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
    <input type="file" id="profileImageUpload" accept="image/*" style="display: none;">

    <div id="activePanelIndicator" class="active-panel-indicator">Panel: Genel Sohbet</div>

    <script>
        // ========== BAÅžLANGIÃ‡ ==========
        document.addEventListener('DOMContentLoaded', function() {
            // TÃ¼m modÃ¼ller yÃ¼klendikten sonra baÅŸlat
            setTimeout(() => {
                if (typeof initFirebase === 'function') initFirebase();
                if (typeof loadTheme === 'function') loadTheme();
                if (typeof initMobileView === 'function') initMobileView();
                console.log('âœ… Popbox ana sayfa hazÄ±r!');
            }, 100);
        });
    </script>
</body>
</html>
