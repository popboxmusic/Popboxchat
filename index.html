<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popbox Elite</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* TEMEL STƒ∞LLER */
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-tertiary: #1a1a1a;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --accent-blue: #3b82f6;
            --accent-green: #10b981;
            --accent-red: #ef4444;
            --border-light: #222222;
        }

        body.day-mode {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f1f5f9;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --border-light: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 25px 25px, rgba(255, 255, 255, 0.05) 2%, transparent 2.5%),
                radial-gradient(circle at 75px 75px, rgba(255, 255, 255, 0.05) 2%, transparent 2.5%);
            background-size: 100px 100px;
            pointer-events: none;
            z-index: -1;
        }

        body.day-mode::before {
            background-image: 
                radial-gradient(circle at 25px 25px, rgba(0, 0, 0, 0.03) 2%, transparent 2.5%),
                radial-gradient(circle at 75px 75px, rgba(0, 0, 0, 0.03) 2%, transparent 2.5%);
        }

        /* Gƒ∞Rƒ∞≈û EKRANI */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .login-container {
            background: var(--bg-secondary);
            padding: 30px;
            border-radius: 10px;
            width: 400px;
            border: 1px solid var(--border-light);
        }

        .login-input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            color: var(--text-primary);
            border-radius: 5px;
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            background: var(--accent-blue);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        /* ANA UYGULAMA */
        .app-container {
            display: flex;
            height: 100vh;
            flex-direction: column;
        }

        /* √úST BAR */
        .top-bar {
            display: flex;
            height: 60px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-light);
            padding: 0 20px;
            align-items: center;
            justify-content: space-between;
        }

        .channel-tabs {
            display: flex;
            gap: 5px;
            overflow-x: auto;
            max-width: 500px;
        }

        .channel-tab {
            padding: 8px 15px;
            background: var(--bg-tertiary);
            border-radius: 5px;
            cursor: pointer;
            white-space: nowrap;
        }

        .channel-tab.active {
            background: var(--accent-blue);
            color: white;
        }

        /* ANA ƒ∞√áERƒ∞K */
        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* SOL PANEL - Online Listesi */
        .online-panel {
            width: 280px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-light);
            display: flex;
            flex-direction: column;
        }

        .user-list {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

        .user-item {
            padding: 10px;
            border-bottom: 1px solid var(--border-light);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        /* ORTA PANEL - Sohbet */
        .chat-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .message {
            margin-bottom: 15px;
            max-width: 70%;
        }

        .message-outgoing {
            margin-left: auto;
            text-align: right;
        }

        .message-text {
            background: var(--bg-tertiary);
            padding: 10px 15px;
            border-radius: 10px;
            display: inline-block;
        }

        .message-outgoing .message-text {
            background: var(--accent-blue);
            color: white;
        }

        .chat-input-area {
            padding: 15px;
            border-top: 1px solid var(--border-light);
            background: var(--bg-secondary);
        }

        .message-input {
            width: 100%;
            padding: 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            color: var(--text-primary);
            border-radius: 5px;
            resize: none;
        }

        /* SAƒû PANEL - Video */
        .video-panel {
            width: 600px;
            background: #000;
            display: flex;
            flex-direction: column;
        }

        .video-container {
            flex: 1;
            background: #000;
        }

        .youtube-video {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* MODALLAR */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal-content {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
        }

        /* UTILITIES */
        .hidden {
            display: none !important;
        }

        .text-sm {
            font-size: 12px;
        }
    </style>
</head>
<body class="night-mode">
    <!-- Gƒ∞Rƒ∞≈û EKRANI -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <h2>Popbox Elite Giri≈ü</h2>
            <input type="text" id="nickInput" class="login-input" placeholder="Kullanƒ±cƒ± adƒ±" autofocus>
            <input type="password" id="passInput" class="login-input" placeholder="≈ûifre (isteƒüe baƒülƒ±)">
            <button class="login-btn" onclick="handleLogin()">Giri≈ü Yap</button>
            <p class="text-sm" style="margin-top: 10px; color: var(--text-secondary)">
                Owner: mateky / kumsal07@<br>
                Bot: MATE / secure123
            </p>
        </div>
    </div>

    <!-- ANA UYGULAMA -->
    <div id="app" class="hidden">
        <!-- √úST BAR -->
        <div class="top-bar">
            <div style="display: flex; align-items: center; gap: 10px;">
                <div style="width: 30px; height: 30px; background: var(--accent-blue); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">P</div>
                <span>Popbox Elite</span>
            </div>

            <!-- KANAL SEKMELERƒ∞ -->
            <div class="channel-tabs" id="channelTabs">
                <div class="channel-tab active" onclick="switchChannel('general')">#Genel</div>
            </div>

            <div style="display: flex; gap: 10px;">
                <button onclick="openCreateChannel()" id="createChannelBtn" style="display: none; padding: 8px 15px; background: var(--accent-green); color: white; border: none; border-radius: 5px;">
                    + Kanal A√ß
                </button>
                <button onclick="openOwnerPanel()" id="ownerBtn" style="display: none; padding: 8px 15px; background: var(--accent-blue); color: white; border: none; border-radius: 5px;">
                    Owner
                </button>
                <button onclick="toggleTheme()" style="padding: 8px 15px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-light); border-radius: 5px;">
                    Tema
                </button>
            </div>
        </div>

        <!-- ANA ƒ∞√áERƒ∞K -->
        <div class="main-content">
            <!-- SOL PANEL -->
            <div class="online-panel">
                <div style="padding: 15px; border-bottom: 1px solid var(--border-light);">
                    <h3>√áevrimi√ßi Kullanƒ±cƒ±lar (<span id="onlineCount">0</span>)</h3>
                </div>
                <div class="user-list" id="userList">
                    <!-- Kullanƒ±cƒ±lar buraya gelecek -->
                </div>
            </div>

            <!-- ORTA PANEL -->
            <div class="chat-panel">
                <div class="chat-messages" id="chatMessages">
                    <!-- Mesajlar buraya gelecek -->
                </div>
                <div class="chat-input-area">
                    <textarea class="message-input" id="messageInput" placeholder="Mesaj yazƒ±n..." rows="3" onkeydown="handleKeyPress(event)"></textarea>
                    <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                        <div>
                            <button onclick="sendImage()" style="padding: 8px 15px; background: var(--bg-tertiary); border: 1px solid var(--border-light); color: var(--text-primary); border-radius: 5px; margin-right: 5px;">
                                <i class="fas fa-image"></i> Resim
                            </button>
                            <button onclick="openIRC()" style="padding: 8px 15px; background: var(--bg-tertiary); border: 1px solid var(--border-light); color: var(--text-primary); border-radius: 5px;">
                                <i class="fas fa-terminal"></i> IRC
                            </button>
                        </div>
                        <button onclick="sendMessage()" style="padding: 8px 20px; background: var(--accent-blue); color: white; border: none; border-radius: 5px;">
                            G√∂nder
                        </button>
                    </div>
                </div>
            </div>

            <!-- SAƒû PANEL -->
            <div class="video-panel">
                <div style="padding: 15px; background: #000; color: white; border-bottom: 1px solid #333;">
                    <h3 style="display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-play-circle"></i>
                        <span id="videoTitle">Popbox Music</span>
                    </h3>
                </div>
                <div class="video-container">
                    <iframe class="youtube-video" id="youtubePlayer"
                        src="https://www.youtube.com/embed/jfKfPfyJRdk?autoplay=1&mute=1&rel=0"
                        frameborder="0"
                        allowfullscreen>
                    </iframe>
                </div>
                <div style="padding: 15px; background: #000; color: white; border-top: 1px solid #333;">
                    <button onclick="openVideoManager()" style="padding: 8px 15px; background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 5px; width: 100%;">
                        <i class="fas fa-video"></i> Video Y√∂net
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- MODALLAR -->
    <!-- Video Y√∂netim -->
    <div id="videoModal" class="modal-overlay">
        <div class="modal-content">
            <h3>Video Y√∂netimi</h3>
            <input type="text" id="videoUrl" class="login-input" placeholder="YouTube URL" style="margin: 10px 0;">
            <input type="text" id="videoTitleInput" class="login-input" placeholder="Video Ba≈ülƒ±ƒüƒ±">
            <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button onclick="closeVideoModal()" style="flex: 1; padding: 10px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-light); border-radius: 5px;">
                    ƒ∞ptal
                </button>
                <button onclick="saveVideo()" style="flex: 1; padding: 10px; background: var(--accent-blue); color: white; border: none; border-radius: 5px;">
                    Kaydet
                </button>
            </div>
        </div>
    </div>

    <!-- Kanal Olu≈üturma -->
    <div id="channelModal" class="modal-overlay">
        <div class="modal-content">
            <h3>Yeni Kanal Olu≈ütur</h3>
            <input type="text" id="channelName" class="login-input" placeholder="#kanal_adi" style="margin: 10px 0;">
            <input type="text" id="channelDesc" class="login-input" placeholder="Kanal A√ßƒ±klamasƒ±">
            <p class="text-sm" style="color: var(--text-secondary); margin: 10px 0;">
                Not: Her kullanƒ±cƒ± sadece 1 kanal a√ßabilir
            </p>
            <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button onclick="closeChannelModal()" style="flex: 1; padding: 10px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-light); border-radius: 5px;">
                    ƒ∞ptal
                </button>
                <button onclick="createNewChannel()" style="flex: 1; padding: 10px; background: var(--accent-green); color: white; border: none; border-radius: 5px;">
                    Olu≈ütur
                </button>
            </div>
        </div>
    </div>

    <!-- Owner Panel -->
    <div id="ownerModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 700px;">
            <h3>Owner Paneli - mateky</h3>
            <div style="display: flex; gap: 10px; margin: 15px 0;">
                <button onclick="switchOwnerTab('users')" class="owner-tab active">Kullanƒ±cƒ±lar</button>
                <button onclick="switchOwnerTab('messages')" class="owner-tab">√ñzel Mesajlar</button>
                <button onclick="switchOwnerTab('channels')" class="owner-tab">Kanallar</button>
                <button onclick="switchOwnerTab('bot')" class="owner-tab">Bot</button>
            </div>
            
            <div id="ownerUsers" class="owner-tab-content">
                <div style="max-height: 300px; overflow-y: auto;">
                    <div id="ownerUserList"></div>
                </div>
            </div>
            
            <div id="ownerMessages" class="owner-tab-content" style="display: none;">
                <div style="max-height: 300px; overflow-y: auto;">
                    <div id="pmList"></div>
                </div>
            </div>
            
            <div id="ownerChannels" class="owner-tab-content" style="display: none;">
                <div style="max-height: 300px; overflow-y: auto;">
                    <div id="channelList"></div>
                </div>
            </div>
            
            <div id="ownerBot" class="owner-tab-content" style="display: none;">
                <textarea id="botMessage" class="login-input" placeholder="Sistem mesajƒ±" rows="3"></textarea>
                <button onclick="sendSystemMessage()" style="width: 100%; padding: 10px; background: var(--accent-blue); color: white; border: none; border-radius: 5px; margin-top: 10px;">
                    Sistem Mesajƒ± G√∂nder
                </button>
            </div>
            
            <button onclick="closeOwnerModal()" style="width: 100%; padding: 10px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-light); border-radius: 5px; margin-top: 15px;">
                Kapat
            </button>
        </div>
    </div>

    <!-- IRC Komutlarƒ± -->
    <div id="ircModal" class="modal-overlay">
        <div class="modal-content">
            <h3>IRC Komutlarƒ±</h3>
            <input type="text" id="ircCommand" class="login-input" placeholder="/komut" onkeydown="handleIRCKeyPress(event)">
            <div style="height: 200px; overflow-y: auto; background: var(--bg-primary); padding: 10px; margin: 10px 0; border-radius: 5px;">
                <div id="ircOutput"></div>
            </div>
            <button onclick="closeIRCModal()" style="width: 100%; padding: 10px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-light); border-radius: 5px;">
                Kapat
            </button>
        </div>
    </div>

    <!-- Profil Modal -->
    <div id="profileModal" class="modal-overlay">
        <div class="modal-content">
            <h3>Profil Ayarlarƒ±</h3>
            <div style="text-align: center; margin: 15px 0;">
                <div id="profileAvatar" style="width: 80px; height: 80px; background: var(--accent-blue); border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; color: white; font-size: 24px; font-weight: bold; cursor: pointer;">
                    A
                </div>
            </div>
            <input type="text" id="profileNick" class="login-input" placeholder="Yeni kullanƒ±cƒ± adƒ±">
            <div style="display: flex; align-items: center; justify-content: space-between; margin: 15px 0;">
                <span>Uyku Modu</span>
                <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                    <input type="checkbox" id="sleepMode" style="opacity: 0; width: 0; height: 0;">
                    <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: var(--bg-tertiary); border-radius: 24px; transition: .4s;"></span>
                    <span style="position: absolute; content: ''; height: 16px; width: 16px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: .4s;"></span>
                </label>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button onclick="closeProfileModal()" style="flex: 1; padding: 10px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-light); border-radius: 5px;">
                    ƒ∞ptal
                </button>
                <button onclick="saveProfile()" style="flex: 1; padding: 10px; background: var(--accent-blue); color: white; border: none; border-radius: 5px;">
                    Kaydet
                </button>
            </div>
        </div>
    </div>

    <script>
        // ==================== Sƒ∞STEM DEƒûƒ∞≈ûKENLERƒ∞ ====================
        let currentUser = null;
        let currentChannel = 'general';
        let channels = {
            general: {
                name: '#Genel',
                owner: 'system',
                users: [],
                messages: [],
                video: { id: 'jfKfPfyJRdk', title: 'Popbox Music' }
            }
        };
        
        let users = [];
        let notifications = [];
        let theme = 'night';
        let botActive = true;

        // ==================== Gƒ∞Rƒ∞≈û Sƒ∞STEMƒ∞ ====================
        function handleLogin() {
            const nick = document.getElementById('nickInput').value.trim();
            const pass = document.getElementById('passInput').value;
            
            if (!nick) {
                alert('Kullanƒ±cƒ± adƒ± gerekli!');
                return;
            }
            
            // Kayƒ±tlƒ± kullanƒ±cƒ± kontrol√º
            if (nick.toLowerCase() === 'mateky') {
                if (pass !== 'kumsal07@') {
                    alert('Yanlƒ±≈ü ≈üifre!');
                    return;
                }
                currentUser = {
                    id: 'mateky',
                    name: 'mateky',
                    role: 'owner',
                    registered: true,
                    online: true,
                    sleepMode: false,
                    avatar: 'M'
                };
                document.getElementById('ownerBtn').style.display = 'block';
                document.getElementById('createChannelBtn').style.display = 'block';
                
            } else if (nick === 'MATE') {
                if (pass !== 'secure123') {
                    alert('Yanlƒ±≈ü ≈üifre!');
                    return;
                }
                currentUser = {
                    id: 'MATE',
                    name: 'MATE',
                    role: 'admin',
                    registered: true,
                    online: true,
                    sleepMode: false,
                    avatar: 'ü§ñ'
                };
                
            } else {
                // Yeni kullanƒ±cƒ±
                currentUser = {
                    id: nick.toLowerCase(),
                    name: nick,
                    role: 'user',
                    registered: false,
                    online: true,
                    sleepMode: false,
                    avatar: nick.charAt(0).toUpperCase()
                };
                
                // Eƒüer ≈üifre varsa kayƒ±tlƒ± say
                if (pass) {
                    currentUser.registered = true;
                    document.getElementById('createChannelBtn').style.display = 'block';
                }
            }
            
            // Kullanƒ±cƒ±yƒ± listeye ekle
            if (!users.find(u => u.id === currentUser.id)) {
                users.push(currentUser);
            }
            
            // Genel kanala ekle
            if (!channels.general.users.includes(currentUser.id)) {
                channels.general.users.push(currentUser.id);
            }
            
            // Giri≈ü yap
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            
            // Ba≈ülangƒ±√ß mesajƒ±
            addMessage('system', `ü§ñ Ho≈ü geldin ${currentUser.name}!`);
            
            // Online listeyi g√ºncelle
            updateOnlineList();
            
            // MATE bot mesajƒ±
            if (currentUser.name !== 'MATE') {
                setTimeout(() => {
                    addMessage('system', 'ü§ñ MATE: Sistem g√ºvenliƒüi aktif.');
                }, 1000);
            }
            
            // Diƒüer kullanƒ±cƒ±larƒ± sim√ºle et
            simulateOtherUsers();
        }

        // ==================== SOHBET Sƒ∞STEMƒ∞ ====================
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            // Komut kontrol√º
            if (text.startsWith('/')) {
                handleCommand(text);
                input.value = '';
                return;
            }
            
            // Normal mesaj
            addMessage('user', text);
            input.value = '';
            
            // Diƒüer kullanƒ±cƒ±lardan cevap sim√ºlasyonu
            simulateResponse(text);
        }

        function handleKeyPress(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        }

        function addMessage(type, text, sender = null) {
            const container = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            
            if (type === 'system') {
                messageDiv.className = 'message';
                messageDiv.innerHTML = `<div class="message-text" style="background: var(--bg-tertiary); color: var(--text-secondary); font-style: italic;">${text}</div>`;
            } else {
                messageDiv.className = `message ${type === 'user' ? 'message-outgoing' : 'message-incoming'}`;
                const senderName = sender || currentUser.name;
                const avatar = sender ? getAvatar(sender) : currentUser.avatar;
                
                messageDiv.innerHTML = `
                    <div style="margin-bottom: 5px; font-size: 12px; color: var(--text-secondary)">
                        <strong>${senderName}</strong>
                        ${sender && users.find(u => u.name === sender)?.role === 'admin' ? '<span style="background: var(--accent-blue); color: white; padding: 2px 5px; border-radius: 3px; font-size: 10px; margin-left: 5px;">admin</span>' : ''}
                    </div>
                    <div class="message-text">${text}</div>
                `;
            }
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
            
            // Mesajƒ± kanal ge√ßmi≈üine kaydet
            if (!channels[currentChannel].messages) {
                channels[currentChannel].messages = [];
            }
            channels[currentChannel].messages.push({
                type: type,
                text: text,
                sender: sender || currentUser.name,
                time: new Date()
            });
        }

        function simulateResponse(text) {
            // Rastgele cevap sim√ºlasyonu
            if (Math.random() > 0.7) {
                setTimeout(() => {
                    const responses = [
                        "G√ºzel bir nokta!",
                        "Katƒ±lƒ±yorum.",
                        "Harika!",
                        "Te≈üekk√ºrler payla≈üƒ±m i√ßin."
                    ];
                    const randomUser = getRandomUser();
                    if (randomUser) {
                        addMessage('incoming', responses[Math.floor(Math.random() * responses.length)], randomUser.name);
                    }
                }, 1000 + Math.random() * 2000);
            }
        }

        // ==================== ONLINE Lƒ∞STESƒ∞ ====================
        function updateOnlineList() {
            const container = document.getElementById('userList');
            const count = document.getElementById('onlineCount');
            
            container.innerHTML = '';
            let onlineCount = 0;
            
            users.forEach(user => {
                if (user.sleepMode) return;
                
                const item = document.createElement('div');
                item.className = 'user-item';
                item.onclick = () => openPrivateChat(user);
                
                item.innerHTML = `
                    <div class="user-avatar" style="background: ${user.online ? 'var(--accent-green)' : 'var(--bg-tertiary)'}">
                        ${user.avatar}
                    </div>
                    <div style="flex: 1;">
                        <div style="font-weight: bold;">${user.name}</div>
                        <div style="font-size: 12px; color: var(--text-secondary)">
                            ${user.online ? 'üü¢ √áevrimi√ßi' : '‚ö´ √áevrimdƒ±≈üƒ±'}
                            ${user.registered ? ' ‚úì Kayƒ±tlƒ±' : ''}
                        </div>
                    </div>
                `;
                
                container.appendChild(item);
                if (user.online) onlineCount++;
            });
            
            count.textContent = onlineCount;
        }

        function simulateOtherUsers() {
            // Fake kullanƒ±cƒ±lar ekle
            const fakeUsers = [
                { name: 'Ahmet', avatar: 'A', role: 'user', online: true },
                { name: 'Ay≈üe', avatar: 'A', role: 'user', online: true },
                { name: 'Mehmet', avatar: 'M', role: 'user', online: false }
            ];
            
            fakeUsers.forEach(user => {
                if (!users.find(u => u.name === user.name)) {
                    users.push({
                        id: user.name.toLowerCase(),
                        name: user.name,
                        role: user.role,
                        registered: false,
                        online: user.online,
                        sleepMode: false,
                        avatar: user.avatar
                    });
                }
            });
            
            updateOnlineList();
        }

        function getRandomUser() {
            const otherUsers = users.filter(u => u.id !== currentUser.id && u.online);
            return otherUsers.length > 0 ? otherUsers[Math.floor(Math.random() * otherUsers.length)] : null;
        }

        function getAvatar(name) {
            const user = users.find(u => u.name === name);
            return user ? user.avatar : name.charAt(0).toUpperCase();
        }

        // ==================== KANAL Sƒ∞STEMƒ∞ ====================
        function switchChannel(channelId) {
            currentChannel = channelId;
            
            // Sekmeleri g√ºncelle
            document.querySelectorAll('.channel-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Mesajlarƒ± y√ºkle
            loadChannelMessages();
            
            // Video y√ºkle
            loadChannelVideo();
        }

        function loadChannelMessages() {
            const container = document.getElementById('chatMessages');
            container.innerHTML = '';
            
            const channel = channels[currentChannel];
            if (channel.messages) {
                channel.messages.forEach(msg => {
                    if (msg.type === 'system') {
                        addMessage('system', msg.text);
                    } else {
                        addMessage(msg.sender === currentUser.name ? 'user' : 'incoming', msg.text, msg.sender);
                    }
                });
            }
        }

        function loadChannelVideo() {
            const channel = channels[currentChannel];
            if (channel.video) {
                document.getElementById('youtubePlayer').src = `https://www.youtube.com/embed/${channel.video.id}?autoplay=1&mute=1`;
                document.getElementById('videoTitle').textContent = channel.video.title;
            }
        }

        function openCreateChannel() {
            if (!currentUser.registered) {
                alert('Sadece kayƒ±tlƒ± kullanƒ±cƒ±lar kanal a√ßabilir!');
                return;
            }
            
            // Kullanƒ±cƒ± zaten kanal a√ßmƒ±≈ü mƒ±?
            const userChannels = Object.keys(channels).filter(id => 
                id !== 'general' && channels[id].owner === currentUser.id
            );
            
            if (userChannels.length > 0) {
                alert('Zaten bir kanalƒ±nƒ±z var! Her kullanƒ±cƒ± sadece 1 kanal a√ßabilir.');
                return;
            }
            
            document.getElementById('channelModal').style.display = 'flex';
        }

        function closeChannelModal() {
            document.getElementById('channelModal').style.display = 'none';
        }

        function createNewChannel() {
            const name = document.getElementById('channelName').value.trim();
            const desc = document.getElementById('channelDesc').value.trim();
            
            if (!name) {
                alert('Kanal adƒ± gerekli!');
                return;
            }
            
            const channelId = name.toLowerCase().replace(/[^a-z0-9]/g, '_');
            
            if (channels[channelId]) {
                alert('Bu kanal adƒ± zaten kullanƒ±lƒ±yor!');
                return;
            }
            
            // Yeni kanal olu≈ütur
            channels[channelId] = {
                name: '#' + name,
                owner: currentUser.id,
                description: desc,
                users: [currentUser.id, 'MATE'], // MATE bot otomatik eklenir
                messages: [
                    {
                        type: 'system',
                        text: `ü§ñ ${currentUser.name} tarafƒ±ndan yeni kanal olu≈üturuldu!`,
                        time: new Date()
                    }
                ],
                video: {
                    id: 'jfKfPfyJRdk',
                    title: 'Popbox Music'
                }
            };
            
            // Kanal sekmesi ekle
            const tabs = document.getElementById('channelTabs');
            const tab = document.createElement('div');
            tab.className = 'channel-tab';
            tab.textContent = '#' + name;
            tab.onclick = () => switchChannel(channelId);
            tabs.appendChild(tab);
            
            // Kanalƒ± se√ß
            switchChannel(channelId);
            
            // Modal'ƒ± kapat
            closeChannelModal();
            
            // Inputlarƒ± temizle
            document.getElementById('channelName').value = '';
            document.getElementById('channelDesc').value = '';
            
            // Bildirim
            addMessage('system', `üéâ ${currentUser.name} yeni kanal olu≈üturdu: #${name}`);
        }

        // ==================== VIDEO Sƒ∞STEMƒ∞ ====================
        function openVideoManager() {
            if (currentChannel === 'general') {
                alert('Genel kanalƒ±n videosu deƒüi≈ütirilemez!');
                return;
            }
            
            const channel = channels[currentChannel];
            if (channel.owner !== currentUser.id && currentUser.role !== 'owner' && currentUser.role !== 'admin') {
                alert('Sadece kanal sahibi veya adminler video deƒüi≈ütirebilir!');
                return;
            }
            
            document.getElementById('videoUrl').value = '';
            document.getElementById('videoTitleInput').value = channel.video?.title || '';
            document.getElementById('videoModal').style.display = 'flex';
        }

        function closeVideoModal() {
            document.getElementById('videoModal').style.display = 'none';
        }

        function saveVideo() {
            const url = document.getElementById('videoUrl').value.trim();
            const title = document.getElementById('videoTitleInput').value.trim();
            
            let videoId = url;
            
            // YouTube ID √ßƒ±kar
            if (url.includes('youtube.com') || url.includes('youtu.be')) {
                const match = url.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/);
                videoId = match ? match[1] : url;
            }
            
            // Kanal videosunu g√ºncelle
            channels[currentChannel].video = {
                id: videoId,
                title: title || 'YouTube Video'
            };
            
            // Player'ƒ± g√ºncelle
            document.getElementById('youtubePlayer').src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1`;
            document.getElementById('videoTitle').textContent = title;
            
            closeVideoModal();
            addMessage('system', `üé• ${currentUser.name} kanal videosunu g√ºncelledi: ${title}`);
        }

        // ==================== OWNER PANELƒ∞ ====================
        function openOwnerPanel() {
            if (currentUser.role !== 'owner') {
                alert('Bu panele eri≈üim yetkiniz yok!');
                return;
            }
            
            // Kullanƒ±cƒ± listesini y√ºkle
            loadOwnerUsers();
            document.getElementById('ownerModal').style.display = 'flex';
        }

        function closeOwnerModal() {
            document.getElementById('ownerModal').style.display = 'none';
        }

        function switchOwnerTab(tabId) {
            // T√ºm sekmeleri gizle
            document.querySelectorAll('.owner-tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            
            // T√ºm tab butonlarƒ±nƒ± pasif yap
            document.querySelectorAll('.owner-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Aktif tab'ƒ± g√∂ster
            document.getElementById('owner' + tabId.charAt(0).toUpperCase() + tabId.slice(1)).style.display = 'block';
            event.target.classList.add('active');
        }

        function loadOwnerUsers() {
            const container = document.getElementById('ownerUserList');
            container.innerHTML = '';
            
            users.forEach(user => {
                const div = document.createElement('div');
                div.className = 'user-item';
                div.style.border = 'none';
                div.style.padding = '8px';
                
                div.innerHTML = `
                    <div class="user-avatar">${user.avatar}</div>
                    <div style="flex: 1;">
                        <div><strong>${user.name}</strong> <span style="font-size: 12px; color: var(--text-secondary)">(${user.role})</span></div>
                        <div style="font-size: 11px; color: var(--text-secondary)">
                            ${user.online ? 'üü¢' : '‚ö´'} ${user.registered ? '‚úì' : '‚úó'}
                        </div>
                    </div>
                    <div style="display: flex; gap: 5px;">
                        <button onclick="kickUser('${user.id}')" style="padding: 4px 8px; background: var(--accent-red); color: white; border: none; border-radius: 3px; font-size: 11px;">Kick</button>
                        ${user.role !== 'owner' ? `
                            <button onclick="banUser('${user.id}')" style="padding: 4px 8px; background: var(--accent-red); color: white; border: none; border-radius: 3px; font-size: 11px;">Ban</button>
                        ` : ''}
                    </div>
                `;
                
                container.appendChild(div);
            });
        }

        function kickUser(userId) {
            const user = users.find(u => u.id === userId);
            if (user && confirm(`${user.name} kullanƒ±cƒ±sƒ±nƒ± atmak istediƒüinize emin misiniz?`)) {
                user.online = false;
                updateOnlineList();
                loadOwnerUsers();
                addMessage('system', `üö´ ${user.name} kullanƒ±cƒ±sƒ± atƒ±ldƒ±.`);
            }
        }

        function banUser(userId) {
            const user = users.find(u => u.id === userId);
            if (user && user.role !== 'owner' && confirm(`${user.name} kullanƒ±cƒ±sƒ±nƒ± banlamak istediƒüinize emin misiniz?`)) {
                const index = users.findIndex(u => u.id === userId);
                if (index > -1) {
                    users.splice(index, 1);
                    updateOnlineList();
                    loadOwnerUsers();
                    addMessage('system', `üö´ ${user.name} kullanƒ±cƒ±sƒ± banlandƒ±.`);
                }
            }
        }

        function sendSystemMessage() {
            const message = document.getElementById('botMessage').value.trim();
            if (message) {
                addMessage('system', `üîî Sƒ∞STEM: ${message}`);
                document.getElementById('botMessage').value = '';
            }
        }

        // ==================== IRC KOMUTLARI ====================
        function openIRC() {
            document.getElementById('ircModal').style.display = 'flex';
        }

        function closeIRCModal() {
            document.getElementById('ircModal').style.display = 'none';
        }

        function handleIRCKeyPress(e) {
            if (e.key === 'Enter') {
                const command = document.getElementById('ircCommand').value.trim();
                if (command) {
                    executeIRCCommand(command);
                    document.getElementById('ircCommand').value = '';
                }
            }
        }

        function executeIRCCommand(fullCommand) {
            const output = document.getElementById('ircOutput');
            const parts = fullCommand.split(' ');
            const cmd = parts[0].toLowerCase();
            const args = parts.slice(1);
            
            let result = '';
            
            switch(cmd) {
                case '/help':
                    result = 'üìã KOMUTLAR:\n' +
                            '/help - Yardƒ±m\n' +
                            '/register <nick> <≈üifre> - Kayƒ±t ol\n' +
                            '/login <nick> <≈üifre> - Giri≈ü yap\n' +
                            '/who - Online listesi\n' +
                            '/join #kanal - Kanal deƒüi≈ütir\n' +
                            '/msg <nick> <mesaj> - √ñzel mesaj\n' +
                            '/me <eylem> - Eylem mesajƒ±\n' +
                            '/clear - Sohbeti temizle\n' +
                            '/kick <nick> - Kullanƒ±cƒ±yƒ± at\n';
                    break;
                    
                case '/register':
                    if (args.length >= 2) {
                        const nick = args[0];
                        const pass = args[1];
                        
                        // Nick kontrol√º
                        if (users.find(u => u.name.toLowerCase() === nick.toLowerCase())) {
                            result = `‚ùå ${nick} zaten kullanƒ±lƒ±yor!`;
                        } else {
                            // Yeni kullanƒ±cƒ± olu≈ütur
                            const newUser = {
                                id: nick.toLowerCase(),
                                name: nick,
                                role: 'user',
                                registered: true,
                                online: true,
                                sleepMode: false,
                                avatar: nick.charAt(0).toUpperCase()
                            };
                            users.push(newUser);
                            updateOnlineList();
                            result = `‚úÖ ${nick} ba≈üarƒ±yla kaydedildi!`;
                        }
                    } else {
                        result = '‚ùå Kullanƒ±m: /register <nick> <≈üifre>';
                    }
                    break;
                    
                case '/login':
                    if (args.length >= 2) {
                        const nick = args[0];
                        const pass = args[1];
                        
                        // Demo i√ßin basit kontrol
                        if (nick === 'mateky' && pass === 'kumsal07@') {
                            currentUser.role = 'owner';
                            result = `‚úÖ ${nick} olarak owner giri≈üi yapƒ±ldƒ±!`;
                        } else {
                            result = '‚ùå Yanlƒ±≈ü nick veya ≈üifre!';
                        }
                    } else {
                        result = '‚ùå Kullanƒ±m: /login <nick> <≈üifre>';
                    }
                    break;
                    
                case '/who':
                    const online = users.filter(u => u.online && !u.sleepMode);
                    result = `üë• √áevrimi√ßi: ${online.length} kullanƒ±cƒ±`;
                    online.forEach(u => {
                        result += `\n‚Ä¢ ${u.name} ${u.role !== 'user' ? `(${u.role})` : ''}`;
                    });
                    break;
                    
                case '/join':
                    if (args.length >= 1) {
                        let channel = args[0];
                        if (!channel.startsWith('#')) channel = '#' + channel;
                        
                        const channelId = channel.substring(1).toLowerCase();
                        
                        if (channels[channelId]) {
                            // Kanala katƒ±l
                            if (!channels[channelId].users.includes(currentUser.id)) {
                                channels[channelId].users.push(currentUser.id);
                            }
                            // Kanal sekmesini ekle (yoksa)
                            if (!document.querySelector(`.channel-tab[data-channel="${channelId}"]`)) {
                                const tabs = document.getElementById('channelTabs');
                                const tab = document.createElement('div');
                                tab.className = 'channel-tab';
                                tab.textContent = channel;
                                tab.onclick = () => switchChannel(channelId);
                                tabs.appendChild(tab);
                            }
                            // Kanalƒ± se√ß
                            switchChannel(channelId);
                            result = `‚úÖ ${channel} kanalƒ±na katƒ±ldƒ±nƒ±z`;
                        } else {
                            result = `‚ùå ${channel} kanalƒ± bulunamadƒ±`;
                        }
                    } else {
                        result = '‚ùå Kullanƒ±m: /join #kanal';
                    }
                    break;
                    
                case '/msg':
                    if (args.length >= 2) {
                        const target = args[0];
                        const message = args.slice(1).join(' ');
                        result = `üì® ${target}'a mesaj g√∂nderildi: ${message}`;
                    } else {
                        result = '‚ùå Kullanƒ±m: /msg <nick> <mesaj>';
                    }
                    break;
                    
                case '/me':
                    if (args.length >= 1) {
                        const action = args.join(' ');
                        addMessage('system', `* ${currentUser.name} ${action}`);
                        result = `‚úÖ Eylem g√∂sterildi: ${action}`;
                    } else {
                        result = '‚ùå Kullanƒ±m: /me <eylem>';
                    }
                    break;
                    
                case '/clear':
                    document.getElementById('chatMessages').innerHTML = '';
                    result = '‚úÖ Sohbet temizlendi';
                    break;
                    
                case '/kick':
                    if (args.length >= 1 && (currentUser.role === 'owner' || currentUser.role === 'admin')) {
                        const target = args[0];
                        const user = users.find(u => u.name.toLowerCase() === target.toLowerCase());
                        if (user && user.role !== 'owner') {
                            user.online = false;
                            updateOnlineList();
                            result = `‚úÖ ${target} kullanƒ±cƒ±sƒ± atƒ±ldƒ±`;
                        } else {
                            result = `‚ùå ${target} atƒ±lamaz`;
                        }
                    } else {
                        result = '‚ùå Bu komutu kullanma yetkiniz yok';
                    }
                    break;
                    
                default:
                    result = `‚ùå Bilinmeyen komut: ${cmd}\n/help yazarak komutlarƒ± g√∂rebilirsiniz.`;
            }
            
            const div = document.createElement('div');
            div.style.padding = '5px 0';
            div.style.borderBottom = '1px solid var(--border-light)';
            div.innerHTML = `<strong>> ${fullCommand}</strong><br><span style="color: var(--text-secondary)">${result.replace(/\n/g, '<br>')}</span>`;
            output.appendChild(div);
            output.scrollTop = output.scrollHeight;
        }

        // ==================== Dƒ∞ƒûER FONKSƒ∞YONLAR ====================
        function handleCommand(command) {
            // Kƒ±sayol komutlarƒ±
            if (command === '/clear') {
                document.getElementById('chatMessages').innerHTML = '';
            } else if (command.startsWith('/me ')) {
                const action = command.substring(4);
                addMessage('system', `* ${currentUser.name} ${action}`);
            } else {
                addMessage('system', `‚ùå Bilinmeyen komut: ${command}`);
            }
        }

        function sendImage() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    if (file.size > 5 * 1024 * 1024) {
                        alert('Resim √ßok b√ºy√ºk! Max 5MB');
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function() {
                        addMessage('user', 'üì∏ Resim g√∂nderdi');
                        // Resmi g√∂ster (basit demo)
                        setTimeout(() => {
                            addMessage('system', '[Resim y√ºklendi - demo]');
                        }, 500);
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        function toggleTheme() {
            if (theme === 'night') {
                document.body.classList.add('day-mode');
                document.body.classList.remove('night-mode');
                theme = 'day';
            } else {
                document.body.classList.add('night-mode');
                document.body.classList.remove('day-mode');
                theme = 'night';
            }
        }

        function openPrivateChat(user) {
            alert(`${user.name} ile √∂zel sohbet a√ßƒ±lacak (demo)`);
        }

        // ==================== PROFƒ∞L Sƒ∞STEMƒ∞ ====================
        function openProfile() {
            document.getElementById('profileNick').value = currentUser.name;
            document.getElementById('profileAvatar').textContent = currentUser.avatar;
            document.getElementById('sleepMode').checked = currentUser.sleepMode;
            document.getElementById('profileModal').style.display = 'flex';
        }

        function closeProfileModal() {
            document.getElementById('profileModal').style.display = 'none';
        }

        function saveProfile() {
            const newNick = document.getElementById('profileNick').value.trim();
            const sleepMode = document.getElementById('sleepMode').checked;
            
            if (newNick && newNick !== currentUser.name) {
                currentUser.name = newNick;
                currentUser.avatar = newNick.charAt(0).toUpperCase();
            }
            
            currentUser.sleepMode = sleepMode;
            
            closeProfileModal();
            updateOnlineList();
            addMessage('system', '‚úÖ Profil g√ºncellendi');
        }

        // ==================== BA≈ûLANGI√á ====================
        document.addEventListener('DOMContentLoaded', function() {
            // Enter ile giri≈ü
            document.getElementById('nickInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') handleLogin();
            });
            document.getElementById('passInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') handleLogin();
            });
            
            // Ba≈ülangƒ±√ßta MATE bot'u ekle
            users.push({
                id: 'MATE',
                name: 'MATE',
                role: 'admin',
                registered: true,
                online: true,
                sleepMode: false,
                avatar: 'ü§ñ'
            });
            
            // Ba≈ülangƒ±√ßta mateky'yi ekle
            users.push({
                id: 'mateky',
                name: 'mateky',
                role: 'owner',
                registered: true,
                online: true,
                sleepMode: false,
                avatar: 'M'
            });
        });

        // MATE bot sadece sistem mesajlarƒ± atar, normal sohbet etmez
        // Bu zaten addMessage('system', ...) ≈üeklinde √ßalƒ±≈üƒ±yor
    </script>
</body>
</html>
