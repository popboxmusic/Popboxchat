<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Popbox IRC Chat</title>

<style>
body{margin:0;background:#0e0e0e;color:#fff;font-family:Arial}
#video{position:fixed;top:0;left:0;width:100%;height:220px}
#video iframe{width:100%;height:100%}
#chat{position:absolute;top:220px;bottom:70px;left:0;right:0;overflow:auto;padding:10px}
.msg{background:#1c1c1c;margin-bottom:8px;padding:8px;border-radius:8px}
#bar{position:fixed;bottom:0;left:0;right:0;height:70px;display:flex;background:#111}
#msg{flex:1;font-size:16px;border:none;padding:10px}
button{width:80px;border:none;background:#ff3c00;color:#fff;font-weight:bold}
.role{font-size:12px;color:#ff3c00;margin-left:6px}
</style>
</head>
<body>

<div id="video">
<iframe src="https://www.youtube.com/embed/shD--eyF8ug?autoplay=1&mute=1" allow="autoplay"></iframe>
</div>

<div id="chat"></div>

<div id="bar">
<input id="msg" placeholder="Mesaj yaz veya /komut gir"/>
<button onclick="send()">Gönder</button>
</div>

<script>
// ===== IRC ROLE SYSTEM =====
const ROLES = {
  owner: ["popboxmusic"],
  admin: ["popbox"],
  mod: []
};

function getRole(n){
  if(ROLES.owner.includes(n)) return "owner";
  if(ROLES.admin.includes(n)) return "admin";
  if(ROLES.mod.includes(n)) return "mod";
  return "user";
}

let nick = prompt("Nick gir");
let role = getRole(nick);

const banned = new Set();
const kicked = new Set();

const chat = document.getElementById("chat");

function addMsg(n, text, sys=false){
  const d=document.createElement("div");
  d.className="msg";
  if(sys){
    d.innerHTML = `<i>${text}</i>`;
  }else{
    d.innerHTML = `<b>${n}</b><span class="role">[${getRole(n)}]</span>: ${text}`;
    if(role!=="user"){
      const del=document.createElement("span");
      del.innerText=" ❌";
      del.onclick=()=>d.remove();
      d.appendChild(del);
    }
  }
  chat.appendChild(d);
  chat.scrollTop=chat.scrollHeight;
}

// ===== COMMANDS =====
function command(txt){
  const parts = txt.split(" ");
  const cmd = parts[0];

  if(cmd==="/op" && role==="owner"){
    ROLES.mod.push(parts[1]);
    addMsg("", parts[1]+" artık MOD", true);
    return true;
  }

  if(cmd==="/ban" && role!=="user"){
    banned.add(parts[1]);
    addMsg("", parts[1]+" banlandı", true);
    return true;
  }

  if(cmd==="/kick" && role!=="user"){
    kicked.add(parts[1]);
    addMsg("", parts[1]+" kicklendi", true);
    return true;
  }

  if(cmd==="/sil" && role!=="user"){
    chat.innerHTML="";
    return true;
  }

  return false;
}

// ===== SEND =====
function send(){
  const input=document.getElementById("msg");
  const t=input.value.trim();
  if(!t) return;

  if(banned.has(nick)){
    alert("Banlısın!");
    return;
  }

  if(t.startsWith("/")){
    if(command(t)){ input.value=""; return; }
  }

  addMsg(nick, t);
  input.value="";
}

document.addEventListener("keydown",e=>{
  if(e.key==="Enter") send();
});

addMsg("", nick+" giriş yaptı", true);
</script>

</body>
</html>
