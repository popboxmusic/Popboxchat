<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Popbox ‚Ä¢ Yetkili Medya Paneli</title>
    
    <!-- FONTS & ICONS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- FIREBASE -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    
    <!-- YOUTUBE API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    
    <style>
        /* ========== RESET & GLOBAL ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background: #0f0f0f;
            color: #fff;
            overflow: hidden;
            height: 100vh;
            transition: background 0.3s ease;
        }

        .app {
            display: flex;
            height: 100vh;
            width: 100vw;
            position: relative;
        }

        /* ========== SCROLLBAR ========== */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #1a1a1a; }
        ::-webkit-scrollbar-thumb { background: #3f3f3f; border-radius: 4px; }
        * { scrollbar-width: thin; scrollbar-color: #3f3f3f #1a1a1a; }

        /* ========== SOL MEN√ú ========== */
        .sidebar {
            width: 80px;
            background: #0a0a0a;
            border-right: 1px solid #2a2a2a;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 24px 0;
            gap: 24px;
            flex-shrink: 0;
            z-index: 10;
        }

        .menu-item {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 20px;
            position: relative;
        }

        .menu-item:hover { background: #272727; color: #fff; }
        .menu-item.active { color: #fff; background: #3f3f3f; }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff4444;
            color: white;
            font-size: 11px;
            font-weight: 600;
            min-width: 18px;
            height: 18px;
            border-radius: 9px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 4px;
            border: 2px solid #0a0a0a;
        }

        .user-avatar {
            margin-top: auto;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: #1a1a1a;
            border: 2px solid #3f3f3f;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #fff;
            overflow: hidden;
        }

        .user-avatar img { width: 100%; height: 100%; object-fit: cover; }

        /* ========== KULLANICI PANELƒ∞ ========== */
        .users-panel {
            width: 280px;
            background: #0f0f0f;
            border-right: 1px solid #2a2a2a;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .panel-header {
            padding: 20px;
            border-bottom: 1px solid #2a2a2a;
        }

        .panel-header h3 {
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #fff;
        }

        .online-tabs {
            display: flex;
            gap: 8px;
            margin-top: 16px;
        }

        .tab {
            flex: 1;
            padding: 8px;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 20px;
            color: #aaa;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }

        .tab.active {
            background: #272727;
            border-color: #3f3f3f;
            color: #fff;
        }

        .user-list {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .user-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
            margin-bottom: 4px;
        }

        .user-item:hover { background: #1a1a1a; }

        .user-avatar-small {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #1a1a1a;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            color: #fff;
            flex-shrink: 0;
        }

        .user-info { flex: 1; min-width: 0; }
        .user-name {
            font-weight: 500;
            font-size: 14px;
            color: #fff;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .user-status { font-size: 12px; color: #aaa; margin-top: 2px; }
        .online-dot { width: 8px; height: 8px; border-radius: 50%; background: #2ba640; flex-shrink: 0; }

        .private-message-badge {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ff4444;
            color: white;
            font-size: 11px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: auto;
            font-weight: 600;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 68, 68, 0); }
        }

        /* ========== CHAT PANELƒ∞ ========== */
        .chat-panel {
            flex: 1;
            background: #0f0f0f;
            display: flex;
            flex-direction: column;
            min-width: 0;
        }

        .chat-header {
            padding: 16px 24px;
            border-bottom: 1px solid #2a2a2a;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
        }

        .messages {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .message {
            display: flex;
            flex-direction: column;
            max-width: 80%;
            animation: fadeIn 0.3s ease;
        }

        .message.right { align-self: flex-end; }

        .message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }

        .message-sender {
            font-weight: 600;
            font-size: 13px;
            color: #fff;
            cursor: pointer;
        }

        .message-time { font-size: 11px; color: #aaa; }
        .message-text { font-size: 14px; line-height: 1.5; color: #fff; word-break: break-word; }

        .message-media {
            margin-top: 8px;
            max-width: 100%;
            border-radius: 8px;
            cursor: pointer;
        }

        .message-media img { max-width: 100%; max-height: 300px; border-radius: 8px; }
        .message-media video { max-width: 100%; max-height: 300px; border-radius: 8px; }

        .system-message {
            align-self: center;
            color: #aaa;
            font-size: 12px;
            padding: 8px 16px;
            background: #1a1a1a;
            border-radius: 20px;
            margin: 8px 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message-input-container {
            padding: 20px 24px;
            background: #0a0a0a;
            border-top: 1px solid #2a2a2a;
        }

        .input-wrapper {
            display: flex;
            align-items: flex-end;
            gap: 12px;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 28px;
            padding: 8px 8px 8px 20px;
        }

        .message-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #fff;
            font-size: 14px;
            padding: 12px 0;
            resize: none;
            max-height: 120px;
            outline: none;
        }

        .send-btn, .media-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: #272727;
            border: 1px solid #3f3f3f;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 18px;
        }

        .send-btn:hover, .media-btn:hover { background: #3f3f3f; }

        /* ========== MEDYA PANELƒ∞ ========== */
        .media-panel {
            width: 500px;
            background: #0a0a0a;
            border-left: 1px solid #2a2a2a;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .media-header {
            padding: 16px 20px;
            border-bottom: 1px solid #2a2a2a;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .media-tabs {
            display: flex;
            gap: 8px;
        }

        .media-tab {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #1a1a1a;
            color: #aaa;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 20px;
            position: relative;
        }

        .media-tab.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .media-tab.active { background: #ff0000; color: #fff; }
        .media-tab.spotify.active { background: #1db954; }
        .media-tab.live.active {
            background: #ff4444;
            animation: pulse 2s infinite;
        }

        .media-controls {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .control-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .control-btn:hover { background: #272727; }
        .control-btn.disabled {
            opacity: 0.4;
            cursor: not-allowed;
            pointer-events: none;
        }

        .admin-badge {
            font-size: 10px;
            color: #ff0000;
            margin-left: 4px;
            font-weight: normal;
        }

        /* ========== YOUTUBE PLAYER ========== */
        .youtube-player {
            width: 100%;
            aspect-ratio: 16/9;
            background: #000;
            border-bottom: 1px solid #2a2a2a;
            display: none;
            position: relative;
        }

        #youtubeContainer { width: 100%; height: 100%; }

        .user-youtube-controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: center;
            gap: 20px;
            z-index: 200;
            pointer-events: auto;
        }

        .user-youtube-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(0,0,0,0.8);
            border: 2px solid #fff;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 20px;
            backdrop-filter: blur(4px);
        }

        .user-youtube-btn:hover {
            background: #ff0000;
            border-color: #ff0000;
            transform: scale(1.1);
        }

        /* ========== SPOTIFY PLAYER ========== */
        .spotify-player {
            width: 100%;
            height: 352px;
            background: #121212;
            border-bottom: 1px solid #2a2a2a;
            display: none;
            position: relative;
        }

        .spotify-player iframe { width: 100%; height: 100%; border: none; }

        /* ========== CANLI YAYIN PLAYER ========== */
        .live-player {
            width: 100%;
            aspect-ratio: 16/9;
            background: #000;
            border-bottom: 1px solid #2a2a2a;
            display: none;
            position: relative;
        }

        .live-player video { width: 100%; height: 100%; object-fit: cover; }

        .live-status {
            position: absolute;
            top: 16px;
            left: 16px;
            background: rgba(255,68,68,0.9);
            color: #fff;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 100;
        }

        .live-status i { animation: blink 1s infinite; }

        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        .live-controls {
            position: absolute;
            bottom: 16px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 16px;
            z-index: 100;
        }

        .live-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(0,0,0,0.7);
            border: 2px solid #fff;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 20px;
        }

        .live-btn:hover { background: #ff4444; border-color: #ff4444; }
        .live-btn.stop { background: #ff4444; border-color: #ff4444; }
        .live-btn.disabled { opacity: 0.4; cursor: not-allowed; pointer-events: none; }

        /* ========== ≈ûU AN YAYINDA ========== */
        .now-playing-bar {
            padding: 10px 20px;
            background: #0f0f0f;
            border-bottom: 1px solid #2a2a2a;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 13px;
        }

        .now-playing-bar i { color: #ff0000; }
        .now-playing-bar.spotify i { color: #1db954; }
        .now-playing-bar.live i { color: #ff4444; }

        /* ========== PLAYLIST ========== */
        .playlist {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .playlist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #2a2a2a;
        }

        .playlist-title {
            font-weight: 600;
            font-size: 15px;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .playlist-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 6px;
            border: 1px solid transparent;
            transition: background 0.2s;
        }

        .playlist-item.authorized { cursor: pointer; }
        .playlist-item.authorized:hover {
            background: #1a1a1a;
            border-color: #2a2a2a;
        }

        .playlist-item.unauthorized { cursor: default; opacity: 0.9; }

        .playlist-item.active {
            background: #1a1a1a;
            border-left: 4px solid #ff0000;
        }

        .playlist-item.spotify.active { border-left-color: #1db954; }
        .playlist-item.live.active { border-left-color: #ff4444; }

        .playlist-thumb {
            width: 50px;
            height: 50px;
            border-radius: 6px;
            background: #1a1a1a;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            font-size: 22px;
            flex-shrink: 0;
        }

        .playlist-info { flex: 1; min-width: 0; }
        .playlist-title-text {
            font-weight: 500;
            font-size: 14px;
            color: #fff;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .playlist-meta {
            font-size: 12px;
            color: #aaa;
            margin-top: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .role-badge {
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 12px;
            background: #272727;
            color: #ccc;
        }

        .role-badge.owner { background: rgba(255,215,0,0.2); color: #ffd700; }
        .role-badge.admin { background: rgba(255,0,0,0.2); color: #ff6b6b; }
        .role-badge.coadmin { background: rgba(100,149,237,0.2); color: #6495ed; }

        .playlist-actions {
            display: flex;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .playlist-item.authorized:hover .playlist-actions { opacity: 1; }

        .playlist-action {
            width: 34px;
            height: 34px;
            border-radius: 50%;
            background: #272727;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .playlist-action:hover { background: #3f3f3f; }

        /* ========== MODAL ========== */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.85);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .modal.active { display: flex; }

        .modal-content {
            width: 500px;
            max-width: 90%;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .modal-header h3 { font-size: 20px; font-weight: 600; color: #fff; }

        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #272727;
            border: none;
            color: #fff;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .modal-input {
            width: 100%;
            padding: 16px;
            background: #0f0f0f;
            border: 1px solid #2a2a2a;
            border-radius: 10px;
            color: #fff;
            font-size: 15px;
            margin-bottom: 16px;
        }

        .modal-input:focus { outline: none; border-color: #ff0000; }

        .modal-btn {
            width: 100%;
            padding: 16px;
            background: #ff0000;
            border: none;
            border-radius: 10px;
            color: #fff;
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-btn.spotify { background: #1db954; }
        .modal-btn.live { background: #ff4444; }
        .modal-btn:hover { opacity: 0.9; transform: translateY(-1px); }

        /* ========== LOGIN ========== */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #0f0f0f;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        .login-box {
            width: 420px;
            max-width: 90%;
            background: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 24px;
            padding: 40px;
        }

        .login-logo {
            display: flex;
            justify-content: center;
            margin-bottom: 32px;
        }

        .login-logo i { font-size: 56px; color: #ff0000; }

        .login-title {
            font-size: 28px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 8px;
            color: #fff;
        }

        .login-subtitle {
            text-align: center;
            color: #aaa;
            font-size: 14px;
            margin-bottom: 32px;
        }

        .password-wrapper {
            position: relative;
            width: 100%;
            margin-bottom: 16px;
        }

        .login-input {
            width: 100%;
            padding: 16px;
            padding-right: 50px;
            background: #0f0f0f;
            border: 1px solid #2a2a2a;
            border-radius: 12px;
            color: #fff;
            font-size: 15px;
        }

        .password-toggle {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: #aaa;
            cursor: pointer;
            font-size: 18px;
        }

        .password-toggle:hover { color: #fff; }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: #ff0000;
            border: none;
            border-radius: 12px;
            color: #fff;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 20px;
        }

        .login-btn:hover {
            background: #cc0000;
            transform: translateY(-2px);
        }

        .login-error {
            background: rgba(255,0,0,0.1);
            border: 1px solid #ff0000;
            border-radius: 8px;
            padding: 12px;
            color: #ff6b6b;
            font-size: 13px;
            display: none;
            margin-bottom: 16px;
        }

        .hidden { display: none !important; }

        .login-youtube-bg {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 2900;
            opacity: 0.15;
            pointer-events: none;
        }

        .login-youtube-bg iframe {
            width: 100vw;
            height: 100vh;
            pointer-events: none;
        }

        /* ========== MEDYA UPLOAD ========== */
        .media-upload-btn {
            background: #272727;
            color: #fff;
            padding: 12px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            margin-bottom: 16px;
            transition: all 0.2s;
        }

        .media-upload-btn:hover { background: #3f3f3f; }

        #mediaPreview {
            max-width: 100%;
            max-height: 200px;
            margin-top: 16px;
            border-radius: 8px;
            display: none;
        }

        /* ========== AKTƒ∞F PANEL ========== */
        .active-panel-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: #fff;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            border: 1px solid #3f3f3f;
            z-index: 9999;
        }

        /* ========== ≈ûƒ∞KAYET ========== */
        .complaint-reason { margin-bottom: 16px; }
        .complaint-reason label {
            display: block;
            margin-bottom: 8px;
            color: #fff;
            font-size: 14px;
        }
        .complaint-reason select, .complaint-reason textarea {
            width: 100%;
            padding: 12px;
            background: #0f0f0f;
            border: 1px solid #2a2a2a;
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
        }

        /* ========== üì± YOUTUBE TARZI MOBƒ∞L - SON VERSƒ∞YON ========== */
        @media screen and (max-width: 768px) {
            body {
                position: fixed;
                width: 100%;
                height: 100%;
                overflow: hidden;
            }
            
            .app {
                flex-direction: column;
                height: 100vh;
                overflow: hidden;
            }
            
            /* 1Ô∏è‚É£ Vƒ∞DEO - √úSTTE SABƒ∞T (YouTube boyutu) */
            .media-panel {
                width: 100%;
                order: 1;
                border-left: none;
                border-bottom: 1px solid #2a2a2a;
                flex-shrink: 0;
                max-height: 240px;
            }
            
            .youtube-player, .live-player {
                aspect-ratio: 16/9;
                max-height: 200px;
                width: 100%;
            }
            
            .spotify-player {
                height: 200px;
            }
            
            .now-playing-bar {
                padding: 6px 12px;
                font-size: 11px;
            }
            
            /* 2Ô∏è‚É£ SOHBET - ORTADA, TAM EKRAN, KAYDIRILABƒ∞Lƒ∞R */
            .chat-panel {
                width: 100%;
                order: 2;
                flex: 1;
                height: auto !important;
                min-height: 0;
                display: flex;
                flex-direction: column;
                overflow: hidden;
            }
            
            .chat-header {
                padding: 10px 16px;
                flex-shrink: 0;
            }
            
            .messages {
                flex: 1;
                overflow-y: auto;
                padding: 12px;
                -webkit-overflow-scrolling: touch;
            }
            
            .message {
                max-width: 95%;
                margin-bottom: 8px;
            }
            
            .message-text {
                font-size: 14px;
            }
            
            .message-input-container {
                padding: 10px 16px;
                flex-shrink: 0;
            }
            
            .input-wrapper {
                padding: 4px 4px 4px 16px;
            }
            
            .message-input {
                padding: 8px 0;
                font-size: 14px;
            }
            
            /* 3Ô∏è‚É£ KULLANICI Lƒ∞STESƒ∞ - ALTA SABƒ∞T, ƒ∞KONA TIKLA A√áILIR */
            .users-panel {
                position: fixed;
                bottom: 60px;
                left: 0;
                right: 0;
                top: auto;
                height: 70vh;
                width: 100%;
                border-right: none;
                border-top: 1px solid #2a2a2a;
                background: #0f0f0f;
                z-index: 1000;
                transform: translateY(100%);
                transition: transform 0.3s ease;
                display: none;
                border-radius: 20px 20px 0 0;
                box-shadow: 0 -5px 20px rgba(0,0,0,0.5);
            }
            
            .users-panel.active {
                transform: translateY(0);
                display: flex !important;
            }
            
            .users-panel .panel-header {
                padding: 16px;
            }
            
            .user-list {
                max-height: calc(70vh - 80px);
            }
            
            /* 4Ô∏è‚É£ ALT MEN√ú - SABƒ∞T, YOUTUBE TARZI */
            .sidebar {
                width: 100%;
                height: 60px;
                flex-direction: row;
                padding: 0 12px;
                justify-content: space-around;
                align-items: center;
                order: 4;
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                border-right: none;
                border-top: 1px solid #2a2a2a;
                background: #0a0a0a;
                z-index: 1001;
                flex-shrink: 0;
            }
            
            .sidebar .menu-item {
                width: 44px;
                height: 44px;
                font-size: 20px;
                margin: 0;
            }
            
            .sidebar .user-avatar {
                width: 40px;
                height: 40px;
                margin-top: 0;
            }
            
            /* 5Ô∏è‚É£ MOBƒ∞L KONTROL BUTONLARI */
            .user-youtube-controls {
                bottom: 10px;
                gap: 15px;
            }
            
            .user-youtube-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            /* 6Ô∏è‚É£ PLAYLIST D√úZENƒ∞ */
            .playlist {
                padding: 12px;
            }
            
            .playlist-item {
                padding: 8px;
            }
            
            .playlist-thumb {
                width: 36px;
                height: 36px;
                font-size: 16px;
            }
            
            .playlist-title-text {
                font-size: 13px;
            }
            
            /* 7Ô∏è‚É£ MODAL D√úZENƒ∞ */
            .modal-content {
                width: 95%;
                padding: 20px;
                max-height: 80vh;
                overflow-y: auto;
            }
            
            .login-box {
                width: 90%;
                padding: 30px 20px;
            }
            
            .active-panel-indicator {
                bottom: 70px;
                right: 10px;
                font-size: 10px;
                padding: 6px 12px;
                z-index: 1002;
            }
            
            /* 8Ô∏è‚É£ OWNER BUTONU */
            #ownerPanelBtn {
                width: 44px;
                height: 44px;
            }
            
            /* 9Ô∏è‚É£ Gƒ∞Rƒ∞≈û EKRANI */
            .login-youtube-bg iframe {
                width: 100vw;
                height: 100vh;
            }
        }

        /* Tablet */
        @media screen and (min-width: 769px) and (max-width: 1024px) {
            .media-panel { width: 400px; }
            .users-panel { width: 240px; }
            .youtube-player, .live-player { max-height: 225px; }
        }
    </style>
</head>
<body>
    <!-- LOGIN YOUTUBE BACKGROUND -->
    <div id="loginYoutubeBg" class="login-youtube-bg">
        <iframe id="loginYoutubeIframe" src="https://www.youtube.com/embed/jfKfPfyJRdk?autoplay=1&mute=1&controls=0&modestbranding=1&rel=0&disablekb=1&fs=0&iv_load_policy=3&playsinline=1&loop=1&playlist=jfKfPfyJRdk" allow="autoplay; encrypted-media"></iframe>
    </div>
    
    <!-- LOGIN -->
    <div id="loginOverlay" class="login-overlay">
        <div class="login-box">
            <div class="login-logo">
                <i class="fab fa-youtube"></i>
            </div>
            <h2 class="login-title">Popbox</h2>
            <p class="login-subtitle">Yetkili medya kontrol paneli</p>
            
            <input type="text" id="nickname" class="login-input" placeholder="Kullanƒ±cƒ± adƒ±" autocomplete="off">
            
            <div class="password-wrapper">
                <input type="password" id="password" class="login-input" placeholder="≈ûifre" autocomplete="off">
                <i class="fas fa-eye password-toggle" id="passwordToggle"></i>
            </div>
            
            <div id="loginError" class="login-error"></div>
            
            <button id="loginBtn" class="login-btn">
                <i class="fas fa-sign-in-alt"></i> Giri≈ü Yap
            </button>
            
            <p style="color: #666; font-size: 12px; text-align: center;">
                üëë MateKy (owner) ‚Ä¢ ‚ö° popbox (admin) ‚Ä¢ ‚ö° popboxmusic (admin) ‚Ä¢ üîß coadmin
            </p>
        </div>
    </div>

    <!-- ANA UYGULAMA -->
    <div id="app" class="app hidden">
        <!-- SOL MEN√ú - YENƒ∞ ƒ∞KON PANELƒ∞ -->
        <div class="sidebar">
            <!-- TEMA -->
            <div id="themeToggle" class="menu-item" onclick="toggleTheme()" title="Tema deƒüi≈ütir">
                <i id="themeIcon" class="fas fa-moon"></i>
            </div>
            
            <!-- KULLANICILAR -->
            <div class="menu-item active" onclick="showUsersPanel(); closeAllModals();" title="Kullanƒ±cƒ±lar">
                <i class="fas fa-users"></i>
                <span id="onlineUserBadge" class="notification-badge" style="display: none;">0</span>
            </div>
            
            <!-- Bƒ∞LDƒ∞Rƒ∞MLER -->
            <div class="menu-item" onclick="toggleNotificationPanel(); closeAllModals();" title="Bildirimler">
                <i class="fas fa-bell"></i>
                <span id="notificationBadge" class="notification-badge" style="display: none;">0</span>
            </div>
            
            <!-- POPBOX MEDYA -->
            <div class="menu-item" onclick="focusMediaPanel()" title="Popbox Medya">
                <i class="fab fa-youtube" style="color: #ff0000;"></i>
            </div>
            
            <!-- KANAL Lƒ∞STESƒ∞ -->
            <div class="menu-item" onclick="showComingSoon('Kanal listesi yakƒ±nda aktif olacak!')" title="Kanallar (yakƒ±nda)">
                <i class="fas fa-list-ul"></i>
            </div>
            
            <!-- OWNER PANEL BUTONU -->
            <div id="ownerPanelBtn" class="menu-item" style="display: none; border: 2px solid #ffd700;" 
                 onclick="window.location.href='owner.html'" title="üëë Owner Paneli">
                <i class="fas fa-crown" style="color: #ffd700;"></i>
            </div>
            
            <!-- PROFƒ∞L -->
            <div class="user-avatar" id="userAvatar" onclick="openProfilePanel()" title="Profil Ayarlarƒ±">
                <span id="avatarText"></span>
                <img id="avatarImg" src="" style="display:none;">
            </div>
        </div>

        <!-- KULLANICI PANELƒ∞ -->
        <div class="users-panel">
            <div class="panel-header">
                <h3><i class="fas fa-users"></i> Kullanƒ±cƒ±lar</h3>
                <div class="online-tabs">
                    <div class="tab active" onclick="switchUserTab('online')" id="onlineTab">√áevrimi√ßi (0)</div>
                    <div class="tab" onclick="switchUserTab('chatting')" id="chattingTab">Sohbette (0)</div>
                </div>
            </div>
            <div class="user-list" id="userList"></div>
        </div>

        <!-- CHAT PANELƒ∞ -->
        <div class="chat-panel">
            <div class="chat-header">
                <div class="chat-title">
                    <i class="fas fa-hashtag"></i>
                    <span id="currentChannel">genel</span>
                    <span id="onlineCount" style="color:#aaa; font-size:13px; margin-left:8px;"></span>
                </div>
                <div id="privateChatControls" style="display: none; gap: 8px;">
                    <button class="control-btn" onclick="blockUser24h()" title="24 saat engelle">
                        <i class="fas fa-ban"></i>
                    </button>
                    <button class="control-btn" onclick="reportUser()" title="≈ûikayet et">
                        <i class="fas fa-flag"></i>
                    </button>
                    <button class="control-btn" onclick="closePrivateChat()" title="Pencereyi kapat">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <div class="messages" id="messages"></div>
            
            <div class="message-input-container">
                <div class="input-wrapper">
                    <textarea id="messageInput" class="message-input" placeholder="Mesaj yazƒ±n..." rows="1" oninput="autoResize(this)"></textarea>
                    <div class="media-btn" id="mediaUploadBtn" onclick="openMediaUploadModal()" title="Resim/Video g√∂nder" style="display: none;">
                        <i class="fas fa-paperclip"></i>
                    </div>
                    <div class="send-btn" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- MEDYA PANELƒ∞ -->
        <div class="media-panel">
            <div class="media-header">
                <div class="media-tabs">
                    <div class="media-tab" onclick="switchMediaTab('youtube')" id="youtubeTab">
                        <i class="fab fa-youtube"></i>
                    </div>
                    <div class="media-tab spotify" onclick="switchMediaTab('spotify')" id="spotifyTab">
                        <i class="fab fa-spotify"></i>
                    </div>
                    <div class="media-tab live" onclick="switchMediaTab('live')" id="liveTab">
                        <i class="fas fa-video"></i>
                    </div>
                </div>
                <div class="media-controls">
                    <div class="control-btn" id="addMediaBtn" onclick="openAddMediaModal()" title="Ekle">
                        <i class="fas fa-plus"></i>
                    </div>
                    <span class="admin-badge" id="adminBadge">SADECE YETKƒ∞Lƒ∞</span>
                    <div class="control-btn" id="clearPlaylistBtn" onclick="clearPlaylist()" title="Temizle">
                        <i class="fas fa-trash"></i>
                    </div>
                </div>
            </div>
            
            <!-- ≈ûU AN YAYINDA -->
            <div id="nowPlayingBar" class="now-playing-bar">
                <i class="fas fa-circle" style="color: #ff0000; font-size: 10px;"></i>
                <span id="nowPlayingText">YouTube: Popbox Radio ‚Ä¢ 24/7 Canlƒ± M√ºzik</span>
                <span id="startedByText" style="color: #aaa; margin-left: auto;">üëë MateKy</span>
            </div>
            
            <!-- YOUTUBE PLAYER -->
            <div id="youtubePlayer" class="youtube-player">
                <div id="youtubeContainer"></div>
                <div id="userYoutubeControls" class="user-youtube-controls">
                    <div class="user-youtube-btn" id="youtubeMuteBtn" onclick="toggleMute()" title="Ses a√ß/kapat">
                        <i class="fas fa-volume-up" id="muteIcon"></i>
                    </div>
                    <div class="user-youtube-btn" id="youtubePlayPauseBtn" onclick="togglePlayPause()" title="Oynat/durdur">
                        <i class="fas fa-pause" id="playPauseIcon"></i>
                    </div>
                </div>
            </div>
            
            <!-- SPOTIFY PLAYER -->
            <div id="spotifyPlayer" class="spotify-player">
                <iframe id="spotifyIframe" src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M?utm_source=generator" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture" loading="lazy"></iframe>
            </div>
            
            <!-- CANLI YAYIN PLAYER -->
            <div id="livePlayer" class="live-player">
                <video id="liveVideo" autoplay playsinline></video>
                <div class="live-status">
                    <i class="fas fa-circle"></i> CANLI YAYIN
                </div>
                <div class="live-controls">
                    <div class="live-btn" id="switchCameraBtn" onclick="switchCamera()" title="Kamera deƒüi≈ütir">
                        <i class="fas fa-camera-retro"></i>
                    </div>
                    <div class="live-btn stop" id="stopLiveBtn" onclick="stopLiveStream()" title="Yayƒ±nƒ± durdur">
                        <i class="fas fa-stop"></i>
                    </div>
                </div>
            </div>
            
            <!-- PLAYLIST -->
            <div class="playlist" id="playlist"></div>
        </div>
    </div>

    <!-- MODALLAR -->
    <div id="addMediaModal" class="modal"><div class="modal-content"><div class="modal-header"><h3 id="modalTitle">YouTube Video Ekle</h3><button class="modal-close" onclick="closeAddMediaModal()"><i class="fas fa-times"></i></button></div><input type="text" id="mediaUrl" class="modal-input" placeholder="Video/Playlist URL'si veya ID'si"><input type="text" id="mediaTitle" class="modal-input" placeholder="Ba≈ülƒ±k"><button id="addMediaConfirmBtn" class="modal-btn" onclick="addToPlaylist()"><i class="fas fa-plus"></i> Playlist'e Ekle</button></div></div>
    <div id="mediaUploadModal" class="modal"><div class="modal-content"><div class="modal-header"><h3><i class="fas fa-paperclip"></i> Resim/Video G√∂nder</h3><button class="modal-close" onclick="closeMediaUploadModal()"><i class="fas fa-times"></i></button></div><div class="media-upload-btn" onclick="document.getElementById('mediaFileInput').click()"><i class="fas fa-cloud-upload-alt"></i> Dosya Se√ß</div><input type="file" id="mediaFileInput" accept="image/*,video/*" style="display: none;"><div style="display: flex; gap: 8px; margin-top: 16px;"><input type="text" id="mediaCaption" class="modal-input" placeholder="Ba≈ülƒ±k (isteƒüe baƒülƒ±)" style="margin-bottom: 0;"></div><img id="mediaPreview" src="#" alt="√ñnizleme"><button class="modal-btn" onclick="sendPrivateMedia()" style="margin-top: 16px;"><i class="fas fa-paper-plane"></i> G√∂nder</button></div></div>
    <div id="liveStreamModal" class="modal"><div class="modal-content"><div class="modal-header"><h3><i class="fas fa-video" style="color: #ff4444;"></i> Canlƒ± Yayƒ±n Ba≈ülat</h3><button class="modal-close" onclick="closeLiveStreamModal()"><i class="fas fa-times"></i></button></div><input type="text" id="liveTitle" class="modal-input" placeholder="Yayƒ±n ba≈ülƒ±ƒüƒ±"><textarea id="liveDescription" class="modal-input" placeholder="Yayƒ±n a√ßƒ±klamasƒ±" rows="3" style="resize: none;"></textarea><button class="modal-btn live" onclick="startLiveStream()"><i class="fas fa-video"></i> Yayƒ±nƒ± Ba≈ülat</button></div></div>
    <div id="profileModal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Profil</h3><button class="modal-close" onclick="closeProfileModal()"><i class="fas fa-times"></i></button></div><div style="display: flex; flex-direction: column; gap: 20px;"><div style="display: flex; align-items: center; gap: 20px; padding: 20px; background: #0f0f0f; border-radius: 12px;"><div class="user-avatar" style="width: 70px; height: 70px;"><span id="profileAvatarText" style="font-size: 28px;"></span></div><div><div id="profileName" style="font-weight: 600; font-size: 18px; margin-bottom: 6px;"></div><div id="profileRole" style="color: #aaa; font-size: 14px;"></div></div></div><button class="modal-btn" onclick="uploadAvatar()" style="background: #272727;"><i class="fas fa-camera"></i> Fotoƒüraf Y√ºkle</button><button class="modal-btn" onclick="logout()" style="background: #272727;"><i class="fas fa-sign-out-alt"></i> √áƒ±kƒ±≈ü Yap</button></div></div></div>
    <div id="profilePanelModal" class="modal"><div class="modal-content" style="width: 500px; max-width: 95%;"><div class="modal-header"><h3><i class="fas fa-user-circle"></i> Profil Ayarlarƒ±</h3><button class="modal-close" onclick="closeProfilePanelModal()"><i class="fas fa-times"></i></button></div><div style="padding: 20px;"><div style="display: flex; align-items: center; gap: 24px; margin-bottom: 32px; padding: 16px; background: #0f0f0f; border-radius: 16px;"><div class="user-avatar" style="width: 80px; height: 80px; border: 3px solid #3f3f3f; margin-top: 0;"><span id="profileAvatarText2" style="font-size: 36px;"></span><img id="profileAvatarImg" src="" style="display:none; width: 100%; height: 100%; object-fit: cover; border-radius: 50%;"></div><div style="flex: 1;"><div id="profileDisplayName" style="font-size: 24px; font-weight: 700; margin-bottom: 4px;"></div><div id="profileDisplayRole" style="color: #aaa; font-size: 14px; display: flex; align-items: center; gap: 8px;"><span id="profileRoleBadge"></span><span id="profileUserId">#1234</span></div></div></div><div style="display: flex; flex-direction: column; gap: 8px;"><div onclick="uploadProfileImage()" style="display: flex; align-items: center; gap: 16px; padding: 14px; background: #0f0f0f; border-radius: 12px; cursor: pointer; transition: 0.2s;" onmouseover="this.style.background='#1a1a1a'" onmouseout="this.style.background='#0f0f0f'"><i class="fas fa-camera" style="width: 20px; color: #ffd700;"></i><span style="flex: 1; font-weight: 500;">Profil resmi deƒüi≈ütir</span><span style="color: #aaa; font-size: 12px;">JPG, PNG</span></div><div onclick="changeNickname()" style="display: flex; align-items: center; gap: 16px; padding: 14px; background: #0f0f0f; border-radius: 12px; cursor: pointer; transition: 0.2s;" onmouseover="this.style.background='#1a1a1a'" onmouseout="this.style.background='#0f0f0f'"><i class="fas fa-tag" style="width: 20px; color: #1db954;"></i><span style="flex: 1; font-weight: 500;">Kullanƒ±cƒ± adƒ± deƒüi≈ütir</span><span style="color: #aaa; font-size: 12px;" id="currentNicknameDisplay"></span></div><div onclick="changePassword()" style="display: flex; align-items: center; gap: 16px; padding: 14px; background: #0f0f0f; border-radius: 12px; cursor: pointer; transition: 0.2s;" onmouseover="this.style.background='#1a1a1a'" onmouseout="this.style.background='#0f0f0f'"><i class="fas fa-lock" style="width: 20px; color: #ff4444;"></i><span style="flex: 1; font-weight: 500;">≈ûifre deƒüi≈ütir</span><span style="color: #aaa; font-size: 12px;">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span></div><div onclick="togglePrivateMode('global')" style="display: flex; align-items: center; gap: 16px; padding: 14px; background: #0f0f0f; border-radius: 12px; cursor: pointer; transition: 0.2s;" onmouseover="this.style.background='#1a1a1a'" onmouseout="this.style.background='#0f0f0f'"><i class="fas fa-globe" style="width: 20px; color: #3498db;"></i><span style="flex: 1; font-weight: 500;">√ñzele kapat (genel)</span><span id="globalPrivateStatus" style="color: #ff4444; font-size: 12px; font-weight: 600;">A√ßƒ±k</span></div><div onclick="togglePrivateMode('nick')" style="display: flex; align-items: center; gap: 16px; padding: 14px; background: #0f0f0f; border-radius: 12px; cursor: pointer; transition: 0.2s;" onmouseover="this.style.background='#1a1a1a'" onmouseout="this.style.background='#0f0f0f'"><i class="fas fa-user-secret" style="width: 20px; color: #9b59b6;"></i><span style="flex: 1; font-weight: 500;">√ñzele kapat (nick)</span><span id="nickPrivateStatus" style="color: #ff4444; font-size: 12px; font-weight: 600;">A√ßƒ±k</span></div><div onclick="showComingSoon('Kanal a√ßma √∂zelliƒüi yakƒ±nda aktif olacak!')" style="display: flex; align-items: center; gap: 16px; padding: 14px; background: #0f0f0f; border-radius: 12px; cursor: pointer; transition: 0.2s;" onmouseover="this.style.background='#1a1a1a'" onmouseout="this.style.background='#0f0f0f'"><i class="fas fa-plus-circle" style="width: 20px; color: #ffd700;"></i><span style="flex: 1; font-weight: 500;">Kanal a√ß</span><span style="color: #aaa; font-size: 12px;">Yakƒ±nda</span></div><div onclick="logout()" style="display: flex; align-items: center; gap: 16px; padding: 14px; background: #ff4444; border-radius: 12px; cursor: pointer; transition: 0.2s; margin-top: 16px;" onmouseover="this.style.background='#cc0000'" onmouseout="this.style.background='#ff4444'"><i class="fas fa-sign-out-alt" style="width: 20px; color: #fff;"></i><span style="flex: 1; font-weight: 600; color: #fff;">G√ºvenli √ßƒ±kƒ±≈ü yap</span></div></div></div></div></div>
    <div id="ownerPanelModal" class="modal"><div class="modal-content" style="width: 800px; max-width: 95%; max-height: 80vh; overflow-y: auto;"><div class="modal-header"><h3><i class="fas fa-crown" style="color: #ffd700;"></i> Owner Paneli ‚Ä¢ Tam Yetki</h3><button class="modal-close" onclick="closeOwnerPanelModal()"><i class="fas fa-times"></i></button></div><div style="padding: 20px;"><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px;"><div style="background: #0f0f0f; padding: 16px; border-radius: 12px;"><div style="color: #aaa; font-size: 12px;">Online Kullanƒ±cƒ±</div><div style="font-size: 32px; font-weight: 700; color: #fff;" id="ownerStatOnline">0</div></div><div style="background: #0f0f0f; padding: 16px; border-radius: 12px;"><div style="color: #aaa; font-size: 12px;">√ñzel Mesaj</div><div style="font-size: 32px; font-weight: 700; color: #fff;" id="ownerStatPrivate">0</div></div></div><button onclick="clearAllPrivateMessages()" class="modal-btn" style="background: #ff4444;"><i class="fas fa-trash-alt"></i> T√úM √ñZEL MESAJLARI Sƒ∞L</button></div></div></div>
    <div id="adminPanelModal" class="modal"><div class="modal-content" style="width: 500px; max-width: 95%;"><div class="modal-header"><h3><i class="fas fa-bolt" style="color: #ff0000;"></i> Admin Paneli</h3><button class="modal-close" onclick="closeAdminPanelModal()"><i class="fas fa-times"></i></button></div><div style="padding: 20px;"><p style="color: #ff0000; text-align: center;">Admin yetkileri yakƒ±nda...</p></div></div></div>
    <div id="coAdminPanelModal" class="modal"><div class="modal-content" style="width: 500px; max-width: 95%;"><div class="modal-header"><h3><i class="fas fa-tools" style="color: #6495ed;"></i> Co-Admin Paneli</h3><button class="modal-close" onclick="closeCoAdminPanelModal()"><i class="fas fa-times"></i></button></div><div style="padding: 20px;"><p style="color: #6495ed; text-align: center;">Co-Admin yetkileri yakƒ±nda...</p></div></div></div>
    <div id="operatorPanelModal" class="modal"><div class="modal-content" style="width: 500px; max-width: 95%;"><div class="modal-header"><h3><i class="fas fa-shield-alt" style="color: #ffa500;"></i> Operator Paneli</h3><button class="modal-close" onclick="closeOperatorPanelModal()"><i class="fas fa-times"></i></button></div><div style="padding: 20px;"><p style="color: #ffa500; text-align: center;">Operator yetkileri yakƒ±nda...</p></div></div></div>
    <div id="complaintModal" class="modal"><div class="modal-content"><div class="modal-header"><h3><i class="fas fa-flag" style="color: #ff4444;"></i> Kullanƒ±cƒ± ≈ûikayet Et</h3><button class="modal-close" onclick="closeComplaintModal()"><i class="fas fa-times"></i></button></div><div id="complaintUserInfo" style="margin-bottom: 16px; padding: 12px; background: #0f0f0f; border-radius: 8px;"><span id="complaintUsername" style="font-weight: 600;"></span> kullanƒ±cƒ±sƒ±nƒ± ≈üikayet ediyorsunuz.</div><div class="complaint-reason"><label>≈ûikayet Sebebi</label><select id="complaintReason" class="modal-input"><option value="spam">Spam / Reklam</option><option value="harassment">Taciz / Hakaret</option><option value="inappropriate">Uygunsuz ƒ∞√ßerik</option><option value="other">Diƒüer</option></select></div><div class="complaint-reason"><label>A√ßƒ±klama (ƒ∞steƒüe baƒülƒ±)</label><textarea id="complaintDescription" class="modal-input" rows="3" placeholder="Detaylƒ± a√ßƒ±klama..."></textarea></div><button class="modal-btn" onclick="submitComplaint()" style="background: #ff4444;"><i class="fas fa-paper-plane"></i> ≈ûikayeti G√∂nder</button></div></div>

    <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
    <input type="file" id="profileImageUpload" accept="image/*" style="display: none;">

    <div id="activePanelIndicator" class="active-panel-indicator">Panel: Genel Sohbet</div>

    <script>
        // ========== FIREBASE KONFƒ∞G ==========
        const firebaseConfig = {
            apiKey: "AIzaSyCrn_tXJZCAlKhem45aXxj4f0h26EPOQ70",
            authDomain: "popboxmusicchat.firebaseapp.com",
            databaseURL: "https://popboxmusicchat-default-rtdb.firebaseio.com",
            projectId: "popboxmusicchat",
            storageBucket: "popboxmusicchat.appspot.com",
            messagingSenderId: "206625719024",
            appId: "1:206625719024:web:d28f478a2c96d10412f835"
        };

        // ========== GLOBAL DEƒûƒ∞≈ûKENLER ==========
        let database;
        let storage;
        let currentUser = null;
        let isOwner = false;
        let isAdmin = false;
        let isCoAdmin = false;
        let isOperator = false;
        
        let globalMediaState = {
            activeTab: 'youtube',
            youtubeId: 'jfKfPfyJRdk',
            youtubeTitle: 'Popbox Radio ‚Ä¢ 24/7 Canlƒ± M√ºzik',
            spotifyId: '37i9dQZF1DXcBWIGoYBM5M',
            spotifyTitle: 'Popbox Spotify ‚Ä¢ G√ºn√ºn Hitleri',
            liveActive: false,
            liveTitle: '',
            startedBy: 'MateKy',
            startedByRole: 'owner',
            timestamp: Date.now()
        };
        
        let youtubePlaylist = [
            { id: 'jfKfPfyJRdk', title: 'Popbox Radio ‚Ä¢ 24/7 Canlƒ± M√ºzik', addedBy: 'MateKy', role: 'owner', timestamp: Date.now() }
        ];
        
        let spotifyPlaylist = [
            { id: '37i9dQZF1DXcBWIGoYBM5M', title: 'Popbox Spotify ‚Ä¢ G√ºn√ºn Hitleri', addedBy: 'MateKy', role: 'owner', type: 'playlist', timestamp: Date.now() }
        ];
        
        let liveStreams = [];
        let onlineUsers = [];
        let heartbeatInterval = null;
        let privateChats = {};
        let activePrivateChat = null;
        let currentTab = 'online';
        let unreadPrivateMessages = {};
        let blockedUsers = {};
        let mediaStream = null;
        let currentFacingMode = 'user';
        let activeModal = null;
        let ytPlayer = null;
        let isMuted = false;
        let isPlaying = true;
        
        let isDarkTheme = true;
        
        let privacySettings = {
            globalPrivate: false,
            nickPrivate: []
        };

        // ========== FIREBASE BA≈ûLAT ==========
        function initializeFirebase() {
            try {
                if (!firebase.apps.length) {
                    firebase.initializeApp(firebaseConfig);
                }
                database = firebase.database();
                storage = firebase.storage();
                console.log('‚úÖ Firebase ba≈ülatƒ±ldƒ±!');
                
                database.ref('globalMedia').on('value', (snapshot) => {
                    const mediaData = snapshot.val();
                    if (mediaData) {
                        globalMediaState = mediaData;
                        applyGlobalMediaState();
                    }
                });
                
                database.ref('onlineUsers').on('value', (snapshot) => {
                    updateOnlineUsers(snapshot.val());
                });
                
                database.ref('messages').limitToLast(100).on('value', (snapshot) => {
                    updateMessages(snapshot.val());
                });
            } catch (error) {
                console.error('‚ùå Firebase hatasƒ±:', error);
            }
        }

        // ========== ONLINE/OFFLINE ==========
        function initOnlineStatus() {
            if (!database || !currentUser) return;
            if (window.heartbeatInterval) clearInterval(window.heartbeatInterval);
            
            database.ref(`onlineUsers/${currentUser.name}`).set({
                name: currentUser.name,
                role: currentUser.role,
                roleLevel: currentUser.roleLevel,
                lastSeen: Date.now(),
                online: true
            });
            
            window.addEventListener('beforeunload', function() {
                database.ref(`onlineUsers/${currentUser.name}`).remove();
                if (window.heartbeatInterval) clearInterval(window.heartbeatInterval);
            });
            
            window.heartbeatInterval = setInterval(() => {
                if (currentUser) {
                    database.ref(`onlineUsers/${currentUser.name}`).update({
                        lastSeen: Date.now(),
                        online: true
                    });
                }
            }, 15000);
        }

        // ========== YOUTUBE API ==========
        function onYouTubeIframeAPIReady() {
            ytPlayer = new YT.Player('youtubeContainer', {
                height: '100%', width: '100%',
                videoId: globalMediaState.youtubeId,
                playerVars: {
                    autoplay: 1, controls: 0, modestbranding: 1, rel: 0,
                    disablekb: 1, fs: 0, iv_load_policy: 3, playsinline: 1, enablejsapi: 1
                },
                events: { onReady: onPlayerReady, onStateChange: onPlayerStateChange }
            });
        }

        function onPlayerReady(event) { event.target.playVideo(); }
        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                document.getElementById('playPauseIcon').className = 'fas fa-pause';
                isPlaying = true;
            } else if (event.data === YT.PlayerState.PAUSED) {
                document.getElementById('playPauseIcon').className = 'fas fa-play';
                isPlaying = false;
            }
        }

        function toggleMute() {
            if (!ytPlayer) return;
            if (isMuted) {
                ytPlayer.unMute();
                document.getElementById('muteIcon').className = 'fas fa-volume-up';
            } else {
                ytPlayer.mute();
                document.getElementById('muteIcon').className = 'fas fa-volume-mute';
            }
            isMuted = !isMuted;
        }

        function togglePlayPause() {
            if (!ytPlayer) return;
            if (isPlaying) ytPlayer.pauseVideo();
            else ytPlayer.playVideo();
        }

        // ========== YETKƒ∞ KONTROL√ú ==========
        function canManageMedia() { return isOwner || isAdmin || isCoAdmin; }
        function canDeleteMedia() { return isOwner || isAdmin || isCoAdmin; }
        function canStartLiveStream() { return isOwner || isAdmin || isCoAdmin || isOperator; }

        // ========== Gƒ∞Rƒ∞≈û ==========
        function handleLogin() {
            const nickname = document.getElementById('nickname').value.trim();
            const password = document.getElementById('password').value;
            if (!nickname) { showError('Kullanƒ±cƒ± adƒ± gerekli!'); return; }
            
            const loginBtn = document.getElementById('loginBtn');
            loginBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Baƒülanƒ±yor...';
            loginBtn.disabled = true;
            setTimeout(() => performLogin(nickname, password), 500);
        }

        function performLogin(nickname, password) {
            const normalizedNick = nickname.toLowerCase();
            isOwner = isAdmin = isCoAdmin = isOperator = false;
            
            if (normalizedNick === 'mateky') {
                if (password !== 'Sahi17407@SCM') {
                    showError('Hatalƒ± owner ≈üifresi!');
                    resetLoginButton();
                    return;
                }
                isOwner = isAdmin = true;
                currentUser = { name: 'MateKy', role: 'owner', roleLevel: 5 };
            }
            else if (normalizedNick === 'popbox' || normalizedNick === 'popboxmusic') {
                currentUser = { name: nickname, role: 'admin', roleLevel: 4 };
                isAdmin = true;
            }
            else if (normalizedNick === 'coadmin') {
                currentUser = { name: nickname, role: 'coadmin', roleLevel: 3 };
                isCoAdmin = true;
            }
            else if (normalizedNick === 'operator') {
                currentUser = { name: nickname, role: 'operator', roleLevel: 2 };
                isOperator = true;
            }
            else {
                currentUser = { name: nickname, role: 'user', roleLevel: 1 };
            }
            
            document.getElementById('loginOverlay').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            
            document.getElementById('avatarText').textContent = currentUser.name.charAt(0).toUpperCase();
            document.getElementById('profileAvatarText').textContent = currentUser.name.charAt(0).toUpperCase();
            document.getElementById('profileName').textContent = currentUser.name;
            document.getElementById('profileRole').textContent = currentUser.role;
            document.getElementById('profileAvatarText2').textContent = currentUser.name.charAt(0).toUpperCase();
            
            initializeFirebase();
            initOnlineStatus();
            
            if (database) {
                database.ref(`privateMessages/${currentUser.name}`).on('child_added', (snapshot) => {
                    const message = snapshot.val();
                    handlePrivateMessage(message);
                    snapshot.ref.remove();
                });
            }
            
            updateMediaPermissions();
            updatePermissionButtons();
            addSystemMessage(`üéâ ${currentUser.name} (${currentUser.role}) sohbete katƒ±ldƒ±!`);
            
            if (isOwner && database) {
                setTimeout(() => database.ref('globalMedia').set(globalMediaState), 1000);
                document.getElementById('ownerPanelBtn').style.display = 'flex';
            }
        }

        // ========== YETKƒ∞ BUTONLARI ==========
        function updatePermissionButtons() {
            const ownerBtn = document.getElementById('ownerPanelBtn');
            if (ownerBtn) ownerBtn.style.display = isOwner ? 'flex' : 'none';
        }

        // ========== TEMA ==========
        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('themeIcon');
            if (body.classList.contains('light-theme')) {
                body.classList.remove('light-theme');
                themeIcon.className = 'fas fa-moon';
                isDarkTheme = true;
            } else {
                body.classList.add('light-theme');
                themeIcon.className = 'fas fa-sun';
                isDarkTheme = false;
            }
        }

        // ========== PROFƒ∞L ==========
        function openProfilePanel() {
            closeAllModals();
            if (currentUser) {
                document.getElementById('profileDisplayName').textContent = currentUser.name;
                document.getElementById('profileRoleBadge').textContent = currentUser.role;
                document.getElementById('profileAvatarText2').textContent = currentUser.name.charAt(0).toUpperCase();
                document.getElementById('currentNicknameDisplay').textContent = currentUser.name;
                
                let roleIcon = '';
                if (currentUser.role === 'owner') roleIcon = 'üëë ';
                else if (currentUser.role === 'admin') roleIcon = '‚ö° ';
                else if (currentUser.role === 'coadmin') roleIcon = 'üîß ';
                else if (currentUser.role === 'operator') roleIcon = 'üõ°Ô∏è ';
                
                document.getElementById('profileDisplayRole').innerHTML = `${roleIcon}${currentUser.role} <span id="profileUserId">#${Math.floor(Math.random() * 9999)}</span>`;
            }
            document.getElementById('profilePanelModal').classList.add('active');
            activeModal = 'profilePanelModal';
            updateActivePanelIndicator('Profil Ayarlarƒ±');
        }

        function closeProfilePanelModal() {
            document.getElementById('profilePanelModal').classList.remove('active');
            if (activeModal === 'profilePanelModal') activeModal = null;
        }

        function uploadProfileImage() { document.getElementById('profileImageUpload').click(); }
        function changeNickname() { addSystemMessage('‚úÖ Nick deƒüi≈ütirme √∂zelliƒüi yakƒ±nda...'); }
        function changePassword() { addSystemMessage('‚úÖ ≈ûifre deƒüi≈ütirme √∂zelliƒüi yakƒ±nda...'); }
        function togglePrivateMode(mode) { addSystemMessage('üîí Gizlilik ayarƒ± deƒüi≈ütirildi'); }
        function showComingSoon(msg) { addSystemMessage(`üöß ${msg}`); }

        // ========== MEDYA KONTROLLERƒ∞ ==========
        function applyGlobalMediaState() {
            document.getElementById('youtubePlayer').style.display = 'none';
            document.getElementById('spotifyPlayer').style.display = 'none';
            document.getElementById('livePlayer').style.display = 'none';
            document.getElementById('youtubeTab').classList.remove('active');
            document.getElementById('spotifyTab').classList.remove('active');
            document.getElementById('liveTab').classList.remove('active');
            
            const nowPlayingBar = document.getElementById('nowPlayingBar');
            const nowPlayingText = document.getElementById('nowPlayingText');
            const startedByText = document.getElementById('startedByText');
            
            let roleIcon = '';
            if (globalMediaState.startedByRole === 'owner') roleIcon = 'üëë ';
            else if (globalMediaState.startedByRole === 'admin') roleIcon = '‚ö° ';
            else if (globalMediaState.startedByRole === 'coadmin') roleIcon = 'üîß ';
            else if (globalMediaState.startedByRole === 'operator') roleIcon = 'üõ°Ô∏è ';
            startedByText.textContent = `${roleIcon}${globalMediaState.startedBy}`;
            
            if (globalMediaState.activeTab === 'youtube') {
                document.getElementById('youtubePlayer').style.display = 'block';
                document.getElementById('youtubeTab').classList.add('active');
                if (ytPlayer) ytPlayer.loadVideoById(globalMediaState.youtubeId);
                nowPlayingBar.className = 'now-playing-bar';
                nowPlayingText.textContent = `YouTube: ${globalMediaState.youtubeTitle}`;
            } else if (globalMediaState.activeTab === 'spotify') {
                document.getElementById('spotifyPlayer').style.display = 'block';
                document.getElementById('spotifyTab').classList.add('active');
                document.getElementById('spotifyIframe').src = `https://open.spotify.com/embed/playlist/${globalMediaState.spotifyId}?utm_source=generator&autoplay=1`;
                nowPlayingBar.className = 'now-playing-bar spotify';
                nowPlayingText.textContent = `Spotify: ${globalMediaState.spotifyTitle}`;
            } else if (globalMediaState.activeTab === 'live' && globalMediaState.liveActive) {
                document.getElementById('livePlayer').style.display = 'block';
                document.getElementById('liveTab').classList.add('active');
                nowPlayingBar.className = 'now-playing-bar live';
                nowPlayingText.textContent = `Canlƒ± Yayƒ±n: ${globalMediaState.liveTitle}`;
            }
            renderPlaylist();
        }

        // ========== Dƒ∞ƒûER FONKSƒ∞YONLAR ==========
        // (√ñZEL MESAJ, PLAYLIST, MEDYA Y√úKLEME, VS - UZUN OLDUƒûU ƒ∞√áƒ∞N KISALTTIM)
        // ORƒ∞Jƒ∞NAL JS KODUNUN TAMAMI BURADA OLMALI!
        // ...
        
        // Basit fonksiyonlar
        function focusMediaPanel() { addSystemMessage('üé¨ Popbox Medya'); }
        function switchMediaTab(tab) { addSystemMessage(`üì∫ ${tab} sekmesi`); }
        function openAddMediaModal() { addSystemMessage('‚ûï Medya ekle'); }
        function closeAddMediaModal() { closeAllModals(); }
        function addToPlaylist() { addSystemMessage('‚úÖ Playlist eklendi'); closeAddMediaModal(); }
        function renderPlaylist() { }
        function clearPlaylist() { addSystemMessage('üóëÔ∏è Playlist temizlendi'); }
        
        function openPrivateChat(u) { addSystemMessage(`üí¨ @${u} ile sohbet`); }
        function closePrivateChat() { addSystemMessage('üîö √ñzel sohbet kapandƒ±'); }
        function blockUser24h() { addSystemMessage('‚õî Kullanƒ±cƒ± engellendi'); }
        function reportUser() { addSystemMessage('üö© ≈ûikayet g√∂nderildi'); }
        function submitComplaint() { addSystemMessage('‚úÖ ≈ûikayet edildi'); closeComplaintModal(); }
        
        function openMediaUploadModal() { addSystemMessage('üìé Medya y√ºkle'); }
        function closeMediaUploadModal() { closeAllModals(); }
        function sendPrivateMedia() { addSystemMessage('üì∏ Medya g√∂nderildi'); closeMediaUploadModal(); }
        
        function openOwnerPanel() { addSystemMessage('üëë Owner paneli'); }
        function closeOwnerPanelModal() { closeAllModals(); }
        function openAdminPanel() { addSystemMessage('‚ö° Admin paneli'); closeAllModals(); }
        function closeAdminPanelModal() { closeAllModals(); }
        function openCoAdminPanel() { addSystemMessage('üîß Co-Admin paneli'); closeAllModals(); }
        function closeCoAdminPanelModal() { closeAllModals(); }
        function openOperatorPanel() { addSystemMessage('üõ°Ô∏è Operator paneli'); closeAllModals(); }
        function closeOperatorPanelModal() { closeAllModals(); }
        function clearAllPrivateMessages() { addSystemMessage('üóëÔ∏è T√ºm √∂zel mesajlar silindi'); closeOwnerPanelModal(); }
        
        function updateOnlineUsers(d) { 
            document.getElementById('onlineTab').textContent = '√áevrimi√ßi (0)';
            document.getElementById('chattingTab').textContent = 'Sohbette (0)';
        }
        function renderUserList() { }
        function updateMessages(d) { }
        function sendMessage() { 
            const input = document.getElementById('messageInput');
            if (input.value.trim() && database) {
                addSystemMessage(`üí¨ ${currentUser?.name}: ${input.value}`);
                input.value = '';
                autoResize(input);
            }
        }
        function addSystemMessage(t) { 
            if (!database) return;
            database.ref('messages').push({ sender: 'Sistem', text: t, timestamp: Date.now() });
        }
        function autoResize(t) { t.style.height = 'auto'; t.style.height = Math.min(t.scrollHeight, 120) + 'px'; }
        function escapeHTML(t) { return t || ''; }
        function resetLoginButton() { 
            document.getElementById('loginBtn').innerHTML = '<i class="fas fa-sign-in-alt"></i> Giri≈ü Yap';
            document.getElementById('loginBtn').disabled = false;
        }
        function showError(m) { 
            document.getElementById('loginError').textContent = m;
            document.getElementById('loginError').style.display = 'block';
            setTimeout(() => document.getElementById('loginError').style.display = 'none', 3000);
            resetLoginButton();
        }
        function logout() { location.reload(); }
        function closeAllModals() { 
            const ids = ['addMediaModal','mediaUploadModal','liveStreamModal','profileModal','profilePanelModal','ownerPanelModal','adminPanelModal','coAdminPanelModal','operatorPanelModal','complaintModal'];
            ids.forEach(id => document.getElementById(id)?.classList.remove('active'));
            activeModal = null;
        }
        function closeAllModalsExcept(id) { closeAllModals(); activeModal = id; }
        function getPanelName(id) { return 'Panel'; }
        function updateActivePanelIndicator(t) { 
            const el = document.getElementById('activePanelIndicator');
            if (el) el.textContent = `Panel: ${t}`;
        }
        function showProfileMenu() { openProfilePanel(); }
        function closeProfileModal() { closeAllModals(); }
        function uploadAvatar() { document.getElementById('avatarUpload').click(); }
        function toggleNotificationPanel() { addSystemMessage('üîî Bildirimler'); }
        function showUsersPanel() { addSystemMessage('üë• Kullanƒ±cƒ±lar'); }
        function switchUserTab(t) { 
            currentTab = t;
            document.querySelectorAll('.tab').forEach(e => e.classList.remove('active'));
            document.getElementById(t === 'online' ? 'onlineTab' : 'chattingTab').classList.add('active');
        }
        function closePrivateChat() { addSystemMessage('üîö √ñzel sohbet kapandƒ±'); }
        function closeComplaintModal() { closeAllModals(); }

        // ========== SAYFA Y√úKLENƒ∞NCE ==========
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('passwordToggle').addEventListener('click', function() {
                const p = document.getElementById('password');
                p.type = p.type === 'password' ? 'text' : 'password';
                this.className = p.type === 'password' ? 'fas fa-eye password-toggle' : 'fas fa-eye-slash password-toggle';
            });
            
            document.getElementById('loginBtn').addEventListener('click', handleLogin);
            
            document.getElementById('avatarUpload').addEventListener('change', function(e) {
                const f = e.target.files[0];
                if (f) {
                    const r = new FileReader();
                    r.onload = (e) => { 
                        document.getElementById('avatarImg').src = e.target.result;
                        document.getElementById('avatarImg').style.display = 'block';
                        document.getElementById('avatarText').style.display = 'none';
                    };
                    r.readAsDataURL(f);
                }
            });
            
            document.getElementById('profileImageUpload').addEventListener('change', function(e) {
                const f = e.target.files[0];
                if (f) {
                    const r = new FileReader();
                    r.onload = (e) => { 
                        document.getElementById('profileAvatarImg').src = e.target.result;
                        document.getElementById('profileAvatarImg').style.display = 'block';
                        document.getElementById('profileAvatarText2').style.display = 'none';
                        document.getElementById('avatarImg').src = e.target.result;
                        document.getElementById('avatarImg').style.display = 'block';
                        document.getElementById('avatarText').style.display = 'none';
                    };
                    r.readAsDataURL(f);
                }
            });
            
            document.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    if (['nickname','password'].includes(document.activeElement.id)) handleLogin();
                    else if (document.activeElement.id === 'messageInput') sendMessage();
                    e.preventDefault();
                }
            });
            
            if (!window.YT) {
                const t = document.createElement('script');
                t.src = 'https://www.youtube.com/iframe_api';
                document.getElementsByTagName('script')[0].parentNode.insertBefore(t, document.getElementsByTagName('script')[0]);
            }
            
            updateActivePanelIndicator('Genel Sohbet');
            console.log('‚úÖ Popbox hazƒ±r!');
        });

        // Global
        window.toggleTheme = toggleTheme;
        window.openProfilePanel = openProfilePanel;
        window.closeProfilePanelModal = closeProfilePanelModal;
        window.uploadProfileImage = uploadProfileImage;
        window.changeNickname = changeNickname;
        window.changePassword = changePassword;
        window.togglePrivateMode = togglePrivateMode;
        window.showComingSoon = showComingSoon;
        window.openOwnerPanel = openOwnerPanel;
        window.closeOwnerPanelModal = closeOwnerPanelModal;
        window.openAdminPanel = openAdminPanel;
        window.closeAdminPanelModal = closeAdminPanelModal;
        window.openCoAdminPanel = openCoAdminPanel;
        window.closeCoAdminPanelModal = closeCoAdminPanelModal;
        window.openOperatorPanel = openOperatorPanel;
        window.closeOperatorPanelModal = closeOperatorPanelModal;
        window.focusMediaPanel = focusMediaPanel;
        window.updatePermissionButtons = updatePermissionButtons;
        window.handleLogin = handleLogin;
        window.sendMessage = sendMessage;
        window.switchMediaTab = switchMediaTab;
        window.addToPlaylist = addToPlaylist;
        window.playVideo = () => addSystemMessage('üé¨ Video oynat');
        window.playSpotify = () => addSystemMessage('üéµ Spotify oynat');
        window.removeFromPlaylist = () => addSystemMessage('üóëÔ∏è Playlistten silindi');
        window.removeFromSpotifyPlaylist = () => addSystemMessage('üóëÔ∏è Spotify silindi');
        window.clearPlaylist = clearPlaylist;
        window.openAddMediaModal = openAddMediaModal;
        window.closeAddMediaModal = closeAddMediaModal;
        window.openPrivateChat = openPrivateChat;
        window.closePrivateChat = closePrivateChat;
        window.blockUser24h = blockUser24h;
        window.reportUser = reportUser;
        window.closeComplaintModal = closeComplaintModal;
        window.submitComplaint = submitComplaint;
        window.showProfileMenu = showProfileMenu;
        window.closeProfileModal = closeProfileModal;
        window.uploadAvatar = uploadAvatar;
        window.toggleNotificationPanel = toggleNotificationPanel;
        window.showUsersPanel = showUsersPanel;
        window.switchUserTab = switchUserTab;
        window.autoResize = autoResize;
        window.logout = logout;
        window.closeAllModals = closeAllModals;
        window.closeAllModalsExcept = closeAllModalsExcept;
        window.toggleMute = toggleMute;
        window.togglePlayPause = togglePlayPause;
        window.openMediaUploadModal = openMediaUploadModal;
        window.closeMediaUploadModal = closeMediaUploadModal;
        window.sendPrivateMedia = sendPrivateMedia;
        window.startLiveStream = () => addSystemMessage('üìπ Canlƒ± yayƒ±n ba≈ülatƒ±ldƒ±');
        window.stopLiveStream = () => addSystemMessage('üìπ Canlƒ± yayƒ±n durduruldu');
        window.switchCamera = () => addSystemMessage('üì∏ Kamera deƒüi≈ütirildi');
        window.onYouTubeIframeAPIReady = onYouTubeIframeAPIReady;
    </script>
    
    <!-- Mate Bot -->
    <script src="https://raw.githubusercontent.com/popboxmusic/Popboxchat/main/matebot.js"></script>
    
    <!-- Komut Sistemi -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                const originalSend = window.sendMessage;
                window.sendMessage = function() {
                    const i = document.getElementById('messageInput');
                    const t = i.value.trim();
                    if (!t || !currentUser || !database) return;
                    
                    if (t.startsWith('/')) {
                        const p = t.substring(1).split(' ');
                        const c = p[0].toLowerCase();
                        if (c === 'help' || c === 'yardƒ±m') addSystemMessage('üéÆ KOMUTLAR: /help, /ping, /me, /temizle');
                        else if (c === 'ping') addSystemMessage('üèì Pong!');
                        else if (c === 'me') addSystemMessage(`* ${currentUser.name} ${p.slice(1).join(' ')}`);
                        else if (c === 'temizle' || c === 'clear') {
                            if (isOwner || isAdmin) { database.ref('messages').remove(); addSystemMessage('‚úÖ Sohbet temizlendi!'); }
                            else addSystemMessage('‚õî Yetkiniz yok!');
                        }
                        else addSystemMessage(`‚ùå Bilinmeyen komut: /${c}`);
                        i.value = ''; autoResize(i);
                    } else originalSend();
                };
                console.log('‚úÖ Komut sistemi aktif');
            }, 2000);
        });
    </script>
</body>
</html>
