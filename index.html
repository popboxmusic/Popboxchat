<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popbox Elite v2 - Owner (mateky) Sistem</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* PROFESYONEL SİYAH TEMA */
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-tertiary: #1a1a1a;
            --bg-overlay: rgba(0, 0, 0, 0.95);
            
            --border-light: #222222;
            --border-medium: #2a2a2a;
            --border-dark: #333333;
            
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --text-tertiary: #888888;
            --text-muted: #666666;
            
            --accent-blue: #3b82f6;
            --accent-green: #10b981;
            --accent-red: #ef4444;
            --accent-orange: #f59e0b;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            --accent-cyan: #06b6d4;
            
            --shadow-light: 0 1px 3px rgba(0, 0, 0, 0.3);
            --shadow-medium: 0 4px 12px rgba(0, 0, 0, 0.5);
            --shadow-heavy: 0 8px 32px rgba(0, 0, 0, 0.7);
            
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            
            --font-primary: 'Inter', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
            
            --spacing-xs: 6px;
            --spacing-sm: 12px;
            --spacing-md: 18px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-primary);
            background: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            font-size: 14px;
            line-height: 1.5;
        }

        /* GİRİŞ EKRANI - ŞEFFAF BUHULU */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(10, 10, 10, 0.98) 0%, rgba(26, 26, 26, 0.95) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 5000;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .login-container {
            width: 100%;
            max-width: 420px;
            padding: var(--spacing-xl);
            background: rgba(17, 17, 17, 0.7);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .login-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            border-radius: 50%;
            margin: 0 auto var(--spacing-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 32px;
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.4);
            position: relative;
            overflow: hidden;
        }

        .login-logo::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .login-title {
            font-size: 28px;
            font-weight: 700;
            text-align: center;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: var(--spacing-xs);
        }

        .login-subtitle {
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-xl);
            font-size: 14px;
        }

        .login-input-group {
            margin-bottom: var(--spacing-lg);
        }

        .login-label {
            display: block;
            margin-bottom: var(--spacing-xs);
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 500;
        }

        .login-input {
            width: 100%;
            padding: 14px 16px;
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 14px;
            font-family: inherit;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .login-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
            background: rgba(17, 17, 17, 0.9);
            box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.2);
        }

        .login-input.nick-suggestion {
            border-color: var(--accent-orange);
            background: rgba(245, 158, 11, 0.05);
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            color: white;
            border: none;
            border-radius: var(--radius-md);
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: var(--spacing-md);
            position: relative;
            overflow: hidden;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
        }

        .login-btn:active {
            transform: translateY(0);
        }

        .login-note {
            text-align: center;
            margin-top: var(--spacing-lg);
            font-size: 12px;
            color: var(--text-tertiary);
            line-height: 1.6;
        }

        .owner-access {
            margin-top: var(--spacing-md);
            padding: var(--spacing-sm);
            background: rgba(139, 92, 246, 0.1);
            border-radius: var(--radius-md);
            text-align: center;
            font-size: 11px;
            color: var(--accent-purple);
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        /* ÜST BAR */
        .top-bar {
            height: 60px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-light);
            padding: 0 var(--spacing-lg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-weight: 600;
            font-size: 18px;
            color: var(--text-primary);
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 18px;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            cursor: pointer;
            padding: 6px 12px;
            border-radius: var(--radius-md);
            transition: background 0.2s;
        }

        .user-info:hover {
            background: var(--bg-tertiary);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
            overflow: hidden;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-name {
            font-weight: 500;
            font-size: 14px;
        }

        .user-role {
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 10px;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
        }

        .user-role.owner { 
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(6, 182, 212, 0.2));
            color: var(--accent-purple);
            border: 1px solid rgba(139, 92, 246, 0.3);
        }
        .user-role.admin { 
            background: rgba(59, 130, 246, 0.1);
            color: var(--accent-blue);
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        .user-role.coadmin { 
            background: rgba(236, 72, 153, 0.1);
            color: var(--accent-pink);
            border: 1px solid rgba(236, 72, 153, 0.3);
        }
        .user-role.operator { 
            background: rgba(245, 158, 11, 0.1);
            color: var(--accent-orange);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        .user-role.hop { 
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent-green);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .nav-controls {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .nav-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.2s ease;
        }

        .nav-btn:hover {
            background: var(--accent-purple);
            color: white;
            border-color: var(--accent-purple);
            transform: translateY(-2px);
        }

        .nav-btn.owner-btn {
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            color: white;
            border: none;
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--accent-red);
            color: white;
            font-size: 10px;
            min-width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            border: 2px solid var(--bg-secondary);
        }

        /* KANAL LİSTESİ */
        .channel-list {
            position: absolute;
            top: 60px;
            left: 0;
            width: 280px;
            height: calc(100vh - 60px);
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-light);
            z-index: 90;
            display: flex;
            flex-direction: column;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .channel-list.active {
            transform: translateX(0);
        }

        .channel-header {
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--border-light);
        }

        .channel-create-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            color: white;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
        }

        .channels-container {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing-md);
        }

        .channel-item {
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            background: var(--bg-tertiary);
            margin-bottom: var(--spacing-sm);
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .channel-item:hover {
            background: var(--bg-primary);
            border-color: var(--accent-purple);
            transform: translateX(5px);
        }

        .channel-item.active {
            background: var(--accent-purple);
            color: white;
        }

        .channel-name {
            font-weight: 600;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .channel-topic {
            font-size: 12px;
            color: var(--text-tertiary);
            margin-bottom: 4px;
        }

        .channel-stats {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: var(--text-muted);
        }

        .channel-private {
            color: var(--accent-orange);
        }

        /* ÖZEL SOHBET PANELİ */
        .private-chats-panel {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 80;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-end;
        }

        .private-chat-minimized {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            box-shadow: var(--shadow-medium);
            overflow: hidden;
        }

        .private-chat-minimized img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .private-chat-minimized:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(139, 92, 246, 0.5);
        }

        .unread-badge {
            position: absolute;
            top: -3px;
            right: -3px;
            background: var(--accent-red);
            color: white;
            font-size: 10px;
            min-width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            border: 2px solid var(--bg-secondary);
        }

        /* ANA LAYOUT */
        .app-container {
            display: flex;
            height: calc(100vh - 60px);
        }

        /* SOL PANEL - Online Listesi */
        .online-panel {
            width: 300px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-light);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .panel-header {
            padding: var(--spacing-md) var(--spacing-lg);
            border-bottom: 1px solid var(--border-light);
        }

        .panel-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .online-count {
            font-size: 13px;
            color: var(--accent-cyan);
            font-weight: 600;
        }

        .search-box {
            padding: var(--spacing-md) var(--spacing-lg) 0;
            margin-bottom: var(--spacing-md);
        }

        .search-input {
            width: 100%;
            padding: 10px var(--spacing-md);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 13px;
            font-family: inherit;
            transition: all 0.2s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
            background: var(--bg-secondary);
        }

        .user-list {
            flex: 1;
            overflow-y: auto;
            padding: 0 var(--spacing-lg);
        }

        .user-item {
            padding: var(--spacing-md) 0;
            border-bottom: 1px solid var(--border-light);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .user-item:last-child {
            border-bottom: none;
        }

        .user-item:hover {
            background: var(--bg-tertiary);
            margin: 0 calc(var(--spacing-lg) * -1);
            padding: var(--spacing-md) var(--spacing-lg);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
            flex-shrink: 0;
            position: relative;
            border: 2px solid var(--bg-secondary);
            overflow: hidden;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-avatar.online::after {
            content: '';
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 10px;
            height: 10px;
            background: var(--accent-green);
            border-radius: 50%;
            border: 2px solid var(--bg-secondary);
        }

        .user-info {
            flex: 1;
            min-width: 0;
        }

        .user-name {
            font-weight: 500;
            font-size: 13px;
            color: var(--text-primary);
            margin-bottom: 2px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .user-status {
            font-size: 11px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* ORTA PANEL - Sohbet */
        .chat-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
        }

        .chat-header {
            padding: 0 var(--spacing-lg);
            height: 70px;
            border-bottom: 1px solid var(--border-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--bg-secondary);
        }

        .chat-info h2 {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .chat-info p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .channel-controls {
            display: flex;
            gap: var(--spacing-sm);
            align-items: center;
        }

        /* SAĞ PANEL - Video */
        .video-panel {
            width: 400px;
            background: #000;
            border-left: 1px solid var(--border-dark);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .video-header {
            padding: var(--spacing-md) var(--spacing-lg);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .video-controls {
            display: flex;
            gap: var(--spacing-sm);
        }

        .video-btn {
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: var(--radius-sm);
            color: white;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: background 0.2s;
        }

        .video-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .video-container {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: #000;
        }

        .video-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.5);
            text-align: center;
            padding: var(--spacing-xl);
        }

        .video-placeholder i {
            font-size: 48px;
            margin-bottom: var(--spacing-md);
            color: var(--accent-purple);
        }

        #youtubePlayer {
            width: 100%;
            height: 100%;
        }

        /* OWNER PANELİ - TANRI MODU */
        .owner-panel {
            position: fixed;
            top: 60px;
            right: 0;
            width: 500px;
            height: calc(100vh - 60px);
            background: var(--bg-secondary);
            border-left: 1px solid var(--border-light);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow-heavy);
        }

        .owner-panel.active {
            transform: translateX(0);
        }

        .owner-header {
            padding: var(--spacing-lg);
            background: linear-gradient(135deg, #1a0033, #330033);
            color: white;
            border-bottom: 1px solid rgba(139, 92, 246, 0.5);
            position: relative;
        }

        .owner-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--accent-purple), transparent);
        }

        .owner-badge {
            background: linear-gradient(135deg, var(--accent-purple), #ff00ff);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            display: inline-block;
            margin-bottom: var(--spacing-sm);
            animation: glow 2s infinite;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px var(--accent-purple); }
            50% { box-shadow: 0 0 15px var(--accent-purple); }
        }

        .owner-tabs {
            display: flex;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-light);
        }

        .owner-tab {
            flex: 1;
            padding: var(--spacing-md);
            text-align: center;
            cursor: pointer;
            border-right: 1px solid var(--border-light);
            transition: all 0.2s;
            font-weight: 500;
            font-size: 13px;
        }

        .owner-tab:last-child {
            border-right: none;
        }

        .owner-tab:hover {
            background: var(--bg-primary);
        }

        .owner-tab.active {
            background: var(--accent-purple);
            color: white;
        }

        .owner-content {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing-lg);
        }

        .owner-section {
            margin-bottom: var(--spacing-xl);
        }

        .owner-section h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 1px solid var(--border-light);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .owner-section h4 i {
            color: var(--accent-purple);
        }

        /* MATE BOT KONTROL */
        .bot-controls {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .bot-command-item {
            padding: var(--spacing-sm);
            border-radius: var(--radius-md);
            background: var(--bg-tertiary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .command-actions {
            display: flex;
            gap: var(--spacing-xs);
        }

        /* ŞİKAYETLER PANELİ */
        .complaint-item {
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            background: var(--bg-tertiary);
            margin-bottom: var(--spacing-sm);
            border-left: 3px solid var(--accent-red);
        }

        .complaint-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xs);
        }

        .complaint-count {
            background: var(--accent-red);
            color: white;
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 10px;
            font-weight: 600;
        }

        /* ADMIN YÖNETİMİ */
        .admin-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .admin-item {
            padding: var(--spacing-sm);
            border-radius: var(--radius-md);
            background: var(--bg-tertiary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* KANAL YÖNETİMİ */
        .channel-admin-item {
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            background: var(--bg-tertiary);
            margin-bottom: var(--spacing-sm);
        }

        /* ÖZEL SOHBET İZLEME */
        .spy-chat-item {
            padding: var(--spacing-sm);
            border-radius: var(--radius-md);
            background: var(--bg-tertiary);
            margin-bottom: var(--spacing-sm);
            cursor: pointer;
            transition: all 0.2s;
        }

        .spy-chat-item:hover {
            background: var(--bg-primary);
            transform: translateX(5px);
        }

        /* STORY YÖNETİMİ */
        .story-manage-item {
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            background: var(--bg-tertiary);
            margin-bottom: var(--spacing-sm);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .story-preview {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-md);
            overflow: hidden;
            flex-shrink: 0;
        }

        .story-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* CHAT MESSAGES */
        .chat-messages {
            flex: 1;
            padding: var(--spacing-lg);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .message {
            display: flex;
            flex-direction: column;
            max-width: 75%;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message-incoming {
            align-self: flex-start;
        }

        .message-outgoing {
            align-self: flex-end;
            align-items: flex-end;
        }

        .message-sender {
            font-weight: 600;
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .message-outgoing .message-sender {
            color: var(--accent-cyan);
        }

        .message-text {
            font-size: 14px;
            line-height: 1.5;
            color: var(--text-primary);
            padding: 10px 14px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            word-break: break-word;
            position: relative;
        }

        .message-outgoing .message-text {
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            color: white;
        }

        .message-time {
            font-size: 10px;
            color: var(--text-tertiary);
            margin-top: 4px;
            text-align: right;
        }

        .message-delete {
            position: absolute;
            top: 4px;
            right: 4px;
            opacity: 0;
            transition: opacity 0.2s;
            cursor: pointer;
            color: var(--text-tertiary);
            font-size: 10px;
        }

        .message:hover .message-delete {
            opacity: 1;
        }

        .message-delete:hover {
            color: var(--accent-red);
        }

        .message-media {
            margin-top: 8px;
            border-radius: var(--radius-md);
            overflow: hidden;
            max-width: 300px;
            cursor: pointer;
        }

        .message-media img {
            width: 100%;
            height: auto;
            display: block;
            border-radius: var(--radius-md);
        }

        .chat-input-area {
            padding: var(--spacing-lg);
            border-top: 1px solid var(--border-light);
            background: var(--bg-secondary);
        }

        .input-wrapper {
            display: flex;
            gap: var(--spacing-md);
            align-items: flex-end;
        }

        .message-input {
            flex: 1;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 14px;
            resize: none;
            min-height: 44px;
            max-height: 120px;
            outline: none;
            transition: all 0.2s ease;
        }

        .message-input:focus {
            border-color: var(--accent-cyan);
            background: var(--bg-secondary);
        }

        .send-btn {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.4);
        }

        /* STORY SİSTEMİ */
        .story-system {
            margin: var(--spacing-md) var(--spacing-lg);
        }

        .story-create-btn {
            padding: 10px 16px;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            color: white;
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .story-create-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.4);
        }

        .story-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            z-index: 3000;
            flex-direction: column;
        }

        .story-viewer.active {
            display: flex;
        }

        /* KANAL OLUŞTURMA MODALI */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-overlay);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-container {
            width: 90%;
            max-width: 500px;
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            overflow: hidden;
            border: 1px solid var(--border-light);
            box-shadow: var(--shadow-heavy);
        }

        .modal-header {
            padding: var(--spacing-lg);
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-light);
        }

        .modal-content {
            padding: var(--spacing-lg);
        }

        .modal-actions {
            padding: var(--spacing-lg);
            border-top: 1px solid var(--border-light);
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-sm);
        }

        .modal-input {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            margin-bottom: var(--spacing-md);
            font-family: inherit;
        }

        .modal-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
        }

        /* PROFİL PANELİ */
        .profile-panel {
            position: fixed;
            top: 60px;
            right: 0;
            width: 400px;
            height: calc(100vh - 60px);
            background: var(--bg-secondary);
            border-left: 1px solid var(--border-light);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 500;
            display: flex;
            flex-direction: column;
        }

        .profile-panel.active {
            transform: translateX(0);
        }

        /* YÖNETİCİ PANELİ */
        .admin-panel {
            position: fixed;
            top: 60px;
            right: 0;
            width: 450px;
            height: calc(100vh - 60px);
            background: var(--bg-secondary);
            border-left: 1px solid var(--border-light);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 999;
            display: flex;
            flex-direction: column;
        }

        .admin-panel.active {
            transform: translateX(0);
        }

        /* UTILITIES */
        .hidden {
            display: none !important;
        }

        .action-btn {
            padding: 6px 12px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border-medium);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .action-btn:hover {
            background: var(--bg-primary);
        }

        .action-btn.primary {
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            color: white;
            border: none;
        }

        .action-btn.danger {
            background: var(--accent-red);
            color: white;
            border: none;
        }

        .action-btn.small {
            padding: 4px 8px;
            font-size: 11px;
        }

        /* SCROLLBAR */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-medium);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--border-dark);
        }

        /* ANIMATIONS */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* RESPONSIVE */
        @media (max-width: 1400px) {
            .video-panel {
                width: 350px;
            }
            .owner-panel {
                width: 450px;
            }
        }

        @media (max-width: 1200px) {
            .online-panel {
                width: 280px;
            }
            .video-panel {
                width: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- GİRİŞ EKRANI -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-logo">P</div>
            <h1 class="login-title">Popbox Elite v2</h1>
            <p class="login-subtitle">Owner (mateky) Tanrı Modeli Sistem</p>
            
            <div class="login-input-group">
                <label class="login-label">Kullanıcı Adı</label>
                <input id="nickInput" class="login-input" type="text" placeholder="Nick girin" autofocus>
                <div style="margin-top: 4px; font-size: 11px; color: var(--text-muted);">
                    Öneri: <span id="nickSuggestion" style="color: var(--accent-orange); cursor: pointer;">popbox123</span>
                </div>
            </div>
            
            <div class="login-input-group">
                <label class="login-label">Şifre</label>
                <input id="passInput" class="login-input" type="password" placeholder="Şifre (zorunlu)">
            </div>
            
            <button class="login-btn" onclick="handleLogin()">
                <i class="fas fa-sign-in-alt"></i> Giriş Yap
            </button>
            
            <div class="owner-access">
                <i class="fas fa-crown"></i> Owner girişi: <strong>mateky</strong> / <strong>mateky123</strong>
            </div>
            
            <div class="login-note">
                <p><i class="fas fa-shield-alt"></i> Nick korumalı sistem - benzer nickler engellenir</p>
                <p><i class="fas fa-video"></i> Kanal açıp canlı yayın yapabilirsiniz</p>
                <p><i class="fas fa-images"></i> Story paylaşımı ve takipleşme sistemi</p>
            </div>
        </div>
    </div>

    <!-- ANA UYGULAMA -->
    <div id="app" class="hidden">
        <!-- ÜST BAR -->
        <div class="top-bar">
            <button class="nav-btn" onclick="toggleChannelList()">
                <i class="fas fa-hashtag"></i>
            </button>
            
            <div class="logo">
                <div class="logo-icon">P</div>
                <span>Popbox Elite</span>
                <span style="font-size: 11px; color: var(--accent-purple); margin-left: 8px;">v2</span>
            </div>
            
            <div class="user-menu">
                <div class="user-info" onclick="toggleProfilePanel()" id="userInfo">
                    <!-- Dinamik olarak eklenecek -->
                </div>
                
                <button class="nav-btn" onclick="openStoryCreator()">
                    <i class="fas fa-plus"></i>
                </button>
                
                <button class="nav-btn" onclick="toggleNotifications()">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notificationBadge">0</span>
                </button>
                
                <button class="nav-btn owner-btn" onclick="toggleOwnerPanel()" id="ownerBtn">
                    <i class="fas fa-crown"></i>
                </button>
            </div>
        </div>

        <!-- KANAL LİSTESİ -->
        <div class="channel-list" id="channelList">
            <div class="channel-header">
                <button class="channel-create-btn" onclick="openCreateChannelModal()">
                    <i class="fas fa-plus-circle"></i> Kanal Oluştur
                </button>
                <div class="panel-title">
                    Kanallar
                    <span class="online-count" id="channelCount">0</span>
                </div>
            </div>
            <div class="channels-container" id="channelsContainer">
                <!-- Kanallar buraya eklenecek -->
            </div>
        </div>

        <!-- ÖZEL SOHBET PANELİ -->
        <div class="private-chats-panel" id="privateChatsPanel">
            <!-- Dinamik olarak eklenecek -->
        </div>

        <!-- OWNER PANELİ -->
        <div class="owner-panel" id="ownerPanel">
            <div class="owner-header">
                <span class="owner-badge">TANRI MODU</span>
                <h3 style="margin-bottom: 4px;">Owner Kontrol Paneli</h3>
                <p style="font-size: 13px; opacity: 0.9;">mateky - Her Şeye Hükmeder</p>
                <button class="nav-btn" onclick="toggleOwnerPanel()" style="position: absolute; right: var(--spacing-lg);">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="owner-tabs" id="ownerTabs">
                <div class="owner-tab active" onclick="switchOwnerTab(0)">
                    <i class="fas fa-eye"></i> İzleme
                </div>
                <div class="owner-tab" onclick="switchOwnerTab(1)">
                    <i class="fas fa-robot"></i> MATE Bot
                </div>
                <div class="owner-tab" onclick="switchOwnerTab(2)">
                    <i class="fas fa-shield-alt"></i> Adminler
                </div>
                <div class="owner-tab" onclick="switchOwnerTab(3)">
                    <i class="fas fa-hashtag"></i> Kanallar
                </div>
                <div class="owner-tab" onclick="switchOwnerTab(4)">
                    <i class="fas fa-flag"></i> Şikayetler
                </div>
            </div>
            
            <div class="owner-content" id="ownerContent">
                <!-- Sekme içerikleri buraya eklenecek -->
            </div>
        </div>

        <!-- ADMIN PANELİ -->
        <div class="admin-panel" id="adminPanel">
            <div class="owner-header" style="background: linear-gradient(135deg, #0f1a2e, #1e3a5f);">
                <span class="owner-badge" style="background: linear-gradient(135deg, var(--accent-blue), #4f46e5);">ADMIN PANEL</span>
                <h3 style="margin-bottom: 4px;">Yönetici Kontrol Paneli</h3>
                <p style="font-size: 13px; opacity: 0.9;">Sınırlı yetkiler</p>
                <button class="nav-btn" onclick="toggleAdminPanel()" style="position: absolute; right: var(--spacing-lg);">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="owner-content">
                <div class="owner-section">
                    <h4><i class="fas fa-hashtag"></i> Kanal Yönetimi</h4>
                    <div id="adminChannelsList">
                        <!-- Adminin yönetebileceği kanallar -->
                    </div>
                </div>
                
                <div class="owner-section">
                    <h4><i class="fas fa-flag"></i> Şikayetler</h4>
                    <div id="adminComplaints">
                        <!-- Şikayetler -->
                    </div>
                </div>
                
                <div class="owner-section">
                    <h4><i class="fas fa-images"></i> Story Yönetimi</h4>
                    <div id="adminStories">
                        <!-- Story yönetimi -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ANA LAYOUT -->
        <div class="app-container">
            <!-- SOL PANEL - Online Listesi -->
            <div class="online-panel">
                <div class="panel-header">
                    <div class="panel-title">
                        Çevrimiçi Kullanıcılar
                        <span class="online-count" id="onlineCount">0</span>
                    </div>
                </div>
                
                <div class="search-box">
                    <input type="text" class="search-input" placeholder="Kullanıcı ara..." onkeyup="searchUsers(this.value)">
                </div>
                
                <div class="user-list" id="userList">
                    <!-- Kullanıcılar buraya eklenecek -->
                </div>
            </div>

            <!-- ORTA PANEL - Ana Sohbet -->
            <div class="chat-panel">
                <div class="chat-header">
                    <div class="chat-info">
                        <h2 id="currentChannel">Genel Sohbet</h2>
                        <p id="channelTopic">Hoş geldiniz! MATE bot sistemi aktif.</p>
                    </div>
                    
                    <div class="channel-controls">
                        <button class="action-btn" onclick="showChannelInfo()">
                            <i class="fas fa-info-circle"></i> Bilgi
                        </button>
                        <button class="action-btn" onclick="toggleAdminPanel()" id="adminPanelBtn" style="display: none;">
                            <i class="fas fa-cogs"></i> Yönetim
                        </button>
                    </div>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <!-- Mesajlar buraya eklenecek -->
                </div>
                
                <div class="chat-input-area">
                    <div class="input-wrapper">
                        <textarea class="message-input" id="messageInput" placeholder="Mesaj yazın (/ komutları için)..." rows="1"></textarea>
                        <button class="send-btn" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SAĞ PANEL - Video -->
            <div class="video-panel">
                <div class="video-header">
                    <h3><i class="fas fa-play-circle"></i> YouTube Player</h3>
                    <div class="video-controls">
                        <button class="video-btn" onclick="changeYouTubeVideo()">
                            <i class="fas fa-exchange-alt"></i> Video Değiştir
                        </button>
                        <button class="video-btn" onclick="openLiveStream()" id="liveStreamBtn">
                            <i class="fas fa-broadcast-tower"></i> Canlı Yayın
                        </button>
                    </div>
                </div>
                
                <div class="video-container" id="videoContainer">
                    <div class="video-placeholder" id="videoPlaceholder">
                        <i class="fab fa-youtube"></i>
                        <h4>YouTube Video Yayını</h4>
                        <p>Video değiştir butonuna tıklayarak YouTube videosu ekleyin veya canlı yayın başlatın.</p>
                    </div>
                    <iframe id="youtubePlayer" style="display: none;" frameborder="0" allowfullscreen></iframe>
                </div>
            </div>
        </div>

        <!-- MODALLAR -->
        <div class="modal-overlay" id="createChannelModal">
            <div class="modal-container">
                <div class="modal-header">
                    <h3>Yeni Kanal Oluştur</h3>
                </div>
                <div class="modal-content">
                    <input type="text" class="modal-input" id="channelNameInput" placeholder="Kanal adı (örn: #müzik)">
                    <input type="text" class="modal-input" id="channelTopicInput" placeholder="Kanal konusu">
                    <div style="margin-bottom: var(--spacing-md);">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="channelPrivateCheckbox">
                            <span>Özel Kanal</span>
                        </label>
                        <div style="font-size: 11px; color: var(--text-tertiary); margin-top: 4px;">
                            Özel kanallar sadece davet ile girilebilir
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="action-btn" onclick="closeCreateChannelModal()">İptal</button>
                    <button class="action-btn primary" onclick="createChannel()">Oluştur</button>
                </div>
            </div>
        </div>

        <div class="modal-overlay" id="youtubeModal">
            <div class="modal-container">
                <div class="modal-header">
                    <h3>YouTube Video URL</h3>
                </div>
                <div class="modal-content">
                    <input type="text" class="modal-input" id="youtubeUrlInput" placeholder="https://www.youtube.com/watch?v=...">
                    <div style="font-size: 11px; color: var(--text-tertiary); margin-bottom: var(--spacing-md);">
                        YouTube video linkini yapıştırın
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="action-btn" onclick="closeYouTubeModal()">İptal</button>
                    <button class="action-btn primary" onclick="loadYouTubeVideo()">Yükle</button>
                </div>
            </div>
        </div>

        <!-- PROFİL PANELİ -->
        <div class="profile-panel" id="profilePanel">
            <div class="owner-header" style="background: linear-gradient(135deg, #2a0a44, #330033);">
                <h3>Profilim</h3>
                <button class="nav-btn" onclick="toggleProfilePanel()" style="position: absolute; right: var(--spacing-lg);">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="owner-content">
                <div style="text-align: center; padding: var(--spacing-xl);">
                    <div class="user-avatar" id="profileAvatar" style="width: 100px; height: 100px; margin: 0 auto 20px; cursor: pointer;" onclick="changeProfilePhoto()">
                        <i class="fas fa-camera" style="position: absolute; bottom: 5px; right: 5px; background: var(--accent-purple); padding: 4px; border-radius: 50%; font-size: 12px;"></i>
                    </div>
                    <h3 id="profileName">Kullanıcı</h3>
                    <span class="user-role owner" id="profileRole">user</span>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 25px 0;">
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--accent-cyan);" id="profileMessages">0</div>
                            <div style="font-size: 11px; color: var(--text-tertiary);">Mesaj</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--accent-purple);" id="profileStories">0</div>
                            <div style="font-size: 11px; color: var(--text-tertiary);">Hikaye</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: 700; color: var(--accent-green);" id="profileFollowers">0</div>
                            <div style="font-size: 11px; color: var(--text-tertiary);">Takipçi</div>
                        </div>
                    </div>
                    
                    <button class="action-btn primary" style="width: 100%; margin-bottom: 10px;" onclick="editProfile()">
                        <i class="fas fa-edit"></i> Profili Düzenle
                    </button>
                    <button class="action-btn" style="width: 100%; margin-bottom: 10px;" onclick="showMyStories()">
                        <i class="fas fa-images"></i> Hikayelerim
                    </button>
                    <button class="action-btn danger" style="width: 100%;" onclick="handleLogout()">
                        <i class="fas fa-sign-out-alt"></i> Çıkış Yap
                    </button>
                </div>
            </div>
        </div>

        <!-- STORY VIEWER -->
        <div class="story-viewer" id="storyViewer">
            <div style="padding: 20px; background: rgba(0,0,0,0.8); display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div class="user-avatar" id="storyUserAvatar" style="width: 50px; height: 50px;"></div>
                    <div>
                        <div style="font-weight: 600;" id="storyUserName">Kullanıcı</div>
                        <div style="font-size: 12px; opacity: 0.7;" id="storyTime">şimdi</div>
                    </div>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="action-btn small" onclick="reportStory()" id="storyReportBtn">
                        <i class="fas fa-flag"></i> Şikayet
                    </button>
                    <button class="action-btn small danger" onclick="deleteStory()" id="storyDeleteBtn" style="display: none;">
                        <i class="fas fa-trash"></i> Sil
                    </button>
                    <button class="nav-btn" onclick="closeStory()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div style="flex: 1; display: flex; align-items: center; justify-content: center;">
                <img id="storyImage" src="" alt="Story" style="max-width: 90%; max-height: 80vh; border-radius: 10px;">
            </div>
            <div style="padding: 20px; display: flex; justify-content: center; gap: 20px;">
                <button class="action-btn primary" onclick="likeStory()" id="storyLikeBtn">
                    <i class="fas fa-heart"></i> <span id="storyLikes">0</span>
                </button>
                <button class="action-btn" onclick="shareStory()">
                    <i class="fas fa-share"></i> Paylaş
                </button>
            </div>
        </div>

        <!-- GİZLİ INPUT'LAR -->
        <input type="file" id="fileInput" class="hidden" accept="image/*" onchange="handleFileUpload(this.files[0])">
        <input type="file" id="storyInput" class="hidden" accept="image/*" onchange="handleStoryUpload(this.files[0])">
        <input type="file" id="profilePhotoInput" class="hidden" accept="image/*" onchange="handleProfilePhotoChange(this.files[0])">

        <script>
            // ==================== SİSTEM YAPILANDIRMASI ====================
            let currentUser = null;
            let isOwner = false;
            let isAdmin = false;
            let channels = [];
            let currentChannel = null;
            let users = [];
            let privateChats = new Map();
            let stories = [];
            let notifications = [];
            let complaints = [];
            let mateBotCommands = [];
            let systemActivity = [];
            let registeredNicks = new Set();
            let userProfilePhotos = {};
            let storyPhotos = {};
            let isFollowing = {};
            let unreadMessages = {};
            let youtubeVideos = [];
            let liveStreams = [];

            // MATE Bot (Owner'ın sağ kolu)
            const mateBot = {
                id: 'mate_bot',
                name: 'MATE',
                avatar: '🤖',
                role: 'bot',
                online: true,
                owner: 'mateky',
                commands: []
            };

            // Başlangıçta Owner (mateky) kullanıcısını ekle
            const ownerUser = {
                id: 'mateky',
                name: 'mateky',
                avatar: '👑',
                role: 'owner',
                online: false,
                messages: 0,
                stories: 0,
                followers: 0,
                following: 0,
                password: 'mateky123'
            };

            // Default YouTube videoları
            youtubeVideos = [
                'https://www.youtube.com/embed/jfKfPfyJRdk', // Lofi girl
                'https://www.youtube.com/embed/5qap5aO4i9A', // Chill music
                'https://www.youtube.com/embed/0GcY4oE9iq8'  // Jazz music
            ];

            // Başlangıç kanalları
            channels = [
                {
                    id: 'general',
                    name: '#genel',
                    topic: 'Genel sohbet kanalı',
                    owner: 'system',
                    private: false,
                    users: [],
                    messages: [],
                    created: new Date()
                },
                {
                    id: 'music',
                    name: '#müzik',
                    topic: 'Müzik sohbeti',
                    owner: 'system',
                    private: false,
                    users: [],
                    messages: [],
                    created: new Date()
                }
            ];

            // Başlangıç MATE bot komutları
            mateBotCommands = [
                { command: '/help', description: 'Komut listesini göster' },
                { command: '/users', description: 'Çevrimiçi kullanıcıları listele' },
                { command: '/channels', description: 'Kanalları listele' },
                { command: '/rules', description: 'Sohbet kurallarını göster' }
            ];

            // ==================== GİRİŞ SİSTEMİ ====================
            function handleLogin() {
                const nickInput = document.getElementById('nickInput');
                const passInput = document.getElementById('passInput');
                
                const nick = nickInput.value.trim();
                const password = passInput.value;
                
                if (!nick || !password) {
                    alert('Nick ve şifre gerekli!');
                    return;
                }
                
                // Nick koruma kontrolü
                const normalizedNick = nick.toLowerCase();
                const existingNick = Array.from(registeredNicks).find(regNick => 
                    regNick.toLowerCase() === normalizedNick
                );
                
                if (existingNick && existingNick !== normalizedNick) {
                    alert(`Bu nick zaten alınmış! Benzer nickler: ${existingNick}`);
                    return;
                }
                
                // Owner girişi kontrolü
                if (normalizedNick === 'mateky') {
                    if (password === 'mateky123') {
                        currentUser = { ...ownerUser, online: true };
                        isOwner = true;
                        registeredNicks.add('mateky');
                    } else {
                        alert('Owner şifresi yanlış!');
                        return;
                    }
                } else {
                    // Yeni kullanıcı kaydı
                    if (registeredNicks.has(normalizedNick)) {
                        // TODO: Mevcut kullanıcı şifre kontrolü
                        currentUser = {
                            id: normalizedNick,
                            name: nick,
                            avatar: nick.charAt(0).toUpperCase(),
                            role: 'user',
                            online: true,
                            messages: 0,
                            stories: 0,
                            followers: 0,
                            following: 0,
                            password: password
                        };
                    } else {
                        currentUser = {
                            id: normalizedNick,
                            name: nick,
                            avatar: nick.charAt(0).toUpperCase(),
                            role: 'user',
                            online: true,
                            messages: 0,
                            stories: 0,
                            followers: 0,
                            following: 0,
                            password: password
                        };
                        registeredNicks.add(normalizedNick);
                    }
                }
                
                // Kullanıcıyı users listesine ekle
                if (!users.find(u => u.id === currentUser.id)) {
                    users.push(currentUser);
                }
                
                // Login ekranını kapat
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('app').classList.remove('hidden');
                
                // Sistemi başlat
                initializeSystem();
            }

            // ==================== SİSTEM BAŞLATMA ====================
            function initializeSystem() {
                updateUserInfo();
                loadChannels();
                loadUsers();
                setupDefaultChannel();
                loadOwnerPanel();
                
                if (isOwner) {
                    document.getElementById('ownerBtn').style.display = 'flex';
                    addNotification('👑 Owner olarak giriş yaptınız. Tanrı modu aktif!');
                    logActivity(`${currentUser.name} (Owner) sisteme giriş yaptı`);
                }
                
                if (isAdmin) {
                    document.getElementById('adminPanelBtn').style.display = 'flex';
                }
                
                // MATE bot mesajı
                setTimeout(() => {
                    sendSystemMessage(`Hoş geldin ${currentUser.name}! MATE bot hizmetinizde.`);
                }, 1000);
                
                // Online listesi güncelleme
                setInterval(updateOnlineStatus, 30000);
                
                // Nick önerisi
                suggestNick();
            }

            function suggestNick() {
                const suggestions = [
                    `${currentUser.name}123`,
                    `${currentUser.name}_${Math.floor(Math.random() * 1000)}`,
                    `pop${Math.floor(Math.random() * 1000)}`,
                    `user${Math.floor(Math.random() * 10000)}`
                ];
                
                const suggestion = suggestions[Math.floor(Math.random() * suggestions.length)];
                document.getElementById('nickSuggestion').textContent = suggestion;
                document.getElementById('nickSuggestion').onclick = () => {
                    document.getElementById('nickInput').value = suggestion;
                };
            }

            // ==================== KANAL SİSTEMİ ====================
            function toggleChannelList() {
                document.getElementById('channelList').classList.toggle('active');
            }

            function loadChannels() {
                const channelsContainer = document.getElementById('channelsContainer');
                channelsContainer.innerHTML = '';
                
                channels.forEach(channel => {
                    const channelItem = document.createElement('div');
                    channelItem.className = 'channel-item';
                    if (currentChannel && channel.id === currentChannel.id) {
                        channelItem.classList.add('active');
                    }
                    channelItem.onclick = () => switchChannel(channel);
                    
                    channelItem.innerHTML = `
                        <div class="channel-name">
                            ${channel.name}
                            ${channel.private ? '<i class="fas fa-lock channel-private"></i>' : ''}
                        </div>
                        <div class="channel-topic">${channel.topic || 'Konu yok'}</div>
                        <div class="channel-stats">
                            <span>👥 ${channel.users.length}</span>
                            <span>💬 ${channel.messages.length}</span>
                        </div>
                    `;
                    
                    channelsContainer.appendChild(channelItem);
                });
                
                document.getElementById('channelCount').textContent = channels.length;
            }

            function openCreateChannelModal() {
                document.getElementById('createChannelModal').classList.add('active');
            }

            function closeCreateChannelModal() {
                document.getElementById('createChannelModal').classList.remove('active');
            }

            function createChannel() {
                const name = document.getElementById('channelNameInput').value.trim();
                const topic = document.getElementById('channelTopicInput').value.trim();
                const isPrivate = document.getElementById('channelPrivateCheckbox').checked;
                
                if (!name) {
                    alert('Kanal adı gerekli!');
                    return;
                }
                
                const channel = {
                    id: name.toLowerCase().replace(/[^a-z0-9]/g, '_'),
                    name: name.startsWith('#') ? name : `#${name}`,
                    topic: topic,
                    owner: currentUser.id,
                    private: isPrivate,
                    users: [currentUser.id],
                    messages: [],
                    created: new Date(),
                    operators: [currentUser.id],
                    halfOps: []
                };
                
                channels.push(channel);
                loadChannels();
                closeCreateChannelModal();
                
                addNotification(`🎉 Kanal oluşturuldu: ${channel.name}`);
                logActivity(`${currentUser.name} yeni kanal oluşturdu: ${channel.name}`);
                
                // Owner'a bildirim
                if (!isOwner) {
                    addComplaint('channel_create', `${currentUser.name} yeni kanal oluşturdu: ${channel.name}`, currentUser.id);
                }
            }

            function switchChannel(channel) {
                currentChannel = channel;
                
                // Kullanıcıyı kanala ekle
                if (!channel.users.includes(currentUser.id)) {
                    channel.users.push(currentUser.id);
                }
                
                // UI güncelle
                document.getElementById('currentChannel').textContent = channel.name;
                document.getElementById('channelTopic').textContent = channel.topic || 'Konu yok';
                
                // Mesajları yükle
                loadChannelMessages();
                
                // Kanalları yenile
                loadChannels();
                
                // Admin panel butonunu kontrol et
                const isChannelAdmin = channel.owner === currentUser.id || 
                                     channel.operators.includes(currentUser.id) ||
                                     isOwner || isAdmin;
                document.getElementById('adminPanelBtn').style.display = isChannelAdmin ? 'flex' : 'none';
            }

            function setupDefaultChannel() {
                if (channels.length > 0) {
                    switchChannel(channels[0]);
                }
            }

            // ==================== MESAJ SİSTEMİ ====================
            function loadChannelMessages() {
                const chatMessages = document.getElementById('chatMessages');
                chatMessages.innerHTML = '';
                
                if (!currentChannel || !currentChannel.messages) return;
                
                currentChannel.messages.forEach(msg => {
                    addMessageToChat(msg);
                });
            }

            function sendMessage() {
                const input = document.getElementById('messageInput');
                const text = input.value.trim();
                
                if (!text || !currentChannel) return;
                
                // Komut kontrolü
                if (text.startsWith('/')) {
                    handleCommand(text);
                    input.value = '';
                    return;
                }
                
                const message = {
                    id: Date.now(),
                    user: currentUser,
                    text: text,
                    time: new Date(),
                    channel: currentChannel.id,
                    type: 'text'
                };
                
                // Kanal mesaj listesine ekle
                currentChannel.messages.push(message);
                
                // UI'da göster
                addMessageToChat(message);
                
                // İstatistik güncelle
                currentUser.messages++;
                updateUserInfo();
                
                // Owner izleme
                if (!isOwner) {
                    logActivity(`${currentUser.name} (#${currentChannel.name}): ${text}`);
                }
                
                input.value = '';
                
                // Diğer kullanıcılara bildirim
                notifyChannelUsers(currentChannel.id, `${currentUser.name}: ${text.substring(0, 30)}...`);
            }

            function addMessageToChat(msg) {
                const chatMessages = document.getElementById('chatMessages');
                const isOwn = msg.user.id === currentUser.id;
                
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${isOwn ? 'message-outgoing' : 'message-incoming'}`;
                messageDiv.dataset.id = msg.id;
                
                const timeStr = msg.time.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
                
                messageDiv.innerHTML = `
                    <div class="message-sender">
                        ${msg.user.name}
                        ${msg.user.role !== 'user' ? `<span class="user-role ${msg.user.role}">${msg.user.role}</span>` : ''}
                    </div>
                    <div class="message-text">
                        ${escapeHtml(msg.text)}
                        ${(isOwn || isOwner || isAdmin) ? 
                          `<span class="message-delete" onclick="deleteMessage(${msg.id})"><i class="fas fa-trash"></i></span>` : ''}
                    </div>
                    <div class="message-time">${timeStr}</div>
                `;
                
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            function sendSystemMessage(text) {
                if (!currentChannel) return;
                
                const message = {
                    id: Date.now(),
                    user: mateBot,
                    text: text,
                    time: new Date(),
                    channel: currentChannel.id,
                    type: 'system'
                };
                
                currentChannel.messages.push(message);
                addMessageToChat(message);
            }

            function deleteMessage(messageId) {
                if (!currentChannel) return;
                
                const messageIndex = currentChannel.messages.findIndex(m => m.id === messageId);
                if (messageIndex !== -1) {
                    // Yetki kontrolü
                    const message = currentChannel.messages[messageIndex];
                    const canDelete = isOwner || isAdmin || 
                                     currentChannel.owner === currentUser.id ||
                                     currentChannel.operators.includes(currentUser.id) ||
                                     message.user.id === currentUser.id;
                    
                    if (canDelete) {
                        currentChannel.messages.splice(messageIndex, 1);
                        loadChannelMessages();
                        addNotification('Mesaj silindi');
                        logActivity(`${currentUser.name} mesaj sildi (ID: ${messageId})`);
                    } else {
                        alert('Bu mesajı silme yetkiniz yok!');
                    }
                }
            }

            // ==================== KULLANICI SİSTEMİ ====================
            function loadUsers() {
                const userList = document.getElementById('userList');
                userList.innerHTML = '';
                
                const onlineUsers = users.filter(u => u.online);
                
                onlineUsers.forEach(user => {
                    if (user.id === currentUser.id) return;
                    
                    const userItem = document.createElement('div');
                    userItem.className = 'user-item';
                    userItem.onclick = () => openPrivateChat(user);
                    
                    const unread = unreadMessages[user.id] || 0;
                    
                    userItem.innerHTML = `
                        <div class="user-avatar online">
                            ${userProfilePhotos[user.id] ? 
                              `<img src="${userProfilePhotos[user.id]}" alt="${user.name}">` : 
                              user.avatar}
                        </div>
                        <div class="user-info">
                            <div class="user-name">
                                ${user.name}
                                ${user.role !== 'user' ? `<span class="user-role ${user.role}">${user.role}</span>` : ''}
                                ${unread > 0 ? `<span style="margin-left: auto; background: var(--accent-red); color: white; font-size: 10px; padding: 1px 6px; border-radius: 10px;">${unread}</span>` : ''}
                            </div>
                            <div class="user-status">🟢 Çevrimiçi</div>
                        </div>
                    `;
                    
                    userList.appendChild(userItem);
                });
                
                document.getElementById('onlineCount').textContent = onlineUsers.length;
            }

            function searchUsers(query) {
                const userItems = document.querySelectorAll('.user-item');
                query = query.toLowerCase();
                
                userItems.forEach(item => {
                    const userName = item.querySelector('.user-name').textContent.toLowerCase();
                    item.style.display = userName.includes(query) ? 'flex' : 'none';
                });
            }

            function updateOnlineStatus() {
                // Simüle edilmiş çevrimdışı kalma
                users.forEach(user => {
                    if (user.id !== currentUser.id && Math.random() > 0.7) {
                        user.online = false;
                    }
                });
                loadUsers();
            }

            // ==================== ÖZEL SOHBET SİSTEMİ ====================
            function openPrivateChat(user) {
                const chatId = [currentUser.id, user.id].sort().join('_');
                
                if (!privateChats.has(chatId)) {
                    privateChats.set(chatId, {
                        id: chatId,
                        users: [currentUser, user],
                        messages: [],
                        created: new Date()
                    });
                }
                
                // Özel sohbet paneli için buton oluştur
                updatePrivateChatsPanel();
                
                // Sohbet aç
                showPrivateChatModal(chatId);
                
                // Okundu işareti kaldır
                unreadMessages[user.id] = 0;
                loadUsers();
            }

            function updatePrivateChatsPanel() {
                const panel = document.getElementById('privateChatsPanel');
                panel.innerHTML = '';
                
                privateChats.forEach((chat, chatId) => {
                    const otherUser = chat.users.find(u => u.id !== currentUser.id);
                    if (!otherUser) return;
                    
                    const unread = unreadMessages[otherUser.id] || 0;
                    
                    const chatBtn = document.createElement('div');
                    chatBtn.className = 'private-chat-minimized';
                    chatBtn.title = otherUser.name;
                    chatBtn.onclick = () => showPrivateChatModal(chatId);
                    
                    chatBtn.innerHTML = `
                        ${userProfilePhotos[otherUser.id] ? 
                          `<img src="${userProfilePhotos[otherUser.id]}" alt="${otherUser.name}">` : 
                          otherUser.avatar}
                        ${unread > 0 ? `<span class="unread-badge">${unread}</span>` : ''}
                    `;
                    
                    panel.appendChild(chatBtn);
                });
            }

            function showPrivateChatModal(chatId) {
                const chat = privateChats.get(chatId);
                if (!chat) return;
                
                const otherUser = chat.users.find(u => u.id !== currentUser.id);
                if (!otherUser) return;
                
                // Modal oluştur
                const modal = document.createElement('div');
                modal.className = 'modal-overlay active';
                modal.id = `privateChatModal_${chatId}`;
                
                modal.innerHTML = `
                    <div class="modal-container" style="width: 600px; height: 700px;">
                        <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div class="user-avatar online" style="width: 40px; height: 40px;">
                                    ${userProfilePhotos[otherUser.id] ? 
                                      `<img src="${userProfilePhotos[otherUser.id]}" alt="${otherUser.name}">` : 
                                      otherUser.avatar}
                                </div>
                                <div>
                                    <h3>${otherUser.name} ile Özel Sohbet</h3>
                                    <p style="font-size: 12px; color: var(--text-tertiary);">🟢 Çevrimiçi</p>
                                </div>
                            </div>
                            <button class="nav-btn" onclick="document.getElementById('privateChatModal_${chatId}').remove()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-content" style="padding: 0; display: flex; flex-direction: column; height: calc(100% - 130px);">
                            <div id="privateChatMessages_${chatId}" style="flex: 1; overflow-y: auto; padding: var(--spacing-md); display: flex; flex-direction: column; gap: var(--spacing-sm);">
                                ${loadPrivateChatMessages(chatId)}
                            </div>
                            <div style="padding: var(--spacing-md); border-top: 1px solid var(--border-light);">
                                <div class="input-wrapper">
                                    <textarea class="message-input" id="privateMessageInput_${chatId}" placeholder="Mesaj yazın..." rows="1"></textarea>
                                    <button class="send-btn" onclick="sendPrivateMessage('${chatId}')">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                // Enter tuşu ile gönderme
                const input = document.getElementById(`privateMessageInput_${chatId}`);
                input.focus();
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendPrivateMessage(chatId);
                    }
                });
                
                // Textarea otomatik yükseklik
                input.addEventListener('input', function() {
                    this.style.height = 'auto';
                    this.style.height = this.scrollHeight + 'px';
                });
            }

            function loadPrivateChatMessages(chatId) {
                const chat = privateChats.get(chatId);
                if (!chat || chat.messages.length === 0) {
                    return '<div style="text-align: center; padding: 40px; color: var(--text-tertiary);">Henüz mesaj yok</div>';
                }
                
                let html = '';
                chat.messages.forEach(msg => {
                    const isOwn = msg.user.id === currentUser.id;
                    const timeStr = msg.time.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
                    
                    html += `
                        <div style="align-self: ${isOwn ? 'flex-end' : 'flex-start'}; max-width: 70%;">
                            <div style="font-size: 11px; color: var(--text-tertiary); margin-bottom: 2px; ${isOwn ? 'text-align: right;' : ''}">
                                ${msg.user.name} • ${timeStr}
                            </div>
                            <div style="background: ${isOwn ? 'linear-gradient(135deg, var(--accent-purple), var(--accent-cyan))' : 'var(--bg-tertiary)'}; 
                                      color: ${isOwn ? 'white' : 'var(--text-primary)'}; 
                                      padding: 8px 12px; 
                                      border-radius: var(--radius-md); 
                                      word-break: break-word;">
                                ${escapeHtml(msg.text)}
                                ${isOwn ? `<span style="float: right; margin-left: 10px; cursor: pointer; font-size: 10px;" onclick="deletePrivateMessage('${chatId}', ${msg.id})">
                                    <i class="fas fa-trash"></i>
                                </span>` : ''}
                            </div>
                        </div>
                    `;
                });
                
                return html;
            }

            function sendPrivateMessage(chatId) {
                const input = document.getElementById(`privateMessageInput_${chatId}`);
                const text = input.value.trim();
                
                if (!text) return;
                
                const chat = privateChats.get(chatId);
                if (!chat) return;
                
                const message = {
                    id: Date.now(),
                    user: currentUser,
                    text: text,
                    time: new Date(),
                    type: 'private'
                };
                
                chat.messages.push(message);
                
                // Mesajları güncelle
                const messagesDiv = document.getElementById(`privateChatMessages_${chatId}`);
                if (messagesDiv) {
                    messagesDiv.innerHTML = loadPrivateChatMessages(chatId);
                    messagesDiv.scrollTop = messagesDiv.scrollHeight;
                }
                
                // Diğer kullanıcıya okunmamış mesaj bildirimi
                const otherUser = chat.users.find(u => u.id !== currentUser.id);
                if (otherUser) {
                    unreadMessages[otherUser.id] = (unreadMessages[otherUser.id] || 0) + 1;
                    updatePrivateChatsPanel();
                    loadUsers();
                }
                
                input.value = '';
                input.style.height = 'auto';
                
                // Owner izleme
                if (!isOwner) {
                    logActivity(`📩 ${currentUser.name} -> ${otherUser.name}: ${text}`);
                }
            }

            function deletePrivateMessage(chatId, messageId) {
                const chat = privateChats.get(chatId);
                if (!chat) return;
                
                const messageIndex = chat.messages.findIndex(m => m.id === messageId);
                if (messageIndex !== -1) {
                    const message = chat.messages[messageIndex];
                    if (message.user.id === currentUser.id || isOwner) {
                        chat.messages.splice(messageIndex, 1);
                        
                        // Mesajları güncelle
                        const messagesDiv = document.getElementById(`privateChatMessages_${chatId}`);
                        if (messagesDiv) {
                            messagesDiv.innerHTML = loadPrivateChatMessages(chatId);
                        }
                        
                        addNotification('Özel mesaj silindi');
                    }
                }
            }

            // ==================== STORY SİSTEMİ ====================
            function openStoryCreator() {
                document.getElementById('storyInput').click();
            }

            function handleStoryUpload(file) {
                if (!file) return;
                
                if (!file.type.startsWith('image/')) {
                    alert('Sadece resim dosyaları yükleyebilirsiniz!');
                    return;
                }
                
                if (file.size > 5 * 1024 * 1024) {
                    alert('Dosya boyutu 5MB\'dan küçük olmalıdır!');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const storyId = `story_${Date.now()}`;
                    storyPhotos[storyId] = e.target.result;
                    
                    const story = {
                        id: storyId,
                        user: currentUser,
                        image: e.target.result,
                        likes: 0,
                        views: 0,
                        time: new Date(),
                        reported: false,
                        likedBy: []
                    };
                    
                    stories.unshift(story);
                    currentUser.stories++;
                    
                    addNotification('📸 Hikayeniz paylaşıldı!');
                    logActivity(`${currentUser.name} hikaye paylaştı`);
                    
                    updateUserInfo();
                };
                reader.readAsDataURL(file);
            }

            function viewStory(storyId) {
                const story = stories.find(s => s.id === storyId);
                if (!story) return;
                
                // Görüntüleme sayısını artır
                story.views++;
                
                // Story viewer'ı aç
                document.getElementById('storyImage').src = story.image;
                document.getElementById('storyUserName').textContent = story.user.name;
                document.getElementById('storyTime').textContent = getTimeAgo(story.time);
                document.getElementById('storyLikes').textContent = story.likes;
                
                // Avatar
                const avatar = document.getElementById('storyUserAvatar');
                if (userProfilePhotos[story.user.id]) {
                    avatar.innerHTML = `<img src="${userProfilePhotos[story.user.id]}" alt="${story.user.name}">`;
                } else {
                    avatar.textContent = story.user.avatar;
                }
                
                // Sil butonu (sadece kendi hikayesi veya owner/admin)
                const deleteBtn = document.getElementById('storyDeleteBtn');
                if (story.user.id === currentUser.id || isOwner || isAdmin) {
                    deleteBtn.style.display = 'block';
                    deleteBtn.onclick = () => deleteStory(storyId);
                } else {
                    deleteBtn.style.display = 'none';
                }
                
                // Beğeni butonu
                const likeBtn = document.getElementById('storyLikeBtn');
                likeBtn.onclick = () => likeStory(storyId);
                
                // Kapatma butonu
                document.getElementById('storyViewer').classList.add('active');
            }

            function closeStory() {
                document.getElementById('storyViewer').classList.remove('active');
            }

            function likeStory(storyId) {
                const story = stories.find(s => s.id === storyId);
                if (!story) return;
                
                if (!story.likedBy) story.likedBy = [];
                
                const alreadyLiked = story.likedBy.includes(currentUser.id);
                if (alreadyLiked) {
                    // Beğeniyi kaldır
                    story.likedBy = story.likedBy.filter(id => id !== currentUser.id);
                    story.likes--;
                } else {
                    // Beğen
                    story.likedBy.push(currentUser.id);
                    story.likes++;
                }
                
                document.getElementById('storyLikes').textContent = story.likes;
                
                if (!alreadyLiked && story.user.id !== currentUser.id) {
                    addNotification(`❤️ ${story.user.name} kullanıcısının hikayesini beğendiniz`);
                }
            }

            function deleteStory(storyId) {
                if (!confirm('Bu hikayeyi silmek istediğinize emin misiniz?')) return;
                
                const storyIndex = stories.findIndex(s => s.id === storyId);
                if (storyIndex !== -1) {
                    const story = stories[storyIndex];
                    
                    // Yetki kontrolü
                    if (story.user.id === currentUser.id || isOwner || isAdmin) {
                        stories.splice(storyIndex, 1);
                        story.user.stories--;
                        
                        addNotification('Hikaye silindi');
                        logActivity(`${currentUser.name} hikaye sildi`);
                        
                        closeStory();
                        updateUserInfo();
                    }
                }
            }

            function reportStory() {
                const storyId = document.getElementById('storyImage').src.split('_').pop();
                const story = stories.find(s => s.id === `story_${storyId}`);
                
                if (story && !story.reported) {
                    story.reported = true;
                    addComplaint('story', `${story.user.name} kullanıcısının hikayesi şikayet edildi`, story.user.id);
                    addNotification('Hikaye şikayet edildi. Yöneticilere bildirildi.');
                    closeStory();
                }
            }

            // ==================== OWNER PANELİ ====================
            function toggleOwnerPanel() {
                if (!isOwner) {
                    alert('Bu panele sadece Owner erişebilir!');
                    return;
                }
                
                document.getElementById('ownerPanel').classList.toggle('active');
                if (document.getElementById('ownerPanel').classList.contains('active')) {
                    switchOwnerTab(0);
                }
            }

            function switchOwnerTab(tabIndex) {
                const tabs = document.querySelectorAll('.owner-tab');
                tabs.forEach((tab, index) => {
                    if (index === tabIndex) {
                        tab.classList.add('active');
                    } else {
                        tab.classList.remove('active');
                    }
                });
                
                loadOwnerTabContent(tabIndex);
            }

            function loadOwnerPanel() {
                // Şikayetleri yükle
                loadComplaints();
            }

            function loadOwnerTabContent(tabIndex) {
                const content = document.getElementById('ownerContent');
                
                switch(tabIndex) {
                    case 0: // İzleme
                        content.innerHTML = `
                            <div class="owner-section">
                                <h4><i class="fas fa-eye"></i> Özel Sohbet İzleme</h4>
                                <div id="spyChatsList">
                                    ${loadSpyChatsHTML()}
                                </div>
                            </div>
                            <div class="owner-section">
                                <h4><i class="fas fa-bolt"></i> Sistem Aktivitesi</h4>
                                <div id="systemActivity">
                                    ${loadSystemActivityHTML()}
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 1: // MATE Bot
                        content.innerHTML = `
                            <div class="owner-section">
                                <h4><i class="fas fa-robot"></i> MATE Bot Kontrolü</h4>
                                <div class="bot-controls">
                                    <button class="action-btn primary" onclick="addMateCommand()">
                                        <i class="fas fa-plus"></i> Yeni Komut Ekle
                                    </button>
                                    <button class="action-btn" onclick="editMateCommands()">
                                        <i class="fas fa-edit"></i> Komutları Düzenle
                                    </button>
                                    <button class="action-btn danger" onclick="clearMateCommands()">
                                        <i class="fas fa-trash"></i> Tüm Komutları Sil
                                    </button>
                                </div>
                                <div style="margin-top: 20px;">
                                    <h5>Mevcut Komutlar:</h5>
                                    ${loadMateCommandsHTML()}
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 2: // Adminler
                        content.innerHTML = `
                            <div class="owner-section">
                                <h4><i class="fas fa-shield-alt"></i> Admin Yönetimi</h4>
                                <button class="action-btn primary" onclick="addAdmin()" style="margin-bottom: 15px;">
                                    <i class="fas fa-user-plus"></i> Admin Ekle
                                </button>
                                <div class="admin-list" id="adminList">
                                    ${loadAdminsHTML()}
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 3: // Kanallar
                        content.innerHTML = `
                            <div class="owner-section">
                                <h4><i class="fas fa-hashtag"></i> Kanal Yönetimi</h4>
                                <div id="ownerChannelsList">
                                    ${loadOwnerChannelsHTML()}
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 4: // Şikayetler
                        content.innerHTML = `
                            <div class="owner-section">
                                <h4><i class="fas fa-flag"></i> Şikayet Yönetimi</h4>
                                <div id="ownerComplaints">
                                    ${loadOwnerComplaintsHTML()}
                                </div>
                            </div>
                        `;
                        break;
                }
            }

            // ==================== YARDIMCI FONKSİYONLAR ====================
            function updateUserInfo() {
                const userInfo = document.getElementById('userInfo');
                if (!userInfo) return;
                
                userInfo.innerHTML = `
                    <div class="user-avatar">
                        ${userProfilePhotos[currentUser.id] ? 
                          `<img src="${userProfilePhotos[currentUser.id]}" alt="${currentUser.name}">` : 
                          currentUser.avatar}
                    </div>
                    <div style="text-align: right;">
                        <div class="user-name">${currentUser.name}</div>
                        <span class="user-role ${currentUser.role}">${currentUser.role}</span>
                    </div>
                `;
                
                // Profil panelini güncelle
                document.getElementById('profileName').textContent = currentUser.name;
                document.getElementById('profileRole').textContent = currentUser.role;
                document.getElementById('profileRole').className = `user-role ${currentUser.role}`;
                document.getElementById('profileMessages').textContent = currentUser.messages;
                document.getElementById('profileStories').textContent = currentUser.stories;
                document.getElementById('profileFollowers').textContent = currentUser.followers;
                
                // Profil avatar
                const profileAvatar = document.getElementById('profileAvatar');
                if (userProfilePhotos[currentUser.id]) {
                    profileAvatar.innerHTML = `<img src="${userProfilePhotos[currentUser.id]}" alt="${currentUser.name}">`;
                } else {
                    profileAvatar.textContent = currentUser.avatar;
                }
            }

            function toggleProfilePanel() {
                document.getElementById('profilePanel').classList.toggle('active');
            }

            function changeProfilePhoto() {
                document.getElementById('profilePhotoInput').click();
            }

            function handleProfilePhotoChange(file) {
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    userProfilePhotos[currentUser.id] = e.target.result;
                    updateUserInfo();
                    loadUsers();
                    addNotification('Profil fotoğrafınız güncellendi');
                };
                reader.readAsDataURL(file);
            }

            function editProfile() {
                const newName = prompt('Yeni kullanıcı adı:', currentUser.name);
                if (newName && newName.trim() && newName !== currentUser.name) {
                    // Nick koruma kontrolü
                    const normalizedNewName = newName.toLowerCase();
                    const existingNick = Array.from(registeredNicks).find(regNick => 
                        regNick.toLowerCase() === normalizedNewName
                    );
                    
                    if (existingNick && existingNick !== currentUser.id) {
                        alert('Bu nick zaten alınmış!');
                        return;
                    }
                    
                    // Eski nick'i kaldır
                    registeredNicks.delete(currentUser.id);
                    
                    // Yeni nick'i ekle
                    currentUser.name = newName;
                    currentUser.avatar = newName.charAt(0).toUpperCase();
                    currentUser.id = normalizedNewName;
                    registeredNicks.add(normalizedNewName);
                    
                    updateUserInfo();
                    addNotification('Profiliniz güncellendi');
                }
            }

            function toggleNotifications() {
                // Bildirimler modalı
                let html = '<div class="modal-overlay active"><div class="modal-container"><div class="modal-header"><h3>Bildirimler</h3><button class="nav-btn" onclick="this.parentElement.parentElement.parentElement.remove()"><i class="fas fa-times"></i></button></div><div class="modal-content">';
                
                if (notifications.length === 0) {
                    html += '<div style="text-align: center; padding: 40px; color: var(--text-tertiary);">Henüz bildirim yok</div>';
                } else {
                    notifications.slice(0, 10).forEach(notif => {
                        html += `
                            <div style="padding: 10px; border-bottom: 1px solid var(--border-light);">
                                <div style="font-size: 12px; color: var(--text-tertiary); margin-bottom: 4px;">${getTimeAgo(notif.time)}</div>
                                <div>${notif.text}</div>
                            </div>
                        `;
                    });
                }
                
                html += '</div></div></div>';
                
                document.body.insertAdjacentHTML('beforeend', html);
            }

            function addNotification(text) {
                notifications.unshift({
                    id: Date.now(),
                    text: text,
                    time: new Date(),
                    read: false
                });
                
                const badge = document.getElementById('notificationBadge');
                const unread = notifications.filter(n => !n.read).length;
                badge.textContent = unread > 9 ? '9+' : unread;
                badge.style.display = unread > 0 ? 'flex' : 'none';
            }

            function logActivity(text) {
                systemActivity.unshift({
                    id: Date.now(),
                    text: text,
                    time: new Date(),
                    user: currentUser.name
                });
                
                if (systemActivity.length > 50) {
                    systemActivity = systemActivity.slice(0, 50);
                }
            }

            function addComplaint(type, text, userId) {
                complaints.push({
                    id: Date.now(),
                    type: type,
                    text: text,
                    userId: userId,
                    time: new Date(),
                    resolved: false
                });
                
                if (isOwner || isAdmin) {
                    addNotification('🚨 Yeni şikayet var!');
                }
            }

            function loadComplaints() {
                // Şikayetleri yükle
                return complaints;
            }

            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            function getTimeAgo(date) {
                const now = new Date();
                const diff = now - new Date(date);
                
                const minutes = Math.floor(diff / 60000);
                const hours = Math.floor(diff / 3600000);
                const days = Math.floor(diff / 86400000);
                
                if (minutes < 1) return 'şimdi';
                if (minutes < 60) return `${minutes} dakika önce`;
                if (hours < 24) return `${hours} saat önce`;
                return `${days} gün önce`;
            }

            // ==================== YOUTUBE SİSTEMİ ====================
            function changeYouTubeVideo() {
                document.getElementById('youtubeModal').classList.add('active');
            }

            function closeYouTubeModal() {
                document.getElementById('youtubeModal').classList.remove('active');
            }

            function loadYouTubeVideo() {
                const url = document.getElementById('youtubeUrlInput').value.trim();
                
                if (!url.includes('youtube.com') && !url.includes('youtu.be')) {
                    alert('Geçerli bir YouTube URL\'si girin!');
                    return;
                }
                
                // Video ID'yi çıkar
                let videoId = '';
                if (url.includes('v=')) {
                    videoId = url.split('v=')[1].split('&')[0];
                } else if (url.includes('youtu.be/')) {
                    videoId = url.split('youtu.be/')[1].split('?')[0];
                }
                
                if (videoId) {
                    const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
                    document.getElementById('youtubePlayer').src = embedUrl;
                    document.getElementById('youtubePlayer').style.display = 'block';
                    document.getElementById('videoPlaceholder').style.display = 'none';
                    
                    addNotification('YouTube videosu yüklendi');
                    logActivity(`${currentUser.name} YouTube videosu yükledi`);
                }
                
                closeYouTubeModal();
            }

            function openLiveStream() {
                if (!isOwner && !isAdmin && (!currentChannel || currentChannel.owner !== currentUser.id)) {
                    alert('Canlı yayın yapmak için kanal sahibi veya yetkili olmalısınız!');
                    return;
                }
                
                alert('Canlı yayın özelliği aktifleştiriliyor... (Demo)');
                // Gerçek uygulamada WebRTC entegrasyonu gerekli
            }

            // ==================== ÇIKIŞ İŞLEMLERİ ====================
            function handleLogout() {
                if (confirm('Çıkış yapmak istediğinize emin misiniz?')) {
                    if (currentUser) {
                        currentUser.online = false;
                    }
                    location.reload();
                }
            }

            // ==================== HTML LOADER FONKSİYONLARI ====================
            function loadSpyChatsHTML() {
                let html = '';
                privateChats.forEach((chat, chatId) => {
                    const otherUser = chat.users.find(u => u.id !== currentUser.id);
                    if (otherUser) {
                        html += `
                            <div class="spy-chat-item" onclick="spyOnChat('${chatId}')">
                                <div style="font-weight: 500;">${chat.users[0].name} ↔ ${chat.users[1].name}</div>
                                <div style="font-size: 11px; color: var(--text-tertiary);">
                                    ${chat.messages.length} mesaj • ${getTimeAgo(chat.created)}
                                </div>
                            </div>
                        `;
                    }
                });
                
                return html || '<div style="text-align: center; padding: 20px; color: var(--text-tertiary);">Henüz özel sohbet yok</div>';
            }

            function loadSystemActivityHTML() {
                let html = '';
                systemActivity.slice(0, 10).forEach(activity => {
                    html += `
                        <div style="padding: 8px; border-bottom: 1px solid var(--border-light);">
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-size: 12px;">${activity.user}</span>
                                <span style="font-size: 11px; color: var(--text-tertiary);">${getTimeAgo(activity.time)}</span>
                            </div>
                            <div style="font-size: 12px; color: var(--text-secondary);">${activity.text}</div>
                        </div>
                    `;
                });
                
                return html || '<div style="text-align: center; padding: 20px; color: var(--text-tertiary);">Henüz aktivite yok</div>';
            }

            function loadMateCommandsHTML() {
                let html = '';
                mateBotCommands.forEach((cmd, index) => {
                    html += `
                        <div class="bot-command-item">
                            <div>
                                <div style="font-family: var(--font-mono); font-weight: 500;">${cmd.command}</div>
                                <div style="font-size: 11px; color: var(--text-tertiary);">${cmd.description}</div>
                            </div>
                            <div class="command-actions">
                                <button class="action-btn small" onclick="editMateCommand(${index})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn small danger" onclick="deleteMateCommand(${index})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                return html || '<div style="text-align: center; padding: 20px; color: var(--text-tertiary);">Henüz komut eklenmedi</div>';
            }

            function loadAdminsHTML() {
                const admins = users.filter(u => u.role === 'admin');
                let html = '';
                
                admins.forEach(admin => {
                    html += `
                        <div class="admin-item">
                            <div>
                                <div style="font-weight: 500;">${admin.name}</div>
                                <div style="font-size: 11px; color: var(--text-tertiary);">${getTimeAgo(new Date(admin.joined || Date.now()))}</div>
                            </div>
                            <button class="action-btn small danger" onclick="removeAdmin('${admin.id}')">
                                <i class="fas fa-user-slash"></i>
                            </button>
                        </div>
                    `;
                });
                
                return html || '<div style="text-align: center; padding: 20px; color: var(--text-tertiary);">Henüz admin yok</div>';
            }

            function loadOwnerChannelsHTML() {
                let html = '';
                channels.forEach(channel => {
                    html += `
                        <div class="channel-admin-item">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <div style="font-weight: 500;">${channel.name}</div>
                                <div>
                                    <button class="action-btn small" onclick="editChannel('${channel.id}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="action-btn small danger" onclick="deleteChannel('${channel.id}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">
                                Sahip: ${channel.owner} • ${channel.users.length} kullanıcı
                            </div>
                            <div style="font-size: 11px; color: var(--text-tertiary);">
                                ${channel.private ? '🔒 Özel' : '🌐 Genel'} • ${getTimeAgo(channel.created)}
                            </div>
                        </div>
                    `;
                });
                
                return html;
            }

            function loadOwnerComplaintsHTML() {
                let html = '';
                complaints.slice(0, 10).forEach(complaint => {
                    if (!complaint.resolved) {
                        html += `
                            <div class="complaint-item">
                                <div class="complaint-header">
                                    <div style="font-weight: 500;">${complaint.type}</div>
                                    <span class="complaint-count">${complaint.userId}</span>
                                </div>
                                <div style="font-size: 12px; margin-bottom: 8px;">${complaint.text}</div>
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span style="font-size: 11px; color: var(--text-tertiary);">${getTimeAgo(complaint.time)}</span>
                                    <button class="action-btn small" onclick="resolveComplaint(${complaint.id})">
                                        Çözüldü
                                    </button>
                                </div>
                            </div>
                        `;
                    }
                });
                
                return html || '<div style="text-align: center; padding: 20px; color: var(--text-tertiary);">Henüz şikayet yok</div>';
            }

            // ==================== OWNER FONKSİYONLARI ====================
            function spyOnChat(chatId) {
                // Özel sohbeti izleme
                const chat = privateChats.get(chatId);
                if (!chat) return;
                
                const modal = document.createElement('div');
                modal.className = 'modal-overlay active';
                modal.innerHTML = `
                    <div class="modal-container" style="width: 700px; height: 800px;">
                        <div class="modal-header">
                            <h3>👁️ Özel Sohbet İzleme: ${chat.users[0].name} ↔ ${chat.users[1].name}</h3>
                            <button class="nav-btn" onclick="this.parentElement.parentElement.parentElement.remove()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-content" style="height: calc(100% - 130px); overflow-y: auto;">
                            ${chat.messages.length === 0 ? 
                              '<div style="text-align: center; padding: 40px; color: var(--text-tertiary);">Henüz mesaj yok</div>' : 
                              chat.messages.map(msg => `
                                  <div style="padding: 10px; border-bottom: 1px solid var(--border-light);">
                                      <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                          <span style="font-weight: 500; color: ${msg.user.id === chat.users[0].id ? 'var(--accent-cyan)' : 'var(--accent-purple)'};">${msg.user.name}</span>
                                          <span style="font-size: 11px; color: var(--text-tertiary);">${getTimeAgo(msg.time)}</span>
                                      </div>
                                      <div>${escapeHtml(msg.text)}</div>
                                  </div>
                              `).join('')}
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                logActivity(`👁️ Owner özel sohbet izliyor: ${chat.users[0].name} ↔ ${chat.users[1].name}`);
            }

            function addMateCommand() {
                if (!isOwner) return;
                
                const command = prompt('Komut (örn: /help):');
                if (!command || !command.startsWith('/')) {
                    alert('Komut / ile başlamalıdır!');
                    return;
                }
                
                const description = prompt('Komut açıklaması:');
                if (!description) {
                    alert('Açıklama gerekli!');
                    return;
                }
                
                mateBotCommands.push({ command, description });
                addNotification('MATE bot komutu eklendi');
                logActivity(`MATE komut eklendi: ${command}`);
                
                // UI'yı yenile
                switchOwnerTab(1);
            }

            function deleteMateCommand(index) {
                if (!isOwner) return;
                
                if (confirm('Bu komutu silmek istediğinize emin misiniz?')) {
                    mateBotCommands.splice(index, 1);
                    addNotification('MATE bot komutu silindi');
                    switchOwnerTab(1);
                }
            }

            function clearMateCommands() {
                if (!isOwner) return;
                
                if (confirm('Tüm MATE bot komutlarını silmek istediğinize emin misiniz?')) {
                    mateBotCommands = [];
                    addNotification('Tüm MATE bot komutları silindi');
                    switchOwnerTab(1);
                }
            }

            function addAdmin() {
                if (!isOwner) return;
                
                const nick = prompt('Admin yapılacak kullanıcı nicki:');
                if (!nick) return;
                
                const user = users.find(u => u.id === nick.toLowerCase());
                if (!user) {
                    alert('Kullanıcı bulunamadı!');
                    return;
                }
                
                user.role = 'admin';
                user.joined = new Date();
                
                addNotification(`${user.name} admin yapıldı`);
                logActivity(`Admin eklendi: ${user.name}`);
                
                // UI'yı yenile
                switchOwnerTab(2);
            }

            function removeAdmin(userId) {
                if (!isOwner) return;
                
                const user = users.find(u => u.id === userId);
                if (user && user.role === 'admin') {
                    user.role = 'user';
                    addNotification(`${user.name} adminlikten çıkarıldı`);
                    logActivity(`Admin kaldırıldı: ${user.name}`);
                    switchOwnerTab(2);
                }
            }

            function deleteChannel(channelId) {
                if (!isOwner) return;
                
                if (confirm('Bu kanalı silmek istediğinize emin misiniz?')) {
                    const index = channels.findIndex(c => c.id === channelId);
                    if (index !== -1) {
                        const channel = channels[index];
                        channels.splice(index, 1);
                        
                        // Eğer silinen kanal şu anki kanal ise, genel kanala geç
                        if (currentChannel && currentChannel.id === channelId) {
                            setupDefaultChannel();
                        }
                        
                        addNotification(`Kanal silindi: ${channel.name}`);
                        logActivity(`Kanal silindi: ${channel.name}`);
                        
                        loadChannels();
                        switchOwnerTab(3);
                    }
                }
            }

            function resolveComplaint(complaintId) {
                if (!isOwner && !isAdmin) return;
                
                const complaint = complaints.find(c => c.id === complaintId);
                if (complaint) {
                    complaint.resolved = true;
                    addNotification('Şikayet çözüldü');
                    switchOwnerTab(4);
                }
            }

            // ==================== COMMAND HANDLER ====================
            function handleCommand(command) {
                const parts = command.split(' ');
                const cmd = parts[0].toLowerCase();
                const args = parts.slice(1);
                
                switch(cmd) {
                    case '/help':
                        showHelp();
                        break;
                    case '/users':
                        listUsers();
                        break;
                    case '/channels':
                        listChannels();
                        break;
                    case '/nick':
                        if (args.length > 0) changeNickCommand(args[0]);
                        break;
                    case '/msg':
                        if (args.length > 1) privateMessageCommand(args[0], args.slice(1).join(' '));
                        break;
                    case '/op':
                        if (isOwner || isAdmin || (currentChannel && currentChannel.owner === currentUser.id)) {
                            if (args.length > 0) giveOperator(args[0]);
                        } else {
                            sendSystemMessage('Bu komut için yetkiniz yok!');
                        }
                        break;
                    case '/deop':
                        if (isOwner || isAdmin || (currentChannel && currentChannel.owner === currentUser.id)) {
                            if (args.length > 0) removeOperator(args[0]);
                        } else {
                            sendSystemMessage('Bu komut için yetkiniz yok!');
                        }
                        break;
                    case '/kick':
                        if (isOwner || isAdmin || (currentChannel && currentChannel.operators.includes(currentUser.id))) {
                            if (args.length > 0) kickUser(args[0], args.slice(1).join(' '));
                        } else {
                            sendSystemMessage('Bu komut için yetkiniz yok!');
                        }
                        break;
                    case '/ban':
                        if (isOwner || isAdmin) {
                            if (args.length > 0) banUser(args[0], args.slice(1).join(' '));
                        } else {
                            sendSystemMessage('Bu komut için yetkiniz yok!');
                        }
                        break;
                    default:
                        // MATE bot komutlarını kontrol et
                        const mateCmd = mateBotCommands.find(c => c.command === cmd);
                        if (mateCmd) {
                            sendSystemMessage(`🤖 ${cmd}: ${mateCmd.description}`);
                        } else {
                            sendSystemMessage(`❌ Bilinmeyen komut: ${cmd}`);
                        }
                }
            }

            function showHelp() {
                let helpText = '📋 Kullanılabilir Komutlar:\n';
                
                // Genel komutlar
                helpText += '  /help - Bu mesajı göster\n';
                helpText += '  /users - Çevrimiçi kullanıcıları listele\n';
                helpText += '  /channels - Kanalları listele\n';
                helpText += '  /nick <yeni_nick> - Nick değiştir\n';
                helpText += '  /msg <nick> <mesaj> - Özel mesaj gönder\n';
                
                // Yetkili komutları
                if (isOwner || isAdmin || (currentChannel && currentChannel.operators.includes(currentUser.id))) {
                    helpText += '\n🛡️ Yetkili Komutları:\n';
                    helpText += '  /op <nick> - Operatör yap\n';
                    helpText += '  /deop <nick> - Operatörlüğü kaldır\n';
                    helpText += '  /kick <nick> [sebep] - Kanaldan at\n';
                    
                    if (isOwner || isAdmin) {
                        helpText += '  /ban <nick> [sebep] - Siteden yasakla\n';
                    }
                }
                
                // MATE bot komutları
                if (mateBotCommands.length > 0) {
                    helpText += '\n🤖 MATE Bot Komutları:\n';
                    mateBotCommands.forEach(cmd => {
                        helpText += `  ${cmd.command} - ${cmd.description}\n`;
                    });
                }
                
                sendSystemMessage(helpText);
            }

            function listUsers() {
                const onlineUsers = users.filter(u => u.online);
                let userList = `👥 Çevrimiçi Kullanıcılar (${onlineUsers.length}):\n`;
                
                onlineUsers.forEach(user => {
                    userList += `  ${user.name} (${user.role})${user.id === currentUser.id ? ' 👈 Siz' : ''}\n`;
                });
                
                sendSystemMessage(userList);
            }

            function listChannels() {
                let channelList = `📺 Kanallar (${channels.length}):\n`;
                
                channels.forEach(channel => {
                    channelList += `  ${channel.name} - ${channel.topic || 'Konu yok'} (${channel.users.length} kişi)\n`;
                });
                
                sendSystemMessage(channelList);
            }

            function changeNickCommand(newNick) {
                // Bu fonksiyon nick değiştirmeyi sağlar
                const normalizedNewNick = newNick.toLowerCase();
                const existingNick = Array.from(registeredNicks).find(regNick => 
                    regNick.toLowerCase() === normalizedNewNick
                );
                
                if (existingNick && existingNick !== currentUser.id) {
                    sendSystemMessage(`❌ Bu nick zaten alınmış: ${newNick}`);
                    return;
                }
                
                // Eski nick'i kaldır
                registeredNicks.delete(currentUser.id);
                
                // Yeni nick'i ekle
                currentUser.name = newNick;
                currentUser.avatar = newNick.charAt(0).toUpperCase();
                currentUser.id = normalizedNewNick;
                registeredNicks.add(normalizedNewNick);
                
                updateUserInfo();
                loadUsers();
                sendSystemMessage(`✅ Nick değiştirildi: ${newNick}`);
            }

            function privateMessageCommand(targetNick, message) {
                const targetUser = users.find(u => u.id === targetNick.toLowerCase() || u.name.toLowerCase() === targetNick.toLowerCase());
                if (targetUser) {
                    openPrivateChat(targetUser);
                    // Modal açıldıktan sonra mesajı gönder
                    setTimeout(() => {
                        const chatId = [currentUser.id, targetUser.id].sort().join('_');
                        const input = document.getElementById(`privateMessageInput_${chatId}`);
                        if (input) {
                            input.value = message;
                            sendPrivateMessage(chatId);
                        }
                    }, 500);
                } else {
                    sendSystemMessage(`❌ Kullanıcı bulunamadı: ${targetNick}`);
                }
            }

            function giveOperator(nick) {
                if (!currentChannel) return;
                
                const user = users.find(u => u.id === nick.toLowerCase() || u.name.toLowerCase() === nick.toLowerCase());
                if (user && !currentChannel.operators.includes(user.id)) {
                    currentChannel.operators.push(user.id);
                    sendSystemMessage(`⚡ ${user.name} operatör yapıldı`);
                    
                    // Admin panel butonunu güncelle
                    if (user.id === currentUser.id) {
                        document.getElementById('adminPanelBtn').style.display = 'flex';
                    }
                }
            }

            function removeOperator(nick) {
                if (!currentChannel) return;
                
                const user = users.find(u => u.id === nick.toLowerCase() || u.name.toLowerCase() === nick.toLowerCase());
                if (user && currentChannel.operators.includes(user.id)) {
                    const index = currentChannel.operators.indexOf(user.id);
                    currentChannel.operators.splice(index, 1);
                    sendSystemMessage(`⚡ ${user.name} operatörlüğü kaldırıldı`);
                    
                    // Admin panel butonunu güncelle
                    if (user.id === currentUser.id && currentChannel.owner !== currentUser.id && !isOwner && !isAdmin) {
                        document.getElementById('adminPanelBtn').style.display = 'none';
                    }
                }
            }

            function kickUser(nick, reason) {
                if (!currentChannel) return;
                
                const user = users.find(u => u.id === nick.toLowerCase() || u.name.toLowerCase() === nick.toLowerCase());
                if (user && user.id !== currentChannel.owner) {
                    // Kanal kullanıcı listesinden çıkar
                    const index = currentChannel.users.indexOf(user.id);
                    if (index !== -1) {
                        currentChannel.users.splice(index, 1);
                        sendSystemMessage(`🚪 ${user.name} kanaldan atıldı${reason ? `: ${reason}` : ''}`);
                        
                        // Eğer atılan kullanıcı şu anki kullanıcı ise, kanaldan çık
                        if (user.id === currentUser.id) {
                            setupDefaultChannel();
                        }
                    }
                }
            }

            function banUser(nick, reason) {
                const user = users.find(u => u.id === nick.toLowerCase() || u.name.toLowerCase() === nick.toLowerCase());
                if (user && user.id !== 'mateky') {
                    // Kullanıcıyı tüm kanallardan çıkar
                    channels.forEach(channel => {
                        const index = channel.users.indexOf(user.id);
                        if (index !== -1) {
                            channel.users.splice(index, 1);
                        }
                    });
                    
                    // Çevrimdışı yap
                    user.online = false;
                    
                    sendSystemMessage(`🚫 ${user.name} yasaklandı${reason ? `: ${reason}` : ''}`);
                    addNotification(`${user.name} kullanıcısı yasaklandı`);
                    
                    loadUsers();
                    loadChannels();
                }
            }

            // ==================== TAMAMLANMAMIŞ FONKSİYONLAR ====================
            function toggleAdminPanel() {
                if (!isAdmin && !isOwner && (!currentChannel || !currentChannel.operators.includes(currentUser.id))) {
                    alert('Yönetim paneli için yetkiniz yok!');
                    return;
                }
                document.getElementById('adminPanel').classList.toggle('active');
            }

            function notifyChannelUsers(channelId, message) {
                // Kanal kullanıcılarına bildirim
                // WebSocket entegrasyonu gerektirir
            }

            // ==================== EVENT LISTENERS ====================
            document.addEventListener('DOMContentLoaded', function() {
                // Enter tuşu ile mesaj gönderme
                document.getElementById('messageInput').addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessage();
                    }
                });
                
                // Textarea otomatik yükseklik
                const adjustTextarea = function(textarea) {
                    textarea.style.height = 'auto';
                    textarea.style.height = textarea.scrollHeight + 'px';
                };
                
                document.getElementById('messageInput').addEventListener('input', function() {
                    adjustTextarea(this);
                });
                
                // Login enter tuşu
                document.getElementById('nickInput').addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') handleLogin();
                });
                
                document.getElementById('passInput').addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') handleLogin();
                });
                
                // Owner kullanıcısını başlat
                registeredNicks.add('mateky');
                users.push(ownerUser);
                
                // Başlangıçta birkaç demo kullanıcı
                const demoUsers = [
                    { id: 'user1', name: 'Ahmet', avatar: 'A', role: 'user', online: true, messages: 5, stories: 2, followers: 3, following: 5, password: '123' },
                    { id: 'user2', name: 'Ayşe', avatar: 'A', role: 'user', online: true, messages: 12, stories: 1, followers: 7, following: 4, password: '123' },
                    { id: 'user3', name: 'Mehmet', avatar: 'M', role: 'user', online: false, messages: 8, stories: 0, followers: 2, following: 3, password: '123' }
                ];
                
                demoUsers.forEach(user => {
                    if (!users.find(u => u.id === user.id)) {
                        users.push(user);
                        registeredNicks.add(user.id);
                    }
                });
                
                // MATE bot'u ekle
                users.push(mateBot);
            });
        </script>
    </div>
</body>
</html>
