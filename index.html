<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popbox Elite</title>
    
    <style>
        /* ZARƒ∞F VE SADE STƒ∞L - DeepSeek tarzƒ± */
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #fafafa;
            --bg-sidebar: #f5f7fa;
            --bg-header: #ffffff;
            --bg-input: #ffffff;
            --bg-card: #ffffff;
            --bg-modal: #ffffff;
            --bg-hover: #f0f2f5;
            --bg-overlay: rgba(0,0,0,0.7);
            
            --text-primary: #1a1a1a;
            --text-secondary: #595959;
            --text-light: #8c8c8c;
            --text-muted: #bfbfbf;
            
            --border-color: #e8e8e8;
            --border-hover: #d9d9d9;
            
            --primary: #1890ff;
            --primary-light: #e6f7ff;
            --primary-hover: #40a9ff;
            --danger: #ff4d4f;
            --success: #52c41a;
            --warning: #faad14;
            --info: #13c2c2;
            --purple: #722ed1;
            --orange: #fa8c16;
            
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.03);
            --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 4px 16px rgba(0, 0, 0, 0.08);
            --shadow-xl: 0 8px 32px rgba(0, 0, 0, 0.12);
            
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --radius-round: 50%;
            
            --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        body.dark-mode {
            --bg-primary: #141414;
            --bg-secondary: #1f1f1f;
            --bg-sidebar: #1a1a1a;
            --bg-header: #141414;
            --bg-input: #262626;
            --bg-card: #1f1f1f;
            --bg-modal: #1f1f1f;
            --bg-hover: #2a2a2a;
            --bg-overlay: rgba(0,0,0,0.9);
            
            --text-primary: #ffffff;
            --text-secondary: #bfbfbf;
            --text-light: #8c8c8c;
            --text-muted: #595959;
            
            --border-color: #303030;
            --border-hover: #434343;
            
            --primary: #177ddc;
            --primary-light: #111b26;
            --primary-hover: #3c9ae8;
            
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 4px 16px rgba(0, 0, 0, 0.5);
            --shadow-xl: 0 8px 32px rgba(0, 0, 0, 0.6);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }
        
        html, body {
            height: 100%;
            width: 100%;
            overflow: hidden;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 14px;
            line-height: 1.5715;
        }
        
        /* ANA LAYOUT */
        .app-container {
            display: flex;
            height: 100vh;
            width: 100vw;
        }
        
        /* SOL Sƒ∞DEBAR - MEDIA/Vƒ∞DEO B√úY√úK */
        .media-sidebar {
            width: 280px;
            background: var(--bg-sidebar);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .media-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-header);
        }
        
        .media-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
        }
        
        .media-container {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }
        
        .media-item {
            width: 100%;
            margin-bottom: 12px;
            border-radius: var(--radius-lg);
            overflow: hidden;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            transition: var(--transition);
        }
        
        .media-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .media-preview {
            width: 100%;
            height: 160px;
            object-fit: cover;
            display: block;
        }
        
        .media-info {
            padding: 12px;
        }
        
        .media-user {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 4px;
        }
        
        .media-time {
            font-size: 11px;
            color: var(--text-light);
        }
        
        /* STORY BAR - √úSTTE KAYDIRILABƒ∞Lƒ∞R */
        .story-bar {
            height: 120px;
            background: var(--bg-header);
            border-bottom: 1px solid var(--border-color);
            overflow-x: auto;
            overflow-y: hidden;
            white-space: nowrap;
            display: flex;
            align-items: center;
            padding: 0 20px;
            scrollbar-width: none;
        }
        
        .story-bar::-webkit-scrollbar {
            display: none;
        }
        
        .story-item-bar {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            margin-right: 20px;
            cursor: pointer;
            position: relative;
        }
        
        .story-avatar-bar {
            width: 64px;
            height: 64px;
            border-radius: var(--radius-round);
            border: 3px solid transparent;
            background: linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3);
            padding: 2px;
            margin-bottom: 8px;
        }
        
        .story-avatar-bar img {
            width: 100%;
            height: 100%;
            border-radius: var(--radius-round);
            object-fit: cover;
            border: 2px solid var(--bg-header);
        }
        
        .story-name-bar {
            font-size: 12px;
            color: var(--text-primary);
            max-width: 64px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* ANA ƒ∞√áERƒ∞K ALANI */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* HEADER */
        .header {
            height: 64px;
            padding: 0 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-header);
        }
        
        .channel-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .channel-icon {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-sm);
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 500;
        }
        
        .channel-name {
            font-size: 16px;
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .channel-topic {
            font-size: 13px;
            color: var(--text-light);
            margin-top: 2px;
        }
        
        .header-actions {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .icon-btn {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-round);
            border: 1px solid var(--border-color);
            background: var(--bg-input);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            position: relative;
        }
        
        .icon-btn:hover {
            background: var(--bg-hover);
            border-color: var(--border-hover);
            color: var(--text-primary);
        }
        
        .notification-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            min-width: 16px;
            height: 16px;
            border-radius: 8px;
            background: var(--danger);
            color: white;
            font-size: 10px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 4px;
            border: 2px solid var(--bg-header);
        }
        
        /* SOHBET ALANI */
        .chat-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        /* SOHBET MESAJLARI */
        .chat-messages {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background: var(--bg-primary);
        }
        
        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }
        
        .message-group {
            margin-bottom: 24px;
        }
        
        .message-date {
            text-align: center;
            margin: 16px 0;
            font-size: 12px;
            color: var(--text-muted);
            position: relative;
        }
        
        .message-date::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            width: 100%;
            height: 1px;
            background: var(--border-color);
            z-index: 1;
        }
        
        .message-date span {
            background: var(--bg-primary);
            padding: 0 12px;
            position: relative;
            z-index: 2;
        }
        
        .message {
            display: flex;
            padding: 8px 0;
            transition: var(--transition);
        }
        
        .message:hover {
            background: var(--bg-hover);
        }
        
        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-round);
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 500;
            margin-right: 12px;
            flex-shrink: 0;
            cursor: pointer;
        }
        
        .message-content {
            flex: 1;
            min-width: 0;
        }
        
        .message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }
        
        .message-sender {
            font-weight: 500;
            font-size: 13px;
            color: var(--text-primary);
            cursor: pointer;
        }
        
        .message-sender:hover {
            text-decoration: underline;
        }
        
        .message-badge {
            font-size: 10px;
            padding: 1px 4px;
            border-radius: 2px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .badge-owner { background: linear-gradient(135deg, #ff4d4f, #ff7875); color: white; }
        .badge-admin { background: linear-gradient(135deg, #faad14, #ffc53d); color: black; }
        .badge-coadmin { background: linear-gradient(135deg, #13c2c2, #36cfc9); color: white; }
        .badge-operator { background: linear-gradient(135deg, #722ed1, #9254de); color: white; }
        .badge-bot { background: linear-gradient(135deg, #52c41a, #73d13d); color: white; }
        .badge-user { background: linear-gradient(135deg, #bfbfbf, #d9d9d9); color: black; }
        
        .message-time {
            font-size: 11px;
            color: var(--text-muted);
        }
        
        .message-text {
            font-size: 14px;
            line-height: 1.5;
            color: var(--text-primary);
            word-break: break-word;
        }
        
        .message-media {
            margin-top: 8px;
            max-width: 300px;
            border-radius: var(--radius-md);
            overflow: hidden;
            border: 1px solid var(--border-color);
        }
        
        .message-media img, .message-media video {
            width: 100%;
            max-height: 200px;
            object-fit: cover;
            display: block;
        }
        
        .message-actions {
            display: flex;
            gap: 8px;
            margin-top: 4px;
        }
        
        .message-action-btn {
            font-size: 11px;
            color: var(--text-light);
            background: none;
            border: none;
            cursor: pointer;
            padding: 2px 4px;
            border-radius: var(--radius-sm);
            transition: var(--transition);
        }
        
        .message-action-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }
        
        .typing-indicator {
            padding: 8px 24px;
            font-size: 13px;
            color: var(--text-light);
            font-style: italic;
        }
        
        /* SOHBET Gƒ∞Rƒ∞≈û */
        .chat-input-area {
            padding: 16px 24px;
            border-top: 1px solid var(--border-color);
            background: var(--bg-primary);
        }
        
        .input-container {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }
        
        .input-actions {
            display: flex;
            gap: 4px;
            margin-bottom: 8px;
        }
        
        .input-action-btn {
            padding: 4px 8px;
            font-size: 12px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .input-action-btn:hover {
            background: var(--bg-hover);
            border-color: var(--primary);
            color: var(--primary);
        }
        
        .chat-input {
            flex: 1;
            padding: 12px 16px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            color: var(--text-primary);
            font-size: 14px;
            resize: none;
            min-height: 40px;
            max-height: 120px;
            outline: none;
            transition: var(--transition);
            line-height: 1.5;
        }
        
        .chat-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.1);
        }
        
        .send-btn {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-round);
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            flex-shrink: 0;
        }
        
        .send-btn:hover {
            background: var(--primary-hover);
        }
        
        /* SAƒû Sƒ∞DEBAR - KULLANICILAR */
        .right-sidebar {
            width: 280px;
            background: var(--bg-sidebar);
            border-left: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .users-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .users-search {
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 8px 12px 8px 32px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 13px;
            outline: none;
            transition: var(--transition);
        }
        
        .search-input:focus {
            border-color: var(--primary);
        }
        
        .search-icon {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
        }
        
        .users-list {
            flex: 1;
            overflow-y: auto;
            padding: 8px 0;
        }
        
        .user-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            cursor: pointer;
            transition: var(--transition);
            gap: 12px;
        }
        
        .user-item:hover {
            background: var(--bg-hover);
        }
        
        .user-item.active {
            background: var(--primary-light);
        }
        
        .user-status {
            width: 10px;
            height: 10px;
            border-radius: var(--radius-round);
            background: var(--success);
            flex-shrink: 0;
            position: relative;
        }
        
        .user-status::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border-radius: var(--radius-round);
            background: var(--success);
            opacity: 0.3;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.2); opacity: 0.1; }
        }
        
        .user-status.away {
            background: var(--warning);
        }
        
        .user-status.away::after {
            background: var(--warning);
        }
        
        .user-status.busy {
            background: var(--danger);
        }
        
        .user-status.busy::after {
            background: var(--danger);
        }
        
        .user-status.offline {
            background: var(--text-muted);
        }
        
        .user-status.offline::after {
            display: none;
        }
        
        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-round);
            background: linear-gradient(135deg, var(--primary), var(--purple));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 500;
            flex-shrink: 0;
        }
        
        .user-info {
            flex: 1;
            min-width: 0;
        }
        
        .user-name {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .user-role {
            font-size: 11px;
            color: var(--text-light);
        }
        
        /* √ñZEL SOHBET PENCERESƒ∞ */
        .private-chat-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-overlay);
            z-index: 3000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .private-chat-overlay.active {
            display: flex;
        }
        
        .private-chat-window {
            width: 90%;
            max-width: 800px;
            height: 80%;
            background: var(--bg-modal);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-xl);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .private-chat-header {
            padding: 16px 20px;
            background: linear-gradient(135deg, var(--primary), var(--purple));
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .private-chat-user {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .private-chat-avatar {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-round);
            background: white;
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }
        
        .private-chat-actions {
            display: flex;
            gap: 8px;
        }
        
        .private-chat-btn {
            padding: 6px 12px;
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: var(--radius-sm);
            color: white;
            cursor: pointer;
            font-size: 12px;
            transition: var(--transition);
        }
        
        .private-chat-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .private-chat-close {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-round);
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .private-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: var(--bg-primary);
        }
        
        .private-chat-input-area {
            padding: 16px 20px;
            border-top: 1px solid var(--border-color);
            background: var(--bg-modal);
        }
        
        /* STORY G√ñR√úNT√úLEYƒ∞Cƒ∞ */
        .story-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-overlay);
            z-index: 4000;
            display: none;
        }
        
        .story-viewer.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .story-viewer-container {
            width: 90%;
            max-width: 400px;
            height: 80%;
            background: black;
            border-radius: var(--radius-lg);
            overflow: hidden;
            position: relative;
        }
        
        .story-nav {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
            background: linear-gradient(to bottom, rgba(0,0,0,0.5), transparent);
        }
        
        .story-user {
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
        }
        
        .story-avatar-small {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-round);
            border: 2px solid white;
        }
        
        .story-close {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-round);
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .story-close:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .story-content {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .story-media {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .story-actions {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 16px;
            z-index: 10;
        }
        
        .story-action-btn {
            padding: 8px 20px;
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 20px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .story-action-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .story-stats {
            position: absolute;
            top: 80px;
            left: 20px;
            color: white;
            font-size: 14px;
            display: flex;
            gap: 16px;
        }
        
        .story-likes, .story-views {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        /* KULLANICI PROFƒ∞L PANELƒ∞ */
        .profile-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-overlay);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .profile-overlay.active {
            display: flex;
        }
        
        .profile-panel {
            width: 90%;
            max-width: 500px;
            background: var(--bg-modal);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
        }
        
        .profile-header {
            padding: 30px 20px;
            background: linear-gradient(135deg, var(--primary), var(--purple));
            color: white;
            text-align: center;
            position: relative;
        }
        
        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: var(--radius-round);
            border: 4px solid white;
            margin: 0 auto 12px;
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 600;
            color: white;
        }
        
        .profile-name {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .profile-role {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 8px;
        }
        
        .profile-stats {
            display: flex;
            justify-content: center;
            gap: 24px;
            margin-top: 16px;
        }
        
        .profile-stat {
            text-align: center;
        }
        
        .profile-stat-value {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 2px;
        }
        
        .profile-stat-label {
            font-size: 12px;
            opacity: 0.8;
        }
        
        .profile-body {
            padding: 24px;
        }
        
        .profile-section {
            margin-bottom: 24px;
        }
        
        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .profile-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .profile-option {
            padding: 12px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .profile-option:hover {
            background: var(--bg-hover);
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .option-icon {
            font-size: 20px;
            margin-bottom: 8px;
        }
        
        .option-text {
            font-size: 13px;
            color: var(--text-primary);
        }
        
        .profile-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }
        
        .profile-btn {
            flex: 1;
            padding: 12px;
            border-radius: var(--radius-md);
            border: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .profile-btn.primary {
            background: var(--primary);
            color: white;
        }
        
        .profile-btn.primary:hover {
            background: var(--primary-hover);
        }
        
        .profile-btn.secondary {
            background: var(--bg-input);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }
        
        .profile-btn.secondary:hover {
            background: var(--bg-hover);
            border-color: var(--border-hover);
        }
        
        /* Y√ñNETƒ∞M PANELƒ∞ */
        .admin-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-overlay);
            z-index: 1000;
            display: none;
        }
        
        .admin-overlay.active {
            display: block;
        }
        
        .admin-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 1000px;
            height: 85%;
            background: var(--bg-modal);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-color);
            z-index: 1001;
            display: none;
            flex-direction: column;
            overflow: hidden;
            box-shadow: var(--shadow-xl);
        }
        
        .admin-panel.active {
            display: flex;
        }
        
        .admin-header {
            padding: 20px 24px;
            background: linear-gradient(135deg, var(--primary), var(--purple));
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .admin-title {
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .admin-stats {
            display: flex;
            gap: 16px;
        }
        
        .admin-stat {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 13px;
            background: rgba(255,255,255,0.2);
            padding: 4px 8px;
            border-radius: var(--radius-sm);
        }
        
        .admin-body {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .admin-sidebar {
            width: 200px;
            background: var(--bg-sidebar);
            border-right: 1px solid var(--border-color);
            padding: 20px 0;
            overflow-y: auto;
        }
        
        .admin-nav-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: var(--transition);
            border-left: 3px solid transparent;
        }
        
        .admin-nav-item:hover {
            background: var(--bg-hover);
        }
        
        .admin-nav-item.active {
            background: var(--primary-light);
            border-left-color: var(--primary);
            color: var(--primary);
        }
        
        .admin-content {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
        }
        
        .admin-section {
            display: none;
        }
        
        .admin-section.active {
            display: block;
        }
        
        .admin-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .admin-table th,
        .admin-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        
        .admin-table th {
            background: var(--bg-secondary);
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .admin-action-btn {
            padding: 4px 8px;
            font-size: 12px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border-color);
            background: var(--bg-input);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .admin-action-btn:hover {
            background: var(--bg-hover);
        }
        
        /* Gƒ∞Rƒ∞≈û EKRANI */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        
        .login-container {
            width: 100%;
            max-width: 400px;
            padding: 40px;
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-xl);
        }
        
        .login-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
            text-align: center;
            margin-bottom: 8px;
        }
        
        .login-subtitle {
            font-size: 14px;
            color: var(--text-light);
            text-align: center;
            margin-bottom: 32px;
        }
        
        .login-input {
            width: 100%;
            padding: 12px 16px;
            margin-bottom: 16px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 14px;
            outline: none;
            transition: var(--transition);
        }
        
        .login-input:focus {
            border-color: var(--primary);
        }
        
        .login-btn {
            width: 100%;
            padding: 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .login-btn:hover {
            background: var(--primary-hover);
        }
        
        /* SCROLLBAR */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-light);
        }
    </style>
</head>
<body>
    <!-- Gƒ∞Rƒ∞≈û EKRANI -->
    <div class="login-screen" id="loginScreen">
        <div class="login-container">
            <div class="login-title">Popbox Elite</div>
            <div class="login-subtitle">Profesyonel Chat Platformu</div>
            
            <input type="text" id="loginNick" class="login-input" placeholder="Kullanƒ±cƒ± adƒ±nƒ±z" autocomplete="off">
            <input type="password" id="loginPassword" class="login-input" placeholder="≈ûifre (yetkili giri≈üi i√ßin)" autocomplete="off">
            
            <button class="login-btn" onclick="login()">Giri≈ü Yap</button>
            
            <div style="margin-top: 24px; text-align: center;">
                <div style="font-size: 12px; color: var(--text-light); line-height: 1.5;">
                    ‚Ä¢ Sistem Owner: MateKy (≈üifre: kumsal07@)<br>
                    ‚Ä¢ Adminler ve Co-Adminler ≈üifre ile giri≈ü yapar<br>
                    ‚Ä¢ Normal kullanƒ±cƒ±lar sadece nick ile girebilir<br>
                    ‚Ä¢ Sistem Botu: MATE (Owner emrinde)
                </div>
            </div>
            
            <div id="loginError" style="color: var(--danger); margin-top: 16px; font-size: 13px; text-align: center; padding: 12px; background: rgba(255, 77, 79, 0.1); border-radius: var(--radius-sm); display: none;"></div>
        </div>
    </div>
    
    <!-- STORY G√ñR√úNT√úLEYƒ∞Cƒ∞ -->
    <div class="story-viewer" id="storyViewer">
        <div class="story-viewer-container">
            <div class="story-nav">
                <div class="story-user">
                    <img class="story-avatar-small" src="" alt="User">
                    <div>
                        <div style="font-weight: 600;" id="storyUserName"></div>
                        <div style="font-size: 12px;" id="storyTime">1 saat √∂nce</div>
                    </div>
                </div>
                <button class="story-close" onclick="closeStory()">‚úï</button>
            </div>
            
            <div class="story-content">
                <img id="storyImage" class="story-media" src="" alt="Story">
                <video id="storyVideo" class="story-media" controls style="display: none;"></video>
            </div>
            
            <div class="story-stats">
                <div class="story-likes">‚ù§Ô∏è <span id="storyLikeCount">0</span></div>
                <div class="story-views">üëÅÔ∏è <span id="storyViewCount">0</span></div>
            </div>
            
            <div class="story-actions">
                <button class="story-action-btn" onclick="likeStory()">
                    ‚ù§Ô∏è Beƒüen
                </button>
                <button class="story-action-btn" onclick="reportStory()">
                    ‚ö†Ô∏è ≈ûikayet
                </button>
            </div>
        </div>
    </div>
    
    <!-- KULLANICI PROFƒ∞L PANELƒ∞ -->
    <div class="profile-overlay" id="profileOverlay">
        <div class="profile-panel" id="profilePanel">
            <!-- Profil i√ßeriƒüi buraya eklenecek -->
        </div>
    </div>
    
    <!-- √ñZEL SOHBET PENCERESƒ∞ -->
    <div class="private-chat-overlay" id="privateChatOverlay">
        <div class="private-chat-window" id="privateChatWindow">
            <!-- √ñzel sohbet i√ßeriƒüi buraya eklenecek -->
        </div>
    </div>
    
    <!-- Y√ñNETƒ∞M PANELƒ∞ -->
    <div class="admin-overlay" id="adminOverlay" onclick="closeAdminPanel()"></div>
    <div class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <div class="admin-title">
                ‚ö° Y√∂netim Paneli
                <span class="notification-badge" id="adminReportCount">0</span>
            </div>
            <div class="admin-stats">
                <div class="admin-stat">üë• <span id="adminOnlineCount">0</span></div>
                <div class="admin-stat">‚ö†Ô∏è <span id="adminWarningCount">0</span></div>
                <div class="admin-stat">üìä <span id="adminActivityCount">0</span></div>
            </div>
        </div>
        
        <div class="admin-body">
            <div class="admin-sidebar" id="adminNav">
                <!-- Y√∂netim navigasyonu buraya eklenecek -->
            </div>
            <div class="admin-content" id="adminContent">
                <!-- Y√∂netim i√ßeriƒüi buraya eklenecek -->
            </div>
        </div>
    </div>
    
    <!-- ANA UYGULAMA -->
    <div class="app-container" id="appContainer" style="display: none;">
        <!-- STORY BAR - √úSTTE -->
        <div class="story-bar" id="storyBar">
            <!-- Story'ler buraya eklenecek -->
        </div>
        
        <!-- ANA ƒ∞√áERƒ∞K -->
        <div class="main-content">
            <!-- HEADER -->
            <div class="header">
                <div class="channel-info">
                    <div class="channel-icon" id="currentChannelIcon">üí¨</div>
                    <div>
                        <div class="channel-name" id="currentChannelName">Genel</div>
                        <div class="channel-topic" id="currentChannelTopic">Ho≈ü geldiniz</div>
                    </div>
                </div>
                
                <div class="header-actions">
                    <button class="icon-btn" onclick="toggleTheme()" title="Tema">
                        üåì
                    </button>
                    <button class="icon-btn" onclick="openProfile(currentUser.nick)" title="Profil">
                        üë§
                    </button>
                    <button class="icon-btn" onclick="openAdminPanel()" id="adminBtn" style="display: none;" title="Y√∂netim">
                        ‚ö°
                        <span class="notification-badge" id="headerReportCount">0</span>
                    </button>
                    <button class="icon-btn" onclick="toggleNotifications()" title="Bildirimler">
                        üîî
                        <span class="notification-badge" id="notificationCount">0</span>
                    </button>
                </div>
            </div>
            
            <!-- SOHBET ALANI -->
            <div class="chat-container">
                <!-- SOL Sƒ∞DEBAR - MEDIA/Vƒ∞DEO B√úY√úK -->
                <div class="media-sidebar">
                    <div class="media-header">
                        <div class="media-title">üìÅ Payla≈üƒ±lan Medya</div>
                        <div style="font-size: 13px; color: var(--text-light);">
                            <span id="mediaCount">0</span> medya
                        </div>
                    </div>
                    <div class="media-container" id="mediaContainer">
                        <!-- Medya √∂ƒüeleri buraya eklenecek -->
                    </div>
                </div>
                
                <!-- SOHBET MESAJLARI - ORTADA -->
                <div class="chat-messages">
                    <div class="messages-container" id="messagesContainer">
                        <!-- Mesajlar buraya eklenecek -->
                    </div>
                    
                    <div class="chat-input-area">
                        <div class="input-actions" id="inputActions">
                            <button class="input-action-btn" onclick="showEmojiPicker()">üòÄ</button>
                            <button class="input-action-btn" onclick="showCommandHelp()">/ Komutlar</button>
                            <button class="input-action-btn" onclick="clearChat()" style="display: none;" id="clearBtn">üóëÔ∏è Temizle</button>
                        </div>
                        <div class="input-container">
                            <textarea 
                                id="messageInput" 
                                class="chat-input" 
                                placeholder="Mesajƒ±nƒ±zƒ± yazƒ±n... (/help komutlarƒ± g√∂sterir)"
                                rows="1"
                                oninput="autoResize(this)"
                                onkeydown="handleKeyDown(event)"
                            ></textarea>
                            <button class="send-btn" onclick="sendMessage()">
                                ‚Üó
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- SAƒû Sƒ∞DEBAR - KULLANICILAR -->
                <div class="right-sidebar">
                    <div class="users-header">
                        <div class="users-search">
                            <input type="text" class="search-input" placeholder="Kullanƒ±cƒ± ara..." id="userSearch" oninput="filterUsers()">
                            <span class="search-icon">üîç</span>
                        </div>
                    </div>
                    
                    <div class="users-list" id="usersList">
                        <!-- Kullanƒ±cƒ±lar buraya eklenecek -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== Sƒ∞STEM AYARLARI ==========
        const SYSTEM_CONFIG = {
            OWNER_PASSWORD: 'kumsal07@',
            ADMIN_PASSWORD: 'admin123',
            COADMIN_PASSWORD: 'coadmin123',
            OPERATOR_PASSWORD: 'operator123',
            
            ROLES: {
                OWNER: 'owner',
                ADMIN: 'admin',
                COADMIN: 'coadmin',
                OPERATOR: 'operator',
                USER: 'user',
                BOT: 'bot'
            },
            
            PERMISSIONS: {
                OWNER: ['all'],
                ADMIN: ['clear', 'kick', 'mute', 'ban', 'op', 'view_reports', 'manage_stories'],
                COADMIN: ['clear', 'kick', 'mute', 'view_reports'],
                OPERATOR: ['clear', 'mute'],
                USER: [],
                BOT: ['auto_moderate']
            },
            
            BOT_NAME: 'MATE',
            BOT_AVATAR: 'ü§ñ',
            BOT_COLOR: '#13c2c2'
        };
        
        // ========== VERƒ∞ YAPILARI ==========
        let currentUser = null;
        let currentChannel = 'general';
        let activePrivateChat = null;
        let currentStory = null;
        let notifications = [];
        let reports = [];
        
        let channels = {
            'general': {
                id: 'general',
                name: 'Genel',
                icon: 'üí¨',
                topic: 'Ho≈ü geldiniz',
                users: new Set(),
                messages: [],
                media: [],
                settings: {
                    allowMedia: false,
                    slowMode: false,
                    readOnly: false
                }
            },
            'random': {
                id: 'random',
                name: 'Rastgele',
                icon: 'üé≤',
                topic: 'Serbest sohbet',
                users: new Set(),
                messages: [],
                media: [],
                settings: {
                    allowMedia: false,
                    slowMode: false,
                    readOnly: false
                }
            },
            'help': {
                id: 'help',
                name: 'Yardƒ±m',
                icon: '‚ùì',
                topic: 'Yardƒ±m ve destek',
                users: new Set(),
                messages: [],
                media: [],
                settings: {
                    allowMedia: false,
                    slowMode: false,
                    readOnly: false
                }
            }
        };
        
        let users = {};
        let stories = [];
        let privateChats = {};
        let following = {};
        let blocked = {};
        let typingUsers = new Set();
        
        // ========== Sƒ∞STEM BOTU MATE ==========
        const BOT_MATE = {
            nick: SYSTEM_CONFIG.BOT_NAME,
            role: SYSTEM_CONFIG.ROLES.BOT,
            isOnline: true,
            avatar: SYSTEM_CONFIG.BOT_AVATAR,
            color: SYSTEM_CONFIG.BOT_COLOR,
            owner: null,
            
            sendMessage: function(channelId, text) {
                const message = {
                    id: 'bot_' + Date.now(),
                    sender: this.nick,
                    text: text,
                    time: new Date(),
                    role: this.role,
                    avatar: this.avatar,
                    color: this.color
                };
                
                channels[channelId].messages.push(message);
                
                if (channelId === currentChannel) {
                    addMessageToUI(message);
                }
            },
            
            sendPrivate: function(targetNick, text) {
                const message = {
                    id: 'bot_private_' + Date.now(),
                    sender: this.nick,
                    text: text,
                    time: new Date(),
                    role: this.role,
                    avatar: this.avatar,
                    color: this.color
                };
                
                const chatId = [this.nick, targetNick].sort().join('_');
                if (!privateChats[chatId]) {
                    privateChats[chatId] = {
                        users: [this.nick, targetNick],
                        messages: []
                    };
                }
                
                privateChats[chatId].messages.push(message);
                addNotification('bot', `${this.nick}: ${text}`);
            },
            
            moderate: function(message) {
                // Otomatik moderasyon
                const bannedWords = ['k√ºf√ºr', 'hakaret', 'spam'];
                let violation = null;
                
                bannedWords.forEach(word => {
                    if (message.text.toLowerCase().includes(word)) {
                        violation = word;
                    }
                });
                
                if (violation) {
                    this.sendMessage(currentChannel, `‚ö†Ô∏è Moderasyon: "${violation}" kelimesi tespit edildi!`);
                    return false;
                }
                
                return true;
            },
            
            notifyOwner: function(event, details) {
                if (this.owner) {
                    this.sendPrivate(this.owner, `üîî Sistem Bildirimi: ${event}\n${JSON.stringify(details, null, 2)}`);
                }
            },
            
            executeCommand: function(command, args) {
                switch(command) {
                    case 'stats':
                        const online = Object.values(users).filter(u => u.isOnline).length;
                        const total = Object.keys(users).length;
                        this.sendMessage(currentChannel, `üìä Sistem ƒ∞statistikleri:\n‚Ä¢ √áevrimi√ßi: ${online}\n‚Ä¢ Toplam: ${total}\n‚Ä¢ Kanallar: ${Object.keys(channels).length}\n‚Ä¢ Story'ler: ${stories.length}`);
                        break;
                        
                    case 'cleanup':
                        // 24 saatten eski mesajlarƒ± temizle
                        const now = Date.now();
                        let cleaned = 0;
                        
                        Object.values(channels).forEach(channel => {
                            const filtered = channel.messages.filter(msg => {
                                return (now - msg.time.getTime()) < 24 * 60 * 60 * 1000;
                            });
                            cleaned += channel.messages.length - filtered.length;
                            channel.messages = filtered;
                        });
                        
                        this.sendMessage(currentChannel, `üßπ ${cleaned} eski mesaj temizlendi.`);
                        break;
                        
                    case 'alert':
                        if (args.length > 0) {
                            const alertMsg = args.join(' ');
                            Object.values(channels).forEach(channel => {
                                this.sendMessage(channel.id, `üö® Sƒ∞STEM UYARISI: ${alertMsg}`);
                            });
                        }
                        break;
                }
            }
        };
        
        // ========== Gƒ∞Rƒ∞≈û Sƒ∞STEMƒ∞ ==========
        function login() {
            const nick = document.getElementById('loginNick').value.trim();
            const password = document.getElementById('loginPassword').value;
            const errorDiv = document.getElementById('loginError');
            
            errorDiv.style.display = 'none';
            
            if (!nick) {
                showError('Kullanƒ±cƒ± adƒ± gereklidir');
                return;
            }
            
            // Yetkili giri≈ü kontrol√º
            let userRole = SYSTEM_CONFIG.ROLES.USER;
            let isPasswordRequired = false;
            
            // Owner kontrol√º
            if (nick.toLowerCase() === 'mateky') {
                isPasswordRequired = true;
                if (password === SYSTEM_CONFIG.OWNER_PASSWORD) {
                    userRole = SYSTEM_CONFIG.ROLES.OWNER;
                    BOT_MATE.owner = nick;
                } else if (!password) {
                    showError('Owner i√ßin ≈üifre gereklidir');
                    return;
                } else {
                    showError('Ge√ßersiz ≈üifre');
                    return;
                }
            }
            // Admin kontrol√º
            else if (nick.toLowerCase() === 'admin') {
                isPasswordRequired = true;
                if (password === SYSTEM_CONFIG.ADMIN_PASSWORD) {
                    userRole = SYSTEM_CONFIG.ROLES.ADMIN;
                } else if (!password) {
                    showError('Admin i√ßin ≈üifre gereklidir');
                    return;
                } else {
                    showError('Ge√ßersiz ≈üifre');
                    return;
                }
            }
            // Co-Admin kontrol√º
            else if (nick.toLowerCase() === 'coadmin') {
                isPasswordRequired = true;
                if (password === SYSTEM_CONFIG.COADMIN_PASSWORD) {
                    userRole = SYSTEM_CONFIG.ROLES.COADMIN;
                } else if (!password) {
                    showError('Co-Admin i√ßin ≈üifre gereklidir');
                    return;
                } else {
                    showError('Ge√ßersiz ≈üifre');
                    return;
                }
            }
            // Operator kontrol√º
            else if (nick.toLowerCase() === 'operator') {
                isPasswordRequired = true;
                if (password === SYSTEM_CONFIG.OPERATOR_PASSWORD) {
                    userRole = SYSTEM_CONFIG.ROLES.OPERATOR;
                } else if (!password) {
                    showError('Operator i√ßin ≈üifre gereklidir');
                    return;
                } else {
                    showError('Ge√ßersiz ≈üifre');
                    return;
                }
            }
            // Normal kullanƒ±cƒ± - ≈üifre gerekmez
            else {
                if (password) {
                    // Normal kullanƒ±cƒ± ≈üifre girmi≈ü ama yetkili deƒüil
                    showError('Bu nick i√ßin ≈üifre gerekmez');
                    return;
                }
            }
            
            // Nick kontrol√º
            if (users[nick] && users[nick].isOnline) {
                showError('Bu nick ≈üu anda √ßevrimi√ßi!');
                return;
            }
            
            // Kullanƒ±cƒ± olu≈ütur
            currentUser = {
                nick: nick,
                role: userRole,
                isOnline: true,
                status: 'online',
                avatar: generateAvatar(nick),
                color: generateColor(nick),
                joinedAt: new Date(),
                lastSeen: new Date(),
                following: new Set(),
                followers: new Set(),
                storyCount: 0,
                messageCount: 0,
                isBanned: false,
                isMuted: false
            };
            
            // Kullanƒ±cƒ±yƒ± kaydet
            users[nick] = currentUser;
            
            // Bot'un owner'ƒ±nƒ± ayarla
            if (userRole === SYSTEM_CONFIG.ROLES.OWNER) {
                BOT_MATE.owner = nick;
            }
            
            // Ana kanala ekle
            channels.general.users.add(currentUser.nick);
            
            // Giri≈ü ba≈üarƒ±lƒ±
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appContainer').style.display = 'flex';
            
            // Yetki butonlarƒ±nƒ± g√∂ster
            updatePermissionButtons();
            
            // Sistemi ba≈ülat
            initializeSystem();
            
            // Bot'tan ho≈ü geldin mesajƒ±
            setTimeout(() => {
                BOT_MATE.sendMessage('general', `üëã Ho≈ü geldin ${currentUser.nick}! Ben ${BOT_MATE.nick}, sistem botuyum. /help yazarak komutlarƒ± g√∂rebilirsin.`);
            }, 1000);
            
            function showError(msg) {
                errorDiv.textContent = msg;
                errorDiv.style.display = 'block';
            }
        }
        
        // ========== Sƒ∞STEM BA≈ûLATMA ==========
        function initializeSystem() {
            // √ñrnek kullanƒ±cƒ±lar ekle
            addSampleUsers();
            
            // √ñrnek veriler olu≈ütur
            createSampleData();
            
            // UI'yi g√ºncelle
            updateChannelsList();
            loadChannel(currentChannel);
            updateUsersList();
            updateStoryBar();
            updateMediaList();
            updateNotificationCount();
            
            // Sistem mesajƒ±
            addSystemMessage(`${currentUser.nick}, sohbete ho≈ü geldin!`);
            
            // Ba≈ülangƒ±√ßta bot'u genel kanala ekle
            channels.general.users.add(BOT_MATE.nick);
            users[BOT_MATE.nick] = BOT_MATE;
        }
        
        function addSampleUsers() {
            const sampleUsers = [
                { nick: 'Ahmet', role: SYSTEM_CONFIG.ROLES.USER, status: 'online' },
                { nick: 'Ay≈üe', role: SYSTEM_CONFIG.ROLES.USER, status: 'online' },
                { nick: 'Mehmet', role: SYSTEM_CONFIG.ROLES.USER, status: 'away' },
                { nick: 'Elif', role: SYSTEM_CONFIG.ROLES.ADMIN, status: 'online' },
                { nick: 'Can', role: SYSTEM_CONFIG.ROLES.OPERATOR, status: 'online' },
                { nick: 'Zeynep', role: SYSTEM_CONFIG.ROLES.USER, status: 'busy' }
            ];
            
            sampleUsers.forEach(user => {
                if (!users[user.nick]) {
                    users[user.nick] = {
                        nick: user.nick,
                        role: user.role,
                        isOnline: true,
                        status: user.status,
                        avatar: generateAvatar(user.nick),
                        color: generateColor(user.nick),
                        joinedAt: new Date(Date.now() - Math.random() * 3600000),
                        lastSeen: new Date(),
                        following: new Set(),
                        followers: new Set(),
                        storyCount: Math.floor(Math.random() * 5),
                        messageCount: Math.floor(Math.random() * 100),
                        isBanned: false,
                        isMuted: false
                    };
                    channels.general.users.add(user.nick);
                    
                    // Takiple≈üme √∂rnekleri
                    if (user.nick === 'Ahmet') {
                        users[user.nick].following.add('Ay≈üe');
                        users['Ay≈üe'].followers.add('Ahmet');
                    }
                    if (user.nick === 'Mehmet') {
                        users[user.nick].following.add('Elif');
                        users['Elif'].followers.add('Mehmet');
                    }
                }
            });
        }
        
        function createSampleData() {
            // √ñrnek story'ler
            stories = [
                {
                    id: 'story1',
                    user: 'Ahmet',
                    type: 'image',
                    url: 'https://picsum.photos/400/600?random=1',
                    likes: 15,
                    views: 42,
                    timestamp: new Date(Date.now() - 3600000),
                    seenBy: new Set(),
                    reported: false
                },
                {
                    id: 'story2',
                    user: 'Ay≈üe',
                    type: 'image',
                    url: 'https://picsum.photos/400/600?random=2',
                    likes: 23,
                    views: 67,
                    timestamp: new Date(Date.now() - 7200000),
                    seenBy: new Set(),
                    reported: false
                },
                {
                    id: 'story3',
                    user: 'Elif',
                    type: 'image',
                    url: 'https://picsum.photos/400/600?random=3',
                    likes: 8,
                    views: 31,
                    timestamp: new Date(Date.now() - 10800000),
                    seenBy: new Set(),
                    reported: false
                }
            ];
            
            // √ñrnek medya
            channels.general.media = [
                {
                    id: 'media1',
                    user: 'Ahmet',
                    type: 'image',
                    url: 'https://picsum.photos/300/200?random=4',
                    timestamp: new Date(Date.now() - 86400000),
                    likes: 5
                },
                {
                    id: 'media2',
                    user: 'Ay≈üe',
                    type: 'image',
                    url: 'https://picsum.photos/300/200?random=5',
                    timestamp: new Date(Date.now() - 172800000),
                    likes: 12
                }
            ];
            
            // √ñrnek bildirimler
            notifications = [
                { id: 'notif1', type: 'follow', user: 'Ahmet', message: 'seni takip etti', time: new Date(Date.now() - 1800000), read: false },
                { id: 'notif2', type: 'like', user: 'Ay≈üe', message: 'story\'ini beƒüendi', time: new Date(Date.now() - 3600000), read: false },
                { id: 'notif3', type: 'mention', user: 'Mehmet', message: 'senden bahsetti', time: new Date(Date.now() - 5400000), read: true }
            ];
            
            // √ñrnek raporlar
            reports = [
                { id: 'report1', type: 'message', user: 'Spammer', reporter: 'Ahmet', reason: 'Spam mesaj', status: 'pending', time: new Date() }
            ];
        }
        
        // ========== UI G√úNCELLEME FONKSƒ∞YONLARI ==========
        function updatePermissionButtons() {
            const clearBtn = document.getElementById('clearBtn');
            const adminBtn = document.getElementById('adminBtn');
            
            if (hasPermission('clear')) {
                clearBtn.style.display = 'inline-block';
            }
            
            if (hasPermission('view_reports')) {
                adminBtn.style.display = 'block';
            }
        }
        
        function updateChannelsList() {
            // Kanallar sabit olduƒüu i√ßin g√ºncellemeye gerek yok
        }
        
        function loadChannel(channelId) {
            const container = document.getElementById('messagesContainer');
            container.innerHTML = '';
            
            // Tarih ba≈ülƒ±ƒüƒ±
            const dateDiv = document.createElement('div');
            dateDiv.className = 'message-date';
            const today = new Date();
            dateDiv.innerHTML = `<span>${formatDate(today)}</span>`;
            container.appendChild(dateDiv);
            
            // Kanal mesajlarƒ±nƒ± y√ºkle
            const messages = channels[channelId].messages;
            
            // Mesajlarƒ± g√∂ster
            messages.forEach(msg => addMessageToUI(msg));
            
            // En alta kaydƒ±r
            container.scrollTop = container.scrollHeight;
        }
        
        function addMessageToUI(message) {
            const container = document.getElementById('messagesContainer');
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            messageDiv.id = `msg_${message.id || Date.now()}`;
            
            // Avatar
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.style.background = message.color || generateColor(message.sender);
            avatar.textContent = message.avatar || message.sender.charAt(0).toUpperCase();
            avatar.title = message.sender;
            avatar.onclick = () => openProfile(message.sender);
            messageDiv.appendChild(avatar);
            
            // ƒ∞√ßerik
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            // Ba≈ülƒ±k
            const headerDiv = document.createElement('div');
            headerDiv.className = 'message-header';
            
            const senderSpan = document.createElement('span');
            senderSpan.className = 'message-sender';
            senderSpan.textContent = message.sender;
            senderSpan.onclick = () => openProfile(message.sender);
            headerDiv.appendChild(senderSpan);
            
            // Yetki rozeti
            if (message.role && message.role !== SYSTEM_CONFIG.ROLES.USER) {
                const badge = document.createElement('span');
                badge.className = `message-badge badge-${message.role}`;
                badge.textContent = getRoleBadge(message.role);
                headerDiv.appendChild(badge);
            }
            
            // Zaman
            const timeSpan = document.createElement('span');
            timeSpan.className = 'message-time';
            timeSpan.textContent = formatTime(message.time);
            headerDiv.appendChild(timeSpan);
            
            contentDiv.appendChild(headerDiv);
            
            // Mesaj metni
            const textDiv = document.createElement('div');
            textDiv.className = 'message-text';
            textDiv.innerHTML = formatMessageText(message.text);
            contentDiv.appendChild(textDiv);
            
            // Medya varsa
            if (message.media) {
                const mediaDiv = document.createElement('div');
                mediaDiv.className = 'message-media';
                
                if (message.media.type === 'image') {
                    const img = document.createElement('img');
                    img.src = message.media.url;
                    img.alt = 'G√∂nderilen resim';
                    mediaDiv.appendChild(img);
                } else if (message.media.type === 'video') {
                    const video = document.createElement('video');
                    video.src = message.media.url;
                    video.controls = true;
                    mediaDiv.appendChild(video);
                }
                
                contentDiv.appendChild(mediaDiv);
            }
            
            // Mesaj aksiyonlarƒ±
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'message-actions';
            
            if (message.sender !== currentUser.nick) {
                const replyBtn = document.createElement('button');
                replyBtn.className = 'message-action-btn';
                replyBtn.textContent = '‚Ü©Ô∏è Yanƒ±tla';
                replyBtn.onclick = () => replyToMessage(message.sender);
                actionsDiv.appendChild(replyBtn);
                
                const privateBtn = document.createElement('button');
                privateBtn.className = 'message-action-btn';
                privateBtn.textContent = 'üîí √ñzel';
                privateBtn.onclick = () => openPrivateChat(message.sender);
                actionsDiv.appendChild(privateBtn);
                
                if (hasPermission('view_reports')) {
                    const reportBtn = document.createElement('button');
                    reportBtn.className = 'message-action-btn';
                    reportBtn.textContent = '‚ö†Ô∏è ≈ûikayet';
                    reportBtn.onclick = () => reportMessage(message);
                    actionsDiv.appendChild(reportBtn);
                }
            }
            
            contentDiv.appendChild(actionsDiv);
            
            messageDiv.appendChild(contentDiv);
            container.appendChild(messageDiv);
            
            // En alta kaydƒ±r
            container.scrollTop = container.scrollHeight;
        }
        
        function addSystemMessage(text) {
            const message = {
                id: 'sys_' + Date.now(),
                sender: 'Sistem',
                text: text,
                time: new Date(),
                type: 'system',
                avatar: '‚ö°',
                color: '#faad14'
            };
            
            channels[currentChannel].messages.push(message);
            addMessageToUI(message);
        }
        
        function updateUsersList() {
            const container = document.getElementById('usersList');
            container.innerHTML = '';
            
            const channelUsers = Array.from(channels[currentChannel].users);
            
            // Online kullanƒ±cƒ±larƒ± √∂nce g√∂ster
            const onlineUsers = channelUsers.filter(nick => users[nick] && users[nick].isOnline);
            const offlineUsers = channelUsers.filter(nick => users[nick] && !users[nick].isOnline);
            
            [...onlineUsers, ...offlineUsers].forEach(nick => {
                const user = users[nick];
                if (!user) return;
                
                const div = document.createElement('div');
                div.className = 'user-item';
                div.onclick = () => openPrivateChat(user.nick);
                
                // Durum
                const statusDiv = document.createElement('div');
                statusDiv.className = `user-status ${user.status || (user.isOnline ? 'online' : 'offline')}`;
                div.appendChild(statusDiv);
                
                // Avatar
                const avatarDiv = document.createElement('div');
                avatarDiv.className = 'user-avatar';
                avatarDiv.style.background = user.color || generateColor(user.nick);
                avatarDiv.textContent = user.nick.charAt(0).toUpperCase();
                div.appendChild(avatarDiv);
                
                // Bilgi
                const infoDiv = document.createElement('div');
                infoDiv.className = 'user-info';
                
                const nameDiv = document.createElement('div');
                nameDiv.className = 'user-name';
                nameDiv.textContent = user.nick;
                
                // Yetki rozeti
                if (user.role && user.role !== SYSTEM_CONFIG.ROLES.USER) {
                    const roleSpan = document.createElement('span');
                    roleSpan.className = `badge-${user.role}`;
                    roleSpan.style.fontSize = '9px';
                    roleSpan.style.padding = '1px 3px';
                    roleSpan.style.borderRadius = '2px';
                    roleSpan.style.marginLeft = '4px';
                    roleSpan.textContent = getRoleBadge(user.role);
                    nameDiv.appendChild(roleSpan);
                }
                
                // Takip√ßi sayƒ±sƒ±
                if (user.followers && user.followers.size > 0) {
                    const followerSpan = document.createElement('span');
                    followerSpan.style.fontSize = '10px';
                    followerSpan.style.color = 'var(--text-light)';
                    followerSpan.style.marginLeft = '4px';
                    followerSpan.textContent = `üë• ${user.followers.size}`;
                    nameDiv.appendChild(followerSpan);
                }
                
                infoDiv.appendChild(nameDiv);
                
                const roleDiv = document.createElement('div');
                roleDiv.className = 'user-role';
                roleDiv.textContent = user.isOnline ? '√áevrimi√ßi' : '√áevrimdƒ±≈üƒ±';
                infoDiv.appendChild(roleDiv);
                
                div.appendChild(infoDiv);
                container.appendChild(div);
            });
            
            // Online sayƒ±sƒ±nƒ± g√ºncelle
            const onlineCount = onlineUsers.length;
            document.getElementById('adminOnlineCount').textContent = onlineCount;
            document.title = `(${onlineCount}) Popbox Elite`;
        }
        
        function updateStoryBar() {
            const container = document.getElementById('storyBar');
            container.innerHTML = '';
            
            // Kendi story ekle butonu
            const addBtn = document.createElement('div');
            addBtn.className = 'story-item-bar';
            addBtn.onclick = createStory;
            
            const addAvatar = document.createElement('div');
            addAvatar.className = 'story-avatar-bar';
            addAvatar.style.background = 'var(--bg-input)';
            addAvatar.style.border = '2px dashed var(--border-color)';
            
            const addIcon = document.createElement('div');
            addIcon.style.width = '100%';
            addIcon.style.height = '100%';
            addIcon.style.borderRadius = '50%';
            addIcon.style.display = 'flex';
            addIcon.style.alignItems = 'center';
            addIcon.style.justifyContent = 'center';
            addIcon.style.fontSize = '24px';
            addIcon.style.color = 'var(--text-light)';
            addIcon.textContent = '+';
            
            addAvatar.appendChild(addIcon);
            addBtn.appendChild(addAvatar);
            
            const addName = document.createElement('div');
            addName.className = 'story-name-bar';
            addName.textContent = 'Ekle';
            addBtn.appendChild(addName);
            
            container.appendChild(addBtn);
            
            // Story'leri g√∂ster
            stories.forEach(story => {
                if (users[story.user]) {
                    const storyItem = document.createElement('div');
                    storyItem.className = 'story-item-bar';
                    storyItem.onclick = () => viewStory(story);
                    
                    const avatar = document.createElement('div');
                    avatar.className = 'story-avatar-bar';
                    
                    const img = document.createElement('img');
                    img.src = story.url;
                    img.alt = story.user;
                    avatar.appendChild(img);
                    
                    storyItem.appendChild(avatar);
                    
                    const name = document.createElement('div');
                    name.className = 'story-name-bar';
                    name.textContent = story.user;
                    storyItem.appendChild(name);
                    
                    container.appendChild(storyItem);
                }
            });
        }
        
        function updateMediaList() {
            const container = document.getElementById('mediaContainer');
            container.innerHTML = '';
            
            const allMedia = [];
            Object.values(channels).forEach(channel => {
                allMedia.push(...channel.media);
            });
            
            // Tarihe g√∂re sƒ±rala
            allMedia.sort((a, b) => b.timestamp - a.timestamp);
            
            allMedia.forEach(media => {
                if (users[media.user]) {
                    const mediaItem = document.createElement('div');
                    mediaItem.className = 'media-item';
                    
                    const preview = document.createElement('img');
                    preview.className = 'media-preview';
                    preview.src = media.url;
                    preview.alt = `${media.user} payla≈üƒ±mƒ±`;
                    mediaItem.appendChild(preview);
                    
                    const info = document.createElement('div');
                    info.className = 'media-info';
                    
                    const user = document.createElement('div');
                    user.className = 'media-user';
                    user.textContent = media.user;
                    info.appendChild(user);
                    
                    const time = document.createElement('div');
                    time.className = 'media-time';
                    time.textContent = formatRelativeTime(media.timestamp);
                    info.appendChild(time);
                    
                    mediaItem.appendChild(info);
                    container.appendChild(mediaItem);
                }
            });
            
            document.getElementById('mediaCount').textContent = allMedia.length;
        }
        
        function updateNotificationCount() {
            const unreadCount = notifications.filter(n => !n.read).length;
            document.getElementById('notificationCount').textContent = unreadCount > 0 ? unreadCount : '';
            
            const reportCount = reports.filter(r => r.status === 'pending').length;
            document.getElementById('adminReportCount').textContent = reportCount;
            document.getElementById('headerReportCount').textContent = reportCount > 0 ? reportCount : '';
        }
        
        // ========== PROFƒ∞L Sƒ∞STEMƒ∞ ==========
        function openProfile(nick) {
            const user = users[nick];
            if (!user) return;
            
            const overlay = document.getElementById('profileOverlay');
            const panel = document.getElementById('profilePanel');
            
            // Profil i√ßeriƒüini olu≈ütur
            panel.innerHTML = `
                <div class="profile-header">
                    <div class="profile-avatar" style="background: ${user.color}">
                        ${user.nick.charAt(0).toUpperCase()}
                    </div>
                    <div class="profile-name">${user.nick}</div>
                    <div class="profile-role">${getRoleName(user.role)}</div>
                    <div class="profile-stats">
                        <div class="profile-stat">
                            <div class="profile-stat-value">${user.following ? user.following.size : 0}</div>
                            <div class="profile-stat-label">Takip</div>
                        </div>
                        <div class="profile-stat">
                            <div class="profile-stat-value">${user.followers ? user.followers.size : 0}</div>
                            <div class="profile-stat-label">Takip√ßi</div>
                        </div>
                        <div class="profile-stat">
                            <div class="profile-stat-value">${user.storyCount || 0}</div>
                            <div class="profile-stat-label">Story</div>
                        </div>
                        <div class="profile-stat">
                            <div class="profile-stat-value">${user.messageCount || 0}</div>
                            <div class="profile-stat-label">Mesaj</div>
                        </div>
                    </div>
                </div>
                <div class="profile-body">
                    <div class="profile-section">
                        <div class="section-title">Bilgiler</div>
                        <div style="font-size: 13px; color: var(--text-secondary); line-height: 1.6;">
                            <div>üìÖ Katƒ±lma: ${user.joinedAt.toLocaleDateString('tr-TR')}</div>
                            <div>üëÅÔ∏è Son g√∂r√ºlme: ${user.lastSeen.toLocaleTimeString('tr-TR')}</div>
                            <div>üìä Durum: ${user.isOnline ? 'üü¢ √áevrimi√ßi' : '‚ö´ √áevrimdƒ±≈üƒ±'}</div>
                        </div>
                    </div>
                    
                    <div class="profile-section">
                        <div class="section-title">Se√ßenekler</div>
                        <div class="profile-options" id="profileOptions">
                            <!-- Dinamik olarak eklenecek -->
                        </div>
                    </div>
                    
                    <div class="profile-actions">
                        <button class="profile-btn secondary" onclick="closeProfile()">Kapat</button>
                        ${currentUser.nick !== user.nick ? 
                            `<button class="profile-btn primary" onclick="openPrivateChat('${user.nick}')">Mesaj G√∂nder</button>` :
                            `<button class="profile-btn primary" onclick="editProfile()">Profili D√ºzenle</button>`
                        }
                    </div>
                </div>
            `;
            
            // Profil se√ßeneklerini ekle
            const optionsContainer = document.getElementById('profileOptions');
            const options = getProfileOptions(user);
            
            options.forEach(option => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'profile-option';
                optionDiv.onclick = option.action;
                
                const iconDiv = document.createElement('div');
                iconDiv.className = 'option-icon';
                iconDiv.textContent = option.icon;
                
                const textDiv = document.createElement('div');
                textDiv.className = 'option-text';
                textDiv.textContent = option.text;
                
                optionDiv.appendChild(iconDiv);
                optionDiv.appendChild(textDiv);
                optionsContainer.appendChild(optionDiv);
            });
            
            overlay.classList.add('active');
        }
        
        function getProfileOptions(user) {
            const options = [];
            
            if (currentUser.nick !== user.nick) {
                // Ba≈üka kullanƒ±cƒ±nƒ±n profili
                const isFollowing = currentUser.following.has(user.nick);
                const isBlocked = blocked[currentUser.nick]?.has(user.nick);
                
                options.push({
                    icon: isFollowing ? '‚ùå' : '‚ûï',
                    text: isFollowing ? 'Takibi Bƒ±rak' : 'Takip Et',
                    action: () => toggleFollow(user.nick)
                });
                
                options.push({
                    icon: 'üîí',
                    text: '√ñzel Mesaj',
                    action: () => openPrivateChat(user.nick)
                });
                
                options.push({
                    icon: 'üìä',
                    text: 'ƒ∞statistikler',
                    action: () => showUserStats(user.nick)
                });
                
                if (hasPermission('view_reports')) {
                    options.push({
                        icon: '‚ö†Ô∏è',
                        text: '≈ûikayet Et',
                        action: () => reportUser(user.nick)
                    });
                }
                
                options.push({
                    icon: isBlocked ? 'üîì' : 'üö´',
                    text: isBlocked ? 'Engeli Kaldƒ±r' : 'Engelle',
                    action: () => toggleBlock(user.nick)
                });
            } else {
                // Kendi profili
                options.push({
                    icon: 'üé®',
                    text: 'Tema',
                    action: toggleTheme
                });
                
                options.push({
                    icon: 'üîî',
                    text: 'Bildirimler',
                    action: showNotifications
                });
                
                options.push({
                    icon: 'üì±',
                    text: 'Durum',
                    action: changeStatus
                });
                
                options.push({
                    icon: 'üë•',
                    text: 'Takip√ßiler',
                    action: () => showFollowers()
                });
                
                options.push({
                    icon: '‚öôÔ∏è',
                    text: 'Ayarlar',
                    action: openSettings
                });
                
                if (hasPermission('view_reports')) {
                    options.push({
                        icon: '‚ö°',
                        text: 'Y√∂netim',
                        action: openAdminPanel
                    });
                }
            }
            
            return options;
        }
        
        function closeProfile() {
            document.getElementById('profileOverlay').classList.remove('active');
        }
        
        function editProfile() {
            alert('Profil d√ºzenleme √∂zelliƒüi yakƒ±nda eklenecek!');
            closeProfile();
        }
        
        function toggleFollow(nick) {
            const targetUser = users[nick];
            if (!targetUser) return;
            
            if (currentUser.following.has(nick)) {
                // Takibi bƒ±rak
                currentUser.following.delete(nick);
                targetUser.followers.delete(currentUser.nick);
                addSystemMessage(`${nick} takibi bƒ±rakƒ±ldƒ±.`);
            } else {
                // Takip et
                currentUser.following.add(nick);
                targetUser.followers.add(currentUser.nick);
                addSystemMessage(`${nick} takip edilmeye ba≈ülandƒ±.`);
                
                // Bildirim ekle
                addNotification('follow', `${currentUser.nick} seni takip etti.`);
            }
            
            closeProfile();
            openProfile(nick); // Profili yeniden a√ß
        }
        
        function toggleBlock(nick) {
            if (!blocked[currentUser.nick]) {
                blocked[currentUser.nick] = new Set();
            }
            
            if (blocked[currentUser.nick].has(nick)) {
                // Engeli kaldƒ±r
                blocked[currentUser.nick].delete(nick);
                addSystemMessage(`${nick} engeli kaldƒ±rƒ±ldƒ±.`);
            } else {
                // Engelle
                blocked[currentUser.nick].add(nick);
                addSystemMessage(`${nick} engellendi.`);
                
                // Eƒüer √∂zel sohbet a√ßƒ±ksa kapat
                if (activePrivateChat === nick) {
                    closePrivateChat();
                }
            }
            
            closeProfile();
        }
        
        // ========== √ñZEL SOHBET Sƒ∞STEMƒ∞ ==========
        function openPrivateChat(nick) {
            if (blocked[currentUser.nick]?.has(nick)) {
                addSystemMessage(`${nick} kullanƒ±cƒ±sƒ±nƒ± engellediniz.`);
                return;
            }
            
            activePrivateChat = nick;
            const overlay = document.getElementById('privateChatOverlay');
            const window = document.getElementById('privateChatWindow');
            
            // Sohbet ID'si olu≈ütur
            const chatId = [currentUser.nick, nick].sort().join('_');
            if (!privateChats[chatId]) {
                privateChats[chatId] = {
                    id: chatId,
                    users: [currentUser.nick, nick],
                    messages: [],
                    media: []
                };
            }
            
            const chat = privateChats[chatId];
            const targetUser = users[nick];
            
            // Pencere i√ßeriƒüini olu≈ütur
            window.innerHTML = `
                <div class="private-chat-header">
                    <div class="private-chat-user">
                        <div class="private-chat-avatar" style="background: ${targetUser.color}">
                            ${targetUser.nick.charAt(0).toUpperCase()}
                        </div>
                        <div>
                            <div style="font-weight: 600;">${targetUser.nick}</div>
                            <div style="font-size: 12px; opacity: 0.9;">${targetUser.isOnline ? 'üü¢ √áevrimi√ßi' : '‚ö´ √áevrimdƒ±≈üƒ±'}</div>
                        </div>
                    </div>
                    <div class="private-chat-actions">
                        <button class="private-chat-btn" onclick="toggleBlock('${nick}')">
                            ${blocked[currentUser.nick]?.has(nick) ? 'üîì Engeli Kaldƒ±r' : 'üö´ Engelle'}
                        </button>
                        <button class="private-chat-btn" onclick="reportUser('${nick}')">
                            ‚ö†Ô∏è ≈ûikayet
                        </button>
                        <button class="private-chat-close" onclick="closePrivateChat()">‚úï</button>
                    </div>
                </div>
                <div class="private-chat-messages" id="privateChatMessages">
                    <!-- Mesajlar buraya eklenecek -->
                </div>
                <div class="private-chat-input-area">
                    <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                        <button class="input-action-btn" onclick="attachMediaToPrivateChat()">üìé Dosya</button>
                        <button class="input-action-btn" onclick="attachImageToPrivateChat()">üñºÔ∏è Resim</button>
                        <button class="input-action-btn" onclick="attachVideoToPrivateChat()">üé¨ Video</button>
                    </div>
                    <div class="input-container">
                        <textarea 
                            id="privateMessageInput" 
                            class="chat-input" 
                            placeholder="${targetUser.nick}'a mesaj g√∂nder..."
                            rows="2"
                            oninput="autoResize(this)"
                            onkeydown="handlePrivateKeyDown(event, '${nick}')"
                        ></textarea>
                        <button class="send-btn" onclick="sendPrivateMessage('${nick}')">
                            ‚Üó
                        </button>
                    </div>
                </div>
            `;
            
            // Mesajlarƒ± y√ºkle
            const messagesContainer = document.getElementById('privateChatMessages');
            messagesContainer.innerHTML = '';
            
            chat.messages.forEach(msg => {
                const msgDiv = document.createElement('div');
                msgDiv.className = 'message';
                msgDiv.style.padding = '4px 0';
                
                const avatar = document.createElement('div');
                avatar.className = 'message-avatar';
                avatar.style.width = '28px';
                avatar.style.height = '28px';
                avatar.style.fontSize = '12px';
                avatar.style.background = msg.color || generateColor(msg.sender);
                avatar.textContent = msg.sender.charAt(0).toUpperCase();
                msgDiv.appendChild(avatar);
                
                const content = document.createElement('div');
                content.className = 'message-content';
                
                const header = document.createElement('div');
                header.className = 'message-header';
                
                const sender = document.createElement('span');
                sender.className = 'message-sender';
                sender.style.fontSize = '12px';
                sender.textContent = msg.sender;
                header.appendChild(sender);
                
                const time = document.createElement('span');
                time.className = 'message-time';
                time.style.fontSize = '10px';
                time.textContent = formatTime(msg.time);
                header.appendChild(time);
                
                content.appendChild(header);
                
                const text = document.createElement('div');
                text.className = 'message-text';
                text.style.fontSize = '13px';
                text.innerHTML = formatMessageText(msg.text);
                content.appendChild(text);
                
                if (msg.media) {
                    const media = document.createElement('div');
                    media.className = 'message-media';
                    media.style.maxWidth = '200px';
                    
                    if (msg.media.type === 'image') {
                        const img = document.createElement('img');
                        img.src = msg.media.url;
                        img.alt = 'G√∂nderilen resim';
                        media.appendChild(img);
                    } else if (msg.media.type === 'video') {
                        const video = document.createElement('video');
                        video.src = msg.media.url;
                        video.controls = true;
                        media.appendChild(video);
                    }
                    
                    content.appendChild(media);
                }
                
                msgDiv.appendChild(content);
                messagesContainer.appendChild(msgDiv);
            });
            
            overlay.classList.add('active');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // Input'a focus
            setTimeout(() => {
                const input = document.getElementById('privateMessageInput');
                if (input) input.focus();
            }, 100);
        }
        
        function closePrivateChat() {
            activePrivateChat = null;
            document.getElementById('privateChatOverlay').classList.remove('active');
        }
        
        function sendPrivateMessage(targetNick) {
            if (!targetNick || !activePrivateChat) return;
            
            const input = document.getElementById('privateMessageInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            // Bot moderasyonu
            if (!BOT_MATE.moderate({ text: text, sender: currentUser.nick })) {
                addSystemMessage('Mesajƒ±nƒ±z moderasyon kurallarƒ±na uymuyor.');
                return;
            }
            
            const chatId = [currentUser.nick, targetNick].sort().join('_');
            if (!privateChats[chatId]) {
                privateChats[chatId] = {
                    id: chatId,
                    users: [currentUser.nick, targetNick],
                    messages: [],
                    media: []
                };
            }
            
            const message = {
                id: 'private_' + Date.now(),
                sender: currentUser.nick,
                text: text,
                time: new Date(),
                role: currentUser.role,
                avatar: currentUser.avatar,
                color: currentUser.color
            };
            
            privateChats[chatId].messages.push(message);
            
            // Mesajƒ± g√∂ster
            const container = document.getElementById('privateChatMessages');
            const msgDiv = document.createElement('div');
            msgDiv.className = 'message';
            msgDiv.style.padding = '4px 0';
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.style.width = '28px';
            avatar.style.height = '28px';
            avatar.style.fontSize = '12px';
            avatar.style.background = currentUser.color;
            avatar.textContent = currentUser.nick.charAt(0).toUpperCase();
            msgDiv.appendChild(avatar);
            
            const content = document.createElement('div');
            content.className = 'message-content';
            
            const header = document.createElement('div');
            header.className = 'message-header';
            
            const sender = document.createElement('span');
            sender.className = 'message-sender';
            sender.style.fontSize = '12px';
            sender.textContent = currentUser.nick;
            header.appendChild(sender);
            
            const time = document.createElement('span');
            time.className = 'message-time';
            time.style.fontSize = '10px';
            time.textContent = formatTime(new Date());
            header.appendChild(time);
            
            content.appendChild(header);
            
            const textDiv = document.createElement('div');
            textDiv.className = 'message-text';
            textDiv.style.fontSize = '13px';
            textDiv.innerHTML = formatMessageText(text);
            content.appendChild(textDiv);
            
            msgDiv.appendChild(content);
            container.appendChild(msgDiv);
            
            input.value = '';
            autoResize(input);
            container.scrollTop = container.scrollHeight;
            
            // Hedef kullanƒ±cƒ±ya bildirim
            if (users[targetNick] && users[targetNick].isOnline) {
                addNotification('private', `${currentUser.nick}: ${text.substring(0, 50)}...`);
            }
            
            // Bot'a bildir (eƒüer owner ise)
            if (BOT_MATE.owner === targetNick) {
                BOT_MATE.sendPrivate(BOT_MATE.owner, `üì© ${currentUser.nick}: ${text}`);
            }
        }
        
        function handlePrivateKeyDown(e, targetNick) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendPrivateMessage(targetNick);
            }
        }
        
        function attachMediaToPrivateChat() {
            alert('Dosya ekleme √∂zelliƒüi yakƒ±nda eklenecek!');
        }
        
        function attachImageToPrivateChat() {
            alert('Resim ekleme √∂zelliƒüi yakƒ±nda eklenecek!');
        }
        
        function attachVideoToPrivateChat() {
            alert('Video ekleme √∂zelliƒüi yakƒ±nda eklenecek!');
        }
        
        // ========== STORY Sƒ∞STEMƒ∞ ==========
        function createStory() {
            if (!hasPermission('manage_stories') && currentUser.role === SYSTEM_CONFIG.ROLES.USER) {
                alert('Story payla≈üƒ±mƒ± i√ßin yetkiniz yok!');
                return;
            }
            
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*,video/*';
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const story = {
                            id: 'story_' + Date.now(),
                            user: currentUser.nick,
                            type: file.type.startsWith('video') ? 'video' : 'image',
                            url: e.target.result,
                            likes: 0,
                            views: 0,
                            timestamp: new Date(),
                            seenBy: new Set(),
                            reported: false
                        };
                        
                        stories.unshift(story); // En ba≈üa ekle
                        updateStoryBar();
                        
                        // Kullanƒ±cƒ± story sayƒ±sƒ±nƒ± g√ºncelle
                        currentUser.storyCount = (currentUser.storyCount || 0) + 1;
                        
                        // Takip√ßilere bildirim
                        if (currentUser.followers) {
                            currentUser.followers.forEach(follower => {
                                addNotification('story', `${currentUser.nick} yeni bir story payla≈ütƒ±`);
                            });
                        }
                        
                        addSystemMessage(`üì∏ ${currentUser.nick} yeni bir story payla≈ütƒ±!`);
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }
        
        function viewStory(story) {
            currentStory = story;
            const viewer = document.getElementById('storyViewer');
            const image = document.getElementById('storyImage');
            const video = document.getElementById('storyVideo');
            const userName = document.getElementById('storyUserName');
            const likeCount = document.getElementById('storyLikeCount');
            const viewCount = document.getElementById('storyViewCount');
            const storyTime = document.getElementById('storyTime');
            
            // G√∂r√ºnt√ºlenme sayƒ±sƒ±nƒ± artƒ±r
            if (!story.seenBy.has(currentUser.nick)) {
                story.seenBy.add(currentUser.nick);
                story.views++;
            }
            
            // Bilgileri g√ºncelle
            userName.textContent = story.user;
            likeCount.textContent = story.likes;
            viewCount.textContent = story.views;
            storyTime.textContent = formatRelativeTime(story.timestamp);
            
            // Avatar resmini ayarla
            const avatarImg = document.querySelector('.story-avatar-small');
            avatarImg.src = story.url;
            
            if (story.type === 'video') {
                image.style.display = 'none';
                video.style.display = 'block';
                video.src = story.url;
                video.play();
            } else {
                image.style.display = 'block';
                video.style.display = 'none';
                image.src = story.url;
            }
            
            viewer.classList.add('active');
        }
        
        function closeStory() {
            const viewer = document.getElementById('storyViewer');
            const video = document.getElementById('storyVideo');
            
            if (video) {
                video.pause();
                video.src = '';
            }
            
            viewer.classList.remove('active');
            currentStory = null;
        }
        
        function likeStory() {
            if (!currentStory) return;
            
            currentStory.likes++;
            document.getElementById('storyLikeCount').textContent = currentStory.likes;
            
            // Kullanƒ±cƒ±ya bildirim
            if (users[currentStory.user]) {
                addNotification('like', `${currentUser.nick} story'ini beƒüendi`);
            }
            
            addSystemMessage(`‚ù§Ô∏è ${currentUser.nick}, ${currentStory.user}'ƒ±n story'sini beƒüendi`);
        }
        
        function reportStory() {
            if (!currentStory) return;
            
            const reason = prompt('Story ≈üikayet sebebiniz:');
            if (reason) {
                reports.push({
                    id: 'report_' + Date.now(),
                    type: 'story',
                    user: currentStory.user,
                    reporter: currentUser.nick,
                    reason: reason,
                    storyId: currentStory.id,
                    status: 'pending',
                    time: new Date()
                });
                
                updateNotificationCount();
                addSystemMessage(`‚ö†Ô∏è Story ≈üikayeti alƒ±ndƒ±: ${reason}`);
                closeStory();
            }
        }
        
        // ========== MESAJ Sƒ∞STEMƒ∞ ==========
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }
        
        function handleKeyDown(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        }
        
        function sendMessage() {
            if (!currentUser) return;
            
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            if (text.startsWith('/')) {
                handleCommand(text);
            } else {
                // Normal mesaj
                const message = {
                    id: 'msg_' + Date.now(),
                    sender: currentUser.nick,
                    text: text,
                    time: new Date(),
                    role: currentUser.role,
                    avatar: currentUser.avatar,
                    color: currentUser.color
                };
                
                // Bot moderasyonu
                if (!BOT_MATE.moderate(message)) {
                    addSystemMessage('Mesajƒ±nƒ±z moderasyon kurallarƒ±na uymuyor.');
                    return;
                }
                
                // Kanal mesajlarƒ±na ekle
                channels[currentChannel].messages.push(message);
                
                // UI'ya ekle
                addMessageToUI(message);
                
                // Mesaj sayƒ±sƒ±nƒ± g√ºncelle
                currentUser.messageCount = (currentUser.messageCount || 0) + 1;
                
                // T√ºm kullanƒ±cƒ±lara ilet (sim√ºlasyon)
                broadcastMessage(message);
            }
            
            input.value = '';
            autoResize(input);
        }
        
        function broadcastMessage(message) {
            // Burada ger√ßek sunucu baƒülantƒ±sƒ±nda mesaj iletilecek
            // ≈ûimdilik sim√ºlasyon
            
            Object.values(users).forEach(user => {
                if (user.isOnline && user.nick !== currentUser.nick) {
                    // Mesajƒ±n iletildiƒüini sim√ºle et
                    // Ger√ßek uygulamada WebSocket ile g√∂nderilecek
                }
            });
        }
        
        function replyToMessage(sender) {
            const input = document.getElementById('messageInput');
            input.value = `@${sender} `;
            input.focus();
        }
        
        function reportMessage(message) {
            const reason = prompt('Mesaj ≈üikayet sebebiniz:');
            if (reason) {
                reports.push({
                    id: 'report_' + Date.now(),
                    type: 'message',
                    user: message.sender,
                    reporter: currentUser.nick,
                    reason: reason,
                    messageId: message.id,
                    status: 'pending',
                    time: new Date()
                });
                
                updateNotificationCount();
                addSystemMessage(`‚ö†Ô∏è Mesaj ≈üikayeti alƒ±ndƒ±: ${reason}`);
                
                // Bot'a bildir
                BOT_MATE.notifyOwner('MESAJ ≈ûƒ∞KAYETƒ∞', {
                    reporter: currentUser.nick,
                    target: message.sender,
                    reason: reason,
                    message: message.text
                });
            }
        }
        
        function reportUser(nick) {
            const reason = prompt(`${nick} kullanƒ±cƒ±sƒ±nƒ± ≈üikayet sebebiniz:`);
            if (reason) {
                reports.push({
                    id: 'report_' + Date.now(),
                    type: 'user',
                    user: nick,
                    reporter: currentUser.nick,
                    reason: reason,
                    status: 'pending',
                    time: new Date()
                });
                
                updateNotificationCount();
                addSystemMessage(`‚ö†Ô∏è Kullanƒ±cƒ± ≈üikayeti alƒ±ndƒ±: ${reason}`);
                
                // Bot'a bildir
                BOT_MATE.notifyOwner('KULLANICI ≈ûƒ∞KAYETƒ∞', {
                    reporter: currentUser.nick,
                    target: nick,
                    reason: reason
                });
            }
        }
        
        // ========== KOMUT Sƒ∞STEMƒ∞ ==========
        function handleCommand(cmd) {
            const parts = cmd.substring(1).split(' ');
            const command = parts[0].toLowerCase();
            const args = parts.slice(1);
            
            switch(command) {
                case 'help':
                case 'yardƒ±m':
                    showHelp();
                    break;
                    
                case 'nick':
                    if (args[0]) {
                        changeNick(args[0]);
                    }
                    break;
                    
                case 'me':
                    if (args.length > 0) {
                        addActionMessage(args.join(' '));
                    }
                    break;
                    
                case 'msg':
                case 'pm':
                    if (args.length >= 2) {
                        openPrivateChat(args[0]);
                        setTimeout(() => {
                            const input = document.getElementById('privateMessageInput');
                            if (input) {
                                input.value = args.slice(1).join(' ');
                                autoResize(input);
                            }
                        }, 100);
                    }
                    break;
                    
                case 'list':
                    showUserList();
                    break;
                    
                case 'whois':
                    if (args[0]) {
                        showUserInfo(args[0]);
                    }
                    break;
                    
                case 'clear':
                    if (hasPermission('clear')) {
                        clearChat();
                    }
                    break;
                    
                case 'kick':
                    if (hasPermission('kick') && args.length >= 2) {
                        kickUser(args[0], args.slice(1).join(' '));
                    }
                    break;
                    
                case 'mute':
                    if (hasPermission('mute') && args.length >= 2) {
                        muteUser(args[0], args.slice(1).join(' '));
                    }
                    break;
                    
                case 'ban':
                    if (hasPermission('ban') && args.length >= 2) {
                        banUser(args[0], args.slice(1).join(' '));
                    }
                    break;
                    
                case 'op':
                    if (hasPermission('op') && args[0]) {
                        giveOp(args[0]);
                    }
                    break;
                    
                case 'admin':
                    if (currentUser.role === SYSTEM_CONFIG.ROLES.OWNER && args[0]) {
                        giveAdmin(args[0]);
                    }
                    break;
                    
                case 'coadmin':
                    if ((currentUser.role === SYSTEM_CONFIG.ROLES.OWNER || 
                         currentUser.role === SYSTEM_CONFIG.ROLES.ADMIN) && args[0]) {
                        giveCoAdmin(args[0]);
                    }
                    break;
                    
                case 'bot':
                    if (currentUser.role === SYSTEM_CONFIG.ROLES.OWNER && args[0]) {
                        handleBotCommand(args);
                    }
                    break;
                    
                case 'follow':
                    if (args[0]) {
                        toggleFollow(args[0]);
                    }
                    break;
                    
                case 'story':
                    createStory();
                    break;
                    
                case 'status':
                    if (args[0]) {
                        changeUserStatus(args[0]);
                    }
                    break;
                    
                case 'theme':
                    toggleTheme();
                    break;
                    
                default:
                    addSystemMessage(`‚ùå Bilinmeyen komut: ${command}`);
            }
        }
        
        function showHelp() {
            let help = `
                <strong>üìñ KOMUT Lƒ∞STESƒ∞:</strong><br><br>
                <strong>Genel Komutlar:</strong><br>
                ‚Ä¢ /help - Komut listesi<br>
                ‚Ä¢ /nick [yeni] - Nick deƒüi≈ütir<br>
                ‚Ä¢ /me [eylem] - Eylem mesajƒ±<br>
                ‚Ä¢ /msg [nick] [mesaj] - √ñzel mesaj<br>
                ‚Ä¢ /list - Kullanƒ±cƒ± listesi<br>
                ‚Ä¢ /whois [nick] - Kullanƒ±cƒ± bilgisi<br>
                ‚Ä¢ /follow [nick] - Takip et/bƒ±rak<br>
                ‚Ä¢ /story - Story payla≈ü<br>
                ‚Ä¢ /status [online/away/busy] - Durum deƒüi≈ütir<br>
                ‚Ä¢ /theme - Tema deƒüi≈ütir<br>
            `;
            
            if (hasPermission('clear')) {
                help += `
                    <strong>Y√∂netim Komutlarƒ±:</strong><br>
                    ‚Ä¢ /clear - Sohbeti temizle<br>
                    ‚Ä¢ /kick [nick] [sebep] - Kullanƒ±cƒ± at<br>
                    ‚Ä¢ /mute [nick] [sebep] - Sustur<br>
                    ‚Ä¢ /ban [nick] [sebep] - Yasakla<br>
                    ‚Ä¢ /op [nick] - Operat√∂r yap<br>
                    ‚Ä¢ /coadmin [nick] - Co-Admin yap<br>
                `;
            }
            
            if (currentUser.role === SYSTEM_CONFIG.ROLES.ADMIN) {
                help += `‚Ä¢ /admin [nick] - Admin yap<br>`;
            }
            
            if (currentUser.role === SYSTEM_CONFIG.ROLES.OWNER) {
                help += `
                    <strong>Owner Komutlarƒ±:</strong><br>
                    ‚Ä¢ /bot [komut] - Bot'u y√∂net<br>
                    ‚Ä¢ Bot komutlarƒ±: stats, cleanup, alert [mesaj]<br>
                `;
            }
            
            addSystemMessage(help);
        }
        
        function addActionMessage(action) {
            const message = {
                id: 'action_' + Date.now(),
                sender: currentUser.nick,
                text: `* ${action}`,
                time: new Date(),
                type: 'action',
                color: '#fa8c16'
            };
            
            channels[currentChannel].messages.push(message);
            addMessageToUI(message);
        }
        
        function changeNick(newNick) {
            if (!newNick || newNick.length < 2) {
                addSystemMessage('‚ùå Ge√ßerli bir nick girin! (min 2 karakter)');
                return;
            }
            
            if (users[newNick]) {
                addSystemMessage('‚ùå Bu nick zaten kullanƒ±lƒ±yor!');
                return;
            }
            
            const oldNick = currentUser.nick;
            
            // Bot'a bildir
            BOT_MATE.notifyOwner('NICK DEƒûƒ∞≈ûƒ∞KLƒ∞ƒûƒ∞', {
                old: oldNick,
                new: newNick,
                user: currentUser
            });
            
            // Kullanƒ±cƒ±yƒ± g√ºncelle
            users[newNick] = currentUser;
            users[newNick].nick = newNick;
            delete users[oldNick];
            
            // Kanallardaki kullanƒ±cƒ± listelerini g√ºncelle
            Object.values(channels).forEach(channel => {
                if (channel.users.has(oldNick)) {
                    channel.users.delete(oldNick);
                    channel.users.add(newNick);
                }
            });
            
            // Takiple≈üme listelerini g√ºncelle
            Object.values(users).forEach(user => {
                if (user.following.has(oldNick)) {
                    user.following.delete(oldNick);
                    user.following.add(newNick);
                }
                if (user.followers.has(oldNick)) {
                    user.followers.delete(oldNick);
                    user.followers.add(newNick);
                }
            });
            
            // Bot owner'ƒ±nƒ± g√ºncelle
            if (BOT_MATE.owner === oldNick) {
                BOT_MATE.owner = newNick;
            }
            
            currentUser.nick = newNick;
            
            addSystemMessage(`üîÑ ${oldNick} artƒ±k ${newNick} olarak biliniyor`);
            updateUsersList();
            
            // Eƒüer owner nick deƒüi≈ütiriyorsa
            if (currentUser.role === SYSTEM_CONFIG.ROLES.OWNER) {
                BOT_MATE.sendMessage(currentChannel, `‚ö° Sistem: Owner nick deƒüi≈ütirdi (${oldNick} ‚Üí ${newNick})`);
            }
        }
        
        function showUserList() {
            const channelUsers = Array.from(channels[currentChannel].users);
            const onlineUsers = channelUsers.filter(nick => users[nick] && users[nick].isOnline);
            const offlineUsers = channelUsers.filter(nick => users[nick] && !users[nick].isOnline);
            
            addSystemMessage(`üë• Kanalda ${channelUsers.length} kullanƒ±cƒ±:<br>
                ‚Ä¢ üü¢ √áevrimi√ßi (${onlineUsers.length}): ${onlineUsers.join(', ')}<br>
                ‚Ä¢ ‚ö´ √áevrimdƒ±≈üƒ± (${offlineUsers.length}): ${offlineUsers.join(', ')}`);
        }
        
        function showUserInfo(nick) {
            const user = users[nick];
            if (user) {
                addSystemMessage(`üë§ <strong>${nick}</strong><br>
                    ‚Ä¢ Yetki: ${getRoleName(user.role)}<br>
                    ‚Ä¢ Durum: ${user.isOnline ? 'üü¢ √áevrimi√ßi' : '‚ö´ √áevrimdƒ±≈üƒ±'}<br>
                    ‚Ä¢ Katƒ±lma: ${user.joinedAt.toLocaleDateString('tr-TR')}<br>
                    ‚Ä¢ Son g√∂r√ºlme: ${user.lastSeen.toLocaleTimeString('tr-TR')}<br>
                    ‚Ä¢ Mesaj: ${user.messageCount || 0}<br>
                    ‚Ä¢ Takip√ßi: ${user.followers ? user.followers.size : 0}<br>
                    ‚Ä¢ Takip: ${user.following ? user.following.size : 0}`);
            } else {
                addSystemMessage(`‚ùå Kullanƒ±cƒ± bulunamadƒ±: ${nick}`);
            }
        }
        
        function clearChat() {
            if (confirm('T√ºm mesajlarƒ± temizlemek istediƒüinizden emin misiniz?')) {
                channels[currentChannel].messages = [];
                loadChannel(currentChannel);
                addSystemMessage('üóëÔ∏è Sohbet temizlendi.');
                
                // Bot'a bildir
                BOT_MATE.notifyOwner('SOHBET TEMƒ∞ZLENDƒ∞', {
                    channel: currentChannel,
                    user: currentUser.nick
                });
            }
        }
        
        function kickUser(nick, reason) {
            if (!users[nick]) {
                addSystemMessage(`‚ùå Kullanƒ±cƒ± bulunamadƒ±: ${nick}`);
                return;
            }
            
            if (users[nick].role === SYSTEM_CONFIG.ROLES.OWNER) {
                addSystemMessage('‚ùå Owner atƒ±lamaz!');
                return;
            }
            
            if (users[nick].role === SYSTEM_CONFIG.ROLES.ADMIN && 
                currentUser.role !== SYSTEM_CONFIG.ROLES.OWNER) {
                addSystemMessage('‚ùå Admin sadece Owner tarafƒ±ndan atƒ±labilir!');
                return;
            }
            
            // Kanaldan at
            channels[currentChannel].users.delete(nick);
            updateUsersList();
            
            addSystemMessage(`‚ö†Ô∏è ${nick} kanaldan atƒ±ldƒ±: ${reason}`);
            
            // Bot'a bildir
            BOT_MATE.notifyOwner('KULLANICI ATILDI', {
                target: nick,
                reason: reason,
                by: currentUser.nick,
                channel: currentChannel
            });
        }
        
        function muteUser(nick, reason) {
            if (!users[nick]) {
                addSystemMessage(`‚ùå Kullanƒ±cƒ± bulunamadƒ±: ${nick}`);
                return;
            }
            
            users[nick].isMuted = true;
            addSystemMessage(`üîá ${nick} susturuldu: ${reason}`);
        }
        
        function banUser(nick, reason) {
            if (!users[nick]) {
                addSystemMessage(`‚ùå Kullanƒ±cƒ± bulunamadƒ±: ${nick}`);
                return;
            }
            
            if (users[nick].role === SYSTEM_CONFIG.ROLES.OWNER) {
                addSystemMessage('‚ùå Owner yasaklanamaz!');
                return;
            }
            
            users[nick].isBanned = true;
            users[nick].isOnline = false;
            
            // T√ºm kanallardan √ßƒ±kar
            Object.values(channels).forEach(channel => {
                channel.users.delete(nick);
            });
            
            updateUsersList();
            addSystemMessage(`üö´ ${nick} yasaklandƒ±: ${reason}`);
            
            // Bot'a bildir
            BOT_MATE.notifyOwner('KULLANICI YASAKLANDI', {
                target: nick,
                reason: reason,
                by: currentUser.nick
            });
        }
        
        function giveOp(nick) {
            if (users[nick]) {
                users[nick].role = SYSTEM_CONFIG.ROLES.OPERATOR;
                addSystemMessage(`‚ö° ${nick}'e operat√∂r yetkisi verildi`);
                updateUsersList();
                
                // Bot'a bildir
                BOT_MATE.notifyOwner('OPERAT√ñR ATANDI', {
                    target: nick,
                    by: currentUser.nick
                });
            }
        }
        
        function giveAdmin(nick) {
            if (users[nick]) {
                users[nick].role = SYSTEM_CONFIG.ROLES.ADMIN;
                addSystemMessage(`‚ö° ${nick}'e admin yetkisi verildi`);
                updateUsersList();
                
                // Bot'a bildir
                BOT_MATE.notifyOwner('ADMIN ATANDI', {
                    target: nick,
                    by: currentUser.nick
                });
            }
        }
        
        function giveCoAdmin(nick) {
            if (users[nick]) {
                users[nick].role = SYSTEM_CONFIG.ROLES.COADMIN;
                addSystemMessage(`‚ö° ${nick}'e co-admin yetkisi verildi`);
                updateUsersList();
                
                // Bot'a bildir
                BOT_MATE.notifyOwner('CO-ADMIN ATANDI', {
                    target: nick,
                    by: currentUser.nick
                });
            }
        }
        
        function handleBotCommand(args) {
            if (args.length === 0) {
                addSystemMessage('Bot komutlarƒ±: /bot [stats|cleanup|alert mesaj]');
                return;
            }
            
            BOT_MATE.executeCommand(args[0], args.slice(1));
        }
        
        function changeUserStatus(status) {
            const validStatuses = ['online', 'away', 'busy', 'offline'];
            
            if (!validStatuses.includes(status)) {
                addSystemMessage('Ge√ßerli durumlar: online, away, busy, offline');
                return;
            }
            
            currentUser.status = status;
            currentUser.isOnline = status !== 'offline';
            
            addSystemMessage(`üîÑ Durumunuz "${status}" olarak deƒüi≈ütirildi`);
            updateUsersList();
        }
        
        // ========== Y√ñNETƒ∞M PANELƒ∞ ==========
        function openAdminPanel() {
            if (!hasPermission('view_reports')) return;
            
            const overlay = document.getElementById('adminOverlay');
            const panel = document.getElementById('adminPanel');
            const nav = document.getElementById('adminNav');
            const content = document.getElementById('adminContent');
            
            // Navigasyonu olu≈ütur
            nav.innerHTML = `
                <div class="admin-nav-item active" onclick="switchAdminSection('dashboard')">üìä Dashboard</div>
                <div class="admin-nav-item" onclick="switchAdminSection('users')">üë• Kullanƒ±cƒ±lar</div>
                <div class="admin-nav-item" onclick="switchAdminSection('reports')">‚ö†Ô∏è ≈ûikayetler</div>
                <div class="admin-nav-item" onclick="switchAdminSection('stories')">üì∏ Story'ler</div>
                <div class="admin-nav-item" onclick="switchAdminSection('channels')">üí¨ Kanallar</div>
                <div class="admin-nav-item" onclick="switchAdminSection('logs')">üìù Loglar</div>
                ${currentUser.role === SYSTEM_CONFIG.ROLES.OWNER ? 
                    '<div class="admin-nav-item" onclick="switchAdminSection(\'bot\')">ü§ñ Bot Kontrol</div>' : ''}
                <div class="admin-nav-item" onclick="switchAdminSection('settings')">‚öôÔ∏è Ayarlar</div>
            `;
            
            // ƒ∞√ßeriƒüi olu≈ütur
            content.innerHTML = `
                <div id="adminDashboard" class="admin-section active">
                    <h3>üìä Sistem Dashboard</h3>
                    <div style="margin-top: 16px;">
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
                            <div style="background: var(--bg-card); padding: 16px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                                <div style="font-size: 12px; color: var(--text-light);">√áevrimi√ßi</div>
                                <div style="font-size: 24px; font-weight: 600; color: var(--primary);">${Object.values(users).filter(u => u.isOnline).length}</div>
                            </div>
                            <div style="background: var(--bg-card); padding: 16px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                                <div style="font-size: 12px; color: var(--text-light);">Toplam Kullanƒ±cƒ±</div>
                                <div style="font-size: 24px; font-weight: 600; color: var(--success);">${Object.keys(users).length}</div>
                            </div>
                            <div style="background: var(--bg-card); padding: 16px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                                <div style="font-size: 12px; color: var(--text-light);">Bekleyen ≈ûikayet</div>
                                <div style="font-size: 24px; font-weight: 600; color: var(--danger);">${reports.filter(r => r.status === 'pending').length}</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="adminUsers" class="admin-section">
                    <h3>üë• Kullanƒ±cƒ± Y√∂netimi</h3>
                    <div style="margin-top: 16px;">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Nick</th>
                                    <th>Yetki</th>
                                    <th>Durum</th>
                                    <th>ƒ∞≈ülemler</th>
                                </tr>
                            </thead>
                            <tbody id="adminUsersTable">
                                <!-- Dinamik olarak eklenecek -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div id="adminReports" class="admin-section">
                    <h3>‚ö†Ô∏è ≈ûikayet Y√∂netimi</h3>
                    <div style="margin-top: 16px;">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>T√ºr</th>
                                    <th>Hedef</th>
                                    <th>≈ûikayet√ßi</th>
                                    <th>Sebep</th>
                                    <th>Durum</th>
                                    <th>ƒ∞≈ülemler</th>
                                </tr>
                            </thead>
                            <tbody id="adminReportsTable">
                                <!-- Dinamik olarak eklenecek -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div id="adminStories" class="admin-section">
                    <h3>üì∏ Story Y√∂netimi</h3>
                    <div style="margin-top: 16px;">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Kullanƒ±cƒ±</th>
                                    <th>Beƒüeni</th>
                                    <th>G√∂r√ºnt√ºlenme</th>
                                    <th>Zaman</th>
                                    <th>ƒ∞≈ülemler</th>
                                </tr>
                            </thead>
                            <tbody id="adminStoriesTable">
                                <!-- Dinamik olarak eklenecek -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div id="adminChannels" class="admin-section">
                    <h3>üí¨ Kanal Y√∂netimi</h3>
                    <!-- Kanal y√∂netimi i√ßeriƒüi -->
                </div>
                
                <div id="adminLogs" class="admin-section">
                    <h3>üìù Sistem Loglarƒ±</h3>
                    <!-- Loglar i√ßeriƒüi -->
                </div>
                
                ${currentUser.role === SYSTEM_CONFIG.ROLES.OWNER ? `
                <div id="adminBot" class="admin-section">
                    <h3>ü§ñ Bot Kontrol Paneli</h3>
                    <div style="margin-top: 16px;">
                        <div style="background: var(--bg-card); padding: 20px; border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                            <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 12px;">
                                Bot Durumu: <span style="color: var(--success); font-weight: 600;">üü¢ Aktif</span><br>
                                Bot Owner: ${BOT_MATE.owner || 'Atanmamƒ±≈ü'}
                            </div>
                            <div style="display: flex; gap: 12px;">
                                <button class="admin-action-btn" onclick="BOT_MATE.executeCommand('stats', [])">üìä ƒ∞statistikler</button>
                                <button class="admin-action-btn" onclick="BOT_MATE.executeCommand('cleanup', [])">üßπ Temizlik</button>
                                <button class="admin-action-btn" onclick="botSendAlert()">üö® Uyarƒ± G√∂nder</button>
                            </div>
                        </div>
                    </div>
                </div>
                ` : ''}
                
                <div id="adminSettings" class="admin-section">
                    <h3>‚öôÔ∏è Sistem Ayarlarƒ±</h3>
                    <!-- Ayarlar i√ßeriƒüi -->
                </div>
            `;
            
            // Tablolarƒ± doldur
            updateAdminUsersTable();
            updateAdminReportsTable();
            updateAdminStoriesTable();
            
            overlay.classList.add('active');
            panel.classList.add('active');
        }
        
        function switchAdminSection(section) {
            // T√ºm section'larƒ± gizle
            document.querySelectorAll('.admin-section').forEach(el => {
                el.classList.remove('active');
            });
            
            // T√ºm nav item'larƒ± pasif yap
            document.querySelectorAll('.admin-nav-item').forEach(el => {
                el.classList.remove('active');
            });
            
            // Hedef section'ƒ± g√∂ster
            document.getElementById(`admin${section.charAt(0).toUpperCase() + section.slice(1)}`).classList.add('active');
            
            // Nav item'ƒ± aktif yap
            event.target.classList.add('active');
        }
        
        function updateAdminUsersTable() {
            const table = document.getElementById('adminUsersTable');
            table.innerHTML = '';
            
            Object.values(users).forEach(user => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${user.nick}</td>
                    <td><span class="badge-${user.role}">${getRoleBadge(user.role)}</span></td>
                    <td>${user.isOnline ? 'üü¢' : '‚ö´'} ${user.status || 'offline'}</td>
                    <td>
                        ${user.role !== SYSTEM_CONFIG.ROLES.OWNER ? `
                            <button class="admin-action-btn" onclick="adminKickUser('${user.nick}')">At</button>
                            ${user.role !== SYSTEM_CONFIG.ROLES.ADMIN ? `
                                <button class="admin-action-btn" onclick="adminMuteUser('${user.nick}')">Sustur</button>
                            ` : ''}
                            ${currentUser.role === SYSTEM_CONFIG.ROLES.OWNER && user.role !== SYSTEM_CONFIG.ROLES.ADMIN ? `
                                <button class="admin-action-btn" onclick="adminPromoteUser('${user.nick}')">Y√ºkselt</button>
                            ` : ''}
                        ` : '<em style="color: var(--text-light);">Owner</em>'}
                    </td>
                `;
                
                table.appendChild(row);
            });
        }
        
        function updateAdminReportsTable() {
            const table = document.getElementById('adminReportsTable');
            table.innerHTML = '';
            
            reports.forEach(report => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${report.type}</td>
                    <td>${report.user}</td>
                    <td>${report.reporter}</td>
                    <td>${report.reason}</td>
                    <td><span style="color: ${report.status === 'pending' ? 'var(--warning)' : 'var(--success)'}">${report.status}</span></td>
                    <td>
                        <button class="admin-action-btn" onclick="adminResolveReport('${report.id}')">√á√∂z</button>
                        <button class="admin-action-btn" onclick="adminDeleteReport('${report.id}')">Sil</button>
                    </td>
                `;
                
                table.appendChild(row);
            });
        }
        
        function updateAdminStoriesTable() {
            const table = document.getElementById('adminStoriesTable');
            table.innerHTML = '';
            
            stories.forEach(story => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${story.user}</td>
                    <td>${story.likes}</td>
                    <td>${story.views}</td>
                    <td>${formatRelativeTime(story.timestamp)}</td>
                    <td>
                        <button class="admin-action-btn" onclick="adminViewStory('${story.id}')">G√∂r√ºnt√ºle</button>
                        ${story.reported ? '<span style="color: var(--danger); font-size: 12px;">‚ö†Ô∏è</span>' : ''}
                    </td>
                `;
                
                table.appendChild(row);
            });
        }
        
        function adminKickUser(nick) {
            if (confirm(`${nick} kullanƒ±cƒ±sƒ±nƒ± atmak istediƒüinizden emin misiniz?`)) {
                kickUser(nick, 'Y√∂netici kararƒ±');
            }
        }
        
        function adminMuteUser(nick) {
            const reason = prompt('Susturma sebebi:');
            if (reason) {
                muteUser(nick, reason);
            }
        }
        
        function adminPromoteUser(nick) {
            const newRole = prompt('Yeni yetki (admin/coadmin/operator/user):');
            if (newRole && ['admin', 'coadmin', 'operator', 'user'].includes(newRole)) {
                users[nick].role = newRole;
                updateAdminUsersTable();
                addSystemMessage(`‚ö° ${nick} kullanƒ±cƒ±sƒ±nƒ±n yetkisi "${newRole}" olarak deƒüi≈ütirildi`);
            }
        }
        
        function adminResolveReport(reportId) {
            const report = reports.find(r => r.id === reportId);
            if (report) {
                report.status = 'resolved';
                updateAdminReportsTable();
                updateNotificationCount();
                addSystemMessage(`‚úÖ ≈ûikayet √ß√∂z√ºld√º: ${report.id}`);
            }
        }
        
        function adminDeleteReport(reportId) {
            reports = reports.filter(r => r.id !== reportId);
            updateAdminReportsTable();
            updateNotificationCount();
            addSystemMessage(`üóëÔ∏è ≈ûikayet silindi: ${reportId}`);
        }
        
        function adminViewStory(storyId) {
            const story = stories.find(s => s.id === storyId);
            if (story) {
                viewStory(story);
                closeAdminPanel();
            }
        }
        
        function botSendAlert() {
            const message = prompt('Sistem uyarƒ± mesajƒ±:');
            if (message) {
                BOT_MATE.executeCommand('alert', [message]);
            }
        }
        
        function closeAdminPanel() {
            document.getElementById('adminOverlay').classList.remove('active');
            document.getElementById('adminPanel').classList.remove('active');
        }
        
        // ========== Bƒ∞LDƒ∞Rƒ∞M Sƒ∞STEMƒ∞ ==========
        function addNotification(type, message) {
            const notification = {
                id: 'notif_' + Date.now(),
                type: type,
                message: message,
                time: new Date(),
                read: false
            };
            
            notifications.unshift(notification);
            updateNotificationCount();
            
            // Bildirim zilini animasyonla g√∂ster
            const bell = document.querySelector('.icon-btn[title="Bildirimler"]');
            if (bell) {
                bell.style.animation = 'shake 0.5s';
                setTimeout(() => {
                    bell.style.animation = '';
                }, 500);
            }
        }
        
        function showNotifications() {
            const unread = notifications.filter(n => !n.read);
            const read = notifications.filter(n => n.read);
            
            let notificationList = '<strong>üîî Bildirimler</strong><br><br>';
            
            if (unread.length === 0 && read.length === 0) {
                notificationList += 'Hen√ºz bildiriminiz yok.';
            } else {
                if (unread.length > 0) {
                    notificationList += '<strong>Yeni Bildirimler:</strong><br>';
                    unread.forEach(notif => {
                        notificationList += `‚Ä¢ ${notif.message} (${formatRelativeTime(notif.time)})<br>`;
                    });
                    notificationList += '<br>';
                }
                
                if (read.length > 0) {
                    notificationList += '<strong>Eski Bildirimler:</strong><br>';
                    read.slice(0, 10).forEach(notif => {
                        notificationList += `‚Ä¢ ${notif.message} (${formatRelativeTime(notif.time)})<br>`;
                    });
                }
            }
            
            // T√ºm bildirimleri okundu olarak i≈üaretle
            notifications.forEach(n => n.read = true);
            updateNotificationCount();
            
            addSystemMessage(notificationList);
        }
        
        function toggleNotifications() {
            showNotifications();
        }
        
        // ========== YARDIMCI FONKSƒ∞YONLAR ==========
        function generateAvatar(nick) {
            return nick.charAt(0).toUpperCase();
        }
        
        function generateColor(nick) {
            const colors = [
                '#1890ff', '#52c41a', '#fa8c16', '#f5222d',
                '#722ed1', '#13c2c2', '#eb2f96', '#faad14'
            ];
            
            let hash = 0;
            for (let i = 0; i < nick.length; i++) {
                hash = nick.charCodeAt(i) + ((hash << 5) - hash);
            }
            
            return colors[Math.abs(hash) % colors.length];
        }
        
        function getRoleBadge(role) {
            switch(role) {
                case SYSTEM_CONFIG.ROLES.OWNER: return 'OWNER';
                case SYSTEM_CONFIG.ROLES.ADMIN: return 'ADMIN';
                case SYSTEM_CONFIG.ROLES.COADMIN: return 'CO-ADMIN';
                case SYSTEM_CONFIG.ROLES.OPERATOR: return 'OP';
                case SYSTEM_CONFIG.ROLES.BOT: return 'BOT';
                default: return 'USER';
            }
        }
        
        function getRoleName(role) {
            switch(role) {
                case SYSTEM_CONFIG.ROLES.OWNER: return 'Sistem Sahibi';
                case SYSTEM_CONFIG.ROLES.ADMIN: return 'Y√∂netici';
                case SYSTEM_CONFIG.ROLES.COADMIN: return 'Co-Y√∂netici';
                case SYSTEM_CONFIG.ROLES.OPERATOR: return 'Operat√∂r';
                case SYSTEM_CONFIG.ROLES.BOT: return 'Sistem Botu';
                default: return 'Kullanƒ±cƒ±';
            }
        }
        
        function hasPermission(action) {
            if (currentUser.role === SYSTEM_CONFIG.ROLES.OWNER) return true;
            
            const permissions = SYSTEM_CONFIG.PERMISSIONS[currentUser.role] || [];
            return permissions.includes('all') || permissions.includes(action);
        }
        
        function formatMessageText(text) {
            // URL'leri link'e √ßevir
            let formatted = text.replace(
                /(https?:\/\/[^\s]+)/g,
                '<a href="$1" target="_blank" style="color: var(--primary); text-decoration: none;">$1</a>'
            );
            
            // @mention'larƒ± vurgula
            formatted = formatted.replace(
                /@(\w+)/g,
                '<span style="color: var(--primary); font-weight: 500;">@$1</span>'
            );
            
            // Satƒ±r sonlarƒ±nƒ± <br> ile deƒüi≈ütir
            formatted = formatted.replace(/\n/g, '<br>');
            
            return formatted;
        }
        
        function formatDate(date) {
            const now = new Date();
            const diff = now - date;
            
            if (diff < 24 * 60 * 60 * 1000) {
                return 'Bug√ºn';
            } else if (diff < 48 * 60 * 60 * 1000) {
                return 'D√ºn';
            } else {
                return date.toLocaleDateString('tr-TR');
            }
        }
        
        function formatTime(date) {
            return date.toLocaleTimeString('tr-TR', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
        }
        
        function formatRelativeTime(date) {
            const now = new Date();
            const diff = now - date;
            
            const minute = 60 * 1000;
            const hour = 60 * minute;
            const day = 24 * hour;
            const week = 7 * day;
            
            if (diff < minute) {
                return 'az √∂nce';
            } else if (diff < hour) {
                return `${Math.floor(diff / minute)} dakika √∂nce`;
            } else if (diff < day) {
                return `${Math.floor(diff / hour)} saat √∂nce`;
            } else if (diff < week) {
                return `${Math.floor(diff / day)} g√ºn √∂nce`;
            } else {
                return date.toLocaleDateString('tr-TR');
            }
        }
        
        function filterUsers() {
            const search = document.getElementById('userSearch').value.toLowerCase();
            const items = document.querySelectorAll('.user-item');
            
            items.forEach(item => {
                const name = item.querySelector('.user-name').textContent.toLowerCase();
                if (name.includes(search)) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        }
        
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
            addSystemMessage(`üé® Tema ${document.body.classList.contains('dark-mode') ? 'koyu' : 'a√ßƒ±k'} moda ge√ßirildi.`);
        }
        
        function showEmojiPicker() {
            alert('Emoji picker yakƒ±nda eklenecek!');
        }
        
        function showCommandHelp() {
            showHelp();
        }
        
        function showUserStats(nick) {
            showUserInfo(nick);
        }
        
        function showFollowers() {
            const followers = Array.from(currentUser.followers || []);
            const following = Array.from(currentUser.following || []);
            
            addSystemMessage(`üë• <strong>Takip ƒ∞statistikleri:</strong><br>
                ‚Ä¢ Takip√ßilerin (${followers.length}): ${followers.length > 0 ? followers.join(', ') : 'Yok'}<br>
                ‚Ä¢ Takip Ettiklerin (${following.length}): ${following.length > 0 ? following.join(', ') : 'Yok'}`);
        }
        
        function openSettings() {
            alert('Ayarlar paneli yakƒ±nda eklenecek!');
        }
        
        // ========== SAYFA Y√úKLENDƒ∞ƒûƒ∞NDE ==========
        window.addEventListener('load', function() {
            // Tema y√ºkle
            if (localStorage.getItem('theme') === 'dark') {
                document.body.classList.add('dark-mode');
            }
            
            // Enter tu≈üu ile giri≈ü
            document.getElementById('loginNick').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') login();
            });
            
            document.getElementById('loginPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') login();
            });
            
            // Sayfa kapatƒ±lƒ±rken √ßƒ±kƒ±≈ü yap
            window.addEventListener('beforeunload', function() {
                if (currentUser) {
                    currentUser.isOnline = false;
                    currentUser.lastSeen = new Date();
                }
            });
            
            // Animasyon i√ßin CSS ekle
            const style = document.createElement('style');
            style.textContent = `
                @keyframes shake {
                    0%, 100% { transform: rotate(0deg); }
                    25% { transform: rotate(10deg); }
                    75% { transform: rotate(-10deg); }
                }
            `;
            document.head.appendChild(style);
        });
    </script>
</body>
</html>
