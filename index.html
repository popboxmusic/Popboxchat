<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Popbox â€¢ Yetkili Medya Paneli</title>
    
    <!-- FONTS & ICONS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- FIREBASE -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    
    <!-- YOUTUBE API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    
    <style>
        /* TÃœM CSS KODLARI - EN SON Ã‡ALIÅžAN HALÄ° */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: #0f0f0f; color: #fff; overflow: hidden; height: 100vh; }
        .app { display: flex; height: 100vh; width: 100vw; position: relative; }
        
        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #1a1a1a; }
        ::-webkit-scrollbar-thumb { background: #3f3f3f; border-radius: 4px; }
        
        /* SIDEBAR */
        .sidebar { width: 80px; background: #0a0a0a; border-right: 1px solid #2a2a2a; display: flex; flex-direction: column; align-items: center; padding: 24px 0; gap: 24px; flex-shrink: 0; z-index: 10; }
        .menu-item { width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #aaa; cursor: pointer; transition: all 0.2s; font-size: 20px; position: relative; }
        .menu-item:hover { background: #272727; color: #fff; }
        .menu-item.active { color: #fff; background: #3f3f3f; }
        .user-avatar { margin-top: auto; width: 48px; height: 48px; border-radius: 50%; background: #1a1a1a; border: 2px solid #3f3f3f; cursor: pointer; display: flex; align-items: center; justify-content: center; font-weight: 600; color: #fff; overflow: hidden; }
        .user-avatar img { width: 100%; height: 100%; object-fit: cover; }
        
        /* USERS PANEL */
        .users-panel { width: 280px; background: #0f0f0f; border-right: 1px solid #2a2a2a; display: flex; flex-direction: column; flex-shrink: 0; }
        .panel-header { padding: 20px; border-bottom: 1px solid #2a2a2a; }
        .panel-header h3 { font-size: 16px; font-weight: 600; display: flex; align-items: center; gap: 12px; color: #fff; }
        .online-tabs { display: flex; gap: 8px; margin-top: 16px; }
        .tab { flex: 1; padding: 8px; background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 20px; color: #aaa; font-size: 13px; cursor: pointer; text-align: center; }
        .tab.active { background: #272727; border-color: #3f3f3f; color: #fff; }
        .user-list { flex: 1; overflow-y: auto; padding: 16px; }
        .user-item { display: flex; align-items: center; gap: 12px; padding: 10px; border-radius: 8px; cursor: pointer; transition: background 0.2s; margin-bottom: 4px; }
        .user-item:hover { background: #1a1a1a; }
        .user-avatar-small { width: 36px; height: 36px; border-radius: 50%; background: #1a1a1a; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; color: #fff; }
        .user-info { flex: 1; min-width: 0; }
        .user-name { font-weight: 500; font-size: 14px; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .user-status { font-size: 12px; color: #aaa; margin-top: 2px; }
        .online-dot { width: 8px; height: 8px; border-radius: 50%; background: #2ba640; flex-shrink: 0; }
        
        /* CHAT PANEL */
        .chat-panel { flex: 1; background: #0f0f0f; display: flex; flex-direction: column; min-width: 0; }
        .chat-header { padding: 16px 24px; border-bottom: 1px solid #2a2a2a; display: flex; align-items: center; justify-content: space-between; }
        .chat-title { display: flex; align-items: center; gap: 12px; font-weight: 600; }
        .messages { flex: 1; overflow-y: auto; padding: 24px; display: flex; flex-direction: column; gap: 16px; }
        .message { display: flex; flex-direction: column; max-width: 80%; animation: fadeIn 0.3s ease; }
        .message.right { align-self: flex-end; }
        .message-header { display: flex; align-items: center; gap: 8px; margin-bottom: 4px; }
        .message-sender { font-weight: 600; font-size: 13px; color: #fff; cursor: pointer; }
        .message-time { font-size: 11px; color: #aaa; }
        .message-text { font-size: 14px; line-height: 1.5; color: #fff; word-break: break-word; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .message-input-container { padding: 20px 24px; background: #0a0a0a; border-top: 1px solid #2a2a2a; }
        .input-wrapper { display: flex; align-items: flex-end; gap: 12px; background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 28px; padding: 8px 8px 8px 20px; }
        .message-input { flex: 1; background: transparent; border: none; color: #fff; font-size: 14px; padding: 12px 0; resize: none; max-height: 120px; outline: none; }
        .send-btn, .media-btn { width: 44px; height: 44px; border-radius: 50%; background: #272727; border: 1px solid #3f3f3f; color: #fff; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; font-size: 18px; }
        .send-btn:hover, .media-btn:hover { background: #3f3f3f; }
        
        /* MEDYA PANELÄ° */
        .media-panel { width: 500px; background: #0a0a0a; border-left: 1px solid #2a2a2a; display: flex; flex-direction: column; flex-shrink: 0; }
        .media-header { padding: 16px 20px; border-bottom: 1px solid #2a2a2a; display: flex; align-items: center; justify-content: space-between; }
        .media-tabs { display: flex; gap: 8px; }
        .media-tab { width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: #1a1a1a; color: #aaa; cursor: pointer; transition: all 0.2s; font-size: 20px; }
        .media-tab.active { background: #ff0000; color: #fff; }
        .media-tab.spotify.active { background: #1db954; }
        .media-tab.live.active { background: #ff4444; animation: pulse 2s infinite; }
        
        /* YOUTUBE PLAYER */
        .youtube-player { width: 100%; aspect-ratio: 16/9; background: #000; border-bottom: 1px solid #2a2a2a; display: none; position: relative; }
        #youtubeContainer { width: 100%; height: 100%; }
        
        /* MOBÄ°L */
        @media screen and (max-width: 768px) {
            .app { flex-direction: column; }
            .media-panel { width: 100%; order: 1; }
            .chat-panel { width: 100%; height: 350px; order: 2; }
            .users-panel { width: 100%; height: 250px; order: 3; }
            .sidebar { width: 100%; height: 60px; flex-direction: row; order: 4; bottom: 0; position: sticky; }
        }
    </style>
</head>
<body>
    <!-- LOGIN -->
    <div id="loginOverlay" class="login-overlay">
        <div class="login-box">
            <div class="login-logo">
                <i class="fab fa-youtube"></i>
            </div>
            <h2 class="login-title">Popbox</h2>
            <p class="login-subtitle">Yetkili medya kontrol paneli</p>
            <input type="text" id="nickname" class="login-input" placeholder="KullanÄ±cÄ± adÄ±">
            <div class="password-wrapper">
                <input type="password" id="password" class="login-input" placeholder="Åžifre">
                <i class="fas fa-eye password-toggle" id="passwordToggle"></i>
            </div>
            <div id="loginError" class="login-error"></div>
            <button id="loginBtn" class="login-btn">GiriÅŸ Yap</button>
            <p style="color: #666; font-size: 12px; text-align: center;">ðŸ‘‘ MateKy (owner) â€¢ âš¡ popbox (admin) â€¢ ðŸ”§ coadmin</p>
        </div>
    </div>

    <!-- ANA UYGULAMA -->
    <div id="app" class="app hidden">
        <!-- SIDEBAR -->
        <div class="sidebar">
            <div class="menu-item active" onclick="showUsersPanel()"><i class="fas fa-users"></i></div>
            <div class="menu-item" onclick="toggleNotificationPanel()"><i class="fas fa-bell"></i></div>
            <div id="ownerPanelBtn" class="menu-item" style="display: none; border: 2px solid #ffd700;" onclick="window.location.href='owner.html'"><i class="fas fa-crown" style="color: #ffd700;"></i></div>
            <div class="user-avatar" id="userAvatar"><span id="avatarText"></span></div>
        </div>

        <!-- USERS PANEL -->
        <div class="users-panel">
            <div class="panel-header">
                <h3><i class="fas fa-users"></i> KullanÄ±cÄ±lar</h3>
                <div class="online-tabs">
                    <div class="tab active" onclick="switchUserTab('online')" id="onlineTab">Ã‡evrimiÃ§i (0)</div>
                    <div class="tab" onclick="switchUserTab('chatting')" id="chattingTab">Sohbette (0)</div>
                </div>
            </div>
            <div class="user-list" id="userList"></div>
        </div>

        <!-- CHAT PANEL -->
        <div class="chat-panel">
            <div class="chat-header">
                <div class="chat-title">
                    <i class="fas fa-hashtag"></i>
                    <span id="currentChannel">genel</span>
                </div>
            </div>
            <div class="messages" id="messages"></div>
            <div class="message-input-container">
                <div class="input-wrapper">
                    <textarea id="messageInput" class="message-input" placeholder="Mesaj yazÄ±n..." rows="1"></textarea>
                    <div class="send-btn" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></div>
                </div>
            </div>
        </div>

        <!-- MEDIA PANEL -->
        <div class="media-panel">
            <div class="media-header">
                <div class="media-tabs">
                    <div class="media-tab active" onclick="switchMediaTab('youtube')" id="youtubeTab"><i class="fab fa-youtube"></i></div>
                    <div class="media-tab spotify" onclick="switchMediaTab('spotify')" id="spotifyTab"><i class="fab fa-spotify"></i></div>
                    <div class="media-tab live" onclick="switchMediaTab('live')" id="liveTab"><i class="fas fa-video"></i></div>
                </div>
                <div class="media-controls">
                    <div class="control-btn" id="addMediaBtn" onclick="openAddMediaModal()"><i class="fas fa-plus"></i></div>
                    <span class="admin-badge" id="adminBadge">YETKÄ°LÄ°</span>
                </div>
            </div>
            
            <div id="youtubePlayer" class="youtube-player">
                <div id="youtubeContainer"></div>
            </div>
            <div id="spotifyPlayer" class="spotify-player">
                <iframe id="spotifyIframe" src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M"></iframe>
            </div>
            <div id="livePlayer" class="live-player">
                <video id="liveVideo" autoplay playsinline></video>
            </div>
            <div class="playlist" id="playlist"></div>
        </div>
    </div>

    <script>
        // ========== BASÄ°T Ã‡ALIÅžAN VERSÄ°YON ==========
        console.log('âœ… Popbox baÅŸlatÄ±lÄ±yor...');
        
        // Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyCrn_tXJZCAlKhem45aXxj4f0h26EPOQ70",
            authDomain: "popboxmusicchat.firebaseapp.com",
            databaseURL: "https://popboxmusicchat-default-rtdb.firebaseio.com",
            projectId: "popboxmusicchat",
            storageBucket: "popboxmusicchat.appspot.com",
            messagingSenderId: "206625719024",
            appId: "1:206625719024:web:d28f478a2c96d10412f835"
        };

        // Global deÄŸiÅŸkenler
        let currentUser = null;
        let isOwner = false;
        let isAdmin = false;
        let database;

        // Firebase baÅŸlat
        try {
            if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
            database = firebase.database();
            console.log('âœ… Firebase baÄŸlandÄ±!');
        } catch(e) {
            console.error('Firebase hatasÄ±:', e);
        }

        // GiriÅŸ
        window.handleLogin = function() {
            const nickname = document.getElementById('nickname').value.trim();
            const password = document.getElementById('password').value;
            
            if (!nickname) { alert('KullanÄ±cÄ± adÄ± gerekli!'); return; }
            
            if (nickname.toLowerCase() === 'mateky') {
                if (password !== 'Sahi17407@SCM') { alert('HatalÄ± ÅŸifre!'); return; }
                isOwner = isAdmin = true;
                currentUser = { name: 'MateKy', role: 'owner' };
                document.getElementById('ownerPanelBtn').style.display = 'flex';
            } else if (['popbox', 'popboxmusic'].includes(nickname.toLowerCase())) {
                isAdmin = true;
                currentUser = { name: nickname, role: 'admin' };
            } else {
                currentUser = { name: nickname, role: 'user' };
            }
            
            document.getElementById('loginOverlay').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            document.getElementById('avatarText').textContent = nickname.charAt(0).toUpperCase();
            
            addSystemMessage(`ðŸŽ‰ ${currentUser.name} (${currentUser.role}) sohbete katÄ±ldÄ±!`);
        };

        window.sendMessage = function() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            if (!text || !database || !currentUser) return;
            
            database.ref('messages').push({
                sender: currentUser.name,
                text: text,
                role: currentUser.role,
                timestamp: Date.now()
            });
            
            input.value = '';
        };

        function addSystemMessage(text) {
            if (!database) return;
            database.ref('messages').push({
                sender: 'Sistem',
                text: text,
                type: 'system',
                timestamp: Date.now()
            });
        }

        window.showUsersPanel = function() { console.log('Users panel'); };
        window.toggleNotificationPanel = function() { console.log('Notifications'); };
        window.switchUserTab = function() { console.log('Switch tab'); };
        window.switchMediaTab = function() { console.log('Media tab'); };
        window.openAddMediaModal = function() { console.log('Add media'); };
        
        // Event listeners
        document.getElementById('loginBtn').addEventListener('click', handleLogin);
        document.getElementById('passwordToggle').addEventListener('click', function() {
            const input = document.getElementById('password');
            input.type = input.type === 'password' ? 'text' : 'password';
        });
    </script>
</body>
</html>
