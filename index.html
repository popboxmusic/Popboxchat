<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popbox Elite v3 - TÃ¼m Ã–zellikler Aktif</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* TÃœM STÄ°LLER - PROFESYONEL TEMA */
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-tertiary: #1a1a1a;
            --bg-overlay: rgba(0, 0, 0, 0.95);
            --border-light: #222222;
            --border-medium: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --text-tertiary: #888888;
            --accent-blue: #3b82f6;
            --accent-green: #10b981;
            --accent-red: #ef4444;
            --accent-orange: #f59e0b;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            --accent-cyan: #06b6d4;
            --shadow-heavy: 0 8px 32px rgba(0, 0, 0, 0.7);
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --font-primary: 'Inter', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
            --spacing-xs: 6px;
            --spacing-sm: 12px;
            --spacing-md: 18px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: var(--font-primary); background: var(--bg-primary); color: var(--text-primary); height: 100vh; overflow: hidden; font-size: 14px; line-height: 1.5; }

        /* GÄ°RÄ°Åž EKRANI */
        .login-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, rgba(10, 10, 10, 0.98) 0%, rgba(26, 26, 26, 0.95) 100%);
            display: flex; align-items: center; justify-content: center; z-index: 5000;
            backdrop-filter: blur(20px);
        }

        .login-container {
            width: 100%; max-width: 450px; padding: var(--spacing-xl);
            background: rgba(17, 17, 17, 0.7); border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.7);
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .login-logo {
            width: 80px; height: 80px; background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            border-radius: 50%; margin: 0 auto var(--spacing-lg); display: flex;
            align-items: center; justify-content: center; color: white;
            font-weight: 700; font-size: 32px;
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.4);
            position: relative; overflow: hidden;
        }

        .login-logo::after {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .login-title {
            font-size: 28px; font-weight: 700; text-align: center;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            -webkit-background-clip: text; background-clip: text; color: transparent;
            margin-bottom: var(--spacing-xs);
        }

        .login-subtitle {
            text-align: center; color: var(--text-secondary);
            margin-bottom: var(--spacing-xl); font-size: 14px;
        }

        .login-input {
            width: 100%; padding: 14px 16px; background: rgba(26, 26, 26, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: var(--radius-md);
            color: var(--text-primary); font-size: 14px; margin-bottom: var(--spacing-md);
            font-family: inherit; transition: all 0.3s ease;
        }

        .login-input:focus {
            outline: none; border-color: var(--accent-cyan);
            background: rgba(17, 17, 17, 0.9);
            box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.2);
        }

        .login-btn {
            width: 100%; padding: 16px; background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            color: white; border: none; border-radius: var(--radius-md); font-size: 15px;
            font-weight: 600; cursor: pointer; transition: all 0.3s ease;
            margin-top: var(--spacing-md); position: relative; overflow: hidden;
        }

        .login-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4); }

        .owner-access {
            margin-top: var(--spacing-md); padding: var(--spacing-sm);
            background: rgba(139, 92, 246, 0.1); border-radius: var(--radius-md);
            text-align: center; font-size: 11px; color: var(--accent-purple);
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        /* ÃœST BAR */
        .top-bar {
            height: 60px; background: var(--bg-secondary); border-bottom: 1px solid var(--border-light);
            padding: 0 var(--spacing-lg); display: flex; align-items: center;
            justify-content: space-between; position: relative; z-index: 100;
        }

        .logo {
            display: flex; align-items: center; gap: var(--spacing-sm);
            font-weight: 600; font-size: 18px; color: var(--text-primary);
        }

        .logo-icon {
            width: 36px; height: 36px; background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            color: white; font-weight: 700; font-size: 18px;
        }

        /* KANAL LÄ°STESÄ° */
        .channel-list {
            position: absolute; top: 60px; left: 0; width: 280px;
            height: calc(100vh - 60px); background: var(--bg-secondary);
            border-right: 1px solid var(--border-light); z-index: 90;
            display: flex; flex-direction: column;
            transform: translateX(-100%); transition: transform 0.3s ease;
        }

        .channel-list.active { transform: translateX(0); }

        .channel-header {
            padding: var(--spacing-lg); border-bottom: 1px solid var(--border-light);
        }

        .channel-create-btn {
            width: 100%; padding: 12px; background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            color: white; border: none; border-radius: var(--radius-md); font-weight: 600;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            gap: var(--spacing-sm); margin-bottom: var(--spacing-md);
        }

        /* Ã–ZEL SOHBET PANELÄ° */
        .private-chats-panel {
            position: fixed; bottom: 20px; right: 20px; z-index: 80;
            display: flex; flex-direction: column; gap: 10px; align-items: flex-end;
        }

        .private-chat-minimized {
            width: 50px; height: 50px; border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            display: flex; align-items: center; justify-content: center;
            color: white; font-weight: 600; cursor: pointer;
            transition: all 0.2s ease; position: relative;
            box-shadow: var(--shadow-heavy); overflow: hidden;
        }

        .private-chat-minimized:hover {
            transform: scale(1.1); box-shadow: 0 8px 20px rgba(139, 92, 246, 0.5);
        }

        .unread-badge {
            position: absolute; top: -3px; right: -3px;
            background: var(--accent-red); color: white; font-size: 10px;
            min-width: 18px; height: 18px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-weight: 600; border: 2px solid var(--bg-secondary);
        }

        /* ANA LAYOUT */
        .app-container { display: flex; height: calc(100vh - 60px); }

        /* SOL PANEL - Online Listesi */
        .online-panel {
            width: 300px; background: var(--bg-secondary);
            border-right: 1px solid var(--border-light);
            display: flex; flex-direction: column; overflow: hidden;
        }

        .panel-header {
            padding: var(--spacing-md) var(--spacing-lg);
            border-bottom: 1px solid var(--border-light);
        }

        .panel-title {
            font-size: 15px; font-weight: 600; color: var(--text-primary);
            margin-bottom: var(--spacing-xs); display: flex;
            align-items: center; justify-content: space-between;
        }

        .online-count {
            font-size: 13px; color: var(--accent-cyan);
            font-weight: 600;
        }

        .search-box {
            padding: var(--spacing-md) var(--spacing-lg) 0;
            margin-bottom: var(--spacing-md);
        }

        .search-input {
            width: 100%; padding: 10px var(--spacing-md);
            background: var(--bg-tertiary); border: 1px solid var(--border-light);
            border-radius: var(--radius-md); color: var(--text-primary);
            font-size: 13px; font-family: inherit; transition: all 0.2s ease;
        }

        .search-input:focus {
            outline: none; border-color: var(--accent-cyan);
            background: var(--bg-secondary);
        }

        .user-list {
            flex: 1; overflow-y: auto; padding: 0 var(--spacing-lg);
        }

        .user-item {
            padding: var(--spacing-md) 0;
            border-bottom: 1px solid var(--border-light);
            display: flex; align-items: center; gap: var(--spacing-md);
            cursor: pointer; transition: all 0.2s ease;
        }

        .user-item:hover {
            background: var(--bg-tertiary);
            margin: 0 calc(var(--spacing-lg) * -1);
            padding: var(--spacing-md) var(--spacing-lg);
        }

        .user-avatar {
            width: 40px; height: 40px; border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            display: flex; align-items: center; justify-content: center;
            color: white; font-weight: 600; font-size: 14px;
            flex-shrink: 0; position: relative;
            border: 2px solid var(--bg-secondary); overflow: hidden;
        }

        .user-avatar img { width: 100%; height: 100%; object-fit: cover; }

        .user-avatar.online::after {
            content: ''; position: absolute; bottom: 2px; right: 2px;
            width: 10px; height: 10px; background: var(--accent-green);
            border-radius: 50%; border: 2px solid var(--bg-secondary);
        }

        .user-info { flex: 1; min-width: 0; }

        .user-name {
            font-weight: 500; font-size: 13px; color: var(--text-primary);
            margin-bottom: 2px; display: flex; align-items: center; gap: 6px;
        }

        .user-role {
            font-size: 11px; padding: 2px 8px; border-radius: 10px;
            background: var(--bg-tertiary); color: var(--text-secondary);
        }

        .user-role.owner {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(6, 182, 212, 0.2));
            color: var(--accent-purple); border: 1px solid rgba(139, 92, 246, 0.3);
        }
        .user-role.admin {
            background: rgba(59, 130, 246, 0.1); color: var(--accent-blue);
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        /* ORTA PANEL - Sohbet */
        .chat-panel {
            flex: 1; display: flex; flex-direction: column;
            background: var(--bg-primary);
        }

        .chat-header {
            padding: 0 var(--spacing-lg); height: 70px;
            border-bottom: 1px solid var(--border-light);
            display: flex; align-items: center; justify-content: space-between;
            background: var(--bg-secondary);
        }

        .chat-info h2 {
            font-size: 18px; font-weight: 600;
            color: var(--text-primary); margin-bottom: 4px;
        }

        .chat-info p {
            font-size: 13px; color: var(--text-secondary);
        }

        .channel-controls {
            display: flex; gap: var(--spacing-sm);
            align-items: center;
        }

        /* SAÄž PANEL - Video */
        .video-panel {
            width: 400px; background: #000;
            border-left: 1px solid var(--border-medium);
            display: flex; flex-direction: column; overflow: hidden;
        }

        .video-header {
            padding: var(--spacing-md) var(--spacing-lg);
            background: rgba(0, 0, 0, 0.9); color: white;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex; justify-content: space-between; align-items: center;
        }

        .video-controls {
            display: flex; gap: var(--spacing-sm);
        }

        .video-btn {
            padding: 6px 12px; background: rgba(255, 255, 255, 0.1);
            border: none; border-radius: var(--radius-sm); color: white;
            cursor: pointer; font-size: 12px; display: flex;
            align-items: center; gap: 4px; transition: background 0.2s;
        }

        .video-btn:hover { background: rgba(255, 255, 255, 0.2); }

        .video-container {
            flex: 1; position: relative; overflow: hidden;
            background: #000;
        }

        #youtubePlayer { width: 100%; height: 100%; }

        /* CHAT MESSAGES */
        .chat-messages {
            flex: 1; padding: var(--spacing-lg); overflow-y: auto;
            display: flex; flex-direction: column; gap: var(--spacing-md);
        }

        .message {
            display: flex; flex-direction: column;
            max-width: 75%; animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message-incoming { align-self: flex-start; }
        .message-outgoing { align-self: flex-end; align-items: flex-end; }

        .message-sender {
            font-weight: 600; font-size: 12px; color: var(--text-secondary);
            margin-bottom: 4px; display: flex; align-items: center; gap: 6px;
        }

        .message-outgoing .message-sender { color: var(--accent-cyan); }

        .message-text {
            font-size: 14px; line-height: 1.5; color: var(--text-primary);
            padding: 10px 14px; background: var(--bg-tertiary);
            border-radius: var(--radius-md); word-break: break-word;
            position: relative;
        }

        .message-outgoing .message-text {
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            color: white;
        }

        .message-time {
            font-size: 10px; color: var(--text-tertiary);
            margin-top: 4px; text-align: right;
        }

        .message-delete {
            position: absolute; top: 4px; right: 4px; opacity: 0;
            transition: opacity 0.2s; cursor: pointer;
            color: var(--text-tertiary); font-size: 10px;
        }

        .message:hover .message-delete { opacity: 1; }
        .message-delete:hover { color: var(--accent-red); }

        .chat-input-area {
            padding: var(--spacing-lg); border-top: 1px solid var(--border-light);
            background: var(--bg-secondary);
        }

        .input-wrapper {
            display: flex; gap: var(--spacing-md);
            align-items: flex-end;
        }

        .message-input {
            flex: 1; background: var(--bg-tertiary);
            border: 1px solid var(--border-light); border-radius: var(--radius-md);
            padding: 12px 16px; color: var(--text-primary);
            font-family: inherit; font-size: 14px; resize: none;
            min-height: 44px; max-height: 120px; outline: none;
            transition: all 0.2s ease;
        }

        .message-input:focus {
            border-color: var(--accent-cyan);
            background: var(--bg-secondary);
        }

        .send-btn {
            width: 44px; height: 44px; border-radius: var(--radius-md);
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            border: none; color: white; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.2s ease;
        }

        .send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.4);
        }

        /* OWNER PANELÄ° */
        .owner-panel {
            position: fixed; top: 60px; right: 0; width: 500px;
            height: calc(100vh - 60px); background: var(--bg-secondary);
            border-left: 1px solid var(--border-light);
            transform: translateX(100%); transition: transform 0.3s ease;
            z-index: 1000; display: flex; flex-direction: column;
            box-shadow: var(--shadow-heavy);
        }

        .owner-panel.active { transform: translateX(0); }

        .owner-header {
            padding: var(--spacing-lg);
            background: linear-gradient(135deg, #1a0033, #330033);
            color: white; border-bottom: 1px solid rgba(139, 92, 246, 0.5);
            position: relative;
        }

        .owner-badge {
            background: linear-gradient(135deg, var(--accent-purple), #ff00ff);
            color: white; padding: 4px 12px; border-radius: 12px;
            font-size: 11px; font-weight: 600; display: inline-block;
            margin-bottom: var(--spacing-sm); animation: glow 2s infinite;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px var(--accent-purple); }
            50% { box-shadow: 0 0 15px var(--accent-purple); }
        }

        /* MODALLAR */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-overlay); display: none;
            align-items: center; justify-content: center; z-index: 2000;
            backdrop-filter: blur(10px);
        }

        .modal-overlay.active { display: flex; }

        .modal-container {
            width: 90%; max-width: 500px; background: var(--bg-secondary);
            border-radius: var(--radius-lg); overflow: hidden;
            border: 1px solid var(--border-light); box-shadow: var(--shadow-heavy);
        }

        .modal-header {
            padding: var(--spacing-lg); background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-light);
        }

        .modal-content { padding: var(--spacing-lg); }
        .modal-actions {
            padding: var(--spacing-lg); border-top: 1px solid var(--border-light);
            display: flex; justify-content: flex-end; gap: var(--spacing-sm);
        }

        .modal-input {
            width: 100%; padding: 12px 16px; background: var(--bg-tertiary);
            border: 1px solid var(--border-light); border-radius: var(--radius-md);
            color: var(--text-primary); margin-bottom: var(--spacing-md);
            font-family: inherit;
        }

        /* UTILITIES */
        .hidden { display: none !important; }
        .action-btn {
            padding: 6px 12px; border-radius: var(--radius-sm);
            border: 1px solid var(--border-medium); background: var(--bg-tertiary);
            color: var(--text-primary); font-size: 12px; cursor: pointer;
            transition: all 0.2s ease;
        }
        .action-btn:hover { background: var(--bg-primary); }
        .action-btn.primary {
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-cyan));
            color: white; border: none;
        }
        .action-btn.danger {
            background: var(--accent-red); color: white; border: none;
        }

        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-tertiary); }
        ::-webkit-scrollbar-thumb { background: var(--border-medium); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--border-medium); }
    </style>
</head>
<body>
    <!-- GÄ°RÄ°Åž EKRANI -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-logo">P</div>
            <h1 class="login-title">Popbox Elite v3</h1>
            <p class="login-subtitle">KayÄ±tsÄ±z GiriÅŸ - Popbox Music Live</p>
            
            <input id="nickInput" class="login-input" type="text" placeholder="Nick girin (ÅŸifresiz)" autofocus>
            <div style="margin-top: 4px; font-size: 11px; color: var(--text-muted);">
                Ã–neri: <span id="nickSuggestion" style="color: var(--accent-orange); cursor: pointer;">popbox_${Math.floor(Math.random() * 1000)}</span>
            </div>
            
            <button class="login-btn" onclick="handleLogin()">
                <i class="fas fa-sign-in-alt"></i> GiriÅŸ Yap
            </button>
            
            <div class="owner-access">
                <i class="fas fa-crown"></i> Owner giriÅŸi: <strong>mateky</strong> / <strong>mateky123</strong>
            </div>
        </div>
    </div>

    <!-- ANA UYGULAMA -->
    <div id="app" class="hidden">
        <!-- ÃœST BAR -->
        <div class="top-bar">
            <button class="nav-btn" onclick="toggleChannelList()" title="Kanallar">
                <i class="fas fa-hashtag"></i>
            </button>
            
            <div class="logo">
                <div class="logo-icon">P</div>
                <span>Popbox Elite</span>
                <span style="font-size: 11px; color: var(--accent-purple); margin-left: 8px;">v3</span>
            </div>
            
            <div class="user-menu">
                <div class="user-info" onclick="toggleProfilePanel()" id="userInfo">
                    <!-- Dinamik -->
                </div>
                
                <button class="nav-btn" onclick="openStoryCreator()" title="Hikaye PaylaÅŸ">
                    <i class="fas fa-plus"></i>
                </button>
                
                <button class="nav-btn" onclick="toggleNotifications()" title="Bildirimler">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notificationBadge">0</span>
                </button>
                
                <button class="nav-btn owner-btn" onclick="toggleOwnerPanel()" id="ownerBtn" style="display: none;" title="Owner Paneli">
                    <i class="fas fa-crown"></i>
                </button>
            </div>
        </div>

        <!-- KANAL LÄ°STESÄ° -->
        <div class="channel-list" id="channelList">
            <div class="channel-header">
                <button class="channel-create-btn" onclick="openCreateChannelModal()">
                    <i class="fas fa-plus-circle"></i> Kanal OluÅŸtur
                </button>
                <div class="panel-title">
                    Kanallar
                    <span class="online-count" id="channelCount">0</span>
                </div>
            </div>
            <div class="channels-container" id="channelsContainer">
                <!-- Dinamik -->
            </div>
        </div>

        <!-- Ã–ZEL SOHBET PANELÄ° -->
        <div class="private-chats-panel" id="privateChatsPanel">
            <!-- Dinamik -->
        </div>

        <!-- OWNER PANELÄ° -->
        <div class="owner-panel" id="ownerPanel">
            <div class="owner-header">
                <span class="owner-badge">TANRI MODU</span>
                <h3 style="margin-bottom: 4px;">Owner Kontrol Paneli</h3>
                <p style="font-size: 13px; opacity: 0.9;">mateky - Her Åžeye HÃ¼kmeder</p>
                <button class="nav-btn" onclick="toggleOwnerPanel()" style="position: absolute; right: var(--spacing-lg);">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="owner-content" id="ownerContent">
                <!-- Sekmeler -->
            </div>
        </div>

        <!-- ANA LAYOUT -->
        <div class="app-container">
            <!-- SOL PANEL -->
            <div class="online-panel">
                <div class="panel-header">
                    <div class="panel-title">
                        Ã‡evrimiÃ§i KullanÄ±cÄ±lar
                        <span class="online-count" id="onlineCount">0</span>
                    </div>
                </div>
                
                <div class="search-box">
                    <input type="text" class="search-input" placeholder="KullanÄ±cÄ± ara..." onkeyup="searchUsers(this.value)">
                </div>
                
                <div class="user-list" id="userList">
                    <!-- Dinamik -->
                </div>
            </div>

            <!-- ORTA PANEL -->
            <div class="chat-panel">
                <div class="chat-header">
                    <div class="chat-info">
                        <h2 id="currentChannel">ðŸŽµ Popbox Music Live</h2>
                        <p id="channelTopic">YouTube canlÄ± yayÄ±nÄ± - Video otomatik deÄŸiÅŸir</p>
                    </div>
                    
                    <div class="channel-controls">
                        <button class="action-btn" onclick="skipVideo()">
                            <i class="fas fa-forward"></i> Video DeÄŸiÅŸtir
                        </button>
                        <button class="action-btn" onclick="toggleLiveStream()" id="liveBtn">
                            <i class="fas fa-broadcast-tower"></i> CanlÄ±
                        </button>
                    </div>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <!-- Mesajlar -->
                </div>
                
                <div class="chat-input-area">
                    <div class="input-wrapper">
                        <textarea class="message-input" id="messageInput" placeholder="Mesaj yazÄ±n (/ komutlarÄ± iÃ§in)..." rows="1"></textarea>
                        <button class="send-btn" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- SAÄž PANEL - Video -->
            <div class="video-panel">
                <div class="video-header">
                    <h3><i class="fas fa-play-circle"></i> Popbox Music Live</h3>
                    <div class="video-controls">
                        <button class="video-btn" onclick="skipVideo()">
                            <i class="fas fa-forward"></i> DeÄŸiÅŸtir
                        </button>
                        <button class="video-btn" onclick="toggleLiveStream()" id="liveStreamBtn">
                            <i class="fas fa-broadcast-tower"></i> CanlÄ±
                        </button>
                    </div>
                </div>
                
                <div class="video-container">
                    <iframe id="youtubePlayer" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
            </div>
        </div>

        <!-- MODALLAR -->
        <div class="modal-overlay" id="createChannelModal">
            <div class="modal-container">
                <div class="modal-header">
                    <h3>Yeni Kanal OluÅŸtur</h3>
                </div>
                <div class="modal-content">
                    <input type="text" class="modal-input" id="channelNameInput" placeholder="Kanal adÄ± (Ã¶rn: #mÃ¼zik)">
                    <input type="text" class="modal-input" id="channelTopicInput" placeholder="Kanal konusu">
                    <div style="margin-bottom: var(--spacing-md);">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="channelPrivateCheckbox">
                            <span>Ã–zel Kanal</span>
                        </label>
                        <div style="font-size: 11px; color: var(--text-tertiary); margin-top: 4px;">
                            Ã–zel kanallar sadece davet ile girilebilir
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="action-btn" onclick="closeCreateChannelModal()">Ä°ptal</button>
                    <button class="action-btn primary" onclick="createChannel()">OluÅŸtur</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== TÃœM DEÄžÄ°ÅžKENLER ====================
        let currentUser = null;
        let isOwner = false;
        let isAdmin = false;
        let channels = [];
        let currentChannel = null;
        let users = [];
        let privateChats = new Map();
        let stories = [];
        let notifications = [];
        let complaints = [];
        let mateBotCommands = [];
        let systemActivity = [];
        let registeredNicks = new Set();
        let userProfilePhotos = {};
        let storyPhotos = {};
        let unreadMessages = {};
        let currentVideoIndex = 0;
        let isLiveStreamActive = false;
        let videoChangeInterval = null;

        // Popbox Music YouTube videolarÄ±
        const popboxMusicVideos = [
            'd6pJmCVLs0U', // Ã–rnek 1
            'jfKfPfyJRdk', // Lofi
            '5qap5aO4i9A', // Chill
            '0GcY4oE9iq8', // Jazz
            'MCkTebktHVc', // Popbox
            'n61ULEU7CO0'  // Live
        ];

        // MATE Bot
        const mateBot = {
            id: 'mate_bot',
            name: 'MATE',
            avatar: 'ðŸ¤–',
            role: 'bot',
            online: true
        };

        // Owner
        const ownerUser = {
            id: 'mateky',
            name: 'mateky',
            avatar: 'ðŸ‘‘',
            role: 'owner',
            online: false,
            password: 'mateky123'
        };

        // ==================== GÄ°RÄ°Åž SÄ°STEMÄ° ====================
        function handleLogin() {
            const nickInput = document.getElementById('nickInput');
            const nick = nickInput.value.trim();
            
            if (!nick) {
                alert('LÃ¼tfen bir nick girin!');
                return;
            }
            
            const normalizedNick = nick.toLowerCase();
            
            // Owner kontrolÃ¼
            if (normalizedNick === 'mateky') {
                const password = prompt('Owner ÅŸifresi girin:');
                if (password === 'mateky123') {
                    currentUser = { ...ownerUser, online: true };
                    isOwner = true;
                } else {
                    alert('Owner ÅŸifresi yanlÄ±ÅŸ!');
                    return;
                }
            } else {
                // KayÄ±tsÄ±z kullanÄ±cÄ±
                currentUser = {
                    id: normalizedNick + '_' + Date.now(),
                    name: nick,
                    avatar: nick.charAt(0).toUpperCase(),
                    role: 'user',
                    online: true,
                    messages: 0,
                    stories: 0,
                    followers: 0,
                    following: 0
                };
            }
            
            // KullanÄ±cÄ±yÄ± ekle
            if (!users.find(u => u.id === currentUser.id)) {
                users.push(currentUser);
            }
            
            registeredNicks.add(currentUser.id);
            
            // Sistemi baÅŸlat
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            initializeSystem();
        }

        // ==================== SÄ°STEM BAÅžLATMA ====================
        function initializeSystem() {
            // BaÅŸlangÄ±Ã§ kanallarÄ±
            channels = [
                {
                    id: 'general',
                    name: '#genel',
                    topic: 'Genel sohbet kanalÄ±',
                    owner: 'system',
                    private: false,
                    users: [],
                    messages: [],
                    created: new Date(),
                    operators: []
                },
                {
                    id: 'music',
                    name: '#mÃ¼zik',
                    topic: 'MÃ¼zik sohbeti',
                    owner: 'system',
                    private: false,
                    users: [],
                    messages: [],
                    created: new Date(),
                    operators: []
                }
            ];
            
            // BaÅŸlangÄ±Ã§ mesajlarÄ±
            channels.forEach(channel => {
                channel.messages.push({
                    id: Date.now(),
                    user: mateBot,
                    text: 'Popbox Music Live yayÄ±nÄ±na hoÅŸ geldiniz!',
                    time: new Date(Date.now() - 3600000),
                    type: 'system'
                });
            });
            
            // BaÅŸlangÄ±Ã§ MATE komutlarÄ±
            mateBotCommands = [
                { command: '/help', description: 'Komut listesini gÃ¶ster' },
                { command: '/users', description: 'Ã‡evrimiÃ§i kullanÄ±cÄ±larÄ± listele' },
                { command: '/channels', description: 'KanallarÄ± listele' },
                { command: '/nick', description: 'Nick deÄŸiÅŸtir' },
                { command: '/msg', description: 'Ã–zel mesaj gÃ¶nder' }
            ];
            
            // UI gÃ¼ncelle
            updateUserInfo();
            loadChannels();
            loadUsers();
            setupDefaultChannel();
            loadYouTubeVideo();
            
            // Owner kontrolÃ¼
            if (isOwner) {
                document.getElementById('ownerBtn').style.display = 'flex';
                addNotification('ðŸ‘‘ Owner olarak giriÅŸ yaptÄ±nÄ±z!');
                logActivity(`${currentUser.name} (Owner) sisteme giriÅŸ yaptÄ±`);
            }
            
            // MATE bot mesajÄ±
            setTimeout(() => {
                sendSystemMessage(`HoÅŸ geldin ${currentUser.name}! MATE bot hizmetinizde.`);
            }, 1000);
            
            // Video otomatik deÄŸiÅŸtirme
            startVideoRotation();
            
            // Online gÃ¼ncelleme
            setInterval(updateOnlineStatus, 30000);
            
            // Demo kullanÄ±cÄ±lar
            addDemoUsers();
        }

        function addDemoUsers() {
            const demoUsers = [
                { id: 'user1_' + Date.now(), name: 'Ahmet', avatar: 'A', role: 'user', online: true, messages: 5, stories: 2, followers: 3, following: 5 },
                { id: 'user2_' + Date.now(), name: 'AyÅŸe', avatar: 'A', role: 'user', online: true, messages: 12, stories: 1, followers: 7, following: 4 },
                { id: 'user3_' + Date.now(), name: 'Mehmet', avatar: 'M', role: 'user', online: false, messages: 8, stories: 0, followers: 2, following: 3 }
            ];
            
            demoUsers.forEach(user => {
                if (!users.find(u => u.name === user.name)) {
                    users.push(user);
                }
            });
            
            // MATE bot'u ekle
            if (!users.find(u => u.id === mateBot.id)) {
                users.push(mateBot);
            }
        }

        // ==================== YOUTUBE SÄ°STEMÄ° ====================
        function loadYouTubeVideo() {
            const videoId = popboxMusicVideos[currentVideoIndex];
            const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0&modestbranding=1`;
            document.getElementById('youtubePlayer').src = embedUrl;
        }

        function skipVideo() {
            currentVideoIndex = (currentVideoIndex + 1) % popboxMusicVideos.length;
            loadYouTubeVideo();
            sendSystemMessage(`â­ï¸ Video deÄŸiÅŸtirildi: Popbox Music Video ${currentVideoIndex + 1}`);
        }

        function startVideoRotation() {
            // Her 5 dakikada bir video deÄŸiÅŸtir
            videoChangeInterval = setInterval(skipVideo, 300000);
        }

        function toggleLiveStream() {
            if (!isOwner && !isAdmin) {
                alert('CanlÄ± yayÄ±n iÃ§in yetkiniz yok!');
                return;
            }
            
            isLiveStreamActive = !isLiveStreamActive;
            
            if (isLiveStreamActive) {
                // CanlÄ± yayÄ±n baÅŸlat
                const liveVideoId = 'MCkTebktHVc';
                document.getElementById('youtubePlayer').src = `https://www.youtube.com/embed/${liveVideoId}?autoplay=1&rel=0`;
                sendSystemMessage('ðŸ”´ CANLI YAYIN BAÅžLADI!');
                document.getElementById('liveBtn').style.background = 'linear-gradient(135deg, var(--accent-red), var(--accent-orange))';
                document.getElementById('liveStreamBtn').style.background = 'linear-gradient(135deg, var(--accent-red), var(--accent-orange))';
                clearInterval(videoChangeInterval);
            } else {
                // Normal moda dÃ¶n
                loadYouTubeVideo();
                sendSystemMessage('âš« CanlÄ± yayÄ±n sona erdi.');
                document.getElementById('liveBtn').style.background = '';
                document.getElementById('liveStreamBtn').style.background = '';
                startVideoRotation();
            }
        }

        // ==================== KANAL SÄ°STEMÄ° ====================
        function toggleChannelList() {
            document.getElementById('channelList').classList.toggle('active');
        }

        function loadChannels() {
            const container = document.getElementById('channelsContainer');
            container.innerHTML = '';
            
            channels.forEach(channel => {
                const item = document.createElement('div');
                item.className = 'channel-item';
                if (currentChannel && channel.id === currentChannel.id) {
                    item.classList.add('active');
                }
                item.onclick = () => switchChannel(channel);
                
                item.innerHTML = `
                    <div class="channel-name">
                        ${channel.name}
                        ${channel.private ? '<i class="fas fa-lock channel-private"></i>' : ''}
                    </div>
                    <div class="channel-topic">${channel.topic || 'Konu yok'}</div>
                    <div class="channel-stats">
                        <span>ðŸ‘¥ ${channel.users.length}</span>
                        <span>ðŸ’¬ ${channel.messages.length}</span>
                    </div>
                `;
                
                container.appendChild(item);
            });
            
            document.getElementById('channelCount').textContent = channels.length;
        }

        function openCreateChannelModal() {
            document.getElementById('createChannelModal').classList.add('active');
        }

        function closeCreateChannelModal() {
            document.getElementById('createChannelModal').classList.remove('active');
        }

        function createChannel() {
            const name = document.getElementById('channelNameInput').value.trim();
            const topic = document.getElementById('channelTopicInput').value.trim();
            const isPrivate = document.getElementById('channelPrivateCheckbox').checked;
            
            if (!name) {
                alert('Kanal adÄ± gerekli!');
                return;
            }
            
            const channel = {
                id: name.toLowerCase().replace(/[^a-z0-9]/g, '_') + '_' + Date.now(),
                name: name.startsWith('#') ? name : `#${name}`,
                topic: topic,
                owner: currentUser.id,
                private: isPrivate,
                users: [currentUser.id],
                messages: [],
                created: new Date(),
                operators: [currentUser.id]
            };
            
            channels.push(channel);
            loadChannels();
            closeCreateChannelModal();
            switchChannel(channel);
            
            addNotification(`ðŸŽ‰ Kanal oluÅŸturuldu: ${channel.name}`);
            logActivity(`${currentUser.name} yeni kanal oluÅŸturdu: ${channel.name}`);
        }

        function switchChannel(channel) {
            currentChannel = channel;
            
            // KullanÄ±cÄ±yÄ± kanala ekle (eÄŸer yoksa)
            if (!channel.users.includes(currentUser.id)) {
                channel.users.push(currentUser.id);
            }
            
            // UI gÃ¼ncelle
            document.getElementById('currentChannel').textContent = channel.name;
            document.getElementById('channelTopic').textContent = channel.topic || 'Konu yok';
            
            // MesajlarÄ± yÃ¼kle
            loadChannelMessages();
            
            // KanallarÄ± yenile
            loadChannels();
        }

        function setupDefaultChannel() {
            if (channels.length > 0) {
                switchChannel(channels[0]);
            }
        }

        // ==================== MESAJ SÄ°STEMÄ° ====================
        function loadChannelMessages() {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML = '';
            
            if (!currentChannel || !currentChannel.messages) return;
            
            currentChannel.messages.forEach(msg => {
                addMessageToChat(msg);
            });
            
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            
            if (!text || !currentChannel) return;
            
            // Komut kontrolÃ¼
            if (text.startsWith('/')) {
                handleCommand(text);
                input.value = '';
                return;
            }
            
            const message = {
                id: Date.now(),
                user: currentUser,
                text: text,
                time: new Date(),
                channel: currentChannel.id,
                type: 'text'
            };
            
            currentChannel.messages.push(message);
            addMessageToChat(message);
            
            currentUser.messages++;
            updateUserInfo();
            
            input.value = '';
            
            // DiÄŸer kullanÄ±cÄ±lara cevap (simÃ¼lasyon)
            simulateResponse(text);
        }

        function addMessageToChat(msg) {
            const chatMessages = document.getElementById('chatMessages');
            const isOwn = msg.user.id === currentUser.id;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isOwn ? 'message-outgoing' : 'message-incoming'}`;
            
            const timeStr = msg.time.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
            
            messageDiv.innerHTML = `
                <div class="message-sender">
                    ${msg.user.name}
                    ${msg.user.role !== 'user' && msg.user.role !== 'bot' ? 
                      `<span class="user-role ${msg.user.role}">${msg.user.role}</span>` : ''}
                </div>
                <div class="message-text">
                    ${escapeHtml(msg.text)}
                    ${isOwn ? `<span class="message-delete" onclick="deleteMessage(${msg.id})"><i class="fas fa-trash"></i></span>` : ''}
                </div>
                <div class="message-time">${timeStr}</div>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function sendSystemMessage(text) {
            if (!currentChannel) return;
            
            const message = {
                id: Date.now(),
                user: mateBot,
                text: text,
                time: new Date(),
                channel: currentChannel.id,
                type: 'system'
            };
            
            currentChannel.messages.push(message);
            addMessageToChat(message);
        }

        function deleteMessage(messageId) {
            if (!currentChannel) return;
            
            const messageIndex = currentChannel.messages.findIndex(m => m.id === messageId);
            if (messageIndex !== -1) {
                const message = currentChannel.messages[messageIndex];
                const canDelete = isOwner || isAdmin || 
                                 currentChannel.owner === currentUser.id ||
                                 currentChannel.operators.includes(currentUser.id) ||
                                 message.user.id === currentUser.id;
                
                if (canDelete) {
                    currentChannel.messages.splice(messageIndex, 1);
                    loadChannelMessages();
                    addNotification('Mesaj silindi');
                }
            }
        }

        function simulateResponse(text) {
            setTimeout(() => {
                const onlineUsers = users.filter(u => u.online && u.id !== currentUser.id && u.id !== mateBot.id);
                if (onlineUsers.length > 0 && Math.random() > 0.5) {
                    const randomUser = onlineUsers[Math.floor(Math.random() * onlineUsers.length)];
                    const responses = [
                        'GÃ¼zel!', 'KatÄ±lÄ±yorum', 'ðŸ‘', 'Harika!',
                        'TeÅŸekkÃ¼rler', 'Evet Ã¶yle', 'HaklÄ±sÄ±n'
                    ];
                    const response = responses[Math.floor(Math.random() * responses.length)];
                    
                    const responseMessage = {
                        id: Date.now(),
                        user: randomUser,
                        text: response,
                        time: new Date(),
                        channel: currentChannel.id,
                        type: 'text'
                    };
                    
                    currentChannel.messages.push(responseMessage);
                    addMessageToChat(responseMessage);
                }
            }, 1000 + Math.random() * 2000);
        }

        // ==================== KULLANICI SÄ°STEMÄ° ====================
        function loadUsers() {
            const userList = document.getElementById('userList');
            userList.innerHTML = '';
            
            const onlineUsers = users.filter(u => u.online);
            
            onlineUsers.forEach(user => {
                if (user.id === currentUser.id) return;
                
                const userItem = document.createElement('div');
                userItem.className = 'user-item';
                userItem.onclick = () => openPrivateChat(user);
                
                const unread = unreadMessages[user.id] || 0;
                
                userItem.innerHTML = `
                    <div class="user-avatar ${user.online ? 'online' : ''}">
                        ${user.avatar}
                    </div>
                    <div class="user-info">
                        <div class="user-name">
                            ${user.name}
                            ${user.role !== 'user' && user.role !== 'bot' ? 
                              `<span class="user-role ${user.role}">${user.role}</span>` : ''}
                            ${unread > 0 ? `<span style="margin-left: auto; background: var(--accent-red); color: white; font-size: 10px; padding: 1px 6px; border-radius: 10px;">${unread}</span>` : ''}
                        </div>
                        <div class="user-status">${user.online ? 'ðŸŸ¢ Ã‡evrimiÃ§i' : 'âš« Ã‡evrimdÄ±ÅŸÄ±'}</div>
                    </div>
                `;
                
                userList.appendChild(userItem);
            });
            
            document.getElementById('onlineCount').textContent = onlineUsers.length;
        }

        function searchUsers(query) {
            const userItems = document.querySelectorAll('.user-item');
            query = query.toLowerCase();
            
            userItems.forEach(item => {
                const userName = item.querySelector('.user-name').textContent.toLowerCase();
                item.style.display = userName.includes(query) ? 'flex' : 'none';
            });
        }

        function updateOnlineStatus() {
            users.forEach(user => {
                if (user.id !== currentUser.id && user.id !== mateBot.id && Math.random() > 0.7) {
                    user.online = false;
                }
            });
            loadUsers();
        }

        function updateUserInfo() {
            const userInfo = document.getElementById('userInfo');
            if (!userInfo || !currentUser) return;
            
            userInfo.innerHTML = `
                <div class="user-avatar">
                    ${currentUser.avatar}
                </div>
                <div style="text-align: right;">
                    <div class="user-name">${currentUser.name}</div>
                    <span class="user-role ${currentUser.role}">${currentUser.role}</span>
                </div>
            `;
        }

        // ==================== Ã–ZEL SOHBET ====================
        function openPrivateChat(user) {
            const chatId = [currentUser.id, user.id].sort().join('_');
            
            if (!privateChats.has(chatId)) {
                privateChats.set(chatId, {
                    id: chatId,
                    users: [currentUser, user],
                    messages: [],
                    created: new Date()
                });
            }
            
            updatePrivateChatsPanel();
            
            // Basit Ã¶zel sohbet modalÄ±
            const message = prompt(`${user.name} kullanÄ±cÄ±sÄ±na Ã¶zel mesaj gÃ¶nder:`);
            if (message) {
                const chat = privateChats.get(chatId);
                chat.messages.push({
                    id: Date.now(),
                    user: currentUser,
                    text: message,
                    time: new Date()
                });
                
                unreadMessages[user.id] = (unreadMessages[user.id] || 0) + 1;
                updatePrivateChatsPanel();
                loadUsers();
                
                // Cevap simÃ¼lasyonu
                setTimeout(() => {
                    const responses = ['TeÅŸekkÃ¼rler!', 'AnladÄ±m.', 'Tamam.', 'GÃ¼zel.'];
                    const response = responses[Math.floor(Math.random() * responses.length)];
                    
                    chat.messages.push({
                        id: Date.now(),
                        user: user,
                        text: response,
                        time: new Date()
                    });
                    
                    unreadMessages[currentUser.id] = (unreadMessages[currentUser.id] || 0) + 1;
                    addNotification(`${user.name}: ${response}`);
                }, 1000 + Math.random() * 2000);
            }
        }

        function updatePrivateChatsPanel() {
            const panel = document.getElementById('privateChatsPanel');
            panel.innerHTML = '';
            
            privateChats.forEach((chat, chatId) => {
                const otherUser = chat.users.find(u => u.id !== currentUser.id);
                if (!otherUser) return;
                
                const unread = unreadMessages[otherUser.id] || 0;
                
                const chatBtn = document.createElement('div');
                chatBtn.className = 'private-chat-minimized';
                chatBtn.title = otherUser.name;
                chatBtn.onclick = () => showPrivateChatModal(chatId);
                
                chatBtn.innerHTML = `
                    ${otherUser.avatar}
                    ${unread > 0 ? `<span class="unread-badge">${unread}</span>` : ''}
                `;
                
                panel.appendChild(chatBtn);
            });
        }

        // ==================== OWNER PANELÄ° ====================
        function toggleOwnerPanel() {
            if (!isOwner) {
                alert('Bu panele sadece Owner eriÅŸebilir!');
                return;
            }
            
            document.getElementById('ownerPanel').classList.toggle('active');
            
            if (document.getElementById('ownerPanel').classList.contains('active')) {
                loadOwnerPanel();
            }
        }

        function loadOwnerPanel() {
            const content = document.getElementById('ownerContent');
            content.innerHTML = `
                <div style="padding: var(--spacing-lg);">
                    <h4 style="margin-bottom: var(--spacing-md);">Owner Kontrolleri</h4>
                    <div style="display: flex; flex-direction: column; gap: var(--spacing-sm);">
                        <button class="action-btn primary" onclick="ownerKickAll()">
                            <i class="fas fa-user-slash"></i> TÃ¼m KullanÄ±cÄ±larÄ± Ã‡Ä±kar
                        </button>
                        <button class="action-btn" onclick="ownerAddAdmin()">
                            <i class="fas fa-user-plus"></i> Admin Ekle
                        </button>
                        <button class="action-btn" onclick="ownerSystemMessage()">
                            <i class="fas fa-bullhorn"></i> Sistem MesajÄ±
                        </button>
                        <button class="action-btn danger" onclick="ownerClearChat()">
                            <i class="fas fa-trash"></i> Sohbeti Temizle
                        </button>
                    </div>
                    
                    <h4 style="margin-top: var(--spacing-lg); margin-bottom: var(--spacing-md);">CanlÄ± Ä°zleme</h4>
                    <div id="ownerMonitoring">
                        ${privateChats.size > 0 ? 
                          `<p>${privateChats.size} Ã¶zel sohbet aktif</p>` : 
                          '<p>HenÃ¼z Ã¶zel sohbet yok</p>'}
                    </div>
                </div>
            `;
        }

        function ownerKickAll() {
            if (!isOwner) return;
            
            if (confirm('TÃ¼m kullanÄ±cÄ±larÄ± Ã§Ä±kartmak istediÄŸinize emin misiniz?')) {
                users.forEach(u => {
                    if (u.id !== currentUser.id && u.id !== mateBot.id) {
                        u.online = false;
                    }
                });
                loadUsers();
                sendSystemMessage('ðŸšª Owner tÃ¼m kullanÄ±cÄ±larÄ± Ã§Ä±karttÄ±.');
            }
        }

        function ownerAddAdmin() {
            if (!isOwner) return;
            
            const nick = prompt('Admin yapÄ±lacak kullanÄ±cÄ± nicki:');
            if (nick) {
                const user = users.find(u => u.name.toLowerCase() === nick.toLowerCase());
                if (user) {
                    user.role = 'admin';
                    addNotification(`${user.name} admin yapÄ±ldÄ±`);
                    sendSystemMessage(`âš¡ ${user.name} admin yapÄ±ldÄ±.`);
                }
            }
        }

        function ownerSystemMessage() {
            if (!isOwner) return;
            
            const message = prompt('Sistem mesajÄ±:');
            if (message) {
                sendSystemMessage(`ðŸ“¢ SÄ°STEM: ${message}`);
            }
        }

        function ownerClearChat() {
            if (!isOwner) return;
            
            if (confirm('TÃ¼m sohbet mesajlarÄ±nÄ± silmek istediÄŸinize emin misiniz?')) {
                if (currentChannel) {
                    currentChannel.messages = [];
                    loadChannelMessages();
                    sendSystemMessage('ðŸ—‘ï¸ Owner sohbeti temizledi.');
                }
            }
        }

        // ==================== BÄ°LDÄ°RÄ°M SÄ°STEMÄ° ====================
        function toggleNotifications() {
            alert(`Bildirimler: ${notifications.length} yeni\n\n${notifications.slice(0, 5).map(n => n.text).join('\n')}`);
        }

        function addNotification(text) {
            notifications.unshift({
                id: Date.now(),
                text: text,
                time: new Date(),
                read: false
            });
            
            const badge = document.getElementById('notificationBadge');
            const unread = notifications.filter(n => !n.read).length;
            badge.textContent = unread > 9 ? '9+' : unread;
            badge.style.display = unread > 0 ? 'flex' : 'none';
        }

        function logActivity(text) {
            systemActivity.unshift({
                id: Date.now(),
                text: text,
                time: new Date(),
                user: currentUser.name
            });
        }

        // ==================== KOMUT SÄ°STEMÄ° ====================
        function handleCommand(command) {
            const parts = command.split(' ');
            const cmd = parts[0].toLowerCase();
            const args = parts.slice(1);
            
            switch(cmd) {
                case '/help':
                    showHelp();
                    break;
                case '/users':
                    listUsers();
                    break;
                case '/channels':
                    listChannels();
                    break;
                case '/nick':
                    if (args.length > 0) changeNick(args[0]);
                    break;
                case '/msg':
                    if (args.length > 1) sendPrivateMessageCommand(args[0], args.slice(1).join(' '));
                    break;
                default:
                    const mateCmd = mateBotCommands.find(c => c.command === cmd);
                    if (mateCmd) {
                        sendSystemMessage(`ðŸ¤– ${cmd}: ${mateCmd.description}`);
                    } else {
                        sendSystemMessage(`âŒ Bilinmeyen komut: ${cmd}`);
                    }
            }
        }

        function showHelp() {
            let helpText = 'ðŸ“‹ KullanÄ±labilir Komutlar:\n\n';
            
            mateBotCommands.forEach(cmd => {
                helpText += `  ${cmd.command} - ${cmd.description}\n`;
            });
            
            if (isOwner || isAdmin) {
                helpText += '\nðŸ›¡ï¸ Yetkili KomutlarÄ±:\n';
                helpText += '  /kick <nick> - KullanÄ±cÄ±yÄ± at\n';
                helpText += '  /ban <nick> - KullanÄ±cÄ±yÄ± yasakla\n';
            }
            
            sendSystemMessage(helpText);
        }

        function listUsers() {
            const onlineUsers = users.filter(u => u.online);
            let userList = `ðŸ‘¥ Ã‡evrimiÃ§i KullanÄ±cÄ±lar (${onlineUsers.length}):\n\n`;
            
            onlineUsers.forEach(user => {
                userList += `  ${user.name} (${user.role})${user.id === currentUser.id ? ' ðŸ‘ˆ Siz' : ''}\n`;
            });
            
            sendSystemMessage(userList);
        }

        function listChannels() {
            let channelList = `ðŸ“º Kanallar (${channels.length}):\n\n`;
            
            channels.forEach(channel => {
                channelList += `  ${channel.name} - ${channel.topic || 'Konu yok'} (${channel.users.length} kiÅŸi)\n`;
            });
            
            sendSystemMessage(channelList);
        }

        function changeNick(newNick) {
            if (!newNick) return;
            
            const oldName = currentUser.name;
            currentUser.name = newNick;
            currentUser.avatar = newNick.charAt(0).toUpperCase();
            
            updateUserInfo();
            loadUsers();
            
            sendSystemMessage(`ðŸ“ ${oldName} nick deÄŸiÅŸtirdi: ${newNick}`);
        }

        function sendPrivateMessageCommand(targetNick, message) {
            const targetUser = users.find(u => 
                u.name.toLowerCase() === targetNick.toLowerCase() || 
                u.id.toLowerCase().includes(targetNick.toLowerCase())
            );
            
            if (targetUser) {
                openPrivateChat(targetUser);
                // Mesaj gÃ¶nderme iÅŸlemi burada yapÄ±labilir
                addNotification(`${targetUser.name} kullanÄ±cÄ±sÄ±na mesaj gÃ¶nderildi: ${message.substring(0, 30)}...`);
            } else {
                sendSystemMessage(`âŒ KullanÄ±cÄ± bulunamadÄ±: ${targetNick}`);
            }
        }

        // ==================== YARDIMCI FONKSÄ°YONLAR ====================
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function openStoryCreator() {
            alert('Hikaye Ã¶zelliÄŸi aktif edilecek...');
        }

        function toggleProfilePanel() {
            alert('Profil paneli aktif edilecek...');
        }

        // ==================== EVENT LISTENERS ====================
        document.addEventListener('DOMContentLoaded', function() {
            // Mesaj gÃ¶nderme
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            // Textarea boyutu
            document.getElementById('messageInput').addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = this.scrollHeight + 'px';
            });
            
            // Login enter
            document.getElementById('nickInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') handleLogin();
            });
            
            // Nick Ã¶nerisi
            document.getElementById('nickSuggestion').onclick = function() {
                document.getElementById('nickInput').value = this.textContent;
            };
            
            // Owner kullanÄ±cÄ±sÄ±nÄ± ekle
            registeredNicks.add('mateky');
            users.push(ownerUser);
        });
    </script>
</body>
</html>
